main {
	name = "freeradius"
	prefix = "/usr"
	localstatedir = "/var"
	sbindir = "/usr/sbin"
	logdir = "/var/log/freeradius"
	run_dir = "/var/run/freeradius"
	libdir = "/usr/lib/freeradius"
	radacctdir = "/var/log/freeradius/radacct"
	hostname_lookups = no
	max_request_time = 30
	cleanup_delay = 5
	max_requests = 16384
	pidfile = "/var/run/freeradius/freeradius.pid"
	checkrad = "/usr/sbin/checkrad"
	debug_level = 0
	proxy_requests = yes
 log {
 	stripped_names = no
 	auth = no
 	auth_badpass = no
 	auth_goodpass = no
 	colourise = yes
 	msg_denied = "You are already logged in - access denied"
 }
 resources {
 }
 security {
 	max_attributes = 200
 	reject_delay = 1.000000
 	status_server = yes
 }
}
radiusd: #### Loading Realms and Home Servers ####
 proxy server {
 	retry_delay = 5
 	retry_count = 3
 	default_fallback = no
 	dead_time = 120
 	wake_all_if_all_dead = no
 }
 home_server localhost {
 	ipaddr = 127.0.0.1
 	port = 1812
 	type = "auth"
 	secret = <<< secret >>>
 	response_window = 20.000000
 	response_timeouts = 1
 	max_outstanding = 65536
 	zombie_period = 40
 	status_check = "status-server"
 	ping_interval = 30
 	check_interval = 30
 	check_timeout = 4
 	num_answers_to_alive = 3
 	revive_interval = 120
  limit {
  	max_connections = 16
  	max_requests = 0
  	lifetime = 0
  	idle_timeout = 0
  }
  coa {
  	irt = 2
  	mrt = 16
  	mrc = 5
  	mrd = 30
  }
 }
 home_server_pool my_auth_failover {
	type = fail-over
	home_server = localhost
 }
 realm example.com {
	auth_pool = my_auth_failover
 }
 realm LOCAL {
 }
radiusd: #### Loading Clients ####
 client localhost {
 	ipaddr = 127.0.0.1
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	nas_type = "other"
 	proto = "*"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client localhost_ipv6 {
 	ipv6addr = ::1
 	require_message_authenticator = no
 	secret = <<< secret >>>
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
Debug state unknown (cap_sys_ptrace capability not set)
 # Creating Auth-Type = digest
radiusd: #### Instantiating modules ####
  # Loaded module rlm_always
  # Loading module "reject" from file /etc/freeradius/mods-enabled/always
  always reject {
  	rcode = "reject"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "fail" from file /etc/freeradius/mods-enabled/always
  always fail {
  	rcode = "fail"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "ok" from file /etc/freeradius/mods-enabled/always
  always ok {
  	rcode = "ok"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "handled" from file /etc/freeradius/mods-enabled/always
  always handled {
  	rcode = "handled"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "invalid" from file /etc/freeradius/mods-enabled/always
  always invalid {
  	rcode = "invalid"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "userlock" from file /etc/freeradius/mods-enabled/always
  always userlock {
  	rcode = "userlock"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "notfound" from file /etc/freeradius/mods-enabled/always
  always notfound {
  	rcode = "notfound"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "noop" from file /etc/freeradius/mods-enabled/always
  always noop {
  	rcode = "noop"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "updated" from file /etc/freeradius/mods-enabled/always
  always updated {
  	rcode = "updated"
  	simulcount = 0
  	mpp = no
  }
  # Loaded module rlm_attr_filter
  # Loading module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.post-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/post-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.pre-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/pre-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_reject {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_reject"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_challenge {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_challenge"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.accounting_response {
  	filename = "/etc/freeradius/mods-config/attr_filter/accounting_response"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loaded module rlm_cache
  # Loading module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
  cache cache_eap {
  	driver = "rlm_cache_rbtree"
  	key = "%{%{control:State}:-%{%{reply:State}:-%{State}}}"
  	ttl = 15
  	max_entries = 0
  	epoch = 0
  	add_stats = no
  }
  # Loaded module rlm_chap
  # Loading module "chap" from file /etc/freeradius/mods-enabled/chap
  # Loaded module rlm_detail
  # Loading module "detail" from file /etc/freeradius/mods-enabled/detail
  detail {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
  detail auth_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/auth-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  detail reply_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/reply-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail pre_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/pre-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail post_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/post-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loaded module rlm_digest
  # Loading module "digest" from file /etc/freeradius/mods-enabled/digest
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_eap
  # Loading module "eap" from file /etc/freeradius/mods-enabled/eap
  eap {
  	default_eap_type = "md5"
  	timer_expire = 60
  	ignore_unknown_eap_types = no
  	cisco_accounting_username_bug = no
  	max_sessions = 16384
  }
  # Loaded module rlm_exec
  # Loading module "echo" from file /etc/freeradius/mods-enabled/echo
  exec echo {
  	wait = yes
  	program = "/bin/echo %{User-Name}"
  	input_pairs = "request"
  	output_pairs = "reply"
  	shell_escape = yes
  }
  # Loading module "exec" from file /etc/freeradius/mods-enabled/exec
  exec {
  	wait = no
  	input_pairs = "request"
  	shell_escape = yes
  	timeout = 10
  }
  # Loaded module rlm_expiration
  # Loading module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Loaded module rlm_expr
  # Loading module "expr" from file /etc/freeradius/mods-enabled/expr
  expr {
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /äéöüàâæçèéêëîïôœùûüaÿÄÉÖÜßÀÂÆÇÈÉÊËÎÏÔŒÙÛÜŸ"
  }
  # Loaded module rlm_files
  # Loading module "files" from file /etc/freeradius/mods-enabled/files
  files {
  	filename = "/etc/freeradius/mods-config/files/authorize"
  	acctusersfile = "/etc/freeradius/mods-config/files/accounting"
  	preproxy_usersfile = "/etc/freeradius/mods-config/files/pre-proxy"
  }
  # Loaded module rlm_linelog
  # Loading module "linelog" from file /etc/freeradius/mods-enabled/linelog
  linelog {
  	filename = "/var/log/freeradius/linelog"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = "This is a log message for %{User-Name}"
  	reference = "messages.%{%{reply:Packet-Type}:-default}"
  }
  # Loading module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  linelog log_accounting {
  	filename = "/var/log/freeradius/linelog-accounting"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = ""
  	reference = "Accounting-Request.%{%{Acct-Status-Type}:-unknown}"
  }
  # Loaded module rlm_logintime
  # Loading module "logintime" from file /etc/freeradius/mods-enabled/logintime
  logintime {
  	minimum_timeout = 60
  }
  # Loaded module rlm_mschap
  # Loading module "mschap" from file /etc/freeradius/mods-enabled/mschap
  mschap {
  	use_mppe = yes
  	require_encryption = no
  	require_strong = no
  	with_ntdomain_hack = yes
   passchange {
   }
  	allow_retry = yes
  }
  # Loading module "ntlm_auth" from file /etc/freeradius/mods-enabled/ntlm_auth
  exec ntlm_auth {
  	wait = yes
  	program = "/path/to/ntlm_auth --request-nt-key --domain=MYDOMAIN --username=%{mschap:User-Name} --password=%{User-Password}"
  	shell_escape = yes
  }
  # Loaded module rlm_pap
  # Loading module "pap" from file /etc/freeradius/mods-enabled/pap
  pap {
  	normalise = yes
  }
  # Loaded module rlm_passwd
  # Loading module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
  passwd etc_passwd {
  	filename = "/etc/passwd"
  	format = "*User-Name:Crypt-Password:"
  	delimiter = ":"
  	ignore_nislike = no
  	ignore_empty = yes
  	allow_multiple_keys = no
  	hash_size = 100
  }
  # Loaded module rlm_preprocess
  # Loading module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
  preprocess {
  	huntgroups = "/etc/freeradius/mods-config/preprocess/huntgroups"
  	hints = "/etc/freeradius/mods-config/preprocess/hints"
  	with_ascend_hack = no
  	ascend_channels_per_line = 23
  	with_ntdomain_hack = no
  	with_specialix_jetstream_hack = no
  	with_cisco_vsa_hack = no
  	with_alvarion_vsa_hack = no
  }
  # Loaded module rlm_radutmp
  # Loading module "radutmp" from file /etc/freeradius/mods-enabled/radutmp
  radutmp {
  	filename = "/var/log/freeradius/radutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 384
  	caller_id = yes
  }
  # Loaded module rlm_realm
  # Loading module "IPASS" from file /etc/freeradius/mods-enabled/realm
  realm IPASS {
  	format = "prefix"
  	delimiter = "/"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "suffix" from file /etc/freeradius/mods-enabled/realm
  realm suffix {
  	format = "suffix"
  	delimiter = "@"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  realm realmpercent {
  	format = "suffix"
  	delimiter = "%"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "ntdomain" from file /etc/freeradius/mods-enabled/realm
  realm ntdomain {
  	format = "prefix"
  	delimiter = "\\"
  	ignore_default = no
  	ignore_null = no
  }
  # Loaded module rlm_replicate
  # Loading module "replicate" from file /etc/freeradius/mods-enabled/replicate
  # Loaded module rlm_soh
  # Loading module "soh" from file /etc/freeradius/mods-enabled/soh
  soh {
  	dhcp = yes
  }
  # Loading module "sradutmp" from file /etc/freeradius/mods-enabled/sradutmp
  radutmp sradutmp {
  	filename = "/var/log/freeradius/sradutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 420
  	caller_id = no
  }
  # Loaded module rlm_unix
  # Loading module "unix" from file /etc/freeradius/mods-enabled/unix
  unix {
  	radwtmp = "/var/log/freeradius/radwtmp"
  }
Creating attribute Unix-Group
  # Loaded module rlm_unpack
  # Loading module "unpack" from file /etc/freeradius/mods-enabled/unpack
  # Loaded module rlm_utf8
  # Loading module "utf8" from file /etc/freeradius/mods-enabled/utf8
 instantiate {
 }
 modules {
  # Instantiating module "reject" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "fail" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "ok" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "handled" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "invalid" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "userlock" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "notfound" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "noop" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "updated" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/post-proxy
  # Instantiating module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/pre-proxy
  # Instantiating module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_reject
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay" 	found in filter list for realm "DEFAULT". 
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay-USec" 	found in filter list for realm "DEFAULT". 
  # Instantiating module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_challenge
  # Instantiating module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/accounting_response
  # Instantiating module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
rlm_cache (cache_eap): Driver rlm_cache_rbtree (module rlm_cache_rbtree) loaded and linked
  # Instantiating module "detail" from file /etc/freeradius/mods-enabled/detail
  # Instantiating module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
rlm_detail (auth_log): 'User-Password' suppressed, will not appear in detail output
  # Instantiating module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "eap" from file /etc/freeradius/mods-enabled/eap
   # Linked to sub-module rlm_eap_md5
   # Linked to sub-module rlm_eap_leap
   # Linked to sub-module rlm_eap_gtc
   gtc {
   	challenge = "Password: "
   	auth_type = "PAP"
   }
   # Linked to sub-module rlm_eap_tls
   tls {
   	tls = "tls-common"
   }
   tls-config tls-common {
   	rsa_key_exchange = no
   	dh_key_exchange = yes
   	rsa_key_length = 512
   	dh_key_length = 512
   	verify_depth = 0
   	ca_path = "/etc/freeradius/certs"
   	pem_file_type = yes
   	private_key_file = "/etc/freeradius/certs/server.pem"
   	certificate_file = "/etc/freeradius/certs/server.pem"
   	ca_file = "/etc/freeradius/certs/ca.pem"
   	private_key_password = <<< secret >>>
   	dh_file = "/etc/freeradius/certs/dh"
   	fragment_size = 1024
   	include_length = yes
   	check_crl = no
   	check_all_crl = no
   	cipher_list = "DEFAULT"
   	ecdh_curve = "prime256v1"
    cache {
    	enable = yes
    	lifetime = 24
    	max_entries = 255
    }
    verify {
    }
    ocsp {
    	enable = no
    	override_cert_url = yes
    	url = "http://127.0.0.1/ocsp/"
    	use_nonce = yes
    	timeout = 0
    	softfail = no
    }
   }
   # Linked to sub-module rlm_eap_ttls
   ttls {
   	tls = "tls-common"
   	default_eap_type = "md5"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	virtual_server = "inner-tunnel"
   	include_length = yes
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_peap
   peap {
   	tls = "tls-common"
   	default_eap_type = "mschapv2"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	proxy_tunneled_request_as_eap = yes
   	virtual_server = "inner-tunnel"
   	soh = no
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_mschapv2
   mschapv2 {
   	with_ntdomain_hack = no
   	send_error = no
   }
  # Instantiating module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Instantiating module "files" from file /etc/freeradius/mods-enabled/files
reading pairlist file /etc/freeradius/mods-config/files/authorize
reading pairlist file /etc/freeradius/mods-config/files/accounting
reading pairlist file /etc/freeradius/mods-config/files/pre-proxy
  # Instantiating module "linelog" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "logintime" from file /etc/freeradius/mods-enabled/logintime
  # Instantiating module "mschap" from file /etc/freeradius/mods-enabled/mschap
rlm_mschap (mschap): using internal authentication
  # Instantiating module "pap" from file /etc/freeradius/mods-enabled/pap
  # Instantiating module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
rlm_passwd: nfields: 3 keyfield 0(User-Name) listable: no
  # Instantiating module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
reading pairlist file /etc/freeradius/mods-config/preprocess/huntgroups
reading pairlist file /etc/freeradius/mods-config/preprocess/hints
  # Instantiating module "IPASS" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "suffix" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "ntdomain" from file /etc/freeradius/mods-enabled/realm
 } # modules
radiusd: #### Loading Virtual Servers ####
server { # from file /etc/freeradius/radiusd.conf
} # server
server default { # from file /etc/freeradius/sites-enabled/default
 # Loading authenticate {...}
 # Loading authorize {...}
Ignoring "sql" (see raddb/mods-available/README.rst)
Ignoring "ldap" (see raddb/mods-available/README.rst)
 # Loading preacct {...}
 # Loading accounting {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server default
server inner-tunnel { # from file /etc/freeradius/sites-enabled/inner-tunnel
 # Loading authenticate {...}
 # Loading authorize {...}
 # Loading session {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server inner-tunnel
 thread pool {
 	start_servers = 5
 	max_servers = 32
 	min_spare_servers = 3
 	max_spare_servers = 10
 	max_requests_per_server = 0
 	cleanup_delay = 5
 	max_queue_size = 65536
 	auto_limit_acct = no
 }
Thread spawned new child 1. Total threads in pool: 1
Thread 1 waiting to be assigned a request
Thread spawned new child 2. Total threads in pool: 2
Thread spawned new child 3. Total threads in pool: 3
Thread spawned new child 4. Total threads in pool: 4
Thread spawned new child 5. Total threads in pool: 5
Thread pool initialized
radiusd: #### Opening IP addresses and Ports ####
listen {
  	type = "auth"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
Thread 2 waiting to be assigned a request
Thread 5 waiting to be assigned a request
Thread 4 waiting to be assigned a request
Thread 3 waiting to be assigned a request
}
listen {
  	type = "acct"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "acct"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipaddr = 127.0.0.1
  	port = 18120
}
Listening on auth address * port 1812 bound to server default
Listening on acct address * port 1813 bound to server default
Listening on auth address :: port 1812 bound to server default
Listening on acct address :: port 1813 bound to server default
Listening on auth address 127.0.0.1 port 18120 bound to server inner-tunnel
Listening on proxy address * port 39455
Listening on proxy address :: port 54658
Ready to process requests
main {
	name = "freeradius"
	prefix = "/usr"
	localstatedir = "/var"
	sbindir = "/usr/sbin"
	logdir = "/var/log/freeradius"
	run_dir = "/var/run/freeradius"
	libdir = "/usr/lib/freeradius"
	radacctdir = "/var/log/freeradius/radacct"
	hostname_lookups = no
	max_request_time = 30
	cleanup_delay = 5
	max_requests = 16384
	pidfile = "/var/run/freeradius/freeradius.pid"
	checkrad = "/usr/sbin/checkrad"
	debug_level = 0
	proxy_requests = yes
 log {
 	stripped_names = no
 	auth = no
 	auth_badpass = no
 	auth_goodpass = no
 	colourise = yes
 	msg_denied = "You are already logged in - access denied"
 }
 resources {
 }
 security {
 	max_attributes = 200
 	reject_delay = 1.000000
 	status_server = yes
 }
}
radiusd: #### Loading Realms and Home Servers ####
 proxy server {
 	retry_delay = 5
 	retry_count = 3
 	default_fallback = no
 	dead_time = 120
 	wake_all_if_all_dead = no
 }
 home_server localhost {
 	ipaddr = 127.0.0.1
 	port = 1812
 	type = "auth"
 	secret = <<< secret >>>
 	response_window = 20.000000
 	response_timeouts = 1
 	max_outstanding = 65536
 	zombie_period = 40
 	status_check = "status-server"
 	ping_interval = 30
 	check_interval = 30
 	check_timeout = 4
 	num_answers_to_alive = 3
 	revive_interval = 120
  limit {
  	max_connections = 16
  	max_requests = 0
  	lifetime = 0
  	idle_timeout = 0
  }
  coa {
  	irt = 2
  	mrt = 16
  	mrc = 5
  	mrd = 30
  }
 }
 home_server_pool my_auth_failover {
	type = fail-over
	home_server = localhost
 }
 realm example.com {
	auth_pool = my_auth_failover
 }
 realm LOCAL {
 }
radiusd: #### Loading Clients ####
 client localhost {
 	ipaddr = 127.0.0.1
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	nas_type = "other"
 	proto = "*"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client localhost_ipv6 {
 	ipv6addr = ::1
 	require_message_authenticator = no
 	secret = <<< secret >>>
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
Debug state unknown (cap_sys_ptrace capability not set)
 # Creating Auth-Type = digest
radiusd: #### Instantiating modules ####
  # Loaded module rlm_always
  # Loading module "reject" from file /etc/freeradius/mods-enabled/always
  always reject {
  	rcode = "reject"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "fail" from file /etc/freeradius/mods-enabled/always
  always fail {
  	rcode = "fail"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "ok" from file /etc/freeradius/mods-enabled/always
  always ok {
  	rcode = "ok"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "handled" from file /etc/freeradius/mods-enabled/always
  always handled {
  	rcode = "handled"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "invalid" from file /etc/freeradius/mods-enabled/always
  always invalid {
  	rcode = "invalid"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "userlock" from file /etc/freeradius/mods-enabled/always
  always userlock {
  	rcode = "userlock"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "notfound" from file /etc/freeradius/mods-enabled/always
  always notfound {
  	rcode = "notfound"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "noop" from file /etc/freeradius/mods-enabled/always
  always noop {
  	rcode = "noop"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "updated" from file /etc/freeradius/mods-enabled/always
  always updated {
  	rcode = "updated"
  	simulcount = 0
  	mpp = no
  }
  # Loaded module rlm_attr_filter
  # Loading module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.post-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/post-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.pre-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/pre-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_reject {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_reject"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_challenge {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_challenge"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.accounting_response {
  	filename = "/etc/freeradius/mods-config/attr_filter/accounting_response"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loaded module rlm_cache
  # Loading module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
  cache cache_eap {
  	driver = "rlm_cache_rbtree"
  	key = "%{%{control:State}:-%{%{reply:State}:-%{State}}}"
  	ttl = 15
  	max_entries = 0
  	epoch = 0
  	add_stats = no
  }
  # Loaded module rlm_chap
  # Loading module "chap" from file /etc/freeradius/mods-enabled/chap
  # Loaded module rlm_detail
  # Loading module "detail" from file /etc/freeradius/mods-enabled/detail
  detail {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
  detail auth_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/auth-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  detail reply_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/reply-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail pre_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/pre-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail post_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/post-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loaded module rlm_digest
  # Loading module "digest" from file /etc/freeradius/mods-enabled/digest
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_eap
  # Loading module "eap" from file /etc/freeradius/mods-enabled/eap
  eap {
  	default_eap_type = "md5"
  	timer_expire = 60
  	ignore_unknown_eap_types = no
  	cisco_accounting_username_bug = no
  	max_sessions = 16384
  }
  # Loaded module rlm_exec
  # Loading module "echo" from file /etc/freeradius/mods-enabled/echo
  exec echo {
  	wait = yes
  	program = "/bin/echo %{User-Name}"
  	input_pairs = "request"
  	output_pairs = "reply"
  	shell_escape = yes
  }
  # Loading module "exec" from file /etc/freeradius/mods-enabled/exec
  exec {
  	wait = no
  	input_pairs = "request"
  	shell_escape = yes
  	timeout = 10
  }
  # Loaded module rlm_expiration
  # Loading module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Loaded module rlm_expr
  # Loading module "expr" from file /etc/freeradius/mods-enabled/expr
  expr {
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /äéöüàâæçèéêëîïôœùûüaÿÄÉÖÜßÀÂÆÇÈÉÊËÎÏÔŒÙÛÜŸ"
  }
  # Loaded module rlm_files
  # Loading module "files" from file /etc/freeradius/mods-enabled/files
  files {
  	filename = "/etc/freeradius/mods-config/files/authorize"
  	acctusersfile = "/etc/freeradius/mods-config/files/accounting"
  	preproxy_usersfile = "/etc/freeradius/mods-config/files/pre-proxy"
  }
  # Loaded module rlm_linelog
  # Loading module "linelog" from file /etc/freeradius/mods-enabled/linelog
  linelog {
  	filename = "/var/log/freeradius/linelog"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = "This is a log message for %{User-Name}"
  	reference = "messages.%{%{reply:Packet-Type}:-default}"
  }
  # Loading module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  linelog log_accounting {
  	filename = "/var/log/freeradius/linelog-accounting"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = ""
  	reference = "Accounting-Request.%{%{Acct-Status-Type}:-unknown}"
  }
  # Loaded module rlm_logintime
  # Loading module "logintime" from file /etc/freeradius/mods-enabled/logintime
  logintime {
  	minimum_timeout = 60
  }
  # Loaded module rlm_mschap
  # Loading module "mschap" from file /etc/freeradius/mods-enabled/mschap
  mschap {
  	use_mppe = yes
  	require_encryption = no
  	require_strong = no
  	with_ntdomain_hack = yes
   passchange {
   }
  	allow_retry = yes
  }
  # Loading module "ntlm_auth" from file /etc/freeradius/mods-enabled/ntlm_auth
  exec ntlm_auth {
  	wait = yes
  	program = "/path/to/ntlm_auth --request-nt-key --domain=MYDOMAIN --username=%{mschap:User-Name} --password=%{User-Password}"
  	shell_escape = yes
  }
  # Loaded module rlm_pap
  # Loading module "pap" from file /etc/freeradius/mods-enabled/pap
  pap {
  	normalise = yes
  }
  # Loaded module rlm_passwd
  # Loading module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
  passwd etc_passwd {
  	filename = "/etc/passwd"
  	format = "*User-Name:Crypt-Password:"
  	delimiter = ":"
  	ignore_nislike = no
  	ignore_empty = yes
  	allow_multiple_keys = no
  	hash_size = 100
  }
  # Loaded module rlm_preprocess
  # Loading module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
  preprocess {
  	huntgroups = "/etc/freeradius/mods-config/preprocess/huntgroups"
  	hints = "/etc/freeradius/mods-config/preprocess/hints"
  	with_ascend_hack = no
  	ascend_channels_per_line = 23
  	with_ntdomain_hack = no
  	with_specialix_jetstream_hack = no
  	with_cisco_vsa_hack = no
  	with_alvarion_vsa_hack = no
  }
  # Loaded module rlm_radutmp
  # Loading module "radutmp" from file /etc/freeradius/mods-enabled/radutmp
  radutmp {
  	filename = "/var/log/freeradius/radutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 384
  	caller_id = yes
  }
  # Loaded module rlm_realm
  # Loading module "IPASS" from file /etc/freeradius/mods-enabled/realm
  realm IPASS {
  	format = "prefix"
  	delimiter = "/"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "suffix" from file /etc/freeradius/mods-enabled/realm
  realm suffix {
  	format = "suffix"
  	delimiter = "@"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  realm realmpercent {
  	format = "suffix"
  	delimiter = "%"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "ntdomain" from file /etc/freeradius/mods-enabled/realm
  realm ntdomain {
  	format = "prefix"
  	delimiter = "\\"
  	ignore_default = no
  	ignore_null = no
  }
  # Loaded module rlm_replicate
  # Loading module "replicate" from file /etc/freeradius/mods-enabled/replicate
  # Loaded module rlm_soh
  # Loading module "soh" from file /etc/freeradius/mods-enabled/soh
  soh {
  	dhcp = yes
  }
  # Loading module "sradutmp" from file /etc/freeradius/mods-enabled/sradutmp
  radutmp sradutmp {
  	filename = "/var/log/freeradius/sradutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 420
  	caller_id = no
  }
  # Loaded module rlm_unix
  # Loading module "unix" from file /etc/freeradius/mods-enabled/unix
  unix {
  	radwtmp = "/var/log/freeradius/radwtmp"
  }
Creating attribute Unix-Group
  # Loaded module rlm_unpack
  # Loading module "unpack" from file /etc/freeradius/mods-enabled/unpack
  # Loaded module rlm_utf8
  # Loading module "utf8" from file /etc/freeradius/mods-enabled/utf8
 instantiate {
 }
 modules {
  # Instantiating module "reject" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "fail" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "ok" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "handled" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "invalid" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "userlock" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "notfound" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "noop" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "updated" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/post-proxy
  # Instantiating module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/pre-proxy
  # Instantiating module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_reject
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay" 	found in filter list for realm "DEFAULT". 
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay-USec" 	found in filter list for realm "DEFAULT". 
  # Instantiating module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_challenge
  # Instantiating module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/accounting_response
  # Instantiating module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
rlm_cache (cache_eap): Driver rlm_cache_rbtree (module rlm_cache_rbtree) loaded and linked
  # Instantiating module "detail" from file /etc/freeradius/mods-enabled/detail
  # Instantiating module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
rlm_detail (auth_log): 'User-Password' suppressed, will not appear in detail output
  # Instantiating module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "eap" from file /etc/freeradius/mods-enabled/eap
   # Linked to sub-module rlm_eap_md5
   # Linked to sub-module rlm_eap_leap
   # Linked to sub-module rlm_eap_gtc
   gtc {
   	challenge = "Password: "
   	auth_type = "PAP"
   }
   # Linked to sub-module rlm_eap_tls
   tls {
   	tls = "tls-common"
   }
   tls-config tls-common {
   	rsa_key_exchange = no
   	dh_key_exchange = yes
   	rsa_key_length = 512
   	dh_key_length = 512
   	verify_depth = 0
   	ca_path = "/etc/freeradius/certs"
   	pem_file_type = yes
   	private_key_file = "/etc/freeradius/certs/server.pem"
   	certificate_file = "/etc/freeradius/certs/server.pem"
   	ca_file = "/etc/freeradius/certs/ca.pem"
   	private_key_password = <<< secret >>>
   	dh_file = "/etc/freeradius/certs/dh"
   	fragment_size = 1024
   	include_length = yes
   	check_crl = no
   	check_all_crl = no
   	cipher_list = "DEFAULT"
   	ecdh_curve = "prime256v1"
    cache {
    	enable = yes
    	lifetime = 24
    	max_entries = 255
    }
    verify {
    }
    ocsp {
    	enable = no
    	override_cert_url = yes
    	url = "http://127.0.0.1/ocsp/"
    	use_nonce = yes
    	timeout = 0
    	softfail = no
    }
   }
   # Linked to sub-module rlm_eap_ttls
   ttls {
   	tls = "tls-common"
   	default_eap_type = "md5"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	virtual_server = "inner-tunnel"
   	include_length = yes
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_peap
   peap {
   	tls = "tls-common"
   	default_eap_type = "mschapv2"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	proxy_tunneled_request_as_eap = yes
   	virtual_server = "inner-tunnel"
   	soh = no
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_mschapv2
   mschapv2 {
   	with_ntdomain_hack = no
   	send_error = no
   }
  # Instantiating module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Instantiating module "files" from file /etc/freeradius/mods-enabled/files
reading pairlist file /etc/freeradius/mods-config/files/authorize
reading pairlist file /etc/freeradius/mods-config/files/accounting
reading pairlist file /etc/freeradius/mods-config/files/pre-proxy
  # Instantiating module "linelog" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "logintime" from file /etc/freeradius/mods-enabled/logintime
  # Instantiating module "mschap" from file /etc/freeradius/mods-enabled/mschap
rlm_mschap (mschap): using internal authentication
  # Instantiating module "pap" from file /etc/freeradius/mods-enabled/pap
  # Instantiating module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
rlm_passwd: nfields: 3 keyfield 0(User-Name) listable: no
  # Instantiating module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
reading pairlist file /etc/freeradius/mods-config/preprocess/huntgroups
reading pairlist file /etc/freeradius/mods-config/preprocess/hints
  # Instantiating module "IPASS" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "suffix" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "ntdomain" from file /etc/freeradius/mods-enabled/realm
 } # modules
radiusd: #### Loading Virtual Servers ####
server { # from file /etc/freeradius/radiusd.conf
} # server
server default { # from file /etc/freeradius/sites-enabled/default
 # Loading authenticate {...}
 # Loading authorize {...}
Ignoring "sql" (see raddb/mods-available/README.rst)
Ignoring "ldap" (see raddb/mods-available/README.rst)
 # Loading preacct {...}
 # Loading accounting {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server default
server inner-tunnel { # from file /etc/freeradius/sites-enabled/inner-tunnel
 # Loading authenticate {...}
 # Loading authorize {...}
 # Loading session {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server inner-tunnel
 thread pool {
 	start_servers = 5
 	max_servers = 32
 	min_spare_servers = 3
 	max_spare_servers = 10
 	max_requests_per_server = 0
 	cleanup_delay = 5
 	max_queue_size = 65536
 	auto_limit_acct = no
 }
Thread spawned new child 1. Total threads in pool: 1
Thread spawned new child 2. Total threads in pool: 2
Thread spawned new child 3. Total threads in pool: 3
Thread spawned new child 4. Total threads in pool: 4
Thread spawned new child 5. Total threads in pool: 5
Thread pool initialized
radiusd: #### Opening IP addresses and Ports ####
listen {
  	type = "auth"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
Thread 1 waiting to be assigned a request
Thread 3 waiting to be assigned a request
Thread 2 waiting to be assigned a request
Thread 5 waiting to be assigned a request
Thread 4 waiting to be assigned a request
}
listen {
  	type = "acct"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "acct"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipaddr = 127.0.0.1
  	port = 18120
}
Listening on auth address * port 1812 bound to server default
Listening on acct address * port 1813 bound to server default
Listening on auth address :: port 1812 bound to server default
Listening on acct address :: port 1813 bound to server default
Listening on auth address 127.0.0.1 port 18120 bound to server inner-tunnel
Listening on proxy address * port 51435
Listening on proxy address :: port 57178
Ready to process requests
main {
	name = "freeradius"
	prefix = "/usr"
	localstatedir = "/var"
	sbindir = "/usr/sbin"
	logdir = "/var/log/freeradius"
	run_dir = "/var/run/freeradius"
	libdir = "/usr/lib/freeradius"
	radacctdir = "/var/log/freeradius/radacct"
	hostname_lookups = no
	max_request_time = 30
	cleanup_delay = 5
	max_requests = 16384
	pidfile = "/var/run/freeradius/freeradius.pid"
	checkrad = "/usr/sbin/checkrad"
	debug_level = 0
	proxy_requests = yes
 log {
 	stripped_names = no
 	auth = no
 	auth_badpass = no
 	auth_goodpass = no
 	colourise = yes
 	msg_denied = "You are already logged in - access denied"
 }
 resources {
 }
 security {
 	max_attributes = 200
 	reject_delay = 1.000000
 	status_server = yes
 }
}
radiusd: #### Loading Realms and Home Servers ####
 proxy server {
 	retry_delay = 5
 	retry_count = 3
 	default_fallback = no
 	dead_time = 120
 	wake_all_if_all_dead = no
 }
 home_server localhost {
 	ipaddr = 127.0.0.1
 	port = 1812
 	type = "auth"
 	secret = <<< secret >>>
 	response_window = 20.000000
 	response_timeouts = 1
 	max_outstanding = 65536
 	zombie_period = 40
 	status_check = "status-server"
 	ping_interval = 30
 	check_interval = 30
 	check_timeout = 4
 	num_answers_to_alive = 3
 	revive_interval = 120
  limit {
  	max_connections = 16
  	max_requests = 0
  	lifetime = 0
  	idle_timeout = 0
  }
  coa {
  	irt = 2
  	mrt = 16
  	mrc = 5
  	mrd = 30
  }
 }
 home_server_pool my_auth_failover {
	type = fail-over
	home_server = localhost
 }
 realm example.com {
	auth_pool = my_auth_failover
 }
 realm LOCAL {
 }
radiusd: #### Loading Clients ####
 client localhost {
 	ipaddr = 127.0.0.1
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	nas_type = "other"
 	proto = "*"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client localhost_ipv6 {
 	ipv6addr = ::1
 	require_message_authenticator = no
 	secret = <<< secret >>>
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
Debug state unknown (cap_sys_ptrace capability not set)
 # Creating Auth-Type = digest
radiusd: #### Instantiating modules ####
  # Loaded module rlm_always
  # Loading module "reject" from file /etc/freeradius/mods-enabled/always
  always reject {
  	rcode = "reject"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "fail" from file /etc/freeradius/mods-enabled/always
  always fail {
  	rcode = "fail"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "ok" from file /etc/freeradius/mods-enabled/always
  always ok {
  	rcode = "ok"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "handled" from file /etc/freeradius/mods-enabled/always
  always handled {
  	rcode = "handled"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "invalid" from file /etc/freeradius/mods-enabled/always
  always invalid {
  	rcode = "invalid"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "userlock" from file /etc/freeradius/mods-enabled/always
  always userlock {
  	rcode = "userlock"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "notfound" from file /etc/freeradius/mods-enabled/always
  always notfound {
  	rcode = "notfound"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "noop" from file /etc/freeradius/mods-enabled/always
  always noop {
  	rcode = "noop"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "updated" from file /etc/freeradius/mods-enabled/always
  always updated {
  	rcode = "updated"
  	simulcount = 0
  	mpp = no
  }
  # Loaded module rlm_attr_filter
  # Loading module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.post-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/post-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.pre-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/pre-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_reject {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_reject"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_challenge {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_challenge"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.accounting_response {
  	filename = "/etc/freeradius/mods-config/attr_filter/accounting_response"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loaded module rlm_cache
  # Loading module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
  cache cache_eap {
  	driver = "rlm_cache_rbtree"
  	key = "%{%{control:State}:-%{%{reply:State}:-%{State}}}"
  	ttl = 15
  	max_entries = 0
  	epoch = 0
  	add_stats = no
  }
  # Loaded module rlm_chap
  # Loading module "chap" from file /etc/freeradius/mods-enabled/chap
  # Loaded module rlm_detail
  # Loading module "detail" from file /etc/freeradius/mods-enabled/detail
  detail {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
  detail auth_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/auth-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  detail reply_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/reply-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail pre_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/pre-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail post_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/post-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loaded module rlm_digest
  # Loading module "digest" from file /etc/freeradius/mods-enabled/digest
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_eap
  # Loading module "eap" from file /etc/freeradius/mods-enabled/eap
  eap {
  	default_eap_type = "md5"
  	timer_expire = 60
  	ignore_unknown_eap_types = no
  	cisco_accounting_username_bug = no
  	max_sessions = 16384
  }
  # Loaded module rlm_exec
  # Loading module "echo" from file /etc/freeradius/mods-enabled/echo
  exec echo {
  	wait = yes
  	program = "/bin/echo %{User-Name}"
  	input_pairs = "request"
  	output_pairs = "reply"
  	shell_escape = yes
  }
  # Loading module "exec" from file /etc/freeradius/mods-enabled/exec
  exec {
  	wait = no
  	input_pairs = "request"
  	shell_escape = yes
  	timeout = 10
  }
  # Loaded module rlm_expiration
  # Loading module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Loaded module rlm_expr
  # Loading module "expr" from file /etc/freeradius/mods-enabled/expr
  expr {
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /äéöüàâæçèéêëîïôœùûüaÿÄÉÖÜßÀÂÆÇÈÉÊËÎÏÔŒÙÛÜŸ"
  }
  # Loaded module rlm_files
  # Loading module "files" from file /etc/freeradius/mods-enabled/files
  files {
  	filename = "/etc/freeradius/mods-config/files/authorize"
  	acctusersfile = "/etc/freeradius/mods-config/files/accounting"
  	preproxy_usersfile = "/etc/freeradius/mods-config/files/pre-proxy"
  }
  # Loaded module rlm_linelog
  # Loading module "linelog" from file /etc/freeradius/mods-enabled/linelog
  linelog {
  	filename = "/var/log/freeradius/linelog"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = "This is a log message for %{User-Name}"
  	reference = "messages.%{%{reply:Packet-Type}:-default}"
  }
  # Loading module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  linelog log_accounting {
  	filename = "/var/log/freeradius/linelog-accounting"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = ""
  	reference = "Accounting-Request.%{%{Acct-Status-Type}:-unknown}"
  }
  # Loaded module rlm_logintime
  # Loading module "logintime" from file /etc/freeradius/mods-enabled/logintime
  logintime {
  	minimum_timeout = 60
  }
  # Loaded module rlm_mschap
  # Loading module "mschap" from file /etc/freeradius/mods-enabled/mschap
  mschap {
  	use_mppe = yes
  	require_encryption = no
  	require_strong = no
  	with_ntdomain_hack = yes
   passchange {
   }
  	allow_retry = yes
  }
  # Loading module "ntlm_auth" from file /etc/freeradius/mods-enabled/ntlm_auth
  exec ntlm_auth {
  	wait = yes
  	program = "/path/to/ntlm_auth --request-nt-key --domain=MYDOMAIN --username=%{mschap:User-Name} --password=%{User-Password}"
  	shell_escape = yes
  }
  # Loaded module rlm_pap
  # Loading module "pap" from file /etc/freeradius/mods-enabled/pap
  pap {
  	normalise = yes
  }
  # Loaded module rlm_passwd
  # Loading module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
  passwd etc_passwd {
  	filename = "/etc/passwd"
  	format = "*User-Name:Crypt-Password:"
  	delimiter = ":"
  	ignore_nislike = no
  	ignore_empty = yes
  	allow_multiple_keys = no
  	hash_size = 100
  }
  # Loaded module rlm_preprocess
  # Loading module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
  preprocess {
  	huntgroups = "/etc/freeradius/mods-config/preprocess/huntgroups"
  	hints = "/etc/freeradius/mods-config/preprocess/hints"
  	with_ascend_hack = no
  	ascend_channels_per_line = 23
  	with_ntdomain_hack = no
  	with_specialix_jetstream_hack = no
  	with_cisco_vsa_hack = no
  	with_alvarion_vsa_hack = no
  }
  # Loaded module rlm_radutmp
  # Loading module "radutmp" from file /etc/freeradius/mods-enabled/radutmp
  radutmp {
  	filename = "/var/log/freeradius/radutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 384
  	caller_id = yes
  }
  # Loaded module rlm_realm
  # Loading module "IPASS" from file /etc/freeradius/mods-enabled/realm
  realm IPASS {
  	format = "prefix"
  	delimiter = "/"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "suffix" from file /etc/freeradius/mods-enabled/realm
  realm suffix {
  	format = "suffix"
  	delimiter = "@"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  realm realmpercent {
  	format = "suffix"
  	delimiter = "%"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "ntdomain" from file /etc/freeradius/mods-enabled/realm
  realm ntdomain {
  	format = "prefix"
  	delimiter = "\\"
  	ignore_default = no
  	ignore_null = no
  }
  # Loaded module rlm_replicate
  # Loading module "replicate" from file /etc/freeradius/mods-enabled/replicate
  # Loaded module rlm_soh
  # Loading module "soh" from file /etc/freeradius/mods-enabled/soh
  soh {
  	dhcp = yes
  }
  # Loading module "sradutmp" from file /etc/freeradius/mods-enabled/sradutmp
  radutmp sradutmp {
  	filename = "/var/log/freeradius/sradutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 420
  	caller_id = no
  }
  # Loaded module rlm_unix
  # Loading module "unix" from file /etc/freeradius/mods-enabled/unix
  unix {
  	radwtmp = "/var/log/freeradius/radwtmp"
  }
Creating attribute Unix-Group
  # Loaded module rlm_unpack
  # Loading module "unpack" from file /etc/freeradius/mods-enabled/unpack
  # Loaded module rlm_utf8
  # Loading module "utf8" from file /etc/freeradius/mods-enabled/utf8
 instantiate {
 }
 modules {
  # Instantiating module "reject" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "fail" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "ok" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "handled" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "invalid" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "userlock" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "notfound" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "noop" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "updated" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/post-proxy
  # Instantiating module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/pre-proxy
  # Instantiating module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_reject
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay" 	found in filter list for realm "DEFAULT". 
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay-USec" 	found in filter list for realm "DEFAULT". 
  # Instantiating module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_challenge
  # Instantiating module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/accounting_response
  # Instantiating module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
rlm_cache (cache_eap): Driver rlm_cache_rbtree (module rlm_cache_rbtree) loaded and linked
  # Instantiating module "detail" from file /etc/freeradius/mods-enabled/detail
  # Instantiating module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
rlm_detail (auth_log): 'User-Password' suppressed, will not appear in detail output
  # Instantiating module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "eap" from file /etc/freeradius/mods-enabled/eap
   # Linked to sub-module rlm_eap_md5
   # Linked to sub-module rlm_eap_leap
   # Linked to sub-module rlm_eap_gtc
   gtc {
   	challenge = "Password: "
   	auth_type = "PAP"
   }
   # Linked to sub-module rlm_eap_tls
   tls {
   	tls = "tls-common"
   }
   tls-config tls-common {
   	rsa_key_exchange = no
   	dh_key_exchange = yes
   	rsa_key_length = 512
   	dh_key_length = 512
   	verify_depth = 0
   	ca_path = "/etc/freeradius/certs"
   	pem_file_type = yes
   	private_key_file = "/etc/freeradius/certs/server.pem"
   	certificate_file = "/etc/freeradius/certs/server.pem"
   	ca_file = "/etc/freeradius/certs/ca.pem"
   	private_key_password = <<< secret >>>
   	dh_file = "/etc/freeradius/certs/dh"
   	fragment_size = 1024
   	include_length = yes
   	check_crl = no
   	check_all_crl = no
   	cipher_list = "DEFAULT"
   	ecdh_curve = "prime256v1"
    cache {
    	enable = yes
    	lifetime = 24
    	max_entries = 255
    }
    verify {
    }
    ocsp {
    	enable = no
    	override_cert_url = yes
    	url = "http://127.0.0.1/ocsp/"
    	use_nonce = yes
    	timeout = 0
    	softfail = no
    }
   }
   # Linked to sub-module rlm_eap_ttls
   ttls {
   	tls = "tls-common"
   	default_eap_type = "md5"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	virtual_server = "inner-tunnel"
   	include_length = yes
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_peap
   peap {
   	tls = "tls-common"
   	default_eap_type = "mschapv2"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	proxy_tunneled_request_as_eap = yes
   	virtual_server = "inner-tunnel"
   	soh = no
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_mschapv2
   mschapv2 {
   	with_ntdomain_hack = no
   	send_error = no
   }
  # Instantiating module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Instantiating module "files" from file /etc/freeradius/mods-enabled/files
reading pairlist file /etc/freeradius/mods-config/files/authorize
reading pairlist file /etc/freeradius/mods-config/files/accounting
reading pairlist file /etc/freeradius/mods-config/files/pre-proxy
  # Instantiating module "linelog" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "logintime" from file /etc/freeradius/mods-enabled/logintime
  # Instantiating module "mschap" from file /etc/freeradius/mods-enabled/mschap
rlm_mschap (mschap): using internal authentication
  # Instantiating module "pap" from file /etc/freeradius/mods-enabled/pap
  # Instantiating module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
rlm_passwd: nfields: 3 keyfield 0(User-Name) listable: no
  # Instantiating module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
reading pairlist file /etc/freeradius/mods-config/preprocess/huntgroups
reading pairlist file /etc/freeradius/mods-config/preprocess/hints
  # Instantiating module "IPASS" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "suffix" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "ntdomain" from file /etc/freeradius/mods-enabled/realm
 } # modules
radiusd: #### Loading Virtual Servers ####
server { # from file /etc/freeradius/radiusd.conf
} # server
server default { # from file /etc/freeradius/sites-enabled/default
 # Loading authenticate {...}
 # Loading authorize {...}
Ignoring "sql" (see raddb/mods-available/README.rst)
Ignoring "ldap" (see raddb/mods-available/README.rst)
 # Loading preacct {...}
 # Loading accounting {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server default
server inner-tunnel { # from file /etc/freeradius/sites-enabled/inner-tunnel
 # Loading authenticate {...}
 # Loading authorize {...}
 # Loading session {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server inner-tunnel
 thread pool {
 	start_servers = 5
 	max_servers = 32
 	min_spare_servers = 3
 	max_spare_servers = 10
 	max_requests_per_server = 0
 	cleanup_delay = 5
 	max_queue_size = 65536
 	auto_limit_acct = no
 }
Thread spawned new child 1. Total threads in pool: 1
Thread spawned new child 2. Total threads in pool: 2
Thread spawned new child 3. Total threads in pool: 3
Thread spawned new child 4. Total threads in pool: 4
Thread spawned new child 5. Total threads in pool: 5
Thread pool initialized
radiusd: #### Opening IP addresses and Ports ####
listen {
  	type = "auth"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
Thread 2 waiting to be assigned a request
Thread 1 waiting to be assigned a request
Thread 5 waiting to be assigned a request
Thread 4 waiting to be assigned a request
Thread 3 waiting to be assigned a request
}
listen {
  	type = "acct"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "acct"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipaddr = 127.0.0.1
  	port = 18120
}
Listening on auth address * port 1812 bound to server default
Listening on acct address * port 1813 bound to server default
Listening on auth address :: port 1812 bound to server default
Listening on acct address :: port 1813 bound to server default
Listening on auth address 127.0.0.1 port 18120 bound to server inner-tunnel
Listening on proxy address * port 50648
Listening on proxy address :: port 38558
Ready to process requests
Tue Nov 24 21:15:13 2015 : Info: Debug state unknown (cap_sys_ptrace capability not set)
Tue Nov 24 21:15:13 2015 : Warning: [/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay" 	found in filter list for realm "DEFAULT". 
Tue Nov 24 21:15:13 2015 : Warning: [/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay-USec" 	found in filter list for realm "DEFAULT". 
Tue Nov 24 21:15:13 2015 : Info: Loaded virtual server <default>
Tue Nov 24 21:15:13 2015 : Warning: Ignoring "sql" (see raddb/mods-available/README.rst)
Tue Nov 24 21:15:13 2015 : Warning: Ignoring "ldap" (see raddb/mods-available/README.rst)
Tue Nov 24 21:15:13 2015 : Info: Loaded virtual server default
Tue Nov 24 21:15:13 2015 : Info: Loaded virtual server inner-tunnel
Tue Nov 24 21:15:13 2015 : Error: Failed creating PID file /var/run/freeradius/freeradius.pid: Permission denied
main {
	name = "freeradius"
	prefix = "/usr"
	localstatedir = "/var"
	sbindir = "/usr/sbin"
	logdir = "/var/log/freeradius"
	run_dir = "/var/run/freeradius"
	libdir = "/usr/lib/freeradius"
	radacctdir = "/var/log/freeradius/radacct"
	hostname_lookups = no
	max_request_time = 30
	cleanup_delay = 5
	max_requests = 16384
	pidfile = "/var/run/freeradius/freeradius.pid"
	checkrad = "/usr/sbin/checkrad"
	debug_level = 0
	proxy_requests = yes
 log {
 	stripped_names = no
 	auth = no
 	auth_badpass = no
 	auth_goodpass = no
 	colourise = yes
 	msg_denied = "You are already logged in - access denied"
 }
 resources {
 }
 security {
 	max_attributes = 200
 	reject_delay = 1.000000
 	status_server = yes
 }
}
radiusd: #### Loading Realms and Home Servers ####
 proxy server {
 	retry_delay = 5
 	retry_count = 3
 	default_fallback = no
 	dead_time = 120
 	wake_all_if_all_dead = no
 }
 home_server localhost {
 	ipaddr = 127.0.0.1
 	port = 1812
 	type = "auth"
 	secret = <<< secret >>>
 	response_window = 20.000000
 	response_timeouts = 1
 	max_outstanding = 65536
 	zombie_period = 40
 	status_check = "status-server"
 	ping_interval = 30
 	check_interval = 30
 	check_timeout = 4
 	num_answers_to_alive = 3
 	revive_interval = 120
  limit {
  	max_connections = 16
  	max_requests = 0
  	lifetime = 0
  	idle_timeout = 0
  }
  coa {
  	irt = 2
  	mrt = 16
  	mrc = 5
  	mrd = 30
  }
 }
 home_server_pool my_auth_failover {
	type = fail-over
	home_server = localhost
 }
 realm example.com {
	auth_pool = my_auth_failover
 }
 realm LOCAL {
 }
radiusd: #### Loading Clients ####
 client localhost {
 	ipaddr = 127.0.0.1
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	nas_type = "other"
 	proto = "*"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client localhost_ipv6 {
 	ipv6addr = ::1
 	require_message_authenticator = no
 	secret = <<< secret >>>
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
Debug state unknown (cap_sys_ptrace capability not set)
 # Creating Auth-Type = digest
radiusd: #### Instantiating modules ####
  # Loaded module rlm_always
  # Loading module "reject" from file /etc/freeradius/mods-enabled/always
  always reject {
  	rcode = "reject"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "fail" from file /etc/freeradius/mods-enabled/always
  always fail {
  	rcode = "fail"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "ok" from file /etc/freeradius/mods-enabled/always
  always ok {
  	rcode = "ok"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "handled" from file /etc/freeradius/mods-enabled/always
  always handled {
  	rcode = "handled"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "invalid" from file /etc/freeradius/mods-enabled/always
  always invalid {
  	rcode = "invalid"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "userlock" from file /etc/freeradius/mods-enabled/always
  always userlock {
  	rcode = "userlock"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "notfound" from file /etc/freeradius/mods-enabled/always
  always notfound {
  	rcode = "notfound"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "noop" from file /etc/freeradius/mods-enabled/always
  always noop {
  	rcode = "noop"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "updated" from file /etc/freeradius/mods-enabled/always
  always updated {
  	rcode = "updated"
  	simulcount = 0
  	mpp = no
  }
  # Loaded module rlm_attr_filter
  # Loading module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.post-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/post-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.pre-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/pre-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_reject {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_reject"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_challenge {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_challenge"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.accounting_response {
  	filename = "/etc/freeradius/mods-config/attr_filter/accounting_response"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loaded module rlm_cache
  # Loading module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
  cache cache_eap {
  	driver = "rlm_cache_rbtree"
  	key = "%{%{control:State}:-%{%{reply:State}:-%{State}}}"
  	ttl = 15
  	max_entries = 0
  	epoch = 0
  	add_stats = no
  }
  # Loaded module rlm_chap
  # Loading module "chap" from file /etc/freeradius/mods-enabled/chap
  # Loaded module rlm_detail
  # Loading module "detail" from file /etc/freeradius/mods-enabled/detail
  detail {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
  detail auth_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/auth-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  detail reply_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/reply-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail pre_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/pre-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail post_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/post-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loaded module rlm_digest
  # Loading module "digest" from file /etc/freeradius/mods-enabled/digest
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_eap
  # Loading module "eap" from file /etc/freeradius/mods-enabled/eap
  eap {
  	default_eap_type = "md5"
  	timer_expire = 60
  	ignore_unknown_eap_types = no
  	cisco_accounting_username_bug = no
  	max_sessions = 16384
  }
  # Loaded module rlm_exec
  # Loading module "echo" from file /etc/freeradius/mods-enabled/echo
  exec echo {
  	wait = yes
  	program = "/bin/echo %{User-Name}"
  	input_pairs = "request"
  	output_pairs = "reply"
  	shell_escape = yes
  }
  # Loading module "exec" from file /etc/freeradius/mods-enabled/exec
  exec {
  	wait = no
  	input_pairs = "request"
  	shell_escape = yes
  	timeout = 10
  }
  # Loaded module rlm_expiration
  # Loading module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Loaded module rlm_expr
  # Loading module "expr" from file /etc/freeradius/mods-enabled/expr
  expr {
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /äéöüàâæçèéêëîïôœùûüaÿÄÉÖÜßÀÂÆÇÈÉÊËÎÏÔŒÙÛÜŸ"
  }
  # Loaded module rlm_files
  # Loading module "files" from file /etc/freeradius/mods-enabled/files
  files {
  	filename = "/etc/freeradius/mods-config/files/authorize"
  	acctusersfile = "/etc/freeradius/mods-config/files/accounting"
  	preproxy_usersfile = "/etc/freeradius/mods-config/files/pre-proxy"
  }
  # Loaded module rlm_linelog
  # Loading module "linelog" from file /etc/freeradius/mods-enabled/linelog
  linelog {
  	filename = "/var/log/freeradius/linelog"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = "This is a log message for %{User-Name}"
  	reference = "messages.%{%{reply:Packet-Type}:-default}"
  }
  # Loading module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  linelog log_accounting {
  	filename = "/var/log/freeradius/linelog-accounting"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = ""
  	reference = "Accounting-Request.%{%{Acct-Status-Type}:-unknown}"
  }
  # Loaded module rlm_logintime
  # Loading module "logintime" from file /etc/freeradius/mods-enabled/logintime
  logintime {
  	minimum_timeout = 60
  }
  # Loaded module rlm_mschap
  # Loading module "mschap" from file /etc/freeradius/mods-enabled/mschap
  mschap {
  	use_mppe = yes
  	require_encryption = no
  	require_strong = no
  	with_ntdomain_hack = yes
   passchange {
   }
  	allow_retry = yes
  }
  # Loading module "ntlm_auth" from file /etc/freeradius/mods-enabled/ntlm_auth
  exec ntlm_auth {
  	wait = yes
  	program = "/path/to/ntlm_auth --request-nt-key --domain=MYDOMAIN --username=%{mschap:User-Name} --password=%{User-Password}"
  	shell_escape = yes
  }
  # Loaded module rlm_pap
  # Loading module "pap" from file /etc/freeradius/mods-enabled/pap
  pap {
  	normalise = yes
  }
  # Loaded module rlm_passwd
  # Loading module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
  passwd etc_passwd {
  	filename = "/etc/passwd"
  	format = "*User-Name:Crypt-Password:"
  	delimiter = ":"
  	ignore_nislike = no
  	ignore_empty = yes
  	allow_multiple_keys = no
  	hash_size = 100
  }
  # Loaded module rlm_preprocess
  # Loading module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
  preprocess {
  	huntgroups = "/etc/freeradius/mods-config/preprocess/huntgroups"
  	hints = "/etc/freeradius/mods-config/preprocess/hints"
  	with_ascend_hack = no
  	ascend_channels_per_line = 23
  	with_ntdomain_hack = no
  	with_specialix_jetstream_hack = no
  	with_cisco_vsa_hack = no
  	with_alvarion_vsa_hack = no
  }
  # Loaded module rlm_radutmp
  # Loading module "radutmp" from file /etc/freeradius/mods-enabled/radutmp
  radutmp {
  	filename = "/var/log/freeradius/radutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 384
  	caller_id = yes
  }
  # Loaded module rlm_realm
  # Loading module "IPASS" from file /etc/freeradius/mods-enabled/realm
  realm IPASS {
  	format = "prefix"
  	delimiter = "/"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "suffix" from file /etc/freeradius/mods-enabled/realm
  realm suffix {
  	format = "suffix"
  	delimiter = "@"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  realm realmpercent {
  	format = "suffix"
  	delimiter = "%"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "ntdomain" from file /etc/freeradius/mods-enabled/realm
  realm ntdomain {
  	format = "prefix"
  	delimiter = "\\"
  	ignore_default = no
  	ignore_null = no
  }
  # Loaded module rlm_replicate
  # Loading module "replicate" from file /etc/freeradius/mods-enabled/replicate
  # Loaded module rlm_soh
  # Loading module "soh" from file /etc/freeradius/mods-enabled/soh
  soh {
  	dhcp = yes
  }
  # Loading module "sradutmp" from file /etc/freeradius/mods-enabled/sradutmp
  radutmp sradutmp {
  	filename = "/var/log/freeradius/sradutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 420
  	caller_id = no
  }
  # Loaded module rlm_unix
  # Loading module "unix" from file /etc/freeradius/mods-enabled/unix
  unix {
  	radwtmp = "/var/log/freeradius/radwtmp"
  }
Creating attribute Unix-Group
  # Loaded module rlm_unpack
  # Loading module "unpack" from file /etc/freeradius/mods-enabled/unpack
  # Loaded module rlm_utf8
  # Loading module "utf8" from file /etc/freeradius/mods-enabled/utf8
 instantiate {
 }
 modules {
  # Instantiating module "reject" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "fail" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "ok" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "handled" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "invalid" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "userlock" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "notfound" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "noop" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "updated" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/post-proxy
  # Instantiating module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/pre-proxy
  # Instantiating module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_reject
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay" 	found in filter list for realm "DEFAULT". 
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay-USec" 	found in filter list for realm "DEFAULT". 
  # Instantiating module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_challenge
  # Instantiating module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/accounting_response
  # Instantiating module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
rlm_cache (cache_eap): Driver rlm_cache_rbtree (module rlm_cache_rbtree) loaded and linked
  # Instantiating module "detail" from file /etc/freeradius/mods-enabled/detail
  # Instantiating module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
rlm_detail (auth_log): 'User-Password' suppressed, will not appear in detail output
  # Instantiating module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "eap" from file /etc/freeradius/mods-enabled/eap
   # Linked to sub-module rlm_eap_md5
   # Linked to sub-module rlm_eap_leap
   # Linked to sub-module rlm_eap_gtc
   gtc {
   	challenge = "Password: "
   	auth_type = "PAP"
   }
   # Linked to sub-module rlm_eap_tls
   tls {
   	tls = "tls-common"
   }
   tls-config tls-common {
   	rsa_key_exchange = no
   	dh_key_exchange = yes
   	rsa_key_length = 512
   	dh_key_length = 512
   	verify_depth = 0
   	ca_path = "/etc/freeradius/certs"
   	pem_file_type = yes
   	private_key_file = "/etc/freeradius/certs/server.pem"
   	certificate_file = "/etc/freeradius/certs/server.pem"
   	ca_file = "/etc/freeradius/certs/ca.pem"
   	private_key_password = <<< secret >>>
   	dh_file = "/etc/freeradius/certs/dh"
   	fragment_size = 1024
   	include_length = yes
   	check_crl = no
   	check_all_crl = no
   	cipher_list = "DEFAULT"
   	ecdh_curve = "prime256v1"
    cache {
    	enable = yes
    	lifetime = 24
    	max_entries = 255
    }
    verify {
    }
    ocsp {
    	enable = no
    	override_cert_url = yes
    	url = "http://127.0.0.1/ocsp/"
    	use_nonce = yes
    	timeout = 0
    	softfail = no
    }
   }
   # Linked to sub-module rlm_eap_ttls
   ttls {
   	tls = "tls-common"
   	default_eap_type = "md5"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	virtual_server = "inner-tunnel"
   	include_length = yes
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_peap
   peap {
   	tls = "tls-common"
   	default_eap_type = "mschapv2"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	proxy_tunneled_request_as_eap = yes
   	virtual_server = "inner-tunnel"
   	soh = no
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_mschapv2
   mschapv2 {
   	with_ntdomain_hack = no
   	send_error = no
   }
  # Instantiating module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Instantiating module "files" from file /etc/freeradius/mods-enabled/files
reading pairlist file /etc/freeradius/mods-config/files/authorize
reading pairlist file /etc/freeradius/mods-config/files/accounting
reading pairlist file /etc/freeradius/mods-config/files/pre-proxy
  # Instantiating module "linelog" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "logintime" from file /etc/freeradius/mods-enabled/logintime
  # Instantiating module "mschap" from file /etc/freeradius/mods-enabled/mschap
rlm_mschap (mschap): using internal authentication
  # Instantiating module "pap" from file /etc/freeradius/mods-enabled/pap
  # Instantiating module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
rlm_passwd: nfields: 3 keyfield 0(User-Name) listable: no
  # Instantiating module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
reading pairlist file /etc/freeradius/mods-config/preprocess/huntgroups
reading pairlist file /etc/freeradius/mods-config/preprocess/hints
  # Instantiating module "IPASS" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "suffix" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "ntdomain" from file /etc/freeradius/mods-enabled/realm
 } # modules
radiusd: #### Loading Virtual Servers ####
server { # from file /etc/freeradius/radiusd.conf
} # server
server default { # from file /etc/freeradius/sites-enabled/default
 # Loading authenticate {...}
 # Loading authorize {...}
Ignoring "sql" (see raddb/mods-available/README.rst)
Ignoring "ldap" (see raddb/mods-available/README.rst)
 # Loading preacct {...}
 # Loading accounting {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server default
server inner-tunnel { # from file /etc/freeradius/sites-enabled/inner-tunnel
 # Loading authenticate {...}
 # Loading authorize {...}
 # Loading session {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server inner-tunnel
 thread pool {
 	start_servers = 5
 	max_servers = 32
 	min_spare_servers = 3
 	max_spare_servers = 10
 	max_requests_per_server = 0
 	cleanup_delay = 5
 	max_queue_size = 65536
 	auto_limit_acct = no
 }
Thread spawned new child 1. Total threads in pool: 1
Thread spawned new child 2. Total threads in pool: 2
Thread spawned new child 3. Total threads in pool: 3
Thread spawned new child 4. Total threads in pool: 4
Thread spawned new child 5. Total threads in pool: 5
Thread pool initialized
radiusd: #### Opening IP addresses and Ports ####
listen {
  	type = "auth"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
Thread 1 waiting to be assigned a request
Thread 5 waiting to be assigned a request
Thread 4 waiting to be assigned a request
Thread 3 waiting to be assigned a request
Thread 2 waiting to be assigned a request
}
listen {
  	type = "acct"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "acct"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipaddr = 127.0.0.1
  	port = 18120
}
Listening on auth address * port 1812 bound to server default
Listening on acct address * port 1813 bound to server default
Listening on auth address :: port 1812 bound to server default
Listening on acct address :: port 1813 bound to server default
Listening on auth address 127.0.0.1 port 18120 bound to server inner-tunnel
Listening on proxy address * port 50170
Listening on proxy address :: port 42750
Ready to process requests
main {
	name = "freeradius"
	prefix = "/usr"
	localstatedir = "/var"
	sbindir = "/usr/sbin"
	logdir = "/var/log/freeradius"
	run_dir = "/var/run/freeradius"
	libdir = "/usr/lib/freeradius"
	radacctdir = "/var/log/freeradius/radacct"
	hostname_lookups = no
	max_request_time = 30
	cleanup_delay = 5
	max_requests = 16384
	pidfile = "/var/run/freeradius/freeradius.pid"
	checkrad = "/usr/sbin/checkrad"
	debug_level = 0
	proxy_requests = yes
 log {
 	stripped_names = no
 	auth = no
 	auth_badpass = no
 	auth_goodpass = no
 	colourise = yes
 	msg_denied = "You are already logged in - access denied"
 }
 resources {
 }
 security {
 	max_attributes = 200
 	reject_delay = 1.000000
 	status_server = yes
 }
}
radiusd: #### Loading Realms and Home Servers ####
 proxy server {
 	retry_delay = 5
 	retry_count = 3
 	default_fallback = no
 	dead_time = 120
 	wake_all_if_all_dead = no
 }
 home_server localhost {
 	ipaddr = 127.0.0.1
 	port = 1812
 	type = "auth"
 	secret = <<< secret >>>
 	response_window = 20.000000
 	response_timeouts = 1
 	max_outstanding = 65536
 	zombie_period = 40
 	status_check = "status-server"
 	ping_interval = 30
 	check_interval = 30
 	check_timeout = 4
 	num_answers_to_alive = 3
 	revive_interval = 120
  limit {
  	max_connections = 16
  	max_requests = 0
  	lifetime = 0
  	idle_timeout = 0
  }
  coa {
  	irt = 2
  	mrt = 16
  	mrc = 5
  	mrd = 30
  }
 }
 home_server_pool my_auth_failover {
	type = fail-over
	home_server = localhost
 }
 realm example.com {
	auth_pool = my_auth_failover
 }
 realm LOCAL {
 }
radiusd: #### Loading Clients ####
 client localhost {
 	ipaddr = 127.0.0.1
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	nas_type = "other"
 	proto = "*"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client localhost_ipv6 {
 	ipv6addr = ::1
 	require_message_authenticator = no
 	secret = <<< secret >>>
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
Debug state unknown (cap_sys_ptrace capability not set)
 # Creating Auth-Type = digest
radiusd: #### Instantiating modules ####
  # Loaded module rlm_always
  # Loading module "reject" from file /etc/freeradius/mods-enabled/always
  always reject {
  	rcode = "reject"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "fail" from file /etc/freeradius/mods-enabled/always
  always fail {
  	rcode = "fail"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "ok" from file /etc/freeradius/mods-enabled/always
  always ok {
  	rcode = "ok"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "handled" from file /etc/freeradius/mods-enabled/always
  always handled {
  	rcode = "handled"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "invalid" from file /etc/freeradius/mods-enabled/always
  always invalid {
  	rcode = "invalid"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "userlock" from file /etc/freeradius/mods-enabled/always
  always userlock {
  	rcode = "userlock"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "notfound" from file /etc/freeradius/mods-enabled/always
  always notfound {
  	rcode = "notfound"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "noop" from file /etc/freeradius/mods-enabled/always
  always noop {
  	rcode = "noop"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "updated" from file /etc/freeradius/mods-enabled/always
  always updated {
  	rcode = "updated"
  	simulcount = 0
  	mpp = no
  }
  # Loaded module rlm_attr_filter
  # Loading module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.post-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/post-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.pre-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/pre-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_reject {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_reject"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_challenge {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_challenge"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.accounting_response {
  	filename = "/etc/freeradius/mods-config/attr_filter/accounting_response"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loaded module rlm_cache
  # Loading module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
  cache cache_eap {
  	driver = "rlm_cache_rbtree"
  	key = "%{%{control:State}:-%{%{reply:State}:-%{State}}}"
  	ttl = 15
  	max_entries = 0
  	epoch = 0
  	add_stats = no
  }
  # Loaded module rlm_chap
  # Loading module "chap" from file /etc/freeradius/mods-enabled/chap
  # Loaded module rlm_detail
  # Loading module "detail" from file /etc/freeradius/mods-enabled/detail
  detail {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
  detail auth_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/auth-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  detail reply_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/reply-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail pre_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/pre-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail post_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/post-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loaded module rlm_digest
  # Loading module "digest" from file /etc/freeradius/mods-enabled/digest
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_eap
  # Loading module "eap" from file /etc/freeradius/mods-enabled/eap
  eap {
  	default_eap_type = "md5"
  	timer_expire = 60
  	ignore_unknown_eap_types = no
  	cisco_accounting_username_bug = no
  	max_sessions = 16384
  }
  # Loaded module rlm_exec
  # Loading module "echo" from file /etc/freeradius/mods-enabled/echo
  exec echo {
  	wait = yes
  	program = "/bin/echo %{User-Name}"
  	input_pairs = "request"
  	output_pairs = "reply"
  	shell_escape = yes
  }
  # Loading module "exec" from file /etc/freeradius/mods-enabled/exec
  exec {
  	wait = no
  	input_pairs = "request"
  	shell_escape = yes
  	timeout = 10
  }
  # Loaded module rlm_expiration
  # Loading module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Loaded module rlm_expr
  # Loading module "expr" from file /etc/freeradius/mods-enabled/expr
  expr {
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /äéöüàâæçèéêëîïôœùûüaÿÄÉÖÜßÀÂÆÇÈÉÊËÎÏÔŒÙÛÜŸ"
  }
  # Loaded module rlm_files
  # Loading module "files" from file /etc/freeradius/mods-enabled/files
  files {
  	filename = "/etc/freeradius/mods-config/files/authorize"
  	acctusersfile = "/etc/freeradius/mods-config/files/accounting"
  	preproxy_usersfile = "/etc/freeradius/mods-config/files/pre-proxy"
  }
  # Loaded module rlm_linelog
  # Loading module "linelog" from file /etc/freeradius/mods-enabled/linelog
  linelog {
  	filename = "/var/log/freeradius/linelog"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = "This is a log message for %{User-Name}"
  	reference = "messages.%{%{reply:Packet-Type}:-default}"
  }
  # Loading module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  linelog log_accounting {
  	filename = "/var/log/freeradius/linelog-accounting"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = ""
  	reference = "Accounting-Request.%{%{Acct-Status-Type}:-unknown}"
  }
  # Loaded module rlm_logintime
  # Loading module "logintime" from file /etc/freeradius/mods-enabled/logintime
  logintime {
  	minimum_timeout = 60
  }
  # Loaded module rlm_mschap
  # Loading module "mschap" from file /etc/freeradius/mods-enabled/mschap
  mschap {
  	use_mppe = yes
  	require_encryption = no
  	require_strong = no
  	with_ntdomain_hack = yes
   passchange {
   }
  	allow_retry = yes
  }
  # Loading module "ntlm_auth" from file /etc/freeradius/mods-enabled/ntlm_auth
  exec ntlm_auth {
  	wait = yes
  	program = "/path/to/ntlm_auth --request-nt-key --domain=MYDOMAIN --username=%{mschap:User-Name} --password=%{User-Password}"
  	shell_escape = yes
  }
  # Loaded module rlm_pap
  # Loading module "pap" from file /etc/freeradius/mods-enabled/pap
  pap {
  	normalise = yes
  }
  # Loaded module rlm_passwd
  # Loading module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
  passwd etc_passwd {
  	filename = "/etc/passwd"
  	format = "*User-Name:Crypt-Password:"
  	delimiter = ":"
  	ignore_nislike = no
  	ignore_empty = yes
  	allow_multiple_keys = no
  	hash_size = 100
  }
  # Loaded module rlm_preprocess
  # Loading module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
  preprocess {
  	huntgroups = "/etc/freeradius/mods-config/preprocess/huntgroups"
  	hints = "/etc/freeradius/mods-config/preprocess/hints"
  	with_ascend_hack = no
  	ascend_channels_per_line = 23
  	with_ntdomain_hack = no
  	with_specialix_jetstream_hack = no
  	with_cisco_vsa_hack = no
  	with_alvarion_vsa_hack = no
  }
  # Loaded module rlm_radutmp
  # Loading module "radutmp" from file /etc/freeradius/mods-enabled/radutmp
  radutmp {
  	filename = "/var/log/freeradius/radutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 384
  	caller_id = yes
  }
  # Loaded module rlm_realm
  # Loading module "IPASS" from file /etc/freeradius/mods-enabled/realm
  realm IPASS {
  	format = "prefix"
  	delimiter = "/"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "suffix" from file /etc/freeradius/mods-enabled/realm
  realm suffix {
  	format = "suffix"
  	delimiter = "@"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  realm realmpercent {
  	format = "suffix"
  	delimiter = "%"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "ntdomain" from file /etc/freeradius/mods-enabled/realm
  realm ntdomain {
  	format = "prefix"
  	delimiter = "\\"
  	ignore_default = no
  	ignore_null = no
  }
  # Loaded module rlm_replicate
  # Loading module "replicate" from file /etc/freeradius/mods-enabled/replicate
  # Loaded module rlm_soh
  # Loading module "soh" from file /etc/freeradius/mods-enabled/soh
  soh {
  	dhcp = yes
  }
  # Loading module "sradutmp" from file /etc/freeradius/mods-enabled/sradutmp
  radutmp sradutmp {
  	filename = "/var/log/freeradius/sradutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 420
  	caller_id = no
  }
  # Loaded module rlm_unix
  # Loading module "unix" from file /etc/freeradius/mods-enabled/unix
  unix {
  	radwtmp = "/var/log/freeradius/radwtmp"
  }
Creating attribute Unix-Group
  # Loaded module rlm_unpack
  # Loading module "unpack" from file /etc/freeradius/mods-enabled/unpack
  # Loaded module rlm_utf8
  # Loading module "utf8" from file /etc/freeradius/mods-enabled/utf8
 instantiate {
 }
 modules {
  # Instantiating module "reject" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "fail" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "ok" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "handled" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "invalid" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "userlock" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "notfound" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "noop" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "updated" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/post-proxy
  # Instantiating module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/pre-proxy
  # Instantiating module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_reject
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay" 	found in filter list for realm "DEFAULT". 
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay-USec" 	found in filter list for realm "DEFAULT". 
  # Instantiating module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_challenge
  # Instantiating module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/accounting_response
  # Instantiating module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
rlm_cache (cache_eap): Driver rlm_cache_rbtree (module rlm_cache_rbtree) loaded and linked
  # Instantiating module "detail" from file /etc/freeradius/mods-enabled/detail
  # Instantiating module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
rlm_detail (auth_log): 'User-Password' suppressed, will not appear in detail output
  # Instantiating module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "eap" from file /etc/freeradius/mods-enabled/eap
   # Linked to sub-module rlm_eap_md5
   # Linked to sub-module rlm_eap_leap
   # Linked to sub-module rlm_eap_gtc
   gtc {
   	challenge = "Password: "
   	auth_type = "PAP"
   }
   # Linked to sub-module rlm_eap_tls
   tls {
   	tls = "tls-common"
   }
   tls-config tls-common {
   	rsa_key_exchange = no
   	dh_key_exchange = yes
   	rsa_key_length = 512
   	dh_key_length = 512
   	verify_depth = 0
   	ca_path = "/etc/freeradius/certs"
   	pem_file_type = yes
   	private_key_file = "/etc/freeradius/certs/server.pem"
   	certificate_file = "/etc/freeradius/certs/server.pem"
   	ca_file = "/etc/freeradius/certs/ca.pem"
   	private_key_password = <<< secret >>>
   	dh_file = "/etc/freeradius/certs/dh"
   	fragment_size = 1024
   	include_length = yes
   	check_crl = no
   	check_all_crl = no
   	cipher_list = "DEFAULT"
   	ecdh_curve = "prime256v1"
    cache {
    	enable = yes
    	lifetime = 24
    	max_entries = 255
    }
    verify {
    }
    ocsp {
    	enable = no
    	override_cert_url = yes
    	url = "http://127.0.0.1/ocsp/"
    	use_nonce = yes
    	timeout = 0
    	softfail = no
    }
   }
   # Linked to sub-module rlm_eap_ttls
   ttls {
   	tls = "tls-common"
   	default_eap_type = "md5"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	virtual_server = "inner-tunnel"
   	include_length = yes
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_peap
   peap {
   	tls = "tls-common"
   	default_eap_type = "mschapv2"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	proxy_tunneled_request_as_eap = yes
   	virtual_server = "inner-tunnel"
   	soh = no
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_mschapv2
   mschapv2 {
   	with_ntdomain_hack = no
   	send_error = no
   }
  # Instantiating module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Instantiating module "files" from file /etc/freeradius/mods-enabled/files
reading pairlist file /etc/freeradius/mods-config/files/authorize
reading pairlist file /etc/freeradius/mods-config/files/accounting
reading pairlist file /etc/freeradius/mods-config/files/pre-proxy
  # Instantiating module "linelog" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "logintime" from file /etc/freeradius/mods-enabled/logintime
  # Instantiating module "mschap" from file /etc/freeradius/mods-enabled/mschap
rlm_mschap (mschap): using internal authentication
  # Instantiating module "pap" from file /etc/freeradius/mods-enabled/pap
  # Instantiating module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
rlm_passwd: nfields: 3 keyfield 0(User-Name) listable: no
  # Instantiating module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
reading pairlist file /etc/freeradius/mods-config/preprocess/huntgroups
reading pairlist file /etc/freeradius/mods-config/preprocess/hints
  # Instantiating module "IPASS" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "suffix" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "ntdomain" from file /etc/freeradius/mods-enabled/realm
 } # modules
radiusd: #### Loading Virtual Servers ####
server { # from file /etc/freeradius/radiusd.conf
} # server
server default { # from file /etc/freeradius/sites-enabled/default
 # Loading authenticate {...}
 # Loading authorize {...}
Ignoring "sql" (see raddb/mods-available/README.rst)
Ignoring "ldap" (see raddb/mods-available/README.rst)
 # Loading preacct {...}
 # Loading accounting {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server default
server inner-tunnel { # from file /etc/freeradius/sites-enabled/inner-tunnel
 # Loading authenticate {...}
 # Loading authorize {...}
 # Loading session {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server inner-tunnel
 thread pool {
 	start_servers = 5
 	max_servers = 32
 	min_spare_servers = 3
 	max_spare_servers = 10
 	max_requests_per_server = 0
 	cleanup_delay = 5
 	max_queue_size = 65536
 	auto_limit_acct = no
 }
Thread spawned new child 1. Total threads in pool: 1
Thread spawned new child 2. Total threads in pool: 2
Thread spawned new child 3. Total threads in pool: 3
Thread spawned new child 4. Total threads in pool: 4
Thread spawned new child 5. Total threads in pool: 5
Thread pool initialized
radiusd: #### Opening IP addresses and Ports ####
listen {
  	type = "auth"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
Thread 2 waiting to be assigned a request
Thread 1 waiting to be assigned a request
Thread 5 waiting to be assigned a request
Thread 4 waiting to be assigned a request
Thread 3 waiting to be assigned a request
}
listen {
  	type = "acct"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "acct"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipaddr = 127.0.0.1
  	port = 18120
}
Listening on auth address * port 1812 bound to server default
Listening on acct address * port 1813 bound to server default
Listening on auth address :: port 1812 bound to server default
Listening on acct address :: port 1813 bound to server default
Listening on auth address 127.0.0.1 port 18120 bound to server inner-tunnel
Listening on proxy address * port 53167
Listening on proxy address :: port 33375
Ready to process requests
Debug state unknown (cap_sys_ptrace capability not set)
Creating attribute Unix-Group
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay" 	found in filter list for realm "DEFAULT". 
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay-USec" 	found in filter list for realm "DEFAULT". 
rlm_cache (cache_eap): Driver rlm_cache_rbtree (module rlm_cache_rbtree) loaded and linked
rlm_detail (auth_log): 'User-Password' suppressed, will not appear in detail output
tls: Using cached TLS configuration from previous invocation
tls: Using cached TLS configuration from previous invocation
rlm_mschap (mschap): using internal authentication
Ignoring "sql" (see raddb/mods-available/README.rst)
Ignoring "ldap" (see raddb/mods-available/README.rst)
radiusd: #### Opening IP addresses and Ports ####
Listening on auth address * port 1812 bound to server default
Listening on acct address * port 1813 bound to server default
Listening on auth address :: port 1812 bound to server default
Listening on acct address :: port 1813 bound to server default
Listening on auth address 127.0.0.1 port 18120 bound to server inner-tunnel
Listening on proxy address * port 53687
Listening on proxy address :: port 54794
Ready to process requests
Debug state unknown (cap_sys_ptrace capability not set)
Creating attribute Unix-Group
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay" 	found in filter list for realm "DEFAULT". 
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay-USec" 	found in filter list for realm "DEFAULT". 
rlm_cache (cache_eap): Driver rlm_cache_rbtree (module rlm_cache_rbtree) loaded and linked
rlm_detail (auth_log): 'User-Password' suppressed, will not appear in detail output
tls: Using cached TLS configuration from previous invocation
tls: Using cached TLS configuration from previous invocation
rlm_mschap (mschap): using internal authentication
Ignoring "sql" (see raddb/mods-available/README.rst)
Ignoring "ldap" (see raddb/mods-available/README.rst)
radiusd: #### Opening IP addresses and Ports ####
Listening on auth address * port 1812 bound to server default
Listening on acct address * port 1813 bound to server default
Listening on auth address :: port 1812 bound to server default
Listening on acct address :: port 1813 bound to server default
Listening on auth address 127.0.0.1 port 18120 bound to server inner-tunnel
Listening on proxy address * port 38755
Listening on proxy address :: port 50040
Ready to process requests
main {
	name = "freeradius"
	prefix = "/usr"
	localstatedir = "/var"
	sbindir = "/usr/sbin"
	logdir = "/var/log/freeradius"
	run_dir = "/var/run/freeradius"
	libdir = "/usr/lib/freeradius"
	radacctdir = "/var/log/freeradius/radacct"
	hostname_lookups = no
	max_request_time = 30
	cleanup_delay = 5
	max_requests = 16384
	pidfile = "/var/run/freeradius/freeradius.pid"
	checkrad = "/usr/sbin/checkrad"
	debug_level = 0
	proxy_requests = yes
 log {
 	stripped_names = no
 	auth = no
 	auth_badpass = no
 	auth_goodpass = no
 	colourise = yes
 	msg_denied = "You are already logged in - access denied"
 }
 resources {
 }
 security {
 	max_attributes = 200
 	reject_delay = 1.000000
 	status_server = yes
 }
}
radiusd: #### Loading Realms and Home Servers ####
 proxy server {
 	retry_delay = 5
 	retry_count = 3
 	default_fallback = no
 	dead_time = 120
 	wake_all_if_all_dead = no
 }
 home_server localhost {
 	ipaddr = 127.0.0.1
 	port = 1812
 	type = "auth"
 	secret = <<< secret >>>
 	response_window = 20.000000
 	response_timeouts = 1
 	max_outstanding = 65536
 	zombie_period = 40
 	status_check = "status-server"
 	ping_interval = 30
 	check_interval = 30
 	check_timeout = 4
 	num_answers_to_alive = 3
 	revive_interval = 120
  limit {
  	max_connections = 16
  	max_requests = 0
  	lifetime = 0
  	idle_timeout = 0
  }
  coa {
  	irt = 2
  	mrt = 16
  	mrc = 5
  	mrd = 30
  }
 }
 home_server_pool my_auth_failover {
	type = fail-over
	home_server = localhost
 }
 realm example.com {
	auth_pool = my_auth_failover
 }
 realm LOCAL {
 }
radiusd: #### Loading Clients ####
 client localhost {
 	ipaddr = 127.0.0.1
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	nas_type = "other"
 	proto = "*"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client localhost_ipv6 {
 	ipv6addr = ::1
 	require_message_authenticator = no
 	secret = <<< secret >>>
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
Debug state unknown (cap_sys_ptrace capability not set)
 # Creating Auth-Type = digest
radiusd: #### Instantiating modules ####
  # Loaded module rlm_always
  # Loading module "reject" from file /etc/freeradius/mods-enabled/always
  always reject {
  	rcode = "reject"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "fail" from file /etc/freeradius/mods-enabled/always
  always fail {
  	rcode = "fail"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "ok" from file /etc/freeradius/mods-enabled/always
  always ok {
  	rcode = "ok"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "handled" from file /etc/freeradius/mods-enabled/always
  always handled {
  	rcode = "handled"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "invalid" from file /etc/freeradius/mods-enabled/always
  always invalid {
  	rcode = "invalid"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "userlock" from file /etc/freeradius/mods-enabled/always
  always userlock {
  	rcode = "userlock"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "notfound" from file /etc/freeradius/mods-enabled/always
  always notfound {
  	rcode = "notfound"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "noop" from file /etc/freeradius/mods-enabled/always
  always noop {
  	rcode = "noop"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "updated" from file /etc/freeradius/mods-enabled/always
  always updated {
  	rcode = "updated"
  	simulcount = 0
  	mpp = no
  }
  # Loaded module rlm_attr_filter
  # Loading module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.post-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/post-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.pre-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/pre-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_reject {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_reject"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_challenge {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_challenge"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.accounting_response {
  	filename = "/etc/freeradius/mods-config/attr_filter/accounting_response"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loaded module rlm_cache
  # Loading module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
  cache cache_eap {
  	driver = "rlm_cache_rbtree"
  	key = "%{%{control:State}:-%{%{reply:State}:-%{State}}}"
  	ttl = 15
  	max_entries = 0
  	epoch = 0
  	add_stats = no
  }
  # Loaded module rlm_chap
  # Loading module "chap" from file /etc/freeradius/mods-enabled/chap
  # Loaded module rlm_detail
  # Loading module "detail" from file /etc/freeradius/mods-enabled/detail
  detail {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
  detail auth_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/auth-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  detail reply_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/reply-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail pre_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/pre-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail post_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/post-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loaded module rlm_digest
  # Loading module "digest" from file /etc/freeradius/mods-enabled/digest
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_eap
  # Loading module "eap" from file /etc/freeradius/mods-enabled/eap
  eap {
  	default_eap_type = "md5"
  	timer_expire = 60
  	ignore_unknown_eap_types = no
  	cisco_accounting_username_bug = no
  	max_sessions = 16384
  }
  # Loaded module rlm_exec
  # Loading module "echo" from file /etc/freeradius/mods-enabled/echo
  exec echo {
  	wait = yes
  	program = "/bin/echo %{User-Name}"
  	input_pairs = "request"
  	output_pairs = "reply"
  	shell_escape = yes
  }
  # Loading module "exec" from file /etc/freeradius/mods-enabled/exec
  exec {
  	wait = no
  	input_pairs = "request"
  	shell_escape = yes
  	timeout = 10
  }
  # Loaded module rlm_expiration
  # Loading module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Loaded module rlm_expr
  # Loading module "expr" from file /etc/freeradius/mods-enabled/expr
  expr {
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /äéöüàâæçèéêëîïôœùûüaÿÄÉÖÜßÀÂÆÇÈÉÊËÎÏÔŒÙÛÜŸ"
  }
  # Loaded module rlm_files
  # Loading module "files" from file /etc/freeradius/mods-enabled/files
  files {
  	filename = "/etc/freeradius/mods-config/files/authorize"
  	acctusersfile = "/etc/freeradius/mods-config/files/accounting"
  	preproxy_usersfile = "/etc/freeradius/mods-config/files/pre-proxy"
  }
  # Loaded module rlm_linelog
  # Loading module "linelog" from file /etc/freeradius/mods-enabled/linelog
  linelog {
  	filename = "/var/log/freeradius/linelog"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = "This is a log message for %{User-Name}"
  	reference = "messages.%{%{reply:Packet-Type}:-default}"
  }
  # Loading module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  linelog log_accounting {
  	filename = "/var/log/freeradius/linelog-accounting"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = ""
  	reference = "Accounting-Request.%{%{Acct-Status-Type}:-unknown}"
  }
  # Loaded module rlm_logintime
  # Loading module "logintime" from file /etc/freeradius/mods-enabled/logintime
  logintime {
  	minimum_timeout = 60
  }
  # Loaded module rlm_mschap
  # Loading module "mschap" from file /etc/freeradius/mods-enabled/mschap
  mschap {
  	use_mppe = yes
  	require_encryption = no
  	require_strong = no
  	with_ntdomain_hack = yes
   passchange {
   }
  	allow_retry = yes
  }
  # Loading module "ntlm_auth" from file /etc/freeradius/mods-enabled/ntlm_auth
  exec ntlm_auth {
  	wait = yes
  	program = "/path/to/ntlm_auth --request-nt-key --domain=MYDOMAIN --username=%{mschap:User-Name} --password=%{User-Password}"
  	shell_escape = yes
  }
  # Loaded module rlm_pap
  # Loading module "pap" from file /etc/freeradius/mods-enabled/pap
  pap {
  	normalise = yes
  }
  # Loaded module rlm_passwd
  # Loading module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
  passwd etc_passwd {
  	filename = "/etc/passwd"
  	format = "*User-Name:Crypt-Password:"
  	delimiter = ":"
  	ignore_nislike = no
  	ignore_empty = yes
  	allow_multiple_keys = no
  	hash_size = 100
  }
  # Loaded module rlm_preprocess
  # Loading module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
  preprocess {
  	huntgroups = "/etc/freeradius/mods-config/preprocess/huntgroups"
  	hints = "/etc/freeradius/mods-config/preprocess/hints"
  	with_ascend_hack = no
  	ascend_channels_per_line = 23
  	with_ntdomain_hack = no
  	with_specialix_jetstream_hack = no
  	with_cisco_vsa_hack = no
  	with_alvarion_vsa_hack = no
  }
  # Loaded module rlm_radutmp
  # Loading module "radutmp" from file /etc/freeradius/mods-enabled/radutmp
  radutmp {
  	filename = "/var/log/freeradius/radutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 384
  	caller_id = yes
  }
  # Loaded module rlm_realm
  # Loading module "IPASS" from file /etc/freeradius/mods-enabled/realm
  realm IPASS {
  	format = "prefix"
  	delimiter = "/"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "suffix" from file /etc/freeradius/mods-enabled/realm
  realm suffix {
  	format = "suffix"
  	delimiter = "@"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  realm realmpercent {
  	format = "suffix"
  	delimiter = "%"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "ntdomain" from file /etc/freeradius/mods-enabled/realm
  realm ntdomain {
  	format = "prefix"
  	delimiter = "\\"
  	ignore_default = no
  	ignore_null = no
  }
  # Loaded module rlm_replicate
  # Loading module "replicate" from file /etc/freeradius/mods-enabled/replicate
  # Loaded module rlm_soh
  # Loading module "soh" from file /etc/freeradius/mods-enabled/soh
  soh {
  	dhcp = yes
  }
  # Loading module "sradutmp" from file /etc/freeradius/mods-enabled/sradutmp
  radutmp sradutmp {
  	filename = "/var/log/freeradius/sradutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 420
  	caller_id = no
  }
  # Loaded module rlm_unix
  # Loading module "unix" from file /etc/freeradius/mods-enabled/unix
  unix {
  	radwtmp = "/var/log/freeradius/radwtmp"
  }
Creating attribute Unix-Group
  # Loaded module rlm_unpack
  # Loading module "unpack" from file /etc/freeradius/mods-enabled/unpack
  # Loaded module rlm_utf8
  # Loading module "utf8" from file /etc/freeradius/mods-enabled/utf8
 instantiate {
 }
 modules {
  # Instantiating module "reject" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "fail" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "ok" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "handled" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "invalid" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "userlock" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "notfound" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "noop" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "updated" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/post-proxy
  # Instantiating module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/pre-proxy
  # Instantiating module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_reject
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay" 	found in filter list for realm "DEFAULT". 
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay-USec" 	found in filter list for realm "DEFAULT". 
  # Instantiating module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_challenge
  # Instantiating module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/accounting_response
  # Instantiating module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
rlm_cache (cache_eap): Driver rlm_cache_rbtree (module rlm_cache_rbtree) loaded and linked
  # Instantiating module "detail" from file /etc/freeradius/mods-enabled/detail
  # Instantiating module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
rlm_detail (auth_log): 'User-Password' suppressed, will not appear in detail output
  # Instantiating module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "eap" from file /etc/freeradius/mods-enabled/eap
   # Linked to sub-module rlm_eap_md5
   # Linked to sub-module rlm_eap_leap
   # Linked to sub-module rlm_eap_gtc
   gtc {
   	challenge = "Password: "
   	auth_type = "PAP"
   }
   # Linked to sub-module rlm_eap_tls
   tls {
   	tls = "tls-common"
   }
   tls-config tls-common {
   	rsa_key_exchange = no
   	dh_key_exchange = yes
   	rsa_key_length = 512
   	dh_key_length = 512
   	verify_depth = 0
   	ca_path = "/etc/freeradius/certs"
   	pem_file_type = yes
   	private_key_file = "/etc/freeradius/certs/server.pem"
   	certificate_file = "/etc/freeradius/certs/server.pem"
   	ca_file = "/etc/freeradius/certs/ca.pem"
   	private_key_password = <<< secret >>>
   	dh_file = "/etc/freeradius/certs/dh"
   	fragment_size = 1024
   	include_length = yes
   	check_crl = no
   	check_all_crl = no
   	cipher_list = "DEFAULT"
   	ecdh_curve = "prime256v1"
    cache {
    	enable = yes
    	lifetime = 24
    	max_entries = 255
    }
    verify {
    }
    ocsp {
    	enable = no
    	override_cert_url = yes
    	url = "http://127.0.0.1/ocsp/"
    	use_nonce = yes
    	timeout = 0
    	softfail = no
    }
   }
   # Linked to sub-module rlm_eap_ttls
   ttls {
   	tls = "tls-common"
   	default_eap_type = "md5"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	virtual_server = "inner-tunnel"
   	include_length = yes
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_peap
   peap {
   	tls = "tls-common"
   	default_eap_type = "mschapv2"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	proxy_tunneled_request_as_eap = yes
   	virtual_server = "inner-tunnel"
   	soh = no
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_mschapv2
   mschapv2 {
   	with_ntdomain_hack = no
   	send_error = no
   }
  # Instantiating module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Instantiating module "files" from file /etc/freeradius/mods-enabled/files
reading pairlist file /etc/freeradius/mods-config/files/authorize
reading pairlist file /etc/freeradius/mods-config/files/accounting
reading pairlist file /etc/freeradius/mods-config/files/pre-proxy
  # Instantiating module "linelog" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "logintime" from file /etc/freeradius/mods-enabled/logintime
  # Instantiating module "mschap" from file /etc/freeradius/mods-enabled/mschap
rlm_mschap (mschap): using internal authentication
  # Instantiating module "pap" from file /etc/freeradius/mods-enabled/pap
  # Instantiating module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
rlm_passwd: nfields: 3 keyfield 0(User-Name) listable: no
  # Instantiating module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
reading pairlist file /etc/freeradius/mods-config/preprocess/huntgroups
reading pairlist file /etc/freeradius/mods-config/preprocess/hints
  # Instantiating module "IPASS" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "suffix" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "ntdomain" from file /etc/freeradius/mods-enabled/realm
 } # modules
radiusd: #### Loading Virtual Servers ####
server { # from file /etc/freeradius/radiusd.conf
} # server
server default { # from file /etc/freeradius/sites-enabled/default
 # Loading authenticate {...}
 # Loading authorize {...}
Ignoring "sql" (see raddb/mods-available/README.rst)
Ignoring "ldap" (see raddb/mods-available/README.rst)
 # Loading preacct {...}
 # Loading accounting {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server default
server inner-tunnel { # from file /etc/freeradius/sites-enabled/inner-tunnel
 # Loading authenticate {...}
 # Loading authorize {...}
 # Loading session {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server inner-tunnel
 thread pool {
 	start_servers = 5
 	max_servers = 32
 	min_spare_servers = 3
 	max_spare_servers = 10
 	max_requests_per_server = 0
 	cleanup_delay = 5
 	max_queue_size = 65536
 	auto_limit_acct = no
 }
Thread spawned new child 1. Total threads in pool: 1
Thread spawned new child 2. Total threads in pool: 2
Thread spawned new child 3. Total threads in pool: 3
Thread spawned new child 4. Total threads in pool: 4
Thread spawned new child 5. Total threads in pool: 5
Thread pool initialized
radiusd: #### Opening IP addresses and Ports ####
listen {
  	type = "auth"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
Thread 4 waiting to be assigned a request
Thread 5 waiting to be assigned a request
Thread 3 waiting to be assigned a request
Thread 2 waiting to be assigned a request
Thread 1 waiting to be assigned a request
}
listen {
  	type = "acct"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "acct"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipaddr = 127.0.0.1
  	port = 18120
}
Listening on auth address * port 1812 bound to server default
Listening on acct address * port 1813 bound to server default
Listening on auth address :: port 1812 bound to server default
Listening on acct address :: port 1813 bound to server default
Listening on auth address 127.0.0.1 port 18120 bound to server inner-tunnel
Listening on proxy address * port 34584
Listening on proxy address :: port 37455
Ready to process requests
main {
	name = "freeradius"
	prefix = "/usr"
	localstatedir = "/var"
	sbindir = "/usr/sbin"
	logdir = "/var/log/freeradius"
	run_dir = "/var/run/freeradius"
	libdir = "/usr/lib/freeradius"
	radacctdir = "/var/log/freeradius/radacct"
	hostname_lookups = no
	max_request_time = 30
	cleanup_delay = 5
	max_requests = 16384
	pidfile = "/var/run/freeradius/freeradius.pid"
	checkrad = "/usr/sbin/checkrad"
	debug_level = 0
	proxy_requests = yes
 log {
 	stripped_names = no
 	auth = no
 	auth_badpass = no
 	auth_goodpass = no
 	colourise = yes
 	msg_denied = "You are already logged in - access denied"
 }
 resources {
 }
 security {
 	max_attributes = 200
 	reject_delay = 1.000000
 	status_server = yes
 }
}
radiusd: #### Loading Realms and Home Servers ####
 proxy server {
 	retry_delay = 5
 	retry_count = 3
 	default_fallback = no
 	dead_time = 120
 	wake_all_if_all_dead = no
 }
 home_server localhost {
 	ipaddr = 127.0.0.1
 	port = 1812
 	type = "auth"
 	secret = <<< secret >>>
 	response_window = 20.000000
 	response_timeouts = 1
 	max_outstanding = 65536
 	zombie_period = 40
 	status_check = "status-server"
 	ping_interval = 30
 	check_interval = 30
 	check_timeout = 4
 	num_answers_to_alive = 3
 	revive_interval = 120
  limit {
  	max_connections = 16
  	max_requests = 0
  	lifetime = 0
  	idle_timeout = 0
  }
  coa {
  	irt = 2
  	mrt = 16
  	mrc = 5
  	mrd = 30
  }
 }
 home_server_pool my_auth_failover {
	type = fail-over
	home_server = localhost
 }
 realm example.com {
	auth_pool = my_auth_failover
 }
 realm LOCAL {
 }
radiusd: #### Loading Clients ####
 client localhost {
 	ipaddr = 127.0.0.1
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	nas_type = "other"
 	proto = "*"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client localhost_ipv6 {
 	ipv6addr = ::1
 	require_message_authenticator = no
 	secret = <<< secret >>>
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
Debug state unknown (cap_sys_ptrace capability not set)
 # Creating Auth-Type = digest
radiusd: #### Instantiating modules ####
  # Loaded module rlm_always
  # Loading module "reject" from file /etc/freeradius/mods-enabled/always
  always reject {
  	rcode = "reject"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "fail" from file /etc/freeradius/mods-enabled/always
  always fail {
  	rcode = "fail"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "ok" from file /etc/freeradius/mods-enabled/always
  always ok {
  	rcode = "ok"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "handled" from file /etc/freeradius/mods-enabled/always
  always handled {
  	rcode = "handled"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "invalid" from file /etc/freeradius/mods-enabled/always
  always invalid {
  	rcode = "invalid"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "userlock" from file /etc/freeradius/mods-enabled/always
  always userlock {
  	rcode = "userlock"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "notfound" from file /etc/freeradius/mods-enabled/always
  always notfound {
  	rcode = "notfound"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "noop" from file /etc/freeradius/mods-enabled/always
  always noop {
  	rcode = "noop"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "updated" from file /etc/freeradius/mods-enabled/always
  always updated {
  	rcode = "updated"
  	simulcount = 0
  	mpp = no
  }
  # Loaded module rlm_attr_filter
  # Loading module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.post-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/post-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.pre-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/pre-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_reject {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_reject"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_challenge {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_challenge"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.accounting_response {
  	filename = "/etc/freeradius/mods-config/attr_filter/accounting_response"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loaded module rlm_cache
  # Loading module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
  cache cache_eap {
  	driver = "rlm_cache_rbtree"
  	key = "%{%{control:State}:-%{%{reply:State}:-%{State}}}"
  	ttl = 15
  	max_entries = 0
  	epoch = 0
  	add_stats = no
  }
  # Loaded module rlm_chap
  # Loading module "chap" from file /etc/freeradius/mods-enabled/chap
  # Loaded module rlm_detail
  # Loading module "detail" from file /etc/freeradius/mods-enabled/detail
  detail {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
  detail auth_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/auth-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  detail reply_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/reply-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail pre_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/pre-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail post_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/post-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loaded module rlm_digest
  # Loading module "digest" from file /etc/freeradius/mods-enabled/digest
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_eap
  # Loading module "eap" from file /etc/freeradius/mods-enabled/eap
  eap {
  	default_eap_type = "md5"
  	timer_expire = 60
  	ignore_unknown_eap_types = no
  	cisco_accounting_username_bug = no
  	max_sessions = 16384
  }
  # Loaded module rlm_exec
  # Loading module "echo" from file /etc/freeradius/mods-enabled/echo
  exec echo {
  	wait = yes
  	program = "/bin/echo %{User-Name}"
  	input_pairs = "request"
  	output_pairs = "reply"
  	shell_escape = yes
  }
  # Loading module "exec" from file /etc/freeradius/mods-enabled/exec
  exec {
  	wait = no
  	input_pairs = "request"
  	shell_escape = yes
  	timeout = 10
  }
  # Loaded module rlm_expiration
  # Loading module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Loaded module rlm_expr
  # Loading module "expr" from file /etc/freeradius/mods-enabled/expr
  expr {
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /äéöüàâæçèéêëîïôœùûüaÿÄÉÖÜßÀÂÆÇÈÉÊËÎÏÔŒÙÛÜŸ"
  }
  # Loaded module rlm_files
  # Loading module "files" from file /etc/freeradius/mods-enabled/files
  files {
  	filename = "/etc/freeradius/mods-config/files/authorize"
Unable to open file "/etc/freeradius/mods-config/files/authorize": Permission denied
/etc/freeradius/mods-enabled/files[9]: Invalid configuration for module "files"
main {
	name = "freeradius"
	prefix = "/usr"
	localstatedir = "/var"
	sbindir = "/usr/sbin"
	logdir = "/var/log/freeradius"
	run_dir = "/var/run/freeradius"
	libdir = "/usr/lib/freeradius"
	radacctdir = "/var/log/freeradius/radacct"
	hostname_lookups = no
	max_request_time = 30
	cleanup_delay = 5
	max_requests = 16384
	pidfile = "/var/run/freeradius/freeradius.pid"
	checkrad = "/usr/sbin/checkrad"
	debug_level = 0
	proxy_requests = yes
 log {
 	stripped_names = no
 	auth = no
 	auth_badpass = no
 	auth_goodpass = no
 	colourise = yes
 	msg_denied = "You are already logged in - access denied"
 }
 resources {
 }
 security {
 	max_attributes = 200
 	reject_delay = 1.000000
 	status_server = yes
 }
}
radiusd: #### Loading Realms and Home Servers ####
 proxy server {
 	retry_delay = 5
 	retry_count = 3
 	default_fallback = no
 	dead_time = 120
 	wake_all_if_all_dead = no
 }
 home_server localhost {
 	ipaddr = 127.0.0.1
 	port = 1812
 	type = "auth"
 	secret = <<< secret >>>
 	response_window = 20.000000
 	response_timeouts = 1
 	max_outstanding = 65536
 	zombie_period = 40
 	status_check = "status-server"
 	ping_interval = 30
 	check_interval = 30
 	check_timeout = 4
 	num_answers_to_alive = 3
 	revive_interval = 120
  limit {
  	max_connections = 16
  	max_requests = 0
  	lifetime = 0
  	idle_timeout = 0
  }
  coa {
  	irt = 2
  	mrt = 16
  	mrc = 5
  	mrd = 30
  }
 }
 home_server_pool my_auth_failover {
	type = fail-over
	home_server = localhost
 }
 realm example.com {
	auth_pool = my_auth_failover
 }
 realm LOCAL {
 }
radiusd: #### Loading Clients ####
 client localhost {
 	ipaddr = 127.0.0.1
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	nas_type = "other"
 	proto = "*"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client localhost_ipv6 {
 	ipv6addr = ::1
 	require_message_authenticator = no
 	secret = <<< secret >>>
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
Debug state unknown (cap_sys_ptrace capability not set)
 # Creating Auth-Type = digest
radiusd: #### Instantiating modules ####
  # Loaded module rlm_always
  # Loading module "reject" from file /etc/freeradius/mods-enabled/always
  always reject {
  	rcode = "reject"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "fail" from file /etc/freeradius/mods-enabled/always
  always fail {
  	rcode = "fail"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "ok" from file /etc/freeradius/mods-enabled/always
  always ok {
  	rcode = "ok"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "handled" from file /etc/freeradius/mods-enabled/always
  always handled {
  	rcode = "handled"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "invalid" from file /etc/freeradius/mods-enabled/always
  always invalid {
  	rcode = "invalid"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "userlock" from file /etc/freeradius/mods-enabled/always
  always userlock {
  	rcode = "userlock"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "notfound" from file /etc/freeradius/mods-enabled/always
  always notfound {
  	rcode = "notfound"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "noop" from file /etc/freeradius/mods-enabled/always
  always noop {
  	rcode = "noop"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "updated" from file /etc/freeradius/mods-enabled/always
  always updated {
  	rcode = "updated"
  	simulcount = 0
  	mpp = no
  }
  # Loaded module rlm_attr_filter
  # Loading module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.post-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/post-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.pre-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/pre-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_reject {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_reject"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_challenge {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_challenge"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.accounting_response {
  	filename = "/etc/freeradius/mods-config/attr_filter/accounting_response"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loaded module rlm_cache
  # Loading module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
  cache cache_eap {
  	driver = "rlm_cache_rbtree"
  	key = "%{%{control:State}:-%{%{reply:State}:-%{State}}}"
  	ttl = 15
  	max_entries = 0
  	epoch = 0
  	add_stats = no
  }
  # Loaded module rlm_chap
  # Loading module "chap" from file /etc/freeradius/mods-enabled/chap
  # Loaded module rlm_detail
  # Loading module "detail" from file /etc/freeradius/mods-enabled/detail
  detail {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
  detail auth_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/auth-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  detail reply_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/reply-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail pre_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/pre-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail post_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/post-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loaded module rlm_digest
  # Loading module "digest" from file /etc/freeradius/mods-enabled/digest
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_eap
  # Loading module "eap" from file /etc/freeradius/mods-enabled/eap
  eap {
  	default_eap_type = "md5"
  	timer_expire = 60
  	ignore_unknown_eap_types = no
  	cisco_accounting_username_bug = no
  	max_sessions = 16384
  }
  # Loaded module rlm_exec
  # Loading module "echo" from file /etc/freeradius/mods-enabled/echo
  exec echo {
  	wait = yes
  	program = "/bin/echo %{User-Name}"
  	input_pairs = "request"
  	output_pairs = "reply"
  	shell_escape = yes
  }
  # Loading module "exec" from file /etc/freeradius/mods-enabled/exec
  exec {
  	wait = no
  	input_pairs = "request"
  	shell_escape = yes
  	timeout = 10
  }
  # Loaded module rlm_expiration
  # Loading module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Loaded module rlm_expr
  # Loading module "expr" from file /etc/freeradius/mods-enabled/expr
  expr {
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /äéöüàâæçèéêëîïôœùûüaÿÄÉÖÜßÀÂÆÇÈÉÊËÎÏÔŒÙÛÜŸ"
  }
  # Loaded module rlm_files
  # Loading module "files" from file /etc/freeradius/mods-enabled/files
  files {
  	filename = "/etc/freeradius/mods-config/files/authorize"
  	acctusersfile = "/etc/freeradius/mods-config/files/accounting"
  	preproxy_usersfile = "/etc/freeradius/mods-config/files/pre-proxy"
  }
  # Loaded module rlm_linelog
  # Loading module "linelog" from file /etc/freeradius/mods-enabled/linelog
  linelog {
  	filename = "/var/log/freeradius/linelog"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = "This is a log message for %{User-Name}"
  	reference = "messages.%{%{reply:Packet-Type}:-default}"
  }
  # Loading module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  linelog log_accounting {
  	filename = "/var/log/freeradius/linelog-accounting"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = ""
  	reference = "Accounting-Request.%{%{Acct-Status-Type}:-unknown}"
  }
  # Loaded module rlm_logintime
  # Loading module "logintime" from file /etc/freeradius/mods-enabled/logintime
  logintime {
  	minimum_timeout = 60
  }
  # Loaded module rlm_mschap
  # Loading module "mschap" from file /etc/freeradius/mods-enabled/mschap
  mschap {
  	use_mppe = yes
  	require_encryption = no
  	require_strong = no
  	with_ntdomain_hack = yes
   passchange {
   }
  	allow_retry = yes
  }
  # Loading module "ntlm_auth" from file /etc/freeradius/mods-enabled/ntlm_auth
  exec ntlm_auth {
  	wait = yes
  	program = "/path/to/ntlm_auth --request-nt-key --domain=MYDOMAIN --username=%{mschap:User-Name} --password=%{User-Password}"
  	shell_escape = yes
  }
  # Loaded module rlm_pap
  # Loading module "pap" from file /etc/freeradius/mods-enabled/pap
  pap {
  	normalise = yes
  }
  # Loaded module rlm_passwd
  # Loading module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
  passwd etc_passwd {
  	filename = "/etc/passwd"
  	format = "*User-Name:Crypt-Password:"
  	delimiter = ":"
  	ignore_nislike = no
  	ignore_empty = yes
  	allow_multiple_keys = no
  	hash_size = 100
  }
  # Loaded module rlm_preprocess
  # Loading module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
  preprocess {
  	huntgroups = "/etc/freeradius/mods-config/preprocess/huntgroups"
  	hints = "/etc/freeradius/mods-config/preprocess/hints"
  	with_ascend_hack = no
  	ascend_channels_per_line = 23
  	with_ntdomain_hack = no
  	with_specialix_jetstream_hack = no
  	with_cisco_vsa_hack = no
  	with_alvarion_vsa_hack = no
  }
  # Loaded module rlm_radutmp
  # Loading module "radutmp" from file /etc/freeradius/mods-enabled/radutmp
  radutmp {
  	filename = "/var/log/freeradius/radutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 384
  	caller_id = yes
  }
  # Loaded module rlm_realm
  # Loading module "IPASS" from file /etc/freeradius/mods-enabled/realm
  realm IPASS {
  	format = "prefix"
  	delimiter = "/"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "suffix" from file /etc/freeradius/mods-enabled/realm
  realm suffix {
  	format = "suffix"
  	delimiter = "@"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  realm realmpercent {
  	format = "suffix"
  	delimiter = "%"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "ntdomain" from file /etc/freeradius/mods-enabled/realm
  realm ntdomain {
  	format = "prefix"
  	delimiter = "\\"
  	ignore_default = no
  	ignore_null = no
  }
  # Loaded module rlm_replicate
  # Loading module "replicate" from file /etc/freeradius/mods-enabled/replicate
  # Loaded module rlm_soh
  # Loading module "soh" from file /etc/freeradius/mods-enabled/soh
  soh {
  	dhcp = yes
  }
  # Loading module "sradutmp" from file /etc/freeradius/mods-enabled/sradutmp
  radutmp sradutmp {
  	filename = "/var/log/freeradius/sradutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 420
  	caller_id = no
  }
  # Loaded module rlm_unix
  # Loading module "unix" from file /etc/freeradius/mods-enabled/unix
  unix {
  	radwtmp = "/var/log/freeradius/radwtmp"
  }
Creating attribute Unix-Group
  # Loaded module rlm_unpack
  # Loading module "unpack" from file /etc/freeradius/mods-enabled/unpack
  # Loaded module rlm_utf8
  # Loading module "utf8" from file /etc/freeradius/mods-enabled/utf8
 instantiate {
 }
 modules {
  # Instantiating module "reject" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "fail" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "ok" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "handled" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "invalid" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "userlock" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "notfound" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "noop" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "updated" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/post-proxy
  # Instantiating module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/pre-proxy
  # Instantiating module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_reject
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay" 	found in filter list for realm "DEFAULT". 
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay-USec" 	found in filter list for realm "DEFAULT". 
  # Instantiating module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_challenge
  # Instantiating module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/accounting_response
  # Instantiating module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
rlm_cache (cache_eap): Driver rlm_cache_rbtree (module rlm_cache_rbtree) loaded and linked
  # Instantiating module "detail" from file /etc/freeradius/mods-enabled/detail
  # Instantiating module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
rlm_detail (auth_log): 'User-Password' suppressed, will not appear in detail output
  # Instantiating module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "eap" from file /etc/freeradius/mods-enabled/eap
   # Linked to sub-module rlm_eap_md5
   # Linked to sub-module rlm_eap_leap
   # Linked to sub-module rlm_eap_gtc
   gtc {
   	challenge = "Password: "
   	auth_type = "PAP"
   }
   # Linked to sub-module rlm_eap_tls
   tls {
   	tls = "tls-common"
   }
   tls-config tls-common {
   	rsa_key_exchange = no
   	dh_key_exchange = yes
   	rsa_key_length = 512
   	dh_key_length = 512
   	verify_depth = 0
   	ca_path = "/etc/freeradius/certs"
   	pem_file_type = yes
   	private_key_file = "/etc/freeradius/certs/server.pem"
   	certificate_file = "/etc/freeradius/certs/server.pem"
   	ca_file = "/etc/freeradius/certs/ca.pem"
   	private_key_password = <<< secret >>>
   	dh_file = "/etc/freeradius/certs/dh"
   	fragment_size = 1024
   	include_length = yes
   	check_crl = no
   	check_all_crl = no
   	cipher_list = "DEFAULT"
   	ecdh_curve = "prime256v1"
    cache {
    	enable = yes
    	lifetime = 24
    	max_entries = 255
    }
    verify {
    }
    ocsp {
    	enable = no
    	override_cert_url = yes
    	url = "http://127.0.0.1/ocsp/"
    	use_nonce = yes
    	timeout = 0
    	softfail = no
    }
   }
   # Linked to sub-module rlm_eap_ttls
   ttls {
   	tls = "tls-common"
   	default_eap_type = "md5"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	virtual_server = "inner-tunnel"
   	include_length = yes
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_peap
   peap {
   	tls = "tls-common"
   	default_eap_type = "mschapv2"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	proxy_tunneled_request_as_eap = yes
   	virtual_server = "inner-tunnel"
   	soh = no
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_mschapv2
   mschapv2 {
   	with_ntdomain_hack = no
   	send_error = no
   }
  # Instantiating module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Instantiating module "files" from file /etc/freeradius/mods-enabled/files
reading pairlist file /etc/freeradius/mods-config/files/authorize
reading pairlist file /etc/freeradius/mods-config/files/accounting
reading pairlist file /etc/freeradius/mods-config/files/pre-proxy
  # Instantiating module "linelog" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "logintime" from file /etc/freeradius/mods-enabled/logintime
  # Instantiating module "mschap" from file /etc/freeradius/mods-enabled/mschap
rlm_mschap (mschap): using internal authentication
  # Instantiating module "pap" from file /etc/freeradius/mods-enabled/pap
  # Instantiating module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
rlm_passwd: nfields: 3 keyfield 0(User-Name) listable: no
  # Instantiating module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
reading pairlist file /etc/freeradius/mods-config/preprocess/huntgroups
reading pairlist file /etc/freeradius/mods-config/preprocess/hints
  # Instantiating module "IPASS" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "suffix" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "ntdomain" from file /etc/freeradius/mods-enabled/realm
 } # modules
radiusd: #### Loading Virtual Servers ####
server { # from file /etc/freeradius/radiusd.conf
} # server
server default { # from file /etc/freeradius/sites-enabled/default
 # Loading authenticate {...}
 # Loading authorize {...}
Ignoring "sql" (see raddb/mods-available/README.rst)
Ignoring "ldap" (see raddb/mods-available/README.rst)
 # Loading preacct {...}
 # Loading accounting {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server default
server inner-tunnel { # from file /etc/freeradius/sites-enabled/inner-tunnel
 # Loading authenticate {...}
 # Loading authorize {...}
 # Loading session {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server inner-tunnel
 thread pool {
 	start_servers = 5
 	max_servers = 32
 	min_spare_servers = 3
 	max_spare_servers = 10
 	max_requests_per_server = 0
 	cleanup_delay = 5
 	max_queue_size = 65536
 	auto_limit_acct = no
 }
Thread spawned new child 1. Total threads in pool: 1
Thread spawned new child 2. Total threads in pool: 2
Thread spawned new child 3. Total threads in pool: 3
Thread spawned new child 4. Total threads in pool: 4
Thread spawned new child 5. Total threads in pool: 5
Thread pool initialized
radiusd: #### Opening IP addresses and Ports ####
listen {
  	type = "auth"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
Thread 2 waiting to be assigned a request
Thread 1 waiting to be assigned a request
Thread 5 waiting to be assigned a request
Thread 4 waiting to be assigned a request
Thread 3 waiting to be assigned a request
}
listen {
  	type = "acct"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "acct"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipaddr = 127.0.0.1
  	port = 18120
}
Listening on auth address * port 1812 bound to server default
Listening on acct address * port 1813 bound to server default
Listening on auth address :: port 1812 bound to server default
Listening on acct address :: port 1813 bound to server default
Listening on auth address 127.0.0.1 port 18120 bound to server inner-tunnel
Listening on proxy address * port 53721
Listening on proxy address :: port 53088
Ready to process requests
main {
	name = "freeradius"
	prefix = "/usr"
	localstatedir = "/var"
	sbindir = "/usr/sbin"
	logdir = "/var/log/freeradius"
	run_dir = "/var/run/freeradius"
	libdir = "/usr/lib/freeradius"
	radacctdir = "/var/log/freeradius/radacct"
	hostname_lookups = no
	max_request_time = 30
	cleanup_delay = 5
	max_requests = 16384
	pidfile = "/var/run/freeradius/freeradius.pid"
	checkrad = "/usr/sbin/checkrad"
	debug_level = 0
	proxy_requests = yes
 log {
 	stripped_names = no
 	auth = no
 	auth_badpass = no
 	auth_goodpass = no
 	colourise = yes
 	msg_denied = "You are already logged in - access denied"
 }
 resources {
 }
 security {
 	max_attributes = 200
 	reject_delay = 1.000000
 	status_server = yes
 }
}
radiusd: #### Loading Realms and Home Servers ####
 proxy server {
 	retry_delay = 5
 	retry_count = 3
 	default_fallback = no
 	dead_time = 120
 	wake_all_if_all_dead = no
 }
 home_server localhost {
 	ipaddr = 127.0.0.1
 	port = 1812
 	type = "auth"
 	secret = <<< secret >>>
 	response_window = 20.000000
 	response_timeouts = 1
 	max_outstanding = 65536
 	zombie_period = 40
 	status_check = "status-server"
 	ping_interval = 30
 	check_interval = 30
 	check_timeout = 4
 	num_answers_to_alive = 3
 	revive_interval = 120
  limit {
  	max_connections = 16
  	max_requests = 0
  	lifetime = 0
  	idle_timeout = 0
  }
  coa {
  	irt = 2
  	mrt = 16
  	mrc = 5
  	mrd = 30
  }
 }
 home_server_pool my_auth_failover {
	type = fail-over
	home_server = localhost
 }
 realm example.com {
	auth_pool = my_auth_failover
 }
 realm LOCAL {
 }
radiusd: #### Loading Clients ####
 client localhost {
 	ipaddr = 127.0.0.1
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	nas_type = "other"
 	proto = "*"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client localhost_ipv6 {
 	ipv6addr = ::1
 	require_message_authenticator = no
 	secret = <<< secret >>>
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
Debug state unknown (cap_sys_ptrace capability not set)
 # Creating Auth-Type = digest
radiusd: #### Instantiating modules ####
  # Loaded module rlm_always
  # Loading module "reject" from file /etc/freeradius/mods-enabled/always
  always reject {
  	rcode = "reject"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "fail" from file /etc/freeradius/mods-enabled/always
  always fail {
  	rcode = "fail"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "ok" from file /etc/freeradius/mods-enabled/always
  always ok {
  	rcode = "ok"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "handled" from file /etc/freeradius/mods-enabled/always
  always handled {
  	rcode = "handled"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "invalid" from file /etc/freeradius/mods-enabled/always
  always invalid {
  	rcode = "invalid"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "userlock" from file /etc/freeradius/mods-enabled/always
  always userlock {
  	rcode = "userlock"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "notfound" from file /etc/freeradius/mods-enabled/always
  always notfound {
  	rcode = "notfound"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "noop" from file /etc/freeradius/mods-enabled/always
  always noop {
  	rcode = "noop"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "updated" from file /etc/freeradius/mods-enabled/always
  always updated {
  	rcode = "updated"
  	simulcount = 0
  	mpp = no
  }
  # Loaded module rlm_attr_filter
  # Loading module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.post-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/post-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.pre-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/pre-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_reject {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_reject"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_challenge {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_challenge"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.accounting_response {
  	filename = "/etc/freeradius/mods-config/attr_filter/accounting_response"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loaded module rlm_cache
  # Loading module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
  cache cache_eap {
  	driver = "rlm_cache_rbtree"
  	key = "%{%{control:State}:-%{%{reply:State}:-%{State}}}"
  	ttl = 15
  	max_entries = 0
  	epoch = 0
  	add_stats = no
  }
  # Loaded module rlm_chap
  # Loading module "chap" from file /etc/freeradius/mods-enabled/chap
  # Loaded module rlm_detail
  # Loading module "detail" from file /etc/freeradius/mods-enabled/detail
  detail {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
  detail auth_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/auth-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  detail reply_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/reply-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail pre_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/pre-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail post_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/post-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loaded module rlm_digest
  # Loading module "digest" from file /etc/freeradius/mods-enabled/digest
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_eap
  # Loading module "eap" from file /etc/freeradius/mods-enabled/eap
  eap {
  	default_eap_type = "md5"
  	timer_expire = 60
  	ignore_unknown_eap_types = no
  	cisco_accounting_username_bug = no
  	max_sessions = 16384
  }
  # Loaded module rlm_exec
  # Loading module "echo" from file /etc/freeradius/mods-enabled/echo
  exec echo {
  	wait = yes
  	program = "/bin/echo %{User-Name}"
  	input_pairs = "request"
  	output_pairs = "reply"
  	shell_escape = yes
  }
  # Loading module "exec" from file /etc/freeradius/mods-enabled/exec
  exec {
  	wait = no
  	input_pairs = "request"
  	shell_escape = yes
  	timeout = 10
  }
  # Loaded module rlm_expiration
  # Loading module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Loaded module rlm_expr
  # Loading module "expr" from file /etc/freeradius/mods-enabled/expr
  expr {
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /äéöüàâæçèéêëîïôœùûüaÿÄÉÖÜßÀÂÆÇÈÉÊËÎÏÔŒÙÛÜŸ"
  }
  # Loaded module rlm_files
  # Loading module "files" from file /etc/freeradius/mods-enabled/files
  files {
  	filename = "/etc/freeradius/mods-config/files/authorize"
Unable to open file "/etc/freeradius/mods-config/files/authorize": Permission denied
/etc/freeradius/mods-enabled/files[9]: Invalid configuration for module "files"
main {
	name = "freeradius"
	prefix = "/usr"
	localstatedir = "/var"
	sbindir = "/usr/sbin"
	logdir = "/var/log/freeradius"
	run_dir = "/var/run/freeradius"
	libdir = "/usr/lib/freeradius"
	radacctdir = "/var/log/freeradius/radacct"
	hostname_lookups = no
	max_request_time = 30
	cleanup_delay = 5
	max_requests = 16384
	pidfile = "/var/run/freeradius/freeradius.pid"
	checkrad = "/usr/sbin/checkrad"
	debug_level = 0
	proxy_requests = yes
 log {
 	stripped_names = no
 	auth = no
 	auth_badpass = no
 	auth_goodpass = no
 	colourise = yes
 	msg_denied = "You are already logged in - access denied"
 }
 resources {
 }
 security {
 	max_attributes = 200
 	reject_delay = 1.000000
 	status_server = yes
 }
}
radiusd: #### Loading Realms and Home Servers ####
 proxy server {
 	retry_delay = 5
 	retry_count = 3
 	default_fallback = no
 	dead_time = 120
 	wake_all_if_all_dead = no
 }
 home_server localhost {
 	ipaddr = 127.0.0.1
 	port = 1812
 	type = "auth"
 	secret = <<< secret >>>
 	response_window = 20.000000
 	response_timeouts = 1
 	max_outstanding = 65536
 	zombie_period = 40
 	status_check = "status-server"
 	ping_interval = 30
 	check_interval = 30
 	check_timeout = 4
 	num_answers_to_alive = 3
 	revive_interval = 120
  limit {
  	max_connections = 16
  	max_requests = 0
  	lifetime = 0
  	idle_timeout = 0
  }
  coa {
  	irt = 2
  	mrt = 16
  	mrc = 5
  	mrd = 30
  }
 }
 home_server_pool my_auth_failover {
	type = fail-over
	home_server = localhost
 }
 realm example.com {
	auth_pool = my_auth_failover
 }
 realm LOCAL {
 }
radiusd: #### Loading Clients ####
 client localhost {
 	ipaddr = 127.0.0.1
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	nas_type = "other"
 	proto = "*"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client localhost_ipv6 {
 	ipv6addr = ::1
 	require_message_authenticator = no
 	secret = <<< secret >>>
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
Debug state unknown (cap_sys_ptrace capability not set)
 # Creating Auth-Type = digest
radiusd: #### Instantiating modules ####
  # Loaded module rlm_always
  # Loading module "reject" from file /etc/freeradius/mods-enabled/always
  always reject {
  	rcode = "reject"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "fail" from file /etc/freeradius/mods-enabled/always
  always fail {
  	rcode = "fail"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "ok" from file /etc/freeradius/mods-enabled/always
  always ok {
  	rcode = "ok"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "handled" from file /etc/freeradius/mods-enabled/always
  always handled {
  	rcode = "handled"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "invalid" from file /etc/freeradius/mods-enabled/always
  always invalid {
  	rcode = "invalid"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "userlock" from file /etc/freeradius/mods-enabled/always
  always userlock {
  	rcode = "userlock"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "notfound" from file /etc/freeradius/mods-enabled/always
  always notfound {
  	rcode = "notfound"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "noop" from file /etc/freeradius/mods-enabled/always
  always noop {
  	rcode = "noop"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "updated" from file /etc/freeradius/mods-enabled/always
  always updated {
  	rcode = "updated"
  	simulcount = 0
  	mpp = no
  }
  # Loaded module rlm_attr_filter
  # Loading module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.post-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/post-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.pre-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/pre-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_reject {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_reject"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_challenge {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_challenge"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.accounting_response {
  	filename = "/etc/freeradius/mods-config/attr_filter/accounting_response"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loaded module rlm_cache
  # Loading module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
  cache cache_eap {
  	driver = "rlm_cache_rbtree"
  	key = "%{%{control:State}:-%{%{reply:State}:-%{State}}}"
  	ttl = 15
  	max_entries = 0
  	epoch = 0
  	add_stats = no
  }
  # Loaded module rlm_chap
  # Loading module "chap" from file /etc/freeradius/mods-enabled/chap
  # Loaded module rlm_detail
  # Loading module "detail" from file /etc/freeradius/mods-enabled/detail
  detail {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
  detail auth_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/auth-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  detail reply_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/reply-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail pre_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/pre-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail post_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/post-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loaded module rlm_digest
  # Loading module "digest" from file /etc/freeradius/mods-enabled/digest
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_eap
  # Loading module "eap" from file /etc/freeradius/mods-enabled/eap
  eap {
  	default_eap_type = "md5"
  	timer_expire = 60
  	ignore_unknown_eap_types = no
  	cisco_accounting_username_bug = no
  	max_sessions = 16384
  }
  # Loaded module rlm_exec
  # Loading module "echo" from file /etc/freeradius/mods-enabled/echo
  exec echo {
  	wait = yes
  	program = "/bin/echo %{User-Name}"
  	input_pairs = "request"
  	output_pairs = "reply"
  	shell_escape = yes
  }
  # Loading module "exec" from file /etc/freeradius/mods-enabled/exec
  exec {
  	wait = no
  	input_pairs = "request"
  	shell_escape = yes
  	timeout = 10
  }
  # Loaded module rlm_expiration
  # Loading module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Loaded module rlm_expr
  # Loading module "expr" from file /etc/freeradius/mods-enabled/expr
  expr {
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /äéöüàâæçèéêëîïôœùûüaÿÄÉÖÜßÀÂÆÇÈÉÊËÎÏÔŒÙÛÜŸ"
  }
  # Loaded module rlm_files
  # Loading module "files" from file /etc/freeradius/mods-enabled/files
  files {
  	filename = "/etc/freeradius/mods-config/files/authorize"
Unable to open file "/etc/freeradius/mods-config/files/authorize": Permission denied
/etc/freeradius/mods-enabled/files[9]: Invalid configuration for module "files"
main {
	name = "freeradius"
	prefix = "/usr"
	localstatedir = "/var"
	sbindir = "/usr/sbin"
	logdir = "/var/log/freeradius"
	run_dir = "/var/run/freeradius"
	libdir = "/usr/lib/freeradius"
	radacctdir = "/var/log/freeradius/radacct"
	hostname_lookups = no
	max_request_time = 30
	cleanup_delay = 5
	max_requests = 16384
	pidfile = "/var/run/freeradius/freeradius.pid"
	checkrad = "/usr/sbin/checkrad"
	debug_level = 0
	proxy_requests = yes
 log {
 	stripped_names = no
 	auth = no
 	auth_badpass = no
 	auth_goodpass = no
 	colourise = yes
 	msg_denied = "You are already logged in - access denied"
 }
 resources {
 }
 security {
 	max_attributes = 200
 	reject_delay = 1.000000
 	status_server = yes
 }
}
radiusd: #### Loading Realms and Home Servers ####
 proxy server {
 	retry_delay = 5
 	retry_count = 3
 	default_fallback = no
 	dead_time = 120
 	wake_all_if_all_dead = no
 }
 home_server localhost {
 	ipaddr = 127.0.0.1
 	port = 1812
 	type = "auth"
 	secret = <<< secret >>>
 	response_window = 20.000000
 	response_timeouts = 1
 	max_outstanding = 65536
 	zombie_period = 40
 	status_check = "status-server"
 	ping_interval = 30
 	check_interval = 30
 	check_timeout = 4
 	num_answers_to_alive = 3
 	revive_interval = 120
  limit {
  	max_connections = 16
  	max_requests = 0
  	lifetime = 0
  	idle_timeout = 0
  }
  coa {
  	irt = 2
  	mrt = 16
  	mrc = 5
  	mrd = 30
  }
 }
 home_server_pool my_auth_failover {
	type = fail-over
	home_server = localhost
 }
 realm example.com {
	auth_pool = my_auth_failover
 }
 realm LOCAL {
 }
radiusd: #### Loading Clients ####
 client localhost {
 	ipaddr = 127.0.0.1
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	nas_type = "other"
 	proto = "*"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client localhost_ipv6 {
 	ipv6addr = ::1
 	require_message_authenticator = no
 	secret = <<< secret >>>
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
Debug state unknown (cap_sys_ptrace capability not set)
 # Creating Auth-Type = digest
radiusd: #### Instantiating modules ####
  # Loaded module rlm_always
  # Loading module "reject" from file /etc/freeradius/mods-enabled/always
  always reject {
  	rcode = "reject"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "fail" from file /etc/freeradius/mods-enabled/always
  always fail {
  	rcode = "fail"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "ok" from file /etc/freeradius/mods-enabled/always
  always ok {
  	rcode = "ok"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "handled" from file /etc/freeradius/mods-enabled/always
  always handled {
  	rcode = "handled"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "invalid" from file /etc/freeradius/mods-enabled/always
  always invalid {
  	rcode = "invalid"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "userlock" from file /etc/freeradius/mods-enabled/always
  always userlock {
  	rcode = "userlock"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "notfound" from file /etc/freeradius/mods-enabled/always
  always notfound {
  	rcode = "notfound"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "noop" from file /etc/freeradius/mods-enabled/always
  always noop {
  	rcode = "noop"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "updated" from file /etc/freeradius/mods-enabled/always
  always updated {
  	rcode = "updated"
  	simulcount = 0
  	mpp = no
  }
  # Loaded module rlm_attr_filter
  # Loading module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.post-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/post-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.pre-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/pre-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_reject {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_reject"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_challenge {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_challenge"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.accounting_response {
  	filename = "/etc/freeradius/mods-config/attr_filter/accounting_response"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loaded module rlm_cache
  # Loading module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
  cache cache_eap {
  	driver = "rlm_cache_rbtree"
  	key = "%{%{control:State}:-%{%{reply:State}:-%{State}}}"
  	ttl = 15
  	max_entries = 0
  	epoch = 0
  	add_stats = no
  }
  # Loaded module rlm_chap
  # Loading module "chap" from file /etc/freeradius/mods-enabled/chap
  # Loaded module rlm_detail
  # Loading module "detail" from file /etc/freeradius/mods-enabled/detail
  detail {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
  detail auth_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/auth-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  detail reply_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/reply-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail pre_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/pre-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail post_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/post-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loaded module rlm_digest
  # Loading module "digest" from file /etc/freeradius/mods-enabled/digest
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_eap
  # Loading module "eap" from file /etc/freeradius/mods-enabled/eap
  eap {
  	default_eap_type = "md5"
  	timer_expire = 60
  	ignore_unknown_eap_types = no
  	cisco_accounting_username_bug = no
  	max_sessions = 16384
  }
  # Loaded module rlm_exec
  # Loading module "echo" from file /etc/freeradius/mods-enabled/echo
  exec echo {
  	wait = yes
  	program = "/bin/echo %{User-Name}"
  	input_pairs = "request"
  	output_pairs = "reply"
  	shell_escape = yes
  }
  # Loading module "exec" from file /etc/freeradius/mods-enabled/exec
  exec {
  	wait = no
  	input_pairs = "request"
  	shell_escape = yes
  	timeout = 10
  }
  # Loaded module rlm_expiration
  # Loading module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Loaded module rlm_expr
  # Loading module "expr" from file /etc/freeradius/mods-enabled/expr
  expr {
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /äéöüàâæçèéêëîïôœùûüaÿÄÉÖÜßÀÂÆÇÈÉÊËÎÏÔŒÙÛÜŸ"
  }
  # Loaded module rlm_files
  # Loading module "files" from file /etc/freeradius/mods-enabled/files
  files {
  	filename = "/etc/freeradius/mods-config/files/authorize"
  	acctusersfile = "/etc/freeradius/mods-config/files/accounting"
  	preproxy_usersfile = "/etc/freeradius/mods-config/files/pre-proxy"
  }
  # Loaded module rlm_linelog
  # Loading module "linelog" from file /etc/freeradius/mods-enabled/linelog
  linelog {
  	filename = "/var/log/freeradius/linelog"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = "This is a log message for %{User-Name}"
  	reference = "messages.%{%{reply:Packet-Type}:-default}"
  }
  # Loading module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  linelog log_accounting {
  	filename = "/var/log/freeradius/linelog-accounting"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = ""
  	reference = "Accounting-Request.%{%{Acct-Status-Type}:-unknown}"
  }
  # Loaded module rlm_logintime
  # Loading module "logintime" from file /etc/freeradius/mods-enabled/logintime
  logintime {
  	minimum_timeout = 60
  }
  # Loaded module rlm_mschap
  # Loading module "mschap" from file /etc/freeradius/mods-enabled/mschap
  mschap {
  	use_mppe = yes
  	require_encryption = no
  	require_strong = no
  	with_ntdomain_hack = yes
   passchange {
   }
  	allow_retry = yes
  }
  # Loading module "ntlm_auth" from file /etc/freeradius/mods-enabled/ntlm_auth
  exec ntlm_auth {
  	wait = yes
  	program = "/path/to/ntlm_auth --request-nt-key --domain=MYDOMAIN --username=%{mschap:User-Name} --password=%{User-Password}"
  	shell_escape = yes
  }
  # Loaded module rlm_pap
  # Loading module "pap" from file /etc/freeradius/mods-enabled/pap
  pap {
  	normalise = yes
  }
  # Loaded module rlm_passwd
  # Loading module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
  passwd etc_passwd {
  	filename = "/etc/passwd"
  	format = "*User-Name:Crypt-Password:"
  	delimiter = ":"
  	ignore_nislike = no
  	ignore_empty = yes
  	allow_multiple_keys = no
  	hash_size = 100
  }
  # Loaded module rlm_preprocess
  # Loading module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
  preprocess {
  	huntgroups = "/etc/freeradius/mods-config/preprocess/huntgroups"
  	hints = "/etc/freeradius/mods-config/preprocess/hints"
  	with_ascend_hack = no
  	ascend_channels_per_line = 23
  	with_ntdomain_hack = no
  	with_specialix_jetstream_hack = no
  	with_cisco_vsa_hack = no
  	with_alvarion_vsa_hack = no
  }
  # Loaded module rlm_radutmp
  # Loading module "radutmp" from file /etc/freeradius/mods-enabled/radutmp
  radutmp {
  	filename = "/var/log/freeradius/radutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 384
  	caller_id = yes
  }
  # Loaded module rlm_realm
  # Loading module "IPASS" from file /etc/freeradius/mods-enabled/realm
  realm IPASS {
  	format = "prefix"
  	delimiter = "/"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "suffix" from file /etc/freeradius/mods-enabled/realm
  realm suffix {
  	format = "suffix"
  	delimiter = "@"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  realm realmpercent {
  	format = "suffix"
  	delimiter = "%"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "ntdomain" from file /etc/freeradius/mods-enabled/realm
  realm ntdomain {
  	format = "prefix"
  	delimiter = "\\"
  	ignore_default = no
  	ignore_null = no
  }
  # Loaded module rlm_replicate
  # Loading module "replicate" from file /etc/freeradius/mods-enabled/replicate
  # Loaded module rlm_soh
  # Loading module "soh" from file /etc/freeradius/mods-enabled/soh
  soh {
  	dhcp = yes
  }
  # Loading module "sradutmp" from file /etc/freeradius/mods-enabled/sradutmp
  radutmp sradutmp {
  	filename = "/var/log/freeradius/sradutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 420
  	caller_id = no
  }
  # Loaded module rlm_unix
  # Loading module "unix" from file /etc/freeradius/mods-enabled/unix
  unix {
  	radwtmp = "/var/log/freeradius/radwtmp"
  }
Creating attribute Unix-Group
  # Loaded module rlm_unpack
  # Loading module "unpack" from file /etc/freeradius/mods-enabled/unpack
  # Loaded module rlm_utf8
  # Loading module "utf8" from file /etc/freeradius/mods-enabled/utf8
 instantiate {
 }
 modules {
  # Instantiating module "reject" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "fail" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "ok" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "handled" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "invalid" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "userlock" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "notfound" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "noop" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "updated" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/post-proxy
  # Instantiating module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/pre-proxy
  # Instantiating module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_reject
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay" 	found in filter list for realm "DEFAULT". 
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay-USec" 	found in filter list for realm "DEFAULT". 
  # Instantiating module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_challenge
  # Instantiating module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/accounting_response
  # Instantiating module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
rlm_cache (cache_eap): Driver rlm_cache_rbtree (module rlm_cache_rbtree) loaded and linked
  # Instantiating module "detail" from file /etc/freeradius/mods-enabled/detail
  # Instantiating module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
rlm_detail (auth_log): 'User-Password' suppressed, will not appear in detail output
  # Instantiating module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "eap" from file /etc/freeradius/mods-enabled/eap
   # Linked to sub-module rlm_eap_md5
   # Linked to sub-module rlm_eap_leap
   # Linked to sub-module rlm_eap_gtc
   gtc {
   	challenge = "Password: "
   	auth_type = "PAP"
   }
   # Linked to sub-module rlm_eap_tls
   tls {
   	tls = "tls-common"
   }
   tls-config tls-common {
   	rsa_key_exchange = no
   	dh_key_exchange = yes
   	rsa_key_length = 512
   	dh_key_length = 512
   	verify_depth = 0
   	ca_path = "/etc/freeradius/certs"
   	pem_file_type = yes
   	private_key_file = "/etc/freeradius/certs/server.pem"
   	certificate_file = "/etc/freeradius/certs/server.pem"
   	ca_file = "/etc/freeradius/certs/ca.pem"
   	private_key_password = <<< secret >>>
   	dh_file = "/etc/freeradius/certs/dh"
   	fragment_size = 1024
   	include_length = yes
   	check_crl = no
   	check_all_crl = no
   	cipher_list = "DEFAULT"
   	ecdh_curve = "prime256v1"
    cache {
    	enable = yes
    	lifetime = 24
    	max_entries = 255
    }
    verify {
    }
    ocsp {
    	enable = no
    	override_cert_url = yes
    	url = "http://127.0.0.1/ocsp/"
    	use_nonce = yes
    	timeout = 0
    	softfail = no
    }
   }
   # Linked to sub-module rlm_eap_ttls
   ttls {
   	tls = "tls-common"
   	default_eap_type = "md5"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	virtual_server = "inner-tunnel"
   	include_length = yes
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_peap
   peap {
   	tls = "tls-common"
   	default_eap_type = "mschapv2"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	proxy_tunneled_request_as_eap = yes
   	virtual_server = "inner-tunnel"
   	soh = no
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_mschapv2
   mschapv2 {
   	with_ntdomain_hack = no
   	send_error = no
   }
  # Instantiating module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Instantiating module "files" from file /etc/freeradius/mods-enabled/files
reading pairlist file /etc/freeradius/mods-config/files/authorize
reading pairlist file /etc/freeradius/mods-config/files/accounting
reading pairlist file /etc/freeradius/mods-config/files/pre-proxy
  # Instantiating module "linelog" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "logintime" from file /etc/freeradius/mods-enabled/logintime
  # Instantiating module "mschap" from file /etc/freeradius/mods-enabled/mschap
rlm_mschap (mschap): using internal authentication
  # Instantiating module "pap" from file /etc/freeradius/mods-enabled/pap
  # Instantiating module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
rlm_passwd: nfields: 3 keyfield 0(User-Name) listable: no
  # Instantiating module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
reading pairlist file /etc/freeradius/mods-config/preprocess/huntgroups
reading pairlist file /etc/freeradius/mods-config/preprocess/hints
  # Instantiating module "IPASS" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "suffix" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "ntdomain" from file /etc/freeradius/mods-enabled/realm
 } # modules
radiusd: #### Loading Virtual Servers ####
server { # from file /etc/freeradius/radiusd.conf
} # server
server default { # from file /etc/freeradius/sites-enabled/default
 # Loading authenticate {...}
 # Loading authorize {...}
Ignoring "sql" (see raddb/mods-available/README.rst)
Ignoring "ldap" (see raddb/mods-available/README.rst)
 # Loading preacct {...}
 # Loading accounting {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server default
server inner-tunnel { # from file /etc/freeradius/sites-enabled/inner-tunnel
 # Loading authenticate {...}
 # Loading authorize {...}
 # Loading session {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server inner-tunnel
 thread pool {
 	start_servers = 5
 	max_servers = 32
 	min_spare_servers = 3
 	max_spare_servers = 10
 	max_requests_per_server = 0
 	cleanup_delay = 5
 	max_queue_size = 65536
 	auto_limit_acct = no
 }
Thread spawned new child 1. Total threads in pool: 1
Thread spawned new child 2. Total threads in pool: 2
Thread spawned new child 3. Total threads in pool: 3
Thread spawned new child 4. Total threads in pool: 4
Thread spawned new child 5. Total threads in pool: 5
Thread pool initialized
radiusd: #### Opening IP addresses and Ports ####
listen {
  	type = "auth"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
Thread 1 waiting to be assigned a request
Thread 5 waiting to be assigned a request
Thread 4 waiting to be assigned a request
Thread 3 waiting to be assigned a request
Thread 2 waiting to be assigned a request
}
listen {
  	type = "acct"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "acct"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipaddr = 127.0.0.1
  	port = 18120
}
Listening on auth address * port 1812 bound to server default
Listening on acct address * port 1813 bound to server default
Listening on auth address :: port 1812 bound to server default
Listening on acct address :: port 1813 bound to server default
Listening on auth address 127.0.0.1 port 18120 bound to server inner-tunnel
Listening on proxy address * port 46067
Listening on proxy address :: port 59972
Ready to process requests
Ignoring request to auth address * port 1812 bound to server default from unknown client 192.168.1.30 port 50038 proto udp
Ready to process requests
Ignoring request to auth address * port 1812 bound to server default from unknown client 192.168.1.30 port 50038 proto udp
Ready to process requests
Ignoring request to auth address * port 1812 bound to server default from unknown client 192.168.1.30 port 50038 proto udp
Ready to process requests
Ignoring request to auth address * port 1812 bound to server default from unknown client 192.168.1.30 port 50038 proto udp
Ready to process requests
Ignoring request to auth address * port 1812 bound to server default from unknown client 192.168.1.30 port 50038 proto udp
Ready to process requests
Ignoring request to auth address * port 1812 bound to server default from unknown client 192.168.1.30 port 50038 proto udp
Ready to process requests
Ignoring request to auth address * port 1812 bound to server default from unknown client 192.168.1.30 port 50038 proto udp
Ready to process requests
Ignoring request to auth address * port 1812 bound to server default from unknown client 192.168.1.30 port 50038 proto udp
Ready to process requests
Ignoring request to auth address * port 1812 bound to server default from unknown client 192.168.1.30 port 50038 proto udp
Ready to process requests
Ignoring request to auth address * port 1812 bound to server default from unknown client 192.168.1.30 port 50038 proto udp
Ready to process requests
Ignoring request to auth address * port 1812 bound to server default from unknown client 192.168.1.30 port 50038 proto udp
Ready to process requests
Ignoring request to auth address * port 1812 bound to server default from unknown client 192.168.1.30 port 50038 proto udp
Ready to process requests
Ignoring request to auth address * port 1812 bound to server default from unknown client 192.168.1.30 port 50038 proto udp
Ready to process requests
Ignoring request to auth address * port 1812 bound to server default from unknown client 192.168.1.30 port 50038 proto udp
Ready to process requests
Ignoring request to auth address * port 1812 bound to server default from unknown client 192.168.1.30 port 50038 proto udp
Ready to process requests
main {
	name = "freeradius"
	prefix = "/usr"
	localstatedir = "/var"
	sbindir = "/usr/sbin"
	logdir = "/var/log/freeradius"
	run_dir = "/var/run/freeradius"
	libdir = "/usr/lib/freeradius"
	radacctdir = "/var/log/freeradius/radacct"
	hostname_lookups = no
	max_request_time = 30
	cleanup_delay = 5
	max_requests = 16384
	pidfile = "/var/run/freeradius/freeradius.pid"
	checkrad = "/usr/sbin/checkrad"
	debug_level = 0
	proxy_requests = yes
 log {
 	stripped_names = no
 	auth = no
 	auth_badpass = no
 	auth_goodpass = no
 	colourise = yes
 	msg_denied = "You are already logged in - access denied"
 }
 resources {
 }
 security {
 	max_attributes = 200
 	reject_delay = 1.000000
 	status_server = yes
 }
}
radiusd: #### Loading Realms and Home Servers ####
 proxy server {
 	retry_delay = 5
 	retry_count = 3
 	default_fallback = no
 	dead_time = 120
 	wake_all_if_all_dead = no
 }
 home_server localhost {
 	ipaddr = 127.0.0.1
 	port = 1812
 	type = "auth"
 	secret = <<< secret >>>
 	response_window = 20.000000
 	response_timeouts = 1
 	max_outstanding = 65536
 	zombie_period = 40
 	status_check = "status-server"
 	ping_interval = 30
 	check_interval = 30
 	check_timeout = 4
 	num_answers_to_alive = 3
 	revive_interval = 120
  limit {
  	max_connections = 16
  	max_requests = 0
  	lifetime = 0
  	idle_timeout = 0
  }
  coa {
  	irt = 2
  	mrt = 16
  	mrc = 5
  	mrd = 30
  }
 }
 home_server_pool my_auth_failover {
	type = fail-over
	home_server = localhost
 }
 realm example.com {
	auth_pool = my_auth_failover
 }
 realm LOCAL {
 }
radiusd: #### Loading Clients ####
 client localhost {
 	ipaddr = 127.0.0.1
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	nas_type = "other"
 	proto = "*"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client localhost_ipv6 {
 	ipv6addr = ::1
 	require_message_authenticator = no
 	secret = <<< secret >>>
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client 192.168.1.0/24 {
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	shortname = "roocell-ap"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
No 'ipaddr' or 'ipv4addr' or 'ipv6addr' field found in client 192.168.1.0/24. Please fix your configuration
Support for old-style clients will be removed in a future release
Debug state unknown (cap_sys_ptrace capability not set)
 # Creating Auth-Type = digest
radiusd: #### Instantiating modules ####
  # Loaded module rlm_always
  # Loading module "reject" from file /etc/freeradius/mods-enabled/always
  always reject {
  	rcode = "reject"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "fail" from file /etc/freeradius/mods-enabled/always
  always fail {
  	rcode = "fail"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "ok" from file /etc/freeradius/mods-enabled/always
  always ok {
  	rcode = "ok"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "handled" from file /etc/freeradius/mods-enabled/always
  always handled {
  	rcode = "handled"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "invalid" from file /etc/freeradius/mods-enabled/always
  always invalid {
  	rcode = "invalid"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "userlock" from file /etc/freeradius/mods-enabled/always
  always userlock {
  	rcode = "userlock"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "notfound" from file /etc/freeradius/mods-enabled/always
  always notfound {
  	rcode = "notfound"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "noop" from file /etc/freeradius/mods-enabled/always
  always noop {
  	rcode = "noop"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "updated" from file /etc/freeradius/mods-enabled/always
  always updated {
  	rcode = "updated"
  	simulcount = 0
  	mpp = no
  }
  # Loaded module rlm_attr_filter
  # Loading module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.post-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/post-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.pre-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/pre-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_reject {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_reject"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_challenge {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_challenge"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.accounting_response {
  	filename = "/etc/freeradius/mods-config/attr_filter/accounting_response"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loaded module rlm_cache
  # Loading module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
  cache cache_eap {
  	driver = "rlm_cache_rbtree"
  	key = "%{%{control:State}:-%{%{reply:State}:-%{State}}}"
  	ttl = 15
  	max_entries = 0
  	epoch = 0
  	add_stats = no
  }
  # Loaded module rlm_chap
  # Loading module "chap" from file /etc/freeradius/mods-enabled/chap
  # Loaded module rlm_detail
  # Loading module "detail" from file /etc/freeradius/mods-enabled/detail
  detail {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
  detail auth_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/auth-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  detail reply_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/reply-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail pre_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/pre-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail post_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/post-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loaded module rlm_digest
  # Loading module "digest" from file /etc/freeradius/mods-enabled/digest
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_eap
  # Loading module "eap" from file /etc/freeradius/mods-enabled/eap
  eap {
  	default_eap_type = "md5"
  	timer_expire = 60
  	ignore_unknown_eap_types = no
  	cisco_accounting_username_bug = no
  	max_sessions = 16384
  }
  # Loaded module rlm_exec
  # Loading module "echo" from file /etc/freeradius/mods-enabled/echo
  exec echo {
  	wait = yes
  	program = "/bin/echo %{User-Name}"
  	input_pairs = "request"
  	output_pairs = "reply"
  	shell_escape = yes
  }
  # Loading module "exec" from file /etc/freeradius/mods-enabled/exec
  exec {
  	wait = no
  	input_pairs = "request"
  	shell_escape = yes
  	timeout = 10
  }
  # Loaded module rlm_expiration
  # Loading module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Loaded module rlm_expr
  # Loading module "expr" from file /etc/freeradius/mods-enabled/expr
  expr {
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /äéöüàâæçèéêëîïôœùûüaÿÄÉÖÜßÀÂÆÇÈÉÊËÎÏÔŒÙÛÜŸ"
  }
  # Loaded module rlm_files
  # Loading module "files" from file /etc/freeradius/mods-enabled/files
  files {
  	filename = "/etc/freeradius/mods-config/files/authorize"
  	acctusersfile = "/etc/freeradius/mods-config/files/accounting"
  	preproxy_usersfile = "/etc/freeradius/mods-config/files/pre-proxy"
  }
  # Loaded module rlm_linelog
  # Loading module "linelog" from file /etc/freeradius/mods-enabled/linelog
  linelog {
  	filename = "/var/log/freeradius/linelog"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = "This is a log message for %{User-Name}"
  	reference = "messages.%{%{reply:Packet-Type}:-default}"
  }
  # Loading module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  linelog log_accounting {
  	filename = "/var/log/freeradius/linelog-accounting"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = ""
  	reference = "Accounting-Request.%{%{Acct-Status-Type}:-unknown}"
  }
  # Loaded module rlm_logintime
  # Loading module "logintime" from file /etc/freeradius/mods-enabled/logintime
  logintime {
  	minimum_timeout = 60
  }
  # Loaded module rlm_mschap
  # Loading module "mschap" from file /etc/freeradius/mods-enabled/mschap
  mschap {
  	use_mppe = yes
  	require_encryption = no
  	require_strong = no
  	with_ntdomain_hack = yes
   passchange {
   }
  	allow_retry = yes
  }
  # Loading module "ntlm_auth" from file /etc/freeradius/mods-enabled/ntlm_auth
  exec ntlm_auth {
  	wait = yes
  	program = "/path/to/ntlm_auth --request-nt-key --domain=MYDOMAIN --username=%{mschap:User-Name} --password=%{User-Password}"
  	shell_escape = yes
  }
  # Loaded module rlm_pap
  # Loading module "pap" from file /etc/freeradius/mods-enabled/pap
  pap {
  	normalise = yes
  }
  # Loaded module rlm_passwd
  # Loading module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
  passwd etc_passwd {
  	filename = "/etc/passwd"
  	format = "*User-Name:Crypt-Password:"
  	delimiter = ":"
  	ignore_nislike = no
  	ignore_empty = yes
  	allow_multiple_keys = no
  	hash_size = 100
  }
  # Loaded module rlm_preprocess
  # Loading module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
  preprocess {
  	huntgroups = "/etc/freeradius/mods-config/preprocess/huntgroups"
  	hints = "/etc/freeradius/mods-config/preprocess/hints"
  	with_ascend_hack = no
  	ascend_channels_per_line = 23
  	with_ntdomain_hack = no
  	with_specialix_jetstream_hack = no
  	with_cisco_vsa_hack = no
  	with_alvarion_vsa_hack = no
  }
  # Loaded module rlm_radutmp
  # Loading module "radutmp" from file /etc/freeradius/mods-enabled/radutmp
  radutmp {
  	filename = "/var/log/freeradius/radutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 384
  	caller_id = yes
  }
  # Loaded module rlm_realm
  # Loading module "IPASS" from file /etc/freeradius/mods-enabled/realm
  realm IPASS {
  	format = "prefix"
  	delimiter = "/"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "suffix" from file /etc/freeradius/mods-enabled/realm
  realm suffix {
  	format = "suffix"
  	delimiter = "@"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  realm realmpercent {
  	format = "suffix"
  	delimiter = "%"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "ntdomain" from file /etc/freeradius/mods-enabled/realm
  realm ntdomain {
  	format = "prefix"
  	delimiter = "\\"
  	ignore_default = no
  	ignore_null = no
  }
  # Loaded module rlm_replicate
  # Loading module "replicate" from file /etc/freeradius/mods-enabled/replicate
  # Loaded module rlm_soh
  # Loading module "soh" from file /etc/freeradius/mods-enabled/soh
  soh {
  	dhcp = yes
  }
  # Loading module "sradutmp" from file /etc/freeradius/mods-enabled/sradutmp
  radutmp sradutmp {
  	filename = "/var/log/freeradius/sradutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 420
  	caller_id = no
  }
  # Loaded module rlm_unix
  # Loading module "unix" from file /etc/freeradius/mods-enabled/unix
  unix {
  	radwtmp = "/var/log/freeradius/radwtmp"
  }
Creating attribute Unix-Group
  # Loaded module rlm_unpack
  # Loading module "unpack" from file /etc/freeradius/mods-enabled/unpack
  # Loaded module rlm_utf8
  # Loading module "utf8" from file /etc/freeradius/mods-enabled/utf8
 instantiate {
 }
 modules {
  # Instantiating module "reject" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "fail" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "ok" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "handled" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "invalid" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "userlock" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "notfound" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "noop" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "updated" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/post-proxy
  # Instantiating module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/pre-proxy
  # Instantiating module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_reject
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay" 	found in filter list for realm "DEFAULT". 
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay-USec" 	found in filter list for realm "DEFAULT". 
  # Instantiating module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_challenge
  # Instantiating module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/accounting_response
  # Instantiating module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
rlm_cache (cache_eap): Driver rlm_cache_rbtree (module rlm_cache_rbtree) loaded and linked
  # Instantiating module "detail" from file /etc/freeradius/mods-enabled/detail
  # Instantiating module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
rlm_detail (auth_log): 'User-Password' suppressed, will not appear in detail output
  # Instantiating module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "eap" from file /etc/freeradius/mods-enabled/eap
   # Linked to sub-module rlm_eap_md5
   # Linked to sub-module rlm_eap_leap
   # Linked to sub-module rlm_eap_gtc
   gtc {
   	challenge = "Password: "
   	auth_type = "PAP"
   }
   # Linked to sub-module rlm_eap_tls
   tls {
   	tls = "tls-common"
   }
   tls-config tls-common {
   	rsa_key_exchange = no
   	dh_key_exchange = yes
   	rsa_key_length = 512
   	dh_key_length = 512
   	verify_depth = 0
   	ca_path = "/etc/freeradius/certs"
   	pem_file_type = yes
   	private_key_file = "/etc/freeradius/certs/server.pem"
   	certificate_file = "/etc/freeradius/certs/server.pem"
   	ca_file = "/etc/freeradius/certs/ca.pem"
   	private_key_password = <<< secret >>>
   	dh_file = "/etc/freeradius/certs/dh"
   	fragment_size = 1024
   	include_length = yes
   	check_crl = no
   	check_all_crl = no
   	cipher_list = "DEFAULT"
   	ecdh_curve = "prime256v1"
    cache {
    	enable = yes
    	lifetime = 24
    	max_entries = 255
    }
    verify {
    }
    ocsp {
    	enable = no
    	override_cert_url = yes
    	url = "http://127.0.0.1/ocsp/"
    	use_nonce = yes
    	timeout = 0
    	softfail = no
    }
   }
   # Linked to sub-module rlm_eap_ttls
   ttls {
   	tls = "tls-common"
   	default_eap_type = "md5"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	virtual_server = "inner-tunnel"
   	include_length = yes
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_peap
   peap {
   	tls = "tls-common"
   	default_eap_type = "mschapv2"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	proxy_tunneled_request_as_eap = yes
   	virtual_server = "inner-tunnel"
   	soh = no
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_mschapv2
   mschapv2 {
   	with_ntdomain_hack = no
   	send_error = no
   }
  # Instantiating module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Instantiating module "files" from file /etc/freeradius/mods-enabled/files
reading pairlist file /etc/freeradius/mods-config/files/authorize
reading pairlist file /etc/freeradius/mods-config/files/accounting
reading pairlist file /etc/freeradius/mods-config/files/pre-proxy
  # Instantiating module "linelog" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "logintime" from file /etc/freeradius/mods-enabled/logintime
  # Instantiating module "mschap" from file /etc/freeradius/mods-enabled/mschap
rlm_mschap (mschap): using internal authentication
  # Instantiating module "pap" from file /etc/freeradius/mods-enabled/pap
  # Instantiating module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
rlm_passwd: nfields: 3 keyfield 0(User-Name) listable: no
  # Instantiating module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
reading pairlist file /etc/freeradius/mods-config/preprocess/huntgroups
reading pairlist file /etc/freeradius/mods-config/preprocess/hints
  # Instantiating module "IPASS" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "suffix" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "ntdomain" from file /etc/freeradius/mods-enabled/realm
 } # modules
radiusd: #### Loading Virtual Servers ####
server { # from file /etc/freeradius/radiusd.conf
} # server
server default { # from file /etc/freeradius/sites-enabled/default
 # Loading authenticate {...}
 # Loading authorize {...}
Ignoring "sql" (see raddb/mods-available/README.rst)
Ignoring "ldap" (see raddb/mods-available/README.rst)
 # Loading preacct {...}
 # Loading accounting {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server default
server inner-tunnel { # from file /etc/freeradius/sites-enabled/inner-tunnel
 # Loading authenticate {...}
 # Loading authorize {...}
 # Loading session {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server inner-tunnel
 thread pool {
 	start_servers = 5
 	max_servers = 32
 	min_spare_servers = 3
 	max_spare_servers = 10
 	max_requests_per_server = 0
 	cleanup_delay = 5
 	max_queue_size = 65536
 	auto_limit_acct = no
 }
Thread spawned new child 1. Total threads in pool: 1
Thread spawned new child 2. Total threads in pool: 2
Thread spawned new child 3. Total threads in pool: 3
Thread spawned new child 4. Total threads in pool: 4
Thread spawned new child 5. Total threads in pool: 5
Thread pool initialized
radiusd: #### Opening IP addresses and Ports ####
listen {
  	type = "auth"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
Thread 1 waiting to be assigned a request
Thread 5 waiting to be assigned a request
Thread 4 waiting to be assigned a request
Thread 3 waiting to be assigned a request
Thread 2 waiting to be assigned a request
}
listen {
  	type = "acct"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "acct"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipaddr = 127.0.0.1
  	port = 18120
}
Listening on auth address * port 1812 bound to server default
Listening on acct address * port 1813 bound to server default
Listening on auth address :: port 1812 bound to server default
Listening on acct address :: port 1813 bound to server default
Listening on auth address 127.0.0.1 port 18120 bound to server inner-tunnel
Listening on proxy address * port 41350
Listening on proxy address :: port 48556
Ready to process requests
Threads: total/active/spare threads = 5/0/5
Thread 5 got semaphore
Thread 5 handling request 0, (1 handled so far)
(0) <running>: Received Access-Request Id 65 from 192.168.1.30:50039 to 172.17.0.4:1812 length 190
(0) <running>:   User-Name = "emiruss"
(0) <running>:   NAS-IP-Address = 192.168.1.30
(0) <running>:   NAS-Identifier = "Ericsson"
(0) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(0) <running>:   NAS-Port-Type = Wireless-802.11
(0) <running>:   NAS-Port = 0
(0) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(0) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(0) <running>:   Acct-Session-Id = "003E2DE6-00000048"
(0) <running>:   Framed-MTU = 1400
(0) <running>:   EAP-Message = 0x021b000c01656d6972757373
(0) <running>:   Message-Authenticator = 0xb860d0a9990013febb2013ce5d29498c
(0) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(0) <running>:   authorize {
(0) <running>:     policy filter_username {
(0) <running>:       if (!&User-Name) {
(0) <running>:       if (!&User-Name)  -> FALSE
(0) <running>:       if (&User-Name =~ / /) {
(0) <running>:       if (&User-Name =~ / /)  -> FALSE
(0) <running>:       if (&User-Name =~ /@.*@/ ) {
(0) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(0) <running>:       if (&User-Name =~ /\.\./ ) {
(0) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(0) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(0) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(0) <running>:       if (&User-Name =~ /\.$/)  {
(0) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
Waking up in 0.3 seconds.
(0) <running>:       if (&User-Name =~ /@\./)  {
(0) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(0) <running>:     } # policy filter_username = notfound
(0)     [preprocess] = ok
(0)     [chap] = noop
(0)     [mschap] = noop
(0)     [digest] = noop
(0) suffix: Checking for suffix after "@"
(0) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(0) suffix: No such realm "NULL"
(0)     [suffix] = noop
(0) eap: Peer sent EAP Response (code 2) ID 27 length 12
(0) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(0)     [eap] = ok
(0)   } # authorize = ok
(0) Found Auth-Type = EAP
(0) # Executing group from file /etc/freeradius/sites-enabled/default
(0)   authenticate {
(0) eap: Peer sent packet with method EAP Identity (1)
(0) eap: Calling submodule eap_md5 to process data
(0) eap_md5: Issuing MD5 Challenge
(0) eap: Sending EAP Request (code 1) ID 28 length 22
(0) eap: EAP session adding &reply:State = 0xfb87387cfb9b3c41
(0)     [eap] = handled
(0)   } # authenticate = handled
(0) Using Post-Auth-Type Challenge
(0) Post-Auth-Type sub-section not found.  Ignoring.
(0) # Executing group from file /etc/freeradius/sites-enabled/default
(0) Sent Access-Challenge Id 65 from 172.17.0.4:1812 to 192.168.1.30:50039 length 0
(0)   EAP-Message = 0x011c00160410db815ead610ac31dbbe0bb67793625e3
(0)   Message-Authenticator = 0x00000000000000000000000000000000
(0)   State = 0xfb87387cfb9b3c41ea2739c57b67432e
(0) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.3 seconds.
Thread 4 got semaphore
Thread 4 handling request 1, (1 handled so far)
(1) <running>: Received Access-Request Id 66 from 192.168.1.30:50039 to 172.17.0.4:1812 length 204
(1) <running>:   User-Name = "emiruss"
(1) <running>:   NAS-IP-Address = 192.168.1.30
(1) <running>:   NAS-Identifier = "Ericsson"
(1) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(1) <running>:   NAS-Port-Type = Wireless-802.11
(1) <running>:   NAS-Port = 0
(1) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(1) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(1) <running>:   Acct-Session-Id = "003E2DE6-00000048"
(1) <running>:   Framed-MTU = 1400
(1) <running>:   EAP-Message = 0x021c00080319152b
(1) <running>:   State = 0xfb87387cfb9b3c41ea2739c57b67432e
(1) <running>:   Message-Authenticator = 0x21c30a699563a1337ff81f5e792e1bf5
(1) <running>: session-state: No cached attributes
(1) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(1) <running>:   authorize {
(1) <running>:     policy filter_username {
(1) <running>:       if (!&User-Name) {
(1) <running>:       if (!&User-Name)  -> FALSE
(1) <running>:       if (&User-Name =~ / /) {
(1) <running>:       if (&User-Name =~ / /)  -> FALSE
(1) <running>:       if (&User-Name =~ /@.*@/ ) {
(1) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(1) <running>:       if (&User-Name =~ /\.\./ ) {
(1) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(1) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(1) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(1) <running>:       if (&User-Name =~ /\.$/)  {
(1) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(1) <running>:       if (&User-Name =~ /@\./)  {
(1) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(1) <running>:     } # policy filter_username = notfound
(1)     [preprocess] = ok
(1)     [chap] = noop
(1)     [mschap] = noop
(1)     [digest] = noop
(1) suffix: Checking for suffix after "@"
(1) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(1) suffix: No such realm "NULL"
(1)     [suffix] = noop
(1) eap: Peer sent EAP Response (code 2) ID 28 length 8
(1) eap: No EAP Start, assuming it's an on-going EAP conversation
(1)     [eap] = updated
(1)     [files] = noop
(1)     [expiration] = noop
(1)     [logintime] = noop
(1) pap: WARNING: No "known good" password found for the user.  Not setting Auth-Type
(1) pap: WARNING: Authentication will fail unless a "known good" password is available
(1)     [pap] = noop
(1)   } # authorize = updated
(1) Found Auth-Type = EAP
(1) # Executing group from file /etc/freeradius/sites-enabled/default
(1)   authenticate {
(1) eap: Expiring EAP session with state 0xfb87387cfb9b3c41
(1) eap: Finished EAP session with state 0xfb87387cfb9b3c41
(1) eap: Previous EAP request found for state 0xfb87387cfb9b3c41, released from the list
(1) eap: Peer sent packet with method EAP NAK (3)
(1) eap: Found mutually acceptable type PEAP (25)
(1) eap: Calling submodule eap_peap to process data
(1) eap_peap: Initiating new EAP-TLS session
(1) eap_peap: Flushing SSL sessions (of #0)
(1) eap_peap: [eaptls start] = request
(1) eap: Sending EAP Request (code 1) ID 29 length 6
(1) eap: EAP session adding &reply:State = 0xfb87387cfa9a2141
(1)     [eap] = handled
(1)   } # authenticate = handled
(1) Using Post-Auth-Type Challenge
(1) Post-Auth-Type sub-section not found.  Ignoring.
(1) # Executing group from file /etc/freeradius/sites-enabled/default
(1) Sent Access-Challenge Id 66 from 172.17.0.4:1812 to 192.168.1.30:50039 length 0
(1)   EAP-Message = 0x011d00061920
(1)   Message-Authenticator = 0x00000000000000000000000000000000
(1)   State = 0xfb87387cfa9a2141ea2739c57b67432e
(1) Finished request
Thread 4 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 3 got semaphore
Thread 3 handling request 2, (1 handled so far)
(2) <running>: Received Access-Request Id 67 from 192.168.1.30:50039 to 172.17.0.4:1812 length 339
(2) <running>:   User-Name = "emiruss"
(2) <running>:   NAS-IP-Address = 192.168.1.30
(2) <running>:   NAS-Identifier = "Ericsson"
(2) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(2) <running>:   NAS-Port-Type = Wireless-802.11
(2) <running>:   NAS-Port = 0
(2) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(2) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(2) <running>:   Acct-Session-Id = "003E2DE6-00000048"
(2) <running>:   Framed-MTU = 1400
(2) <running>:   EAP-Message = 0x021d008f19800000008516030100800100007c03015655281757d57828d8fa2ead913a07f5006e14a22688260f4003ca349d48946b00003400ffc02cc02bc024c023c00ac009c008c030c02fc028c027c014c013c012009d009c003d003c0035002f000ac007c011000500040100001f000a0008000600
(2) <running>:   State = 0xfb87387cfa9a2141ea2739c57b67432e
(2) <running>:   Message-Authenticator = 0xc02ebe40f881730fa20effc0e01146a6
(2) <running>: session-state: No cached attributes
(2) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(2) <running>:   authorize {
(2) <running>:     policy filter_username {
(2) <running>:       if (!&User-Name) {
(2) <running>:       if (!&User-Name)  -> FALSE
(2) <running>:       if (&User-Name =~ / /) {
(2) <running>:       if (&User-Name =~ / /)  -> FALSE
(2) <running>:       if (&User-Name =~ /@.*@/ ) {
(2) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(2) <running>:       if (&User-Name =~ /\.\./ ) {
(2) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(2) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(2) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(2) <running>:       if (&User-Name =~ /\.$/)  {
(2) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(2) <running>:       if (&User-Name =~ /@\./)  {
(2) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(2) <running>:     } # policy filter_username = notfound
(2)     [preprocess] = ok
(2)     [chap] = noop
(2)     [mschap] = noop
(2)     [digest] = noop
(2) suffix: Checking for suffix after "@"
(2) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(2) suffix: No such realm "NULL"
(2)     [suffix] = noop
(2) eap: Peer sent EAP Response (code 2) ID 29 length 143
(2) eap: Continuing tunnel setup
(2)     [eap] = ok
(2)   } # authorize = ok
(2) Found Auth-Type = EAP
(2) # Executing group from file /etc/freeradius/sites-enabled/default
(2)   authenticate {
(2) eap: Expiring EAP session with state 0xfb87387cfa9a2141
(2) eap: Finished EAP session with state 0xfb87387cfa9a2141
(2) eap: Previous EAP request found for state 0xfb87387cfa9a2141, released from the list
(2) eap: Peer sent packet with method EAP PEAP (25)
(2) eap: Calling submodule eap_peap to process data
(2) eap_peap: Continuing EAP-TLS
(2) eap_peap: Peer indicated complete TLS record size will be 133 bytes
(2) eap_peap: Got complete TLS record (133 bytes)
(2) eap_peap: [eaptls verify] = length included
(2) eap_peap: (other): before/accept initialization
(2) eap_peap: TLS_accept: before/accept initialization
(2) eap_peap: <<< TLS 1.0 Handshake [length 0080], ClientHello 
(2) eap_peap: TLS_accept: SSLv3 read client hello A
(2) eap_peap: >>> TLS 1.0 Handshake [length 0059], ServerHello 
(2) eap_peap: TLS_accept: SSLv3 write server hello A
(2) eap_peap: >>> TLS 1.0 Handshake [length 08d3], Certificate 
(2) eap_peap: TLS_accept: SSLv3 write certificate A
(2) eap_peap: >>> TLS 1.0 Handshake [length 014b], ServerKeyExchange 
(2) eap_peap: TLS_accept: SSLv3 write key exchange A
(2) eap_peap: >>> TLS 1.0 Handshake [length 0004], ServerHelloDone 
(2) eap_peap: TLS_accept: SSLv3 write server done A
(2) eap_peap: TLS_accept: SSLv3 flush data
(2) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(2) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(2) eap_peap: In SSL Handshake Phase
(2) eap_peap: In SSL Accept mode
(2) eap_peap: [eaptls process] = handled
(2) eap: Sending EAP Request (code 1) ID 30 length 1004
(2) eap: EAP session adding &reply:State = 0xfb87387cf9992141
(2)     [eap] = handled
(2)   } # authenticate = handled
(2) Using Post-Auth-Type Challenge
(2) Post-Auth-Type sub-section not found.  Ignoring.
(2) # Executing group from file /etc/freeradius/sites-enabled/default
(2) Sent Access-Challenge Id 67 from 172.17.0.4:1812 to 192.168.1.30:50039 length 0
(2)   EAP-Message = 0x011e03ec19c000000a8f1603010059020000550301cf636bbb010f727c69e16ad2dfca42657d58fa423a068de50dca02dffa0992c820f16fd0c33cf613a08718f47c25ef5268903dfa4855351229ae4635f058bddfe3c01400000dff01000100000b00040300010216030108d30b0008cf0008cc0003de
(2)   Message-Authenticator = 0x00000000000000000000000000000000
(2)   State = 0xfb87387cf9992141ea2739c57b67432e
(2) Finished request
Thread 3 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 1 got semaphore
Thread 1 handling request 3, (1 handled so far)
(3) <running>: Received Access-Request Id 68 from 192.168.1.30:50039 to 172.17.0.4:1812 length 202
(3) <running>:   User-Name = "emiruss"
(3) <running>:   NAS-IP-Address = 192.168.1.30
(3) <running>:   NAS-Identifier = "Ericsson"
(3) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(3) <running>:   NAS-Port-Type = Wireless-802.11
(3) <running>:   NAS-Port = 0
(3) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(3) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(3) <running>:   Acct-Session-Id = "003E2DE6-00000048"
(3) <running>:   Framed-MTU = 1400
(3) <running>:   EAP-Message = 0x021e00061900
(3) <running>:   State = 0xfb87387cf9992141ea2739c57b67432e
(3) <running>:   Message-Authenticator = 0x5bb3dc357904d91165c7317e7d01486b
(3) <running>: session-state: No cached attributes
(3) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(3) <running>:   authorize {
(3) <running>:     policy filter_username {
(3) <running>:       if (!&User-Name) {
(3) <running>:       if (!&User-Name)  -> FALSE
(3) <running>:       if (&User-Name =~ / /) {
(3) <running>:       if (&User-Name =~ / /)  -> FALSE
(3) <running>:       if (&User-Name =~ /@.*@/ ) {
(3) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(3) <running>:       if (&User-Name =~ /\.\./ ) {
(3) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(3) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(3) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(3) <running>:       if (&User-Name =~ /\.$/)  {
(3) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(3) <running>:       if (&User-Name =~ /@\./)  {
(3) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(3) <running>:     } # policy filter_username = notfound
(3)     [preprocess] = ok
(3)     [chap] = noop
(3)     [mschap] = noop
(3)     [digest] = noop
(3) suffix: Checking for suffix after "@"
(3) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(3) suffix: No such realm "NULL"
(3)     [suffix] = noop
(3) eap: Peer sent EAP Response (code 2) ID 30 length 6
(3) eap: Continuing tunnel setup
(3)     [eap] = ok
(3)   } # authorize = ok
(3) Found Auth-Type = EAP
(3) # Executing group from file /etc/freeradius/sites-enabled/default
(3)   authenticate {
(3) eap: Expiring EAP session with state 0xfb87387cf9992141
(3) eap: Finished EAP session with state 0xfb87387cf9992141
(3) eap: Previous EAP request found for state 0xfb87387cf9992141, released from the list
(3) eap: Peer sent packet with method EAP PEAP (25)
(3) eap: Calling submodule eap_peap to process data
(3) eap_peap: Continuing EAP-TLS
(3) eap_peap: Peer ACKed our handshake fragment
(3) eap_peap: [eaptls verify] = request
(3) eap_peap: [eaptls process] = handled
(3) eap: Sending EAP Request (code 1) ID 31 length 1000
(3) eap: EAP session adding &reply:State = 0xfb87387cf8982141
(3)     [eap] = handled
(3)   } # authenticate = handled
(3) Using Post-Auth-Type Challenge
(3) Post-Auth-Type sub-section not found.  Ignoring.
(3) # Executing group from file /etc/freeradius/sites-enabled/default
(3) Sent Access-Challenge Id 68 from 172.17.0.4:1812 to 192.168.1.30:50039 length 0
(3)   EAP-Message = 0x011f03e819400dd0405955c762981948527048701681d313d3cc6629a5557b66df2aae22c8590ab99d66ec8d3792a72e30596410f5d1e81f5a774969a1ce9ad6bd01d42da65536016e80a905c662a71ef5c075b8bdf0127a0cf1bd4c91290e15edffa035febde0185096bdc1e553090004e8308204e430
(3)   Message-Authenticator = 0x00000000000000000000000000000000
(3)   State = 0xfb87387cf8982141ea2739c57b67432e
(3) Finished request
Thread 1 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 2 got semaphore
Thread 2 handling request 4, (1 handled so far)
(4) <running>: Received Access-Request Id 69 from 192.168.1.30:50039 to 172.17.0.4:1812 length 202
(4) <running>:   User-Name = "emiruss"
(4) <running>:   NAS-IP-Address = 192.168.1.30
(4) <running>:   NAS-Identifier = "Ericsson"
(4) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(4) <running>:   NAS-Port-Type = Wireless-802.11
(4) <running>:   NAS-Port = 0
(4) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(4) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(4) <running>:   Acct-Session-Id = "003E2DE6-00000048"
(4) <running>:   Framed-MTU = 1400
(4) <running>:   EAP-Message = 0x021f00061900
(4) <running>:   State = 0xfb87387cf8982141ea2739c57b67432e
(4) <running>:   Message-Authenticator = 0x02640daf58b7798ae574592b2bdf72f5
(4) <running>: session-state: No cached attributes
(4) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(4) <running>:   authorize {
(4) <running>:     policy filter_username {
(4) <running>:       if (!&User-Name) {
(4) <running>:       if (!&User-Name)  -> FALSE
(4) <running>:       if (&User-Name =~ / /) {
(4) <running>:       if (&User-Name =~ / /)  -> FALSE
(4) <running>:       if (&User-Name =~ /@.*@/ ) {
(4) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(4) <running>:       if (&User-Name =~ /\.\./ ) {
(4) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(4) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(4) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(4) <running>:       if (&User-Name =~ /\.$/)  {
(4) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(4) <running>:       if (&User-Name =~ /@\./)  {
(4) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(4) <running>:     } # policy filter_username = notfound
(4)     [preprocess] = ok
(4)     [chap] = noop
(4)     [mschap] = noop
(4)     [digest] = noop
(4) suffix: Checking for suffix after "@"
(4) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(4) suffix: No such realm "NULL"
(4)     [suffix] = noop
(4) eap: Peer sent EAP Response (code 2) ID 31 length 6
(4) eap: Continuing tunnel setup
(4)     [eap] = ok
(4)   } # authorize = ok
(4) Found Auth-Type = EAP
(4) # Executing group from file /etc/freeradius/sites-enabled/default
(4)   authenticate {
(4) eap: Expiring EAP session with state 0xfb87387cf8982141
(4) eap: Finished EAP session with state 0xfb87387cf8982141
(4) eap: Previous EAP request found for state 0xfb87387cf8982141, released from the list
(4) eap: Peer sent packet with method EAP PEAP (25)
(4) eap: Calling submodule eap_peap to process data
(4) eap_peap: Continuing EAP-TLS
(4) eap_peap: Peer ACKed our handshake fragment
(4) eap_peap: [eaptls verify] = request
(4) eap_peap: [eaptls process] = handled
(4) eap: Sending EAP Request (code 1) ID 32 length 721
(4) eap: EAP session adding &reply:State = 0xfb87387cffa72141
(4)     [eap] = handled
(4)   } # authenticate = handled
(4) Using Post-Auth-Type Challenge
(4) Post-Auth-Type sub-section not found.  Ignoring.
(4) # Executing group from file /etc/freeradius/sites-enabled/default
(4) Sent Access-Challenge Id 69 from 172.17.0.4:1812 to 192.168.1.30:50039 length 0
(4)   EAP-Message = 0x012002d1190020417574686f72697479820900c3fc536eef83d741300f0603551d130101ff040530030101ff30360603551d1f042f302d302ba029a0278625687474703a2f2f7777772e6578616d706c652e6f72672f6578616d706c655f63612e63726c300d06092a864886f70d01010b050003820101
(4)   Message-Authenticator = 0x00000000000000000000000000000000
(4)   State = 0xfb87387cffa72141ea2739c57b67432e
(4) Finished request
Thread 2 waiting to be assigned a request
Thread 5 got semaphore
Thread 5 handling request 5, (2 handled so far)
(5) <running>: Received Access-Request Id 70 from 192.168.1.30:50039 to 172.17.0.4:1812 length 340
(5) <running>:   User-Name = "emiruss"
(5) <running>:   NAS-IP-Address = 192.168.1.30
(5) <running>:   NAS-Identifier = "Ericsson"
(5) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(5) <running>:   NAS-Port-Type = Wireless-802.11
(5) <running>:   NAS-Port = 0
(5) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(5) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(5) <running>:   Acct-Session-Id = "003E2DE6-00000048"
(5) <running>:   Framed-MTU = 1400
(5) <running>:   EAP-Message = 0x022000901980000000861603010046100000424104a0955c4220e6a0c47ed6b47d41f9e729096a98724d079413a25d927b92112f672150cdb1810075cd83c5f2645701c8a6d46239327b96db3ca9e7c44f4a20e2cd1403010001011603010030d12324e161d00cb707dabfb798350dc2d08809d792f676
(5) <running>:   State = 0xfb87387cffa72141ea2739c57b67432e
(5) <running>:   Message-Authenticator = 0x0139323c106152fed7bb6a32d29f751d
(5) <running>: session-state: No cached attributes
(5) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(5) <running>:   authorize {
(5) <running>:     policy filter_username {
(5) <running>:       if (!&User-Name) {
(5) <running>:       if (!&User-Name)  -> FALSE
(5) <running>:       if (&User-Name =~ / /) {
(5) <running>:       if (&User-Name =~ / /)  -> FALSE
(5) <running>:       if (&User-Name =~ /@.*@/ ) {
(5) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(5) <running>:       if (&User-Name =~ /\.\./ ) {
(5) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(5) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(5) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(5) <running>:       if (&User-Name =~ /\.$/)  {
(5) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(5) <running>:       if (&User-Name =~ /@\./)  {
(5) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(5) <running>:     } # policy filter_username = notfound
(5)     [preprocess] = ok
(5)     [chap] = noop
(5)     [mschap] = noop
(5)     [digest] = noop
(5) suffix: Checking for suffix after "@"
(5) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(5) suffix: No such realm "NULL"
(5)     [suffix] = noop
(5) eap: Peer sent EAP Response (code 2) ID 32 length 144
(5) eap: Continuing tunnel setup
(5)     [eap] = ok
(5)   } # authorize = ok
(5) Found Auth-Type = EAP
(5) # Executing group from file /etc/freeradius/sites-enabled/default
(5)   authenticate {
(5) eap: Expiring EAP session with state 0xfb87387cffa72141
(5) eap: Finished EAP session with state 0xfb87387cffa72141
(5) eap: Previous EAP request found for state 0xfb87387cffa72141, released from the list
(5) eap: Peer sent packet with method EAP PEAP (25)
(5) eap: Calling submodule eap_peap to process data
(5) eap_peap: Continuing EAP-TLS
(5) eap_peap: Peer indicated complete TLS record size will be 134 bytes
(5) eap_peap: Got complete TLS record (134 bytes)
(5) eap_peap: [eaptls verify] = length included
(5) eap_peap: <<< TLS 1.0 Handshake [length 0046], ClientKeyExchange 
(5) eap_peap: TLS_accept: SSLv3 read client key exchange A
(5) eap_peap: <<< TLS 1.0 ChangeCipherSpec [length 0001] 
(5) eap_peap: <<< TLS 1.0 Handshake [length 0010], Finished 
(5) eap_peap: TLS_accept: SSLv3 read finished A
(5) eap_peap: >>> TLS 1.0 ChangeCipherSpec [length 0001] 
(5) eap_peap: TLS_accept: SSLv3 write change cipher spec A
(5) eap_peap: >>> TLS 1.0 Handshake [length 0010], Finished 
(5) eap_peap: TLS_accept: SSLv3 write finished A
(5) eap_peap: TLS_accept: SSLv3 flush data
(5) eap_peap: (other): SSL negotiation finished successfully
(5) eap_peap: SSL Connection Established
(5) eap_peap: [eaptls process] = handled
(5) eap: Sending EAP Request (code 1) ID 33 length 65
(5) eap: EAP session adding &reply:State = 0xfb87387cfea62141
(5)     [eap] = handled
(5)   } # authenticate = handled
(5) Using Post-Auth-Type Challenge
(5) Post-Auth-Type sub-section not found.  Ignoring.
(5) # Executing group from file /etc/freeradius/sites-enabled/default
(5) Sent Access-Challenge Id 70 from 172.17.0.4:1812 to 192.168.1.30:50039 length 0
(5)   EAP-Message = 0x0121004119001403010001011603010030e0357057efacc554f256414da845b1d4866444238970f0ad989b32d8b69ff24b7491afaeb27ea06ad4f8cbc39908bedf
(5)   Message-Authenticator = 0x00000000000000000000000000000000
(5)   State = 0xfb87387cfea62141ea2739c57b67432e
(5) Finished request
Thread 5 waiting to be assigned a request
Thread 4 got semaphore
Thread 4 handling request 6, (2 handled so far)
(6) <running>: Received Access-Request Id 71 from 192.168.1.30:50039 to 172.17.0.4:1812 length 202
(6) <running>:   User-Name = "emiruss"
(6) <running>:   NAS-IP-Address = 192.168.1.30
(6) <running>:   NAS-Identifier = "Ericsson"
(6) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(6) <running>:   NAS-Port-Type = Wireless-802.11
(6) <running>:   NAS-Port = 0
(6) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(6) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(6) <running>:   Acct-Session-Id = "003E2DE6-00000048"
(6) <running>:   Framed-MTU = 1400
(6) <running>:   EAP-Message = 0x022100061900
(6) <running>:   State = 0xfb87387cfea62141ea2739c57b67432e
(6) <running>:   Message-Authenticator = 0xab58f84a3bb14a8d0e00ee20b54d139a
(6) <running>: session-state: No cached attributes
(6) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(6) <running>:   authorize {
(6) <running>:     policy filter_username {
(6) <running>:       if (!&User-Name) {
(6) <running>:       if (!&User-Name)  -> FALSE
(6) <running>:       if (&User-Name =~ / /) {
(6) <running>:       if (&User-Name =~ / /)  -> FALSE
(6) <running>:       if (&User-Name =~ /@.*@/ ) {
(6) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(6) <running>:       if (&User-Name =~ /\.\./ ) {
(6) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(6) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(6) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(6) <running>:       if (&User-Name =~ /\.$/)  {
(6) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(6) <running>:       if (&User-Name =~ /@\./)  {
(6) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(6) <running>:     } # policy filter_username = notfound
(6)     [preprocess] = ok
(6)     [chap] = noop
(6)     [mschap] = noop
(6)     [digest] = noop
(6) suffix: Checking for suffix after "@"
(6) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(6) suffix: No such realm "NULL"
(6)     [suffix] = noop
(6) eap: Peer sent EAP Response (code 2) ID 33 length 6
(6) eap: Continuing tunnel setup
(6)     [eap] = ok
(6)   } # authorize = ok
(6) Found Auth-Type = EAP
(6) # Executing group from file /etc/freeradius/sites-enabled/default
(6)   authenticate {
(6) eap: Expiring EAP session with state 0xfb87387cfea62141
(6) eap: Finished EAP session with state 0xfb87387cfea62141
(6) eap: Previous EAP request found for state 0xfb87387cfea62141, released from the list
(6) eap: Peer sent packet with method EAP PEAP (25)
(6) eap: Calling submodule eap_peap to process data
(6) eap_peap: Continuing EAP-TLS
(6) eap_peap: Peer ACKed our handshake fragment.  handshake is finished
(6) eap_peap: [eaptls verify] = success
(6) eap_peap: [eaptls process] = success
(6) eap_peap: Session established.  Decoding tunneled attributes
(6) eap_peap: PEAP state TUNNEL ESTABLISHED
(6) eap: Sending EAP Request (code 1) ID 34 length 43
(6) eap: EAP session adding &reply:State = 0xfb87387cfda52141
(6)     [eap] = handled
(6)   } # authenticate = handled
(6) Using Post-Auth-Type Challenge
(6) Post-Auth-Type sub-section not found.  Ignoring.
(6) # Executing group from file /etc/freeradius/sites-enabled/default
(6) Sent Access-Challenge Id 71 from 172.17.0.4:1812 to 192.168.1.30:50039 length 0
(6)   EAP-Message = 0x0122002b190017030100206079906520ef2e033046432fb18f20713508cda8f55bf243611c1ad7bfcc04ea
(6)   Message-Authenticator = 0x00000000000000000000000000000000
(6)   State = 0xfb87387cfda52141ea2739c57b67432e
(6) Finished request
Thread 4 waiting to be assigned a request
Thread 3 got semaphore
Thread 3 handling request 7, (2 handled so far)
(7) <running>: Received Access-Request Id 72 from 192.168.1.30:50039 to 172.17.0.4:1812 length 239
(7) <running>:   User-Name = "emiruss"
(7) <running>:   NAS-IP-Address = 192.168.1.30
(7) <running>:   NAS-Identifier = "Ericsson"
(7) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(7) <running>:   NAS-Port-Type = Wireless-802.11
(7) <running>:   NAS-Port = 0
(7) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(7) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(7) <running>:   Acct-Session-Id = "003E2DE6-00000048"
(7) <running>:   Framed-MTU = 1400
(7) <running>:   EAP-Message = 0x0222002b19001703010020de9a977acf4eeff651b9a3b29e088e597c39f71c0766dbd87e11ac82ce28220d
(7) <running>:   State = 0xfb87387cfda52141ea2739c57b67432e
(7) <running>:   Message-Authenticator = 0xea88c4c039dc241a9cd0643b5fbd6f5e
(7) <running>: session-state: No cached attributes
(7) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(7) <running>:   authorize {
(7) <running>:     policy filter_username {
(7) <running>:       if (!&User-Name) {
(7) <running>:       if (!&User-Name)  -> FALSE
(7) <running>:       if (&User-Name =~ / /) {
(7) <running>:       if (&User-Name =~ / /)  -> FALSE
(7) <running>:       if (&User-Name =~ /@.*@/ ) {
(7) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(7) <running>:       if (&User-Name =~ /\.\./ ) {
(7) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(7) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(7) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(7) <running>:       if (&User-Name =~ /\.$/)  {
(7) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(7) <running>:       if (&User-Name =~ /@\./)  {
(7) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(7) <running>:     } # policy filter_username = notfound
(7)     [preprocess] = ok
(7)     [chap] = noop
(7)     [mschap] = noop
(7)     [digest] = noop
(7) suffix: Checking for suffix after "@"
(7) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(7) suffix: No such realm "NULL"
(7)     [suffix] = noop
(7) eap: Peer sent EAP Response (code 2) ID 34 length 43
(7) eap: Continuing tunnel setup
(7)     [eap] = ok
(7)   } # authorize = ok
(7) Found Auth-Type = EAP
(7) # Executing group from file /etc/freeradius/sites-enabled/default
(7)   authenticate {
(7) eap: Expiring EAP session with state 0xfb87387cfda52141
(7) eap: Finished EAP session with state 0xfb87387cfda52141
(7) eap: Previous EAP request found for state 0xfb87387cfda52141, released from the list
(7) eap: Peer sent packet with method EAP PEAP (25)
(7) eap: Calling submodule eap_peap to process data
(7) eap_peap: Continuing EAP-TLS
(7) eap_peap: [eaptls verify] = ok
(7) eap_peap: Done initial handshake
(7) eap_peap: [eaptls process] = ok
(7) eap_peap: Session established.  Decoding tunneled attributes
(7) eap_peap: PEAP state WAITING FOR INNER IDENTITY
(7) eap_peap: Identity - emiruss
(7) eap_peap: Got inner identity 'emiruss'
(7) eap_peap: Setting default EAP type for tunneled EAP session
(7) eap_peap: Got tunneled request
(7) eap_peap:   EAP-Message = 0x0222000c01656d6972757373
(7) eap_peap: Setting User-Name to emiruss
(7) eap_peap: Sending tunneled request to inner-tunnel
(7) eap_peap:   EAP-Message = 0x0222000c01656d6972757373
(7) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(7) eap_peap:   User-Name = "emiruss"
(7) Virtual server inner-tunnel received request
(7)   EAP-Message = 0x0222000c01656d6972757373
(7)   FreeRADIUS-Proxied-To = 127.0.0.1
(7)   User-Name = "emiruss"
(7) server inner-tunnel {
(7)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(7)     authorize {
(7)       [chap] = noop
(7)       [mschap] = noop
(7) suffix: Checking for suffix after "@"
(7) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(7) suffix: No such realm "NULL"
(7)       [suffix] = noop
(7)       update control {
(7)         &Proxy-To-Realm := LOCAL
(7)       } # update control = noop
(7) eap: Peer sent EAP Response (code 2) ID 34 length 12
(7) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(7)       [eap] = ok
(7)     } # authorize = ok
(7)   Found Auth-Type = EAP
(7)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(7)     authenticate {
(7) eap: Peer sent packet with method EAP Identity (1)
(7) eap: Calling submodule eap_mschapv2 to process data
(7) eap_mschapv2: Issuing Challenge
(7) eap: Sending EAP Request (code 1) ID 35 length 43
(7) eap: EAP session adding &reply:State = 0x685f2f33687c3594
(7)       [eap] = handled
(7)     } # authenticate = handled
(7) } # server inner-tunnel
(7) Virtual server sending reply
(7)   EAP-Message = 0x0123002b1a0123002610626efe414dcf00f412d7a568e1952fd9667265657261646975732d332e302e3130
(7)   Message-Authenticator = 0x00000000000000000000000000000000
(7)   State = 0x685f2f33687c359425e8aab44fb864b8
(7) eap_peap: Got tunneled reply code 11
(7) eap_peap:   EAP-Message = 0x0123002b1a0123002610626efe414dcf00f412d7a568e1952fd9667265657261646975732d332e302e3130
(7) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(7) eap_peap:   State = 0x685f2f33687c359425e8aab44fb864b8
(7) eap_peap: Got tunneled Access-Challenge
(7) eap: Sending EAP Request (code 1) ID 35 length 75
(7) eap: EAP session adding &reply:State = 0xfb87387cfca42141
(7)     [eap] = handled
(7)   } # authenticate = handled
(7) Using Post-Auth-Type Challenge
(7) Post-Auth-Type sub-section not found.  Ignoring.
(7) # Executing group from file /etc/freeradius/sites-enabled/default
(7) Sent Access-Challenge Id 72 from 172.17.0.4:1812 to 192.168.1.30:50039 length 0
(7)   EAP-Message = 0x0123004b19001703010040364e2f50f2ccfa113f0c4bf902f7acc74259bbbcf186264a358ac879545192a636ec552aae83a8640539d852f58f90e776f28659c83a2688255e29cb0ee67357
(7)   Message-Authenticator = 0x00000000000000000000000000000000
(7)   State = 0xfb87387cfca42141ea2739c57b67432e
(7) Finished request
Thread 3 waiting to be assigned a request
Thread 1 got semaphore
Thread 1 handling request 8, (2 handled so far)
(8) <running>: Received Access-Request Id 73 from 192.168.1.30:50039 to 172.17.0.4:1812 length 303
(8) <running>:   User-Name = "emiruss"
(8) <running>:   NAS-IP-Address = 192.168.1.30
(8) <running>:   NAS-Identifier = "Ericsson"
(8) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(8) <running>:   NAS-Port-Type = Wireless-802.11
(8) <running>:   NAS-Port = 0
(8) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(8) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(8) <running>:   Acct-Session-Id = "003E2DE6-00000048"
(8) <running>:   Framed-MTU = 1400
(8) <running>:   EAP-Message = 0x0223006b1900170301006045365b0448fe92038b582cd8626bf058a6d9bc2177584dc7353b27a60e819cb3183749cda31b2e8b97780e5a5e20c70a2fec05de14ae2b7f1bf1916878e915223213aca43b67d1260a668f4c2072efd6df00df8283bc3948201a42fafea20151
(8) <running>:   State = 0xfb87387cfca42141ea2739c57b67432e
(8) <running>:   Message-Authenticator = 0x18b2c23ea7795df91f52528941e92828
(8) <running>: session-state: No cached attributes
(8) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(8) <running>:   authorize {
(8) <running>:     policy filter_username {
(8) <running>:       if (!&User-Name) {
(8) <running>:       if (!&User-Name)  -> FALSE
(8) <running>:       if (&User-Name =~ / /) {
(8) <running>:       if (&User-Name =~ / /)  -> FALSE
(8) <running>:       if (&User-Name =~ /@.*@/ ) {
(8) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(8) <running>:       if (&User-Name =~ /\.\./ ) {
(8) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(8) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(8) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(8) <running>:       if (&User-Name =~ /\.$/)  {
(8) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(8) <running>:       if (&User-Name =~ /@\./)  {
(8) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(8) <running>:     } # policy filter_username = notfound
(8)     [preprocess] = ok
(8)     [chap] = noop
(8)     [mschap] = noop
(8)     [digest] = noop
(8) suffix: Checking for suffix after "@"
(8) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(8) suffix: No such realm "NULL"
(8)     [suffix] = noop
(8) eap: Peer sent EAP Response (code 2) ID 35 length 107
(8) eap: Continuing tunnel setup
(8)     [eap] = ok
(8)   } # authorize = ok
(8) Found Auth-Type = EAP
(8) # Executing group from file /etc/freeradius/sites-enabled/default
(8)   authenticate {
(8) eap: Expiring EAP session with state 0x685f2f33687c3594
(8) eap: Finished EAP session with state 0xfb87387cfca42141
(8) eap: Previous EAP request found for state 0xfb87387cfca42141, released from the list
(8) eap: Peer sent packet with method EAP PEAP (25)
(8) eap: Calling submodule eap_peap to process data
(8) eap_peap: Continuing EAP-TLS
(8) eap_peap: [eaptls verify] = ok
(8) eap_peap: Done initial handshake
(8) eap_peap: [eaptls process] = ok
(8) eap_peap: Session established.  Decoding tunneled attributes
(8) eap_peap: PEAP state phase2
(8) eap_peap: EAP method MSCHAPv2 (26)
(8) eap_peap: Got tunneled request
(8) eap_peap:   EAP-Message = 0x022300421a0223003d31c794c555f7bbe731803a4f293387da420000000000000000d9de73b1f166e7045091e18ed1a210aedee4d3289fa9a90200656d6972757373
(8) eap_peap: Setting User-Name to emiruss
(8) eap_peap: Sending tunneled request to inner-tunnel
(8) eap_peap:   EAP-Message = 0x022300421a0223003d31c794c555f7bbe731803a4f293387da420000000000000000d9de73b1f166e7045091e18ed1a210aedee4d3289fa9a90200656d6972757373
(8) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(8) eap_peap:   User-Name = "emiruss"
(8) eap_peap:   State = 0x685f2f33687c359425e8aab44fb864b8
(8) Virtual server inner-tunnel received request
(8)   EAP-Message = 0x022300421a0223003d31c794c555f7bbe731803a4f293387da420000000000000000d9de73b1f166e7045091e18ed1a210aedee4d3289fa9a90200656d6972757373
(8)   FreeRADIUS-Proxied-To = 127.0.0.1
(8)   User-Name = "emiruss"
(8)   State = 0x685f2f33687c359425e8aab44fb864b8
(8) server inner-tunnel {
(8)   session-state: No cached attributes
(8)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(8)     authorize {
(8)       [chap] = noop
(8)       [mschap] = noop
(8) suffix: Checking for suffix after "@"
(8) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(8) suffix: No such realm "NULL"
(8)       [suffix] = noop
(8)       update control {
(8)         &Proxy-To-Realm := LOCAL
(8)       } # update control = noop
(8) eap: Peer sent EAP Response (code 2) ID 35 length 66
(8) eap: No EAP Start, assuming it's an on-going EAP conversation
(8)       [eap] = updated
(8)       [files] = noop
(8)       [expiration] = noop
(8)       [logintime] = noop
(8)       [pap] = noop
(8)     } # authorize = updated
(8)   Found Auth-Type = EAP
(8)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(8)     authenticate {
(8) eap: Expiring EAP session with state 0x685f2f33687c3594
(8) eap: Finished EAP session with state 0x685f2f33687c3594
(8) eap: Previous EAP request found for state 0x685f2f33687c3594, released from the list
(8) eap: Peer sent packet with method EAP MSCHAPv2 (26)
(8) eap: Calling submodule eap_mschapv2 to process data
(8) eap_mschapv2: # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(8) eap_mschapv2:   Auth-Type MS-CHAP {
(8) mschap: WARNING: No Cleartext-Password configured.  Cannot create NT-Password
(8) mschap: WARNING: No Cleartext-Password configured.  Cannot create LM-Password
(8) mschap: Creating challenge hash with username: emiruss
(8) mschap: Client is using MS-CHAPv2
(8) mschap: ERROR: FAILED: No NT/LM-Password.  Cannot perform authentication
(8) mschap: ERROR: MS-CHAP2-Response is incorrect
(8)     [mschap] = reject
(8)   } # Auth-Type MS-CHAP = reject
(8) eap: Sending EAP Failure (code 4) ID 35 length 4
(8) eap: Freeing handler
(8)       [eap] = reject
(8)     } # authenticate = reject
(8)   Failed to authenticate the user
(8)   Using Post-Auth-Type Reject
(8)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(8)     Post-Auth-Type REJECT {
(8) attr_filter.access_reject: EXPAND %{User-Name}
(8) attr_filter.access_reject:    --> emiruss
(8) attr_filter.access_reject: Matched entry DEFAULT at line 11
(8)       [attr_filter.access_reject] = updated
(8)       update outer.session-state {
(8)         &Module-Failure-Message := &request:Module-Failure-Message -> 'mschap: FAILED: No NT/LM-Password.  Cannot perform authentication'
(8)       } # update outer.session-state = noop
(8)     } # Post-Auth-Type REJECT = updated
(8) } # server inner-tunnel
(8) Virtual server sending reply
(8)   MS-CHAP-Error = "#E=691 R=1 C=d4e22e71ed553f5f93947a8d63969fba V=3 M=Authentication failed"
(8)   EAP-Message = 0x04230004
(8)   Message-Authenticator = 0x00000000000000000000000000000000
(8) eap_peap: Got tunneled reply code 3
(8) eap_peap:   MS-CHAP-Error = "#E=691 R=1 C=d4e22e71ed553f5f93947a8d63969fba V=3 M=Authentication failed"
(8) eap_peap:   EAP-Message = 0x04230004
(8) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(8) eap_peap: Tunneled authentication was rejected
(8) eap_peap: FAILURE
(8) eap: Sending EAP Request (code 1) ID 36 length 43
(8) eap: EAP session adding &reply:State = 0xfb87387cf3a32141
(8)     [eap] = handled
(8)   } # authenticate = handled
(8) Using Post-Auth-Type Challenge
(8) Post-Auth-Type sub-section not found.  Ignoring.
(8) # Executing group from file /etc/freeradius/sites-enabled/default
(8) session-state: Saving cached attributes
(8)   Module-Failure-Message := "mschap: FAILED: No NT/LM-Password.  Cannot perform authentication"
(8) Sent Access-Challenge Id 73 from 172.17.0.4:1812 to 192.168.1.30:50039 length 0
(8)   EAP-Message = 0x0124002b19001703010020ec1b502311abe2d4113fc530d084a92dd3b72eef60674a6e87034a3d93b421c3
(8)   Message-Authenticator = 0x00000000000000000000000000000000
(8)   State = 0xfb87387cf3a32141ea2739c57b67432e
(8) Finished request
Thread 1 waiting to be assigned a request
Thread 2 got semaphore
Thread 2 handling request 9, (2 handled so far)
(9) <running>: Received Access-Request Id 74 from 192.168.1.30:50039 to 172.17.0.4:1812 length 239
(9) <running>:   User-Name = "emiruss"
(9) <running>:   NAS-IP-Address = 192.168.1.30
(9) <running>:   NAS-Identifier = "Ericsson"
(9) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(9) <running>:   NAS-Port-Type = Wireless-802.11
(9) <running>:   NAS-Port = 0
(9) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(9) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(9) <running>:   Acct-Session-Id = "003E2DE6-00000048"
(9) <running>:   Framed-MTU = 1400
(9) <running>:   EAP-Message = 0x0224002b19001703010020e7e800e0d9c4e8da9a5399808e298e417aae81afb23781d1c0661ef294912fe5
(9) <running>:   State = 0xfb87387cf3a32141ea2739c57b67432e
(9) <running>:   Message-Authenticator = 0xfb6f0e7f6d566aaee2a790d2bcfac95a
(9) <running>: session-state: Found cached attributes
(9) <running>:   Module-Failure-Message := "mschap: FAILED: No NT/LM-Password.  Cannot perform authentication"
(9) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(9) <running>:   authorize {
(9) <running>:     policy filter_username {
(9) <running>:       if (!&User-Name) {
(9) <running>:       if (!&User-Name)  -> FALSE
(9) <running>:       if (&User-Name =~ / /) {
(9) <running>:       if (&User-Name =~ / /)  -> FALSE
(9) <running>:       if (&User-Name =~ /@.*@/ ) {
(9) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(9) <running>:       if (&User-Name =~ /\.\./ ) {
(9) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(9) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(9) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(9) <running>:       if (&User-Name =~ /\.$/)  {
(9) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(9) <running>:       if (&User-Name =~ /@\./)  {
(9) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(9) <running>:     } # policy filter_username = notfound
(9)     [preprocess] = ok
(9)     [chap] = noop
(9)     [mschap] = noop
(9)     [digest] = noop
(9) suffix: Checking for suffix after "@"
(9) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(9) suffix: No such realm "NULL"
(9)     [suffix] = noop
(9) eap: Peer sent EAP Response (code 2) ID 36 length 43
(9) eap: Continuing tunnel setup
(9)     [eap] = ok
(9)   } # authorize = ok
(9) Found Auth-Type = EAP
(9) # Executing group from file /etc/freeradius/sites-enabled/default
(9)   authenticate {
(9) eap: Expiring EAP session with state 0xfb87387cf3a32141
(9) eap: Finished EAP session with state 0xfb87387cf3a32141
(9) eap: Previous EAP request found for state 0xfb87387cf3a32141, released from the list
(9) eap: Peer sent packet with method EAP PEAP (25)
(9) eap: Calling submodule eap_peap to process data
(9) eap_peap: Continuing EAP-TLS
(9) eap_peap: [eaptls verify] = ok
(9) eap_peap: Done initial handshake
(9) eap_peap: [eaptls process] = ok
(9) eap_peap: Session established.  Decoding tunneled attributes
(9) eap_peap: PEAP state send tlv failure
(9) eap_peap: Received EAP-TLV response
(9) eap_peap:   The users session was previously rejected: returning reject (again.)
(9) eap_peap:   This means you need to read the PREVIOUS messages in the debug output
(9) eap_peap:   to find out the reason why the user was rejected
(9) eap_peap:   Look for "reject" or "fail".  Those earlier messages will tell you
(9) eap_peap:   what went wrong, and how to fix the problem
(9) eap: ERROR: Failed continuing EAP PEAP (25) session.  EAP sub-module failed
(9) eap: Sending EAP Failure (code 4) ID 36 length 4
(9) eap: Failed in EAP select
(9)     [eap] = invalid
(9)   } # authenticate = invalid
(9) Failed to authenticate the user
(9) Using Post-Auth-Type Reject
(9) # Executing group from file /etc/freeradius/sites-enabled/default
(9)   Post-Auth-Type REJECT {
(9) attr_filter.access_reject: EXPAND %{User-Name}
(9) attr_filter.access_reject:    --> emiruss
(9) attr_filter.access_reject: Matched entry DEFAULT at line 11
(9)     [attr_filter.access_reject] = updated
(9)     [eap] = noop
(9)     policy remove_reply_message_if_eap {
(9)       if (&reply:EAP-Message && &reply:Reply-Message) {
(9)       if (&reply:EAP-Message && &reply:Reply-Message)  -> FALSE
(9)       else {
(9)         [noop] = noop
(9)       } # else = noop
(9)     } # policy remove_reply_message_if_eap = noop
(9)   } # Post-Auth-Type REJECT = updated
(9) Delaying response for 1.000000 seconds
Thread 2 waiting to be assigned a request
Waking up in 0.1 seconds.
(9) Discarding duplicate request from client roocell-ap port 50039 - ID: 74 due to delayed response
Waking up in 0.6 seconds.
Thread 5 got semaphore
Thread 5 handling request 10, (3 handled so far)
(10) <running>: Received Access-Request Id 75 from 192.168.1.30:50039 to 172.17.0.4:1812 length 190
(10) <running>:   User-Name = "emiruss"
(10) <running>:   NAS-IP-Address = 192.168.1.30
(10) <running>:   NAS-Identifier = "Ericsson"
(10) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(10) <running>:   NAS-Port-Type = Wireless-802.11
(10) <running>:   NAS-Port = 0
(10) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(10) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(10) <running>:   Acct-Session-Id = "003E2DE6-00000049"
(10) <running>:   Framed-MTU = 1400
(10) <running>:   EAP-Message = 0x0235000c01656d6972757373
(10) <running>:   Message-Authenticator = 0x1019f2ad260722c8bf9b8b7796c3e07e
(10) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(10) <running>:   authorize {
(10) <running>:     policy filter_username {
(10) <running>:       if (!&User-Name) {
(10) <running>:       if (!&User-Name)  -> FALSE
(10) <running>:       if (&User-Name =~ / /) {
(10) <running>:       if (&User-Name =~ / /)  -> FALSE
(10) <running>:       if (&User-Name =~ /@.*@/ ) {
(10) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(10) <running>:       if (&User-Name =~ /\.\./ ) {
(10) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(10) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(10) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(10) <running>:       if (&User-Name =~ /\.$/)  {
(10) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(10) <running>:       if (&User-Name =~ /@\./)  {
(10) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(10) <running>:     } # policy filter_username = notfound
(10)     [preprocess] = ok
(10)     [chap] = noop
(10)     [mschap] = noop
(10)     [digest] = noop
(10) suffix: Checking for suffix after "@"
(10) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(10) suffix: No such realm "NULL"
Waking up in 0.1 seconds.
(10)     [suffix] = noop
(10) eap: Peer sent EAP Response (code 2) ID 53 length 12
(10) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(10)     [eap] = ok
(10)   } # authorize = ok
(10) Found Auth-Type = EAP
(10) # Executing group from file /etc/freeradius/sites-enabled/default
(10)   authenticate {
(10) eap: Peer sent packet with method EAP Identity (1)
(10) eap: Calling submodule eap_md5 to process data
(10) eap_md5: Issuing MD5 Challenge
(10) eap: Sending EAP Request (code 1) ID 54 length 22
(10) eap: EAP session adding &reply:State = 0x22590211226f06af
(10)     [eap] = handled
(10)   } # authenticate = handled
(10) Using Post-Auth-Type Challenge
(10) Post-Auth-Type sub-section not found.  Ignoring.
(10) # Executing group from file /etc/freeradius/sites-enabled/default
(10) Sent Access-Challenge Id 75 from 172.17.0.4:1812 to 192.168.1.30:50039 length 0
(10)   EAP-Message = 0x01360016041075cc335d4e72888ef43ac0a8fd71d331
(10)   Message-Authenticator = 0x00000000000000000000000000000000
(10)   State = 0x22590211226f06af655a133202c8e0d2
(10) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 4 got semaphore
Thread 4 handling request 11, (3 handled so far)
(11) <running>: Received Access-Request Id 76 from 192.168.1.30:50039 to 172.17.0.4:1812 length 204
(11) <running>:   User-Name = "emiruss"
(11) <running>:   NAS-IP-Address = 192.168.1.30
(11) <running>:   NAS-Identifier = "Ericsson"
(11) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(11) <running>:   NAS-Port-Type = Wireless-802.11
(11) <running>:   NAS-Port = 0
(11) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(11) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(11) <running>:   Acct-Session-Id = "003E2DE6-00000049"
(11) <running>:   Framed-MTU = 1400
(11) <running>:   EAP-Message = 0x023600080319152b
(11) <running>:   State = 0x22590211226f06af655a133202c8e0d2
(11) <running>:   Message-Authenticator = 0x3e34f33a76f7dcee191e56b200293da7
(11) <running>: session-state: No cached attributes
(11) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(11) <running>:   authorize {
(11) <running>:     policy filter_username {
(11) <running>:       if (!&User-Name) {
(11) <running>:       if (!&User-Name)  -> FALSE
(11) <running>:       if (&User-Name =~ / /) {
(11) <running>:       if (&User-Name =~ / /)  -> FALSE
(11) <running>:       if (&User-Name =~ /@.*@/ ) {
(11) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(11) <running>:       if (&User-Name =~ /\.\./ ) {
(11) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(11) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(11) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(11) <running>:       if (&User-Name =~ /\.$/)  {
(11) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(11) <running>:       if (&User-Name =~ /@\./)  {
(11) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(11) <running>:     } # policy filter_username = notfound
(11)     [preprocess] = ok
(11)     [chap] = noop
(11)     [mschap] = noop
(11)     [digest] = noop
(11) suffix: Checking for suffix after "@"
(11) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(11) suffix: No such realm "NULL"
(11)     [suffix] = noop
(11) eap: Peer sent EAP Response (code 2) ID 54 length 8
(11) eap: No EAP Start, assuming it's an on-going EAP conversation
(11)     [eap] = updated
(11)     [files] = noop
(11)     [expiration] = noop
(11)     [logintime] = noop
(11) pap: WARNING: No "known good" password found for the user.  Not setting Auth-Type
(11) pap: WARNING: Authentication will fail unless a "known good" password is available
(11)     [pap] = noop
(11)   } # authorize = updated
(11) Found Auth-Type = EAP
(11) # Executing group from file /etc/freeradius/sites-enabled/default
(11)   authenticate {
(11) eap: Expiring EAP session with state 0x22590211226f06af
(11) eap: Finished EAP session with state 0x22590211226f06af
(11) eap: Previous EAP request found for state 0x22590211226f06af, released from the list
(11) eap: Peer sent packet with method EAP NAK (3)
(11) eap: Found mutually acceptable type PEAP (25)
(11) eap: Calling submodule eap_peap to process data
(11) eap_peap: Initiating new EAP-TLS session
(11) eap_peap: [eaptls start] = request
(11) eap: Sending EAP Request (code 1) ID 55 length 6
(11) eap: EAP session adding &reply:State = 0x22590211236e1baf
(11)     [eap] = handled
(11)   } # authenticate = handled
(11) Using Post-Auth-Type Challenge
(11) Post-Auth-Type sub-section not found.  Ignoring.
(11) # Executing group from file /etc/freeradius/sites-enabled/default
(11) Sent Access-Challenge Id 76 from 172.17.0.4:1812 to 192.168.1.30:50039 length 0
(11)   EAP-Message = 0x013700061920
(11)   Message-Authenticator = 0x00000000000000000000000000000000
(11)   State = 0x22590211236e1baf655a133202c8e0d2
(11) Finished request
Thread 4 waiting to be assigned a request
Thread 3 got semaphore
Thread 3 handling request 12, (3 handled so far)
(12) <running>: Received Access-Request Id 77 from 192.168.1.30:50039 to 172.17.0.4:1812 length 339
(12) <running>:   User-Name = "emiruss"
(12) <running>:   NAS-IP-Address = 192.168.1.30
(12) <running>:   NAS-Identifier = "Ericsson"
(12) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(12) <running>:   NAS-Port-Type = Wireless-802.11
(12) <running>:   NAS-Port = 0
(12) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(12) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(12) <running>:   Acct-Session-Id = "003E2DE6-00000049"
(12) <running>:   Framed-MTU = 1400
(12) <running>:   EAP-Message = 0x0237008f19800000008516030100800100007c03015655281ece73be9e4af72f171355eaee23bcf8d179e29080af69abc7d933cc5900003400ffc02cc02bc024c023c00ac009c008c030c02fc028c027c014c013c012009d009c003d003c0035002f000ac007c011000500040100001f000a0008000600
(12) <running>:   State = 0x22590211236e1baf655a133202c8e0d2
(12) <running>:   Message-Authenticator = 0xb33b04db72f997a8039eee40cbd94260
(12) <running>: session-state: No cached attributes
(12) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(12) <running>:   authorize {
(12) <running>:     policy filter_username {
(12) <running>:       if (!&User-Name) {
(12) <running>:       if (!&User-Name)  -> FALSE
(12) <running>:       if (&User-Name =~ / /) {
(12) <running>:       if (&User-Name =~ / /)  -> FALSE
(12) <running>:       if (&User-Name =~ /@.*@/ ) {
(12) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(12) <running>:       if (&User-Name =~ /\.\./ ) {
(12) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(12) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(12) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(12) <running>:       if (&User-Name =~ /\.$/)  {
(12) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(12) <running>:       if (&User-Name =~ /@\./)  {
(12) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(12) <running>:     } # policy filter_username = notfound
(12)     [preprocess] = ok
(12)     [chap] = noop
(12)     [mschap] = noop
(12)     [digest] = noop
(12) suffix: Checking for suffix after "@"
(12) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(12) suffix: No such realm "NULL"
(12)     [suffix] = noop
(12) eap: Peer sent EAP Response (code 2) ID 55 length 143
(12) eap: Continuing tunnel setup
(12)     [eap] = ok
(12)   } # authorize = ok
(12) Found Auth-Type = EAP
(12) # Executing group from file /etc/freeradius/sites-enabled/default
(12)   authenticate {
(12) eap: Expiring EAP session with state 0x22590211236e1baf
(12) eap: Finished EAP session with state 0x22590211236e1baf
(12) eap: Previous EAP request found for state 0x22590211236e1baf, released from the list
(12) eap: Peer sent packet with method EAP PEAP (25)
(12) eap: Calling submodule eap_peap to process data
(12) eap_peap: Continuing EAP-TLS
(12) eap_peap: Peer indicated complete TLS record size will be 133 bytes
(12) eap_peap: Got complete TLS record (133 bytes)
(12) eap_peap: [eaptls verify] = length included
(12) eap_peap: (other): before/accept initialization
(12) eap_peap: TLS_accept: before/accept initialization
(12) eap_peap: <<< TLS 1.0 Handshake [length 0080], ClientHello 
(12) eap_peap: TLS_accept: SSLv3 read client hello A
(12) eap_peap: >>> TLS 1.0 Handshake [length 0059], ServerHello 
(12) eap_peap: TLS_accept: SSLv3 write server hello A
(12) eap_peap: >>> TLS 1.0 Handshake [length 08d3], Certificate 
(12) eap_peap: TLS_accept: SSLv3 write certificate A
(12) eap_peap: >>> TLS 1.0 Handshake [length 014b], ServerKeyExchange 
(12) eap_peap: TLS_accept: SSLv3 write key exchange A
(12) eap_peap: >>> TLS 1.0 Handshake [length 0004], ServerHelloDone 
(12) eap_peap: TLS_accept: SSLv3 write server done A
(12) eap_peap: TLS_accept: SSLv3 flush data
(12) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(12) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(12) eap_peap: In SSL Handshake Phase
(12) eap_peap: In SSL Accept mode
(12) eap_peap: [eaptls process] = handled
(12) eap: Sending EAP Request (code 1) ID 56 length 1004
(12) eap: EAP session adding &reply:State = 0x2259021120611baf
(12)     [eap] = handled
(12)   } # authenticate = handled
(12) Using Post-Auth-Type Challenge
(12) Post-Auth-Type sub-section not found.  Ignoring.
(12) # Executing group from file /etc/freeradius/sites-enabled/default
(12) Sent Access-Challenge Id 77 from 172.17.0.4:1812 to 192.168.1.30:50039 length 0
(12)   EAP-Message = 0x013803ec19c000000a8f1603010059020000550301f61e5c059f6e385daed4d5f5ce734b2cbc1392d91dd21193a4684906930d01752085d3eb98800dd8f187ebe9cca66f84a85d40df6e2ba51b8971201ba3c258ec6fc01400000dff01000100000b00040300010216030108d30b0008cf0008cc0003de
(12)   Message-Authenticator = 0x00000000000000000000000000000000
(12)   State = 0x2259021120611baf655a133202c8e0d2
(12) Finished request
Thread 3 waiting to be assigned a request
Thread 1 got semaphore
Thread 1 handling request 13, (3 handled so far)
(13) <running>: Received Access-Request Id 78 from 192.168.1.30:50039 to 172.17.0.4:1812 length 202
(13) <running>:   User-Name = "emiruss"
(13) <running>:   NAS-IP-Address = 192.168.1.30
(13) <running>:   NAS-Identifier = "Ericsson"
(13) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(13) <running>:   NAS-Port-Type = Wireless-802.11
(13) <running>:   NAS-Port = 0
(13) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(13) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(13) <running>:   Acct-Session-Id = "003E2DE6-00000049"
(13) <running>:   Framed-MTU = 1400
(13) <running>:   EAP-Message = 0x023800061900
(13) <running>:   State = 0x2259021120611baf655a133202c8e0d2
(13) <running>:   Message-Authenticator = 0x4754a31273021142100d3c7e8fdf1397
(13) <running>: session-state: No cached attributes
(13) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(13) <running>:   authorize {
(13) <running>:     policy filter_username {
(13) <running>:       if (!&User-Name) {
(13) <running>:       if (!&User-Name)  -> FALSE
(13) <running>:       if (&User-Name =~ / /) {
(13) <running>:       if (&User-Name =~ / /)  -> FALSE
(13) <running>:       if (&User-Name =~ /@.*@/ ) {
(13) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(13) <running>:       if (&User-Name =~ /\.\./ ) {
(13) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(13) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(13) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(13) <running>:       if (&User-Name =~ /\.$/)  {
(13) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(13) <running>:       if (&User-Name =~ /@\./)  {
(13) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(13) <running>:     } # policy filter_username = notfound
(13)     [preprocess] = ok
(13)     [chap] = noop
(13)     [mschap] = noop
(13)     [digest] = noop
(13) suffix: Checking for suffix after "@"
(13) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(13) suffix: No such realm "NULL"
(13)     [suffix] = noop
(13) eap: Peer sent EAP Response (code 2) ID 56 length 6
(13) eap: Continuing tunnel setup
(13)     [eap] = ok
(13)   } # authorize = ok
(13) Found Auth-Type = EAP
(13) # Executing group from file /etc/freeradius/sites-enabled/default
(13)   authenticate {
(13) eap: Expiring EAP session with state 0x2259021120611baf
(13) eap: Finished EAP session with state 0x2259021120611baf
(13) eap: Previous EAP request found for state 0x2259021120611baf, released from the list
(13) eap: Peer sent packet with method EAP PEAP (25)
(13) eap: Calling submodule eap_peap to process data
(13) eap_peap: Continuing EAP-TLS
(13) eap_peap: Peer ACKed our handshake fragment
(13) eap_peap: [eaptls verify] = request
(13) eap_peap: [eaptls process] = handled
(13) eap: Sending EAP Request (code 1) ID 57 length 1000
(13) eap: EAP session adding &reply:State = 0x2259021121601baf
(13)     [eap] = handled
(13)   } # authenticate = handled
(13) Using Post-Auth-Type Challenge
(13) Post-Auth-Type sub-section not found.  Ignoring.
(13) # Executing group from file /etc/freeradius/sites-enabled/default
(13) Sent Access-Challenge Id 78 from 172.17.0.4:1812 to 192.168.1.30:50039 length 0
(13)   EAP-Message = 0x013903e819400dd0405955c762981948527048701681d313d3cc6629a5557b66df2aae22c8590ab99d66ec8d3792a72e30596410f5d1e81f5a774969a1ce9ad6bd01d42da65536016e80a905c662a71ef5c075b8bdf0127a0cf1bd4c91290e15edffa035febde0185096bdc1e553090004e8308204e430
(13)   Message-Authenticator = 0x00000000000000000000000000000000
(13)   State = 0x2259021121601baf655a133202c8e0d2
(13) Finished request
Thread 1 waiting to be assigned a request
(9) Sending delayed response
(9) Sent Access-Reject Id 74 from 172.17.0.4:1812 to 192.168.1.30:50039 length 44
(9)   EAP-Message = 0x04240004
(9)   Message-Authenticator = 0x00000000000000000000000000000000
Waking up in 0.1 seconds.
Waking up in 0.1 seconds.
Thread 2 got semaphore
Thread 2 handling request 14, (3 handled so far)
(14) <running>: Received Access-Request Id 79 from 192.168.1.30:50039 to 172.17.0.4:1812 length 202
(14) <running>:   User-Name = "emiruss"
(14) <running>:   NAS-IP-Address = 192.168.1.30
(14) <running>:   NAS-Identifier = "Ericsson"
(14) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(14) <running>:   NAS-Port-Type = Wireless-802.11
(14) <running>:   NAS-Port = 0
(14) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(14) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(14) <running>:   Acct-Session-Id = "003E2DE6-00000049"
(14) <running>:   Framed-MTU = 1400
(14) <running>:   EAP-Message = 0x023900061900
(14) <running>:   State = 0x2259021121601baf655a133202c8e0d2
(14) <running>:   Message-Authenticator = 0x8218521c7f027ed7352c03cc49168dcd
(14) <running>: session-state: No cached attributes
(14) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(14) <running>:   authorize {
(14) <running>:     policy filter_username {
(14) <running>:       if (!&User-Name) {
(14) <running>:       if (!&User-Name)  -> FALSE
(14) <running>:       if (&User-Name =~ / /) {
(14) <running>:       if (&User-Name =~ / /)  -> FALSE
(14) <running>:       if (&User-Name =~ /@.*@/ ) {
(14) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(14) <running>:       if (&User-Name =~ /\.\./ ) {
(14) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(14) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(14) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(14) <running>:       if (&User-Name =~ /\.$/)  {
(14) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(14) <running>:       if (&User-Name =~ /@\./)  {
(14) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(14) <running>:     } # policy filter_username = notfound
(14)     [preprocess] = ok
(14)     [chap] = noop
(14)     [mschap] = noop
(14)     [digest] = noop
(14) suffix: Checking for suffix after "@"
(14) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(14) suffix: No such realm "NULL"
(14)     [suffix] = noop
(14) eap: Peer sent EAP Response (code 2) ID 57 length 6
(14) eap: Continuing tunnel setup
(14)     [eap] = ok
(14)   } # authorize = ok
(14) Found Auth-Type = EAP
(14) # Executing group from file /etc/freeradius/sites-enabled/default
(14)   authenticate {
(14) eap: Expiring EAP session with state 0x2259021121601baf
(14) eap: Finished EAP session with state 0x2259021121601baf
(14) eap: Previous EAP request found for state 0x2259021121601baf, released from the list
(14) eap: Peer sent packet with method EAP PEAP (25)
(14) eap: Calling submodule eap_peap to process data
(14) eap_peap: Continuing EAP-TLS
(14) eap_peap: Peer ACKed our handshake fragment
(14) eap_peap: [eaptls verify] = request
(14) eap_peap: [eaptls process] = handled
(14) eap: Sending EAP Request (code 1) ID 58 length 721
(14) eap: EAP session adding &reply:State = 0x2259021126631baf
(14)     [eap] = handled
(14)   } # authenticate = handled
(14) Using Post-Auth-Type Challenge
(14) Post-Auth-Type sub-section not found.  Ignoring.
(14) # Executing group from file /etc/freeradius/sites-enabled/default
(14) Sent Access-Challenge Id 79 from 172.17.0.4:1812 to 192.168.1.30:50039 length 0
(14)   EAP-Message = 0x013a02d1190020417574686f72697479820900c3fc536eef83d741300f0603551d130101ff040530030101ff30360603551d1f042f302d302ba029a0278625687474703a2f2f7777772e6578616d706c652e6f72672f6578616d706c655f63612e63726c300d06092a864886f70d01010b050003820101
(14)   Message-Authenticator = 0x00000000000000000000000000000000
(14)   State = 0x2259021126631baf655a133202c8e0d2
(14) Finished request
Thread 2 waiting to be assigned a request
Thread 5 got semaphore
Thread 5 handling request 15, (4 handled so far)
(15) <running>: Received Access-Request Id 80 from 192.168.1.30:50039 to 172.17.0.4:1812 length 340
(15) <running>:   User-Name = "emiruss"
(15) <running>:   NAS-IP-Address = 192.168.1.30
(15) <running>:   NAS-Identifier = "Ericsson"
(15) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(15) <running>:   NAS-Port-Type = Wireless-802.11
(15) <running>:   NAS-Port = 0
(15) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(15) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(15) <running>:   Acct-Session-Id = "003E2DE6-00000049"
(15) <running>:   Framed-MTU = 1400
(15) <running>:   EAP-Message = 0x023a0090198000000086160301004610000042410498b2273da811026f9c9f70c564a4e6cae7eeb961d6cfbf503b5f1b7ecccbb0b98e5b9dd70ce4bfd7f8135f275b760bf2a4304a1ff1475795926d0590040d15c814030100010116030100305698dfd900b3de2e7c32e591284fb06203e200d9a055ae
(15) <running>:   State = 0x2259021126631baf655a133202c8e0d2
(15) <running>:   Message-Authenticator = 0xc17a44b2c25539099769a0659f842f2d
(15) <running>: session-state: No cached attributes
(15) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(15) <running>:   authorize {
(15) <running>:     policy filter_username {
(15) <running>:       if (!&User-Name) {
(15) <running>:       if (!&User-Name)  -> FALSE
(15) <running>:       if (&User-Name =~ / /) {
(15) <running>:       if (&User-Name =~ / /)  -> FALSE
(15) <running>:       if (&User-Name =~ /@.*@/ ) {
(15) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(15) <running>:       if (&User-Name =~ /\.\./ ) {
(15) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(15) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(15) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(15) <running>:       if (&User-Name =~ /\.$/)  {
(15) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(15) <running>:       if (&User-Name =~ /@\./)  {
(15) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(15) <running>:     } # policy filter_username = notfound
(15)     [preprocess] = ok
(15)     [chap] = noop
(15)     [mschap] = noop
(15)     [digest] = noop
(15) suffix: Checking for suffix after "@"
(15) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(15) suffix: No such realm "NULL"
(15)     [suffix] = noop
(15) eap: Peer sent EAP Response (code 2) ID 58 length 144
(15) eap: Continuing tunnel setup
(15)     [eap] = ok
(15)   } # authorize = ok
(15) Found Auth-Type = EAP
(15) # Executing group from file /etc/freeradius/sites-enabled/default
(15)   authenticate {
(15) eap: Expiring EAP session with state 0x2259021126631baf
(15) eap: Finished EAP session with state 0x2259021126631baf
(15) eap: Previous EAP request found for state 0x2259021126631baf, released from the list
(15) eap: Peer sent packet with method EAP PEAP (25)
(15) eap: Calling submodule eap_peap to process data
(15) eap_peap: Continuing EAP-TLS
(15) eap_peap: Peer indicated complete TLS record size will be 134 bytes
(15) eap_peap: Got complete TLS record (134 bytes)
(15) eap_peap: [eaptls verify] = length included
(15) eap_peap: <<< TLS 1.0 Handshake [length 0046], ClientKeyExchange 
(15) eap_peap: TLS_accept: SSLv3 read client key exchange A
(15) eap_peap: <<< TLS 1.0 ChangeCipherSpec [length 0001] 
(15) eap_peap: <<< TLS 1.0 Handshake [length 0010], Finished 
(15) eap_peap: TLS_accept: SSLv3 read finished A
(15) eap_peap: >>> TLS 1.0 ChangeCipherSpec [length 0001] 
(15) eap_peap: TLS_accept: SSLv3 write change cipher spec A
(15) eap_peap: >>> TLS 1.0 Handshake [length 0010], Finished 
(15) eap_peap: TLS_accept: SSLv3 write finished A
(15) eap_peap: TLS_accept: SSLv3 flush data
(15) eap_peap: (other): SSL negotiation finished successfully
(15) eap_peap: SSL Connection Established
(15) eap_peap: [eaptls process] = handled
(15) eap: Sending EAP Request (code 1) ID 59 length 65
(15) eap: EAP session adding &reply:State = 0x2259021127621baf
(15)     [eap] = handled
(15)   } # authenticate = handled
(15) Using Post-Auth-Type Challenge
(15) Post-Auth-Type sub-section not found.  Ignoring.
(15) # Executing group from file /etc/freeradius/sites-enabled/default
(15) Sent Access-Challenge Id 80 from 172.17.0.4:1812 to 192.168.1.30:50039 length 0
(15)   EAP-Message = 0x013b004119001403010001011603010030c14ca1194d8969a14108c38d2c0e9537e13a2450174ce1a9c120eb73298ab33698507267e33f102638d913153dacc8bc
(15)   Message-Authenticator = 0x00000000000000000000000000000000
(15)   State = 0x2259021127621baf655a133202c8e0d2
(15) Finished request
Thread 5 waiting to be assigned a request
Thread 4 got semaphore
Thread 4 handling request 16, (4 handled so far)
(16) <running>: Received Access-Request Id 81 from 192.168.1.30:50039 to 172.17.0.4:1812 length 202
(16) <running>:   User-Name = "emiruss"
(16) <running>:   NAS-IP-Address = 192.168.1.30
(16) <running>:   NAS-Identifier = "Ericsson"
(16) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(16) <running>:   NAS-Port-Type = Wireless-802.11
(16) <running>:   NAS-Port = 0
(16) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(16) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(16) <running>:   Acct-Session-Id = "003E2DE6-00000049"
(16) <running>:   Framed-MTU = 1400
(16) <running>:   EAP-Message = 0x023b00061900
(16) <running>:   State = 0x2259021127621baf655a133202c8e0d2
(16) <running>:   Message-Authenticator = 0x3f8783e4be4e8dedb4b87b43274ce475
(16) <running>: session-state: No cached attributes
(16) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(16) <running>:   authorize {
(16) <running>:     policy filter_username {
(16) <running>:       if (!&User-Name) {
(16) <running>:       if (!&User-Name)  -> FALSE
(16) <running>:       if (&User-Name =~ / /) {
(16) <running>:       if (&User-Name =~ / /)  -> FALSE
(16) <running>:       if (&User-Name =~ /@.*@/ ) {
(16) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(16) <running>:       if (&User-Name =~ /\.\./ ) {
(16) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(16) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(16) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(16) <running>:       if (&User-Name =~ /\.$/)  {
(16) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(16) <running>:       if (&User-Name =~ /@\./)  {
(16) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(16) <running>:     } # policy filter_username = notfound
(16)     [preprocess] = ok
(16)     [chap] = noop
(16)     [mschap] = noop
(16)     [digest] = noop
(16) suffix: Checking for suffix after "@"
(16) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(16) suffix: No such realm "NULL"
(16)     [suffix] = noop
(16) eap: Peer sent EAP Response (code 2) ID 59 length 6
(16) eap: Continuing tunnel setup
(16)     [eap] = ok
(16)   } # authorize = ok
(16) Found Auth-Type = EAP
(16) # Executing group from file /etc/freeradius/sites-enabled/default
(16)   authenticate {
(16) eap: Expiring EAP session with state 0x2259021127621baf
(16) eap: Finished EAP session with state 0x2259021127621baf
(16) eap: Previous EAP request found for state 0x2259021127621baf, released from the list
(16) eap: Peer sent packet with method EAP PEAP (25)
(16) eap: Calling submodule eap_peap to process data
(16) eap_peap: Continuing EAP-TLS
(16) eap_peap: Peer ACKed our handshake fragment.  handshake is finished
(16) eap_peap: [eaptls verify] = success
(16) eap_peap: [eaptls process] = success
(16) eap_peap: Session established.  Decoding tunneled attributes
(16) eap_peap: PEAP state TUNNEL ESTABLISHED
(16) eap: Sending EAP Request (code 1) ID 60 length 43
(16) eap: EAP session adding &reply:State = 0x2259021124651baf
(16)     [eap] = handled
(16)   } # authenticate = handled
(16) Using Post-Auth-Type Challenge
(16) Post-Auth-Type sub-section not found.  Ignoring.
(16) # Executing group from file /etc/freeradius/sites-enabled/default
(16) Sent Access-Challenge Id 81 from 172.17.0.4:1812 to 192.168.1.30:50039 length 0
(16)   EAP-Message = 0x013c002b1900170301002053a27d77de19c033dea352541753223f6a2c8dec6c7c20c2ab61432e901c05b5
(16)   Message-Authenticator = 0x00000000000000000000000000000000
(16)   State = 0x2259021124651baf655a133202c8e0d2
(16) Finished request
Thread 4 waiting to be assigned a request
Thread 3 got semaphore
Thread 3 handling request 17, (4 handled so far)
(17) <running>: Received Access-Request Id 82 from 192.168.1.30:50039 to 172.17.0.4:1812 length 239
(17) <running>:   User-Name = "emiruss"
(17) <running>:   NAS-IP-Address = 192.168.1.30
(17) <running>:   NAS-Identifier = "Ericsson"
(17) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(17) <running>:   NAS-Port-Type = Wireless-802.11
(17) <running>:   NAS-Port = 0
(17) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(17) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(17) <running>:   Acct-Session-Id = "003E2DE6-00000049"
(17) <running>:   Framed-MTU = 1400
(17) <running>:   EAP-Message = 0x023c002b19001703010020813150071e87a48a82583825aecf97bf9d88309371414c3e743da01d11781ff8
(17) <running>:   State = 0x2259021124651baf655a133202c8e0d2
(17) <running>:   Message-Authenticator = 0xf1f42e729e3f477a7930c55686bd53e5
(17) <running>: session-state: No cached attributes
(17) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(17) <running>:   authorize {
(17) <running>:     policy filter_username {
(17) <running>:       if (!&User-Name) {
(17) <running>:       if (!&User-Name)  -> FALSE
(17) <running>:       if (&User-Name =~ / /) {
(17) <running>:       if (&User-Name =~ / /)  -> FALSE
(17) <running>:       if (&User-Name =~ /@.*@/ ) {
(17) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(17) <running>:       if (&User-Name =~ /\.\./ ) {
(17) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(17) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(17) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(17) <running>:       if (&User-Name =~ /\.$/)  {
(17) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(17) <running>:       if (&User-Name =~ /@\./)  {
(17) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(17) <running>:     } # policy filter_username = notfound
(17)     [preprocess] = ok
(17)     [chap] = noop
(17)     [mschap] = noop
(17)     [digest] = noop
(17) suffix: Checking for suffix after "@"
(17) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(17) suffix: No such realm "NULL"
(17)     [suffix] = noop
(17) eap: Peer sent EAP Response (code 2) ID 60 length 43
(17) eap: Continuing tunnel setup
(17)     [eap] = ok
(17)   } # authorize = ok
(17) Found Auth-Type = EAP
(17) # Executing group from file /etc/freeradius/sites-enabled/default
(17)   authenticate {
(17) eap: Expiring EAP session with state 0x2259021124651baf
(17) eap: Finished EAP session with state 0x2259021124651baf
(17) eap: Previous EAP request found for state 0x2259021124651baf, released from the list
(17) eap: Peer sent packet with method EAP PEAP (25)
(17) eap: Calling submodule eap_peap to process data
(17) eap_peap: Continuing EAP-TLS
(17) eap_peap: [eaptls verify] = ok
(17) eap_peap: Done initial handshake
(17) eap_peap: [eaptls process] = ok
(17) eap_peap: Session established.  Decoding tunneled attributes
(17) eap_peap: PEAP state WAITING FOR INNER IDENTITY
(17) eap_peap: Identity - emiruss
(17) eap_peap: Got inner identity 'emiruss'
(17) eap_peap: Setting default EAP type for tunneled EAP session
(17) eap_peap: Got tunneled request
(17) eap_peap:   EAP-Message = 0x023c000c01656d6972757373
(17) eap_peap: Setting User-Name to emiruss
(17) eap_peap: Sending tunneled request to inner-tunnel
(17) eap_peap:   EAP-Message = 0x023c000c01656d6972757373
(17) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(17) eap_peap:   User-Name = "emiruss"
(17) Virtual server inner-tunnel received request
(17)   EAP-Message = 0x023c000c01656d6972757373
(17)   FreeRADIUS-Proxied-To = 127.0.0.1
(17)   User-Name = "emiruss"
(17) server inner-tunnel {
(17)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(17)     authorize {
(17)       [chap] = noop
(17)       [mschap] = noop
(17) suffix: Checking for suffix after "@"
(17) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(17) suffix: No such realm "NULL"
(17)       [suffix] = noop
(17)       update control {
(17)         &Proxy-To-Realm := LOCAL
(17)       } # update control = noop
(17) eap: Peer sent EAP Response (code 2) ID 60 length 12
(17) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(17)       [eap] = ok
(17)     } # authorize = ok
(17)   Found Auth-Type = EAP
(17)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(17)     authenticate {
(17) eap: Peer sent packet with method EAP Identity (1)
(17) eap: Calling submodule eap_mschapv2 to process data
(17) eap_mschapv2: Issuing Challenge
(17) eap: Sending EAP Request (code 1) ID 61 length 43
(17) eap: EAP session adding &reply:State = 0x4582de8145bfc4fc
(17)       [eap] = handled
(17)     } # authenticate = handled
(17) } # server inner-tunnel
(17) Virtual server sending reply
(17)   EAP-Message = 0x013d002b1a013d002610f5f7281345fb159746004f040a252a1f667265657261646975732d332e302e3130
(17)   Message-Authenticator = 0x00000000000000000000000000000000
(17)   State = 0x4582de8145bfc4fcaa63e965f8e6527e
(17) eap_peap: Got tunneled reply code 11
(17) eap_peap:   EAP-Message = 0x013d002b1a013d002610f5f7281345fb159746004f040a252a1f667265657261646975732d332e302e3130
(17) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(17) eap_peap:   State = 0x4582de8145bfc4fcaa63e965f8e6527e
(17) eap_peap: Got tunneled Access-Challenge
(17) eap: Sending EAP Request (code 1) ID 61 length 75
(17) eap: EAP session adding &reply:State = 0x2259021125641baf
(17)     [eap] = handled
(17)   } # authenticate = handled
(17) Using Post-Auth-Type Challenge
(17) Post-Auth-Type sub-section not found.  Ignoring.
(17) # Executing group from file /etc/freeradius/sites-enabled/default
(17) Sent Access-Challenge Id 82 from 172.17.0.4:1812 to 192.168.1.30:50039 length 0
(17)   EAP-Message = 0x013d004b19001703010040b430a6649da0571b61d6001b2c1bf3aaf17bb9b5b14754e17493d9c706a31e1adcec247f0b7a0d27c2b9debf1fccb98a7307524cd940c91c173869558f3ecf6c
(17)   Message-Authenticator = 0x00000000000000000000000000000000
(17)   State = 0x2259021125641baf655a133202c8e0d2
(17) Finished request
Thread 3 waiting to be assigned a request
Thread 1 got semaphore
Thread 1 handling request 18, (4 handled so far)
(18) <running>: Received Access-Request Id 83 from 192.168.1.30:50039 to 172.17.0.4:1812 length 303
(18) <running>:   User-Name = "emiruss"
(18) <running>:   NAS-IP-Address = 192.168.1.30
(18) <running>:   NAS-Identifier = "Ericsson"
(18) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(18) <running>:   NAS-Port-Type = Wireless-802.11
(18) <running>:   NAS-Port = 0
(18) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(18) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(18) <running>:   Acct-Session-Id = "003E2DE6-00000049"
(18) <running>:   Framed-MTU = 1400
(18) <running>:   EAP-Message = 0x023d006b19001703010060e7b93295273d97b1282bc6f75e1692c8576d004741623028ccf12e31d3d8cac62f6838be7c93ad3c7f8016de547d05d76d637a6b172801bd646447bd99ff8b92e157ea635e766dc3f92eb8ce8bbc47c842accb83cba519487022b91292906b7d
(18) <running>:   State = 0x2259021125641baf655a133202c8e0d2
(18) <running>:   Message-Authenticator = 0x9fd689e265eb8b936e21c027c66f4f00
(18) <running>: session-state: No cached attributes
(18) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(18) <running>:   authorize {
(18) <running>:     policy filter_username {
(18) <running>:       if (!&User-Name) {
(18) <running>:       if (!&User-Name)  -> FALSE
(18) <running>:       if (&User-Name =~ / /) {
(18) <running>:       if (&User-Name =~ / /)  -> FALSE
(18) <running>:       if (&User-Name =~ /@.*@/ ) {
(18) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(18) <running>:       if (&User-Name =~ /\.\./ ) {
(18) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(18) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(18) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(18) <running>:       if (&User-Name =~ /\.$/)  {
(18) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(18) <running>:       if (&User-Name =~ /@\./)  {
(18) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(18) <running>:     } # policy filter_username = notfound
(18)     [preprocess] = ok
(18)     [chap] = noop
(18)     [mschap] = noop
(18)     [digest] = noop
(18) suffix: Checking for suffix after "@"
(18) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(18) suffix: No such realm "NULL"
(18)     [suffix] = noop
(18) eap: Peer sent EAP Response (code 2) ID 61 length 107
(18) eap: Continuing tunnel setup
(18)     [eap] = ok
(18)   } # authorize = ok
(18) Found Auth-Type = EAP
(18) # Executing group from file /etc/freeradius/sites-enabled/default
(18)   authenticate {
(18) eap: Expiring EAP session with state 0x4582de8145bfc4fc
(18) eap: Finished EAP session with state 0x2259021125641baf
(18) eap: Previous EAP request found for state 0x2259021125641baf, released from the list
(18) eap: Peer sent packet with method EAP PEAP (25)
(18) eap: Calling submodule eap_peap to process data
(18) eap_peap: Continuing EAP-TLS
(18) eap_peap: [eaptls verify] = ok
(18) eap_peap: Done initial handshake
(18) eap_peap: [eaptls process] = ok
(18) eap_peap: Session established.  Decoding tunneled attributes
(18) eap_peap: PEAP state phase2
(18) eap_peap: EAP method MSCHAPv2 (26)
(18) eap_peap: Got tunneled request
(18) eap_peap:   EAP-Message = 0x023d00421a023d003d31a55fd7d12e3d8acb4a35e6e24b729ec5000000000000000035cd2db0194cec8de0949e5d14cf422610690c22b76158e600656d6972757373
(18) eap_peap: Setting User-Name to emiruss
(18) eap_peap: Sending tunneled request to inner-tunnel
(18) eap_peap:   EAP-Message = 0x023d00421a023d003d31a55fd7d12e3d8acb4a35e6e24b729ec5000000000000000035cd2db0194cec8de0949e5d14cf422610690c22b76158e600656d6972757373
(18) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(18) eap_peap:   User-Name = "emiruss"
(18) eap_peap:   State = 0x4582de8145bfc4fcaa63e965f8e6527e
(18) Virtual server inner-tunnel received request
(18)   EAP-Message = 0x023d00421a023d003d31a55fd7d12e3d8acb4a35e6e24b729ec5000000000000000035cd2db0194cec8de0949e5d14cf422610690c22b76158e600656d6972757373
(18)   FreeRADIUS-Proxied-To = 127.0.0.1
(18)   User-Name = "emiruss"
(18)   State = 0x4582de8145bfc4fcaa63e965f8e6527e
(18) server inner-tunnel {
(18)   session-state: No cached attributes
(18)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(18)     authorize {
(18)       [chap] = noop
(18)       [mschap] = noop
(18) suffix: Checking for suffix after "@"
(18) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(18) suffix: No such realm "NULL"
(18)       [suffix] = noop
(18)       update control {
(18)         &Proxy-To-Realm := LOCAL
(18)       } # update control = noop
(18) eap: Peer sent EAP Response (code 2) ID 61 length 66
(18) eap: No EAP Start, assuming it's an on-going EAP conversation
(18)       [eap] = updated
(18)       [files] = noop
(18)       [expiration] = noop
(18)       [logintime] = noop
(18)       [pap] = noop
(18)     } # authorize = updated
(18)   Found Auth-Type = EAP
(18)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(18)     authenticate {
(18) eap: Expiring EAP session with state 0x4582de8145bfc4fc
(18) eap: Finished EAP session with state 0x4582de8145bfc4fc
(18) eap: Previous EAP request found for state 0x4582de8145bfc4fc, released from the list
(18) eap: Peer sent packet with method EAP MSCHAPv2 (26)
(18) eap: Calling submodule eap_mschapv2 to process data
(18) eap_mschapv2: # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(18) eap_mschapv2:   Auth-Type MS-CHAP {
(18) mschap: WARNING: No Cleartext-Password configured.  Cannot create NT-Password
(18) mschap: WARNING: No Cleartext-Password configured.  Cannot create LM-Password
(18) mschap: Creating challenge hash with username: emiruss
(18) mschap: Client is using MS-CHAPv2
(18) mschap: ERROR: FAILED: No NT/LM-Password.  Cannot perform authentication
(18) mschap: ERROR: MS-CHAP2-Response is incorrect
(18)     [mschap] = reject
(18)   } # Auth-Type MS-CHAP = reject
(18) eap: Sending EAP Failure (code 4) ID 61 length 4
(18) eap: Freeing handler
(18)       [eap] = reject
(18)     } # authenticate = reject
(18)   Failed to authenticate the user
(18)   Using Post-Auth-Type Reject
(18)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(18)     Post-Auth-Type REJECT {
(18) attr_filter.access_reject: EXPAND %{User-Name}
(18) attr_filter.access_reject:    --> emiruss
(18) attr_filter.access_reject: Matched entry DEFAULT at line 11
(18)       [attr_filter.access_reject] = updated
(18)       update outer.session-state {
(18)         &Module-Failure-Message := &request:Module-Failure-Message -> 'mschap: FAILED: No NT/LM-Password.  Cannot perform authentication'
(18)       } # update outer.session-state = noop
(18)     } # Post-Auth-Type REJECT = updated
(18) } # server inner-tunnel
(18) Virtual server sending reply
(18)   MS-CHAP-Error = "=E=691 R=1 C=8fb2e6efdb42846a931520ed623de798 V=3 M=Authentication failed"
(18)   EAP-Message = 0x043d0004
(18)   Message-Authenticator = 0x00000000000000000000000000000000
(18) eap_peap: Got tunneled reply code 3
(18) eap_peap:   MS-CHAP-Error = "=E=691 R=1 C=8fb2e6efdb42846a931520ed623de798 V=3 M=Authentication failed"
(18) eap_peap:   EAP-Message = 0x043d0004
(18) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(18) eap_peap: Tunneled authentication was rejected
(18) eap_peap: FAILURE
(18) eap: Sending EAP Request (code 1) ID 62 length 43
(18) eap: EAP session adding &reply:State = 0x225902112a671baf
(18)     [eap] = handled
(18)   } # authenticate = handled
(18) Using Post-Auth-Type Challenge
(18) Post-Auth-Type sub-section not found.  Ignoring.
(18) # Executing group from file /etc/freeradius/sites-enabled/default
(18) session-state: Saving cached attributes
(18)   Module-Failure-Message := "mschap: FAILED: No NT/LM-Password.  Cannot perform authentication"
(18) Sent Access-Challenge Id 83 from 172.17.0.4:1812 to 192.168.1.30:50039 length 0
(18)   EAP-Message = 0x013e002b1900170301002039776c36216164eeea611a1936b88eea2455ae86452598f6de86a6de1fb9a5b0
(18)   Message-Authenticator = 0x00000000000000000000000000000000
(18)   State = 0x225902112a671baf655a133202c8e0d2
(18) Finished request
Thread 1 waiting to be assigned a request
Thread 2 got semaphore
Thread 2 handling request 19, (4 handled so far)
(19) <running>: Received Access-Request Id 84 from 192.168.1.30:50039 to 172.17.0.4:1812 length 239
(19) <running>:   User-Name = "emiruss"
(19) <running>:   NAS-IP-Address = 192.168.1.30
(19) <running>:   NAS-Identifier = "Ericsson"
(19) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(19) <running>:   NAS-Port-Type = Wireless-802.11
(19) <running>:   NAS-Port = 0
(19) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(19) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(19) <running>:   Acct-Session-Id = "003E2DE6-00000049"
(19) <running>:   Framed-MTU = 1400
(19) <running>:   EAP-Message = 0x023e002b190017030100208b3c5a932af8a67bc62ad4d4f966047fa5b190ad20a3bc960f7a0f65c883a16c
(19) <running>:   State = 0x225902112a671baf655a133202c8e0d2
(19) <running>:   Message-Authenticator = 0x8ce0ec072ab0b0686729c6b2d74ac4ba
(19) <running>: session-state: Found cached attributes
(19) <running>:   Module-Failure-Message := "mschap: FAILED: No NT/LM-Password.  Cannot perform authentication"
(19) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(19) <running>:   authorize {
(19) <running>:     policy filter_username {
(19) <running>:       if (!&User-Name) {
(19) <running>:       if (!&User-Name)  -> FALSE
(19) <running>:       if (&User-Name =~ / /) {
(19) <running>:       if (&User-Name =~ / /)  -> FALSE
(19) <running>:       if (&User-Name =~ /@.*@/ ) {
(19) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(19) <running>:       if (&User-Name =~ /\.\./ ) {
(19) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(19) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(19) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(19) <running>:       if (&User-Name =~ /\.$/)  {
(19) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(19) <running>:       if (&User-Name =~ /@\./)  {
(19) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(19) <running>:     } # policy filter_username = notfound
(19)     [preprocess] = ok
(19)     [chap] = noop
(19)     [mschap] = noop
(19)     [digest] = noop
(19) suffix: Checking for suffix after "@"
(19) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(19) suffix: No such realm "NULL"
(19)     [suffix] = noop
(19) eap: Peer sent EAP Response (code 2) ID 62 length 43
(19) eap: Continuing tunnel setup
(19)     [eap] = ok
(19)   } # authorize = ok
(19) Found Auth-Type = EAP
(19) # Executing group from file /etc/freeradius/sites-enabled/default
(19)   authenticate {
(19) eap: Expiring EAP session with state 0x225902112a671baf
(19) eap: Finished EAP session with state 0x225902112a671baf
(19) eap: Previous EAP request found for state 0x225902112a671baf, released from the list
(19) eap: Peer sent packet with method EAP PEAP (25)
(19) eap: Calling submodule eap_peap to process data
(19) eap_peap: Continuing EAP-TLS
(19) eap_peap: [eaptls verify] = ok
(19) eap_peap: Done initial handshake
(19) eap_peap: [eaptls process] = ok
(19) eap_peap: Session established.  Decoding tunneled attributes
(19) eap_peap: PEAP state send tlv failure
(19) eap_peap: Received EAP-TLV response
(19) eap_peap:   The users session was previously rejected: returning reject (again.)
(19) eap_peap:   This means you need to read the PREVIOUS messages in the debug output
(19) eap_peap:   to find out the reason why the user was rejected
(19) eap_peap:   Look for "reject" or "fail".  Those earlier messages will tell you
(19) eap_peap:   what went wrong, and how to fix the problem
(19) eap: ERROR: Failed continuing EAP PEAP (25) session.  EAP sub-module failed
(19) eap: Sending EAP Failure (code 4) ID 62 length 4
(19) eap: Failed in EAP select
(19)     [eap] = invalid
(19)   } # authenticate = invalid
(19) Failed to authenticate the user
(19) Using Post-Auth-Type Reject
(19) # Executing group from file /etc/freeradius/sites-enabled/default
(19)   Post-Auth-Type REJECT {
(19) attr_filter.access_reject: EXPAND %{User-Name}
(19) attr_filter.access_reject:    --> emiruss
(19) attr_filter.access_reject: Matched entry DEFAULT at line 11
(19)     [attr_filter.access_reject] = updated
(19)     [eap] = noop
(19)     policy remove_reply_message_if_eap {
(19)       if (&reply:EAP-Message && &reply:Reply-Message) {
(19)       if (&reply:EAP-Message && &reply:Reply-Message)  -> FALSE
(19)       else {
(19)         [noop] = noop
(19)       } # else = noop
(19)     } # policy remove_reply_message_if_eap = noop
(19)   } # Post-Auth-Type REJECT = updated
(19) Delaying response for 1.000000 seconds
Thread 2 waiting to be assigned a request
(19) Discarding duplicate request from client roocell-ap port 50039 - ID: 84 due to delayed response
Waking up in 0.6 seconds.
(19) Sending delayed response
(19) Sent Access-Reject Id 84 from 172.17.0.4:1812 to 192.168.1.30:50039 length 44
(19)   EAP-Message = 0x043e0004
(19)   Message-Authenticator = 0x00000000000000000000000000000000
Waking up in 2.4 seconds.
(0) Cleaning up request packet ID 65 with timestamp +5
(1) Cleaning up request packet ID 66 with timestamp +6
(2) Cleaning up request packet ID 67 with timestamp +6
(3) Cleaning up request packet ID 68 with timestamp +6
(4) Cleaning up request packet ID 69 with timestamp +6
Waking up in 0.1 seconds.
(5) Cleaning up request packet ID 70 with timestamp +6
(6) Cleaning up request packet ID 71 with timestamp +6
(7) Cleaning up request packet ID 72 with timestamp +6
(8) Cleaning up request packet ID 73 with timestamp +6
(9) Cleaning up request packet ID 74 with timestamp +6
Waking up in 0.8 seconds.
Thread 5 got semaphore
Thread 5 handling request 20, (5 handled so far)
(20) <running>: Received Access-Request Id 85 from 192.168.1.30:50040 to 172.17.0.4:1812 length 184
(20) <running>:   User-Name = "mike"
(20) <running>:   NAS-IP-Address = 192.168.1.30
(20) <running>:   NAS-Identifier = "Ericsson"
(20) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(20) <running>:   NAS-Port-Type = Wireless-802.11
(20) <running>:   NAS-Port = 0
(20) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(20) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(20) <running>:   Acct-Session-Id = "003E2DE6-0000004A"
(20) <running>:   Framed-MTU = 1400
(20) <running>:   EAP-Message = 0x02630009016d696b65
(20) <running>:   Message-Authenticator = 0x981561a30b6577fcb5578d186dc92f3d
(20) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(20) <running>:   authorize {
(20) <running>:     policy filter_username {
(20) <running>:       if (!&User-Name) {
(20) <running>:       if (!&User-Name)  -> FALSE
(20) <running>:       if (&User-Name =~ / /) {
(20) <running>:       if (&User-Name =~ / /)  -> FALSE
(20) <running>:       if (&User-Name =~ /@.*@/ ) {
(20) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(20) <running>:       if (&User-Name =~ /\.\./ ) {
(20) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(20) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(20) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(20) <running>:       if (&User-Name =~ /\.$/)  {
(20) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(20) <running>:       if (&User-Name =~ /@\./)  {
(20) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(20) <running>:     } # policy filter_username = notfound
(20)     [preprocess] = ok
(20)     [chap] = noop
(20)     [mschap] = noop
(20)     [digest] = noop
(20) suffix: Checking for suffix after "@"
(20) suffix: No '@' in User-Name = "mike", looking up realm NULL
Waking up in 0.3 seconds.
(20) suffix: No such realm "NULL"
(20)     [suffix] = noop
(20) eap: Peer sent EAP Response (code 2) ID 99 length 9
(20) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(20)     [eap] = ok
(20)   } # authorize = ok
(20) Found Auth-Type = EAP
(20) # Executing group from file /etc/freeradius/sites-enabled/default
(20)   authenticate {
(20) eap: Peer sent packet with method EAP Identity (1)
(20) eap: Calling submodule eap_md5 to process data
(20) eap_md5: Issuing MD5 Challenge
(20) eap: Sending EAP Request (code 1) ID 100 length 22
(20) eap: EAP session adding &reply:State = 0x0302951d036691fb
(20)     [eap] = handled
(20)   } # authenticate = handled
(20) Using Post-Auth-Type Challenge
(20) Post-Auth-Type sub-section not found.  Ignoring.
(20) # Executing group from file /etc/freeradius/sites-enabled/default
(20) Sent Access-Challenge Id 85 from 172.17.0.4:1812 to 192.168.1.30:50040 length 0
(20)   EAP-Message = 0x016400160410ce8fc382a0198f8ccb6a0f82ab747038
(20)   Message-Authenticator = 0x00000000000000000000000000000000
(20)   State = 0x0302951d036691fb984a4f42c0fe7f5f
(20) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.3 seconds.
Thread 4 got semaphore
Thread 4 handling request 21, (5 handled so far)
(21) <running>: Received Access-Request Id 86 from 192.168.1.30:50040 to 172.17.0.4:1812 length 201
(21) <running>:   User-Name = "mike"
(21) <running>:   NAS-IP-Address = 192.168.1.30
(21) <running>:   NAS-Identifier = "Ericsson"
(21) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(21) <running>:   NAS-Port-Type = Wireless-802.11
(21) <running>:   NAS-Port = 0
(21) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(21) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(21) <running>:   Acct-Session-Id = "003E2DE6-0000004A"
(21) <running>:   Framed-MTU = 1400
(21) <running>:   EAP-Message = 0x026400080319152b
(21) <running>:   State = 0x0302951d036691fb984a4f42c0fe7f5f
(21) <running>:   Message-Authenticator = 0xfc8f4e3fb3458a791ba6c24aa98268ea
(21) <running>: session-state: No cached attributes
(21) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(21) <running>:   authorize {
(21) <running>:     policy filter_username {
(21) <running>:       if (!&User-Name) {
(21) <running>:       if (!&User-Name)  -> FALSE
(21) <running>:       if (&User-Name =~ / /) {
(21) <running>:       if (&User-Name =~ / /)  -> FALSE
(21) <running>:       if (&User-Name =~ /@.*@/ ) {
(21) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(21) <running>:       if (&User-Name =~ /\.\./ ) {
(21) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(21) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(21) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(21) <running>:       if (&User-Name =~ /\.$/)  {
(21) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(21) <running>:       if (&User-Name =~ /@\./)  {
(21) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(21) <running>:     } # policy filter_username = notfound
(21)     [preprocess] = ok
(21)     [chap] = noop
(21)     [mschap] = noop
(21)     [digest] = noop
(21) suffix: Checking for suffix after "@"
(21) suffix: No '@' in User-Name = "mike", looking up realm NULL
(21) suffix: No such realm "NULL"
(21)     [suffix] = noop
(21) eap: Peer sent EAP Response (code 2) ID 100 length 8
(21) eap: No EAP Start, assuming it's an on-going EAP conversation
(21)     [eap] = updated
(21) files: users: Matched entry mike at line 221
(21)     [files] = ok
(21)     [expiration] = noop
(21)     [logintime] = noop
(21) pap: WARNING: Auth-Type already set.  Not setting to PAP
(21)     [pap] = noop
(21)   } # authorize = updated
(21) Found Auth-Type = EAP
(21) # Executing group from file /etc/freeradius/sites-enabled/default
(21)   authenticate {
(21) eap: Expiring EAP session with state 0x0302951d036691fb
(21) eap: Finished EAP session with state 0x0302951d036691fb
(21) eap: Previous EAP request found for state 0x0302951d036691fb, released from the list
(21) eap: Peer sent packet with method EAP NAK (3)
(21) eap: Found mutually acceptable type PEAP (25)
(21) eap: Calling submodule eap_peap to process data
(21) eap_peap: Initiating new EAP-TLS session
(21) eap_peap: [eaptls start] = request
(21) eap: Sending EAP Request (code 1) ID 101 length 6
(21) eap: EAP session adding &reply:State = 0x0302951d02678cfb
(21)     [eap] = handled
(21)   } # authenticate = handled
(21) Using Post-Auth-Type Challenge
(21) Post-Auth-Type sub-section not found.  Ignoring.
(21) # Executing group from file /etc/freeradius/sites-enabled/default
(21) Sent Access-Challenge Id 86 from 172.17.0.4:1812 to 192.168.1.30:50040 length 0
(21)   EAP-Message = 0x016500061920
(21)   Message-Authenticator = 0x00000000000000000000000000000000
(21)   State = 0x0302951d02678cfb984a4f42c0fe7f5f
(21) Finished request
Thread 4 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 3 got semaphore
Thread 3 handling request 22, (5 handled so far)
(22) <running>: Received Access-Request Id 87 from 192.168.1.30:50040 to 172.17.0.4:1812 length 336
(22) <running>:   User-Name = "mike"
(22) <running>:   NAS-IP-Address = 192.168.1.30
(22) <running>:   NAS-Identifier = "Ericsson"
(22) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(22) <running>:   NAS-Port-Type = Wireless-802.11
(22) <running>:   NAS-Port = 0
(22) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(22) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(22) <running>:   Acct-Session-Id = "003E2DE6-0000004A"
(22) <running>:   Framed-MTU = 1400
(22) <running>:   EAP-Message = 0x0265008f19800000008516030100800100007c0301565528401378d9f3f16d873111c7cd3a1e900854b34bd782a3cda3d16cfaa77600003400ffc02cc02bc024c023c00ac009c008c030c02fc028c027c014c013c012009d009c003d003c0035002f000ac007c011000500040100001f000a0008000600
(22) <running>:   State = 0x0302951d02678cfb984a4f42c0fe7f5f
(22) <running>:   Message-Authenticator = 0xf79eca1c923dd33b171f4ed2b5025bb7
(22) <running>: session-state: No cached attributes
(22) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(22) <running>:   authorize {
(22) <running>:     policy filter_username {
(22) <running>:       if (!&User-Name) {
(22) <running>:       if (!&User-Name)  -> FALSE
(22) <running>:       if (&User-Name =~ / /) {
(22) <running>:       if (&User-Name =~ / /)  -> FALSE
(22) <running>:       if (&User-Name =~ /@.*@/ ) {
(22) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(22) <running>:       if (&User-Name =~ /\.\./ ) {
(22) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(22) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(22) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(22) <running>:       if (&User-Name =~ /\.$/)  {
(22) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(22) <running>:       if (&User-Name =~ /@\./)  {
(22) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(22) <running>:     } # policy filter_username = notfound
(22)     [preprocess] = ok
(22)     [chap] = noop
(22)     [mschap] = noop
(22)     [digest] = noop
(22) suffix: Checking for suffix after "@"
(22) suffix: No '@' in User-Name = "mike", looking up realm NULL
(22) suffix: No such realm "NULL"
(22)     [suffix] = noop
(22) eap: Peer sent EAP Response (code 2) ID 101 length 143
(22) eap: Continuing tunnel setup
(22)     [eap] = ok
(22)   } # authorize = ok
(22) Found Auth-Type = EAP
(22) # Executing group from file /etc/freeradius/sites-enabled/default
(22)   authenticate {
(22) eap: Expiring EAP session with state 0x0302951d02678cfb
(22) eap: Finished EAP session with state 0x0302951d02678cfb
(22) eap: Previous EAP request found for state 0x0302951d02678cfb, released from the list
(22) eap: Peer sent packet with method EAP PEAP (25)
(22) eap: Calling submodule eap_peap to process data
(22) eap_peap: Continuing EAP-TLS
(22) eap_peap: Peer indicated complete TLS record size will be 133 bytes
(22) eap_peap: Got complete TLS record (133 bytes)
(22) eap_peap: [eaptls verify] = length included
(22) eap_peap: (other): before/accept initialization
(22) eap_peap: TLS_accept: before/accept initialization
(22) eap_peap: <<< TLS 1.0 Handshake [length 0080], ClientHello 
(22) eap_peap: TLS_accept: SSLv3 read client hello A
(22) eap_peap: >>> TLS 1.0 Handshake [length 0059], ServerHello 
(22) eap_peap: TLS_accept: SSLv3 write server hello A
(22) eap_peap: >>> TLS 1.0 Handshake [length 08d3], Certificate 
(22) eap_peap: TLS_accept: SSLv3 write certificate A
(22) eap_peap: >>> TLS 1.0 Handshake [length 014b], ServerKeyExchange 
(22) eap_peap: TLS_accept: SSLv3 write key exchange A
(22) eap_peap: >>> TLS 1.0 Handshake [length 0004], ServerHelloDone 
(22) eap_peap: TLS_accept: SSLv3 write server done A
(22) eap_peap: TLS_accept: SSLv3 flush data
(22) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(22) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(22) eap_peap: In SSL Handshake Phase
(22) eap_peap: In SSL Accept mode
(22) eap_peap: [eaptls process] = handled
(22) eap: Sending EAP Request (code 1) ID 102 length 1004
(22) eap: EAP session adding &reply:State = 0x0302951d01648cfb
(22)     [eap] = handled
(22)   } # authenticate = handled
(22) Using Post-Auth-Type Challenge
(22) Post-Auth-Type sub-section not found.  Ignoring.
(22) # Executing group from file /etc/freeradius/sites-enabled/default
(22) Sent Access-Challenge Id 87 from 172.17.0.4:1812 to 192.168.1.30:50040 length 0
(22)   EAP-Message = 0x016603ec19c000000a8f16030100590200005503011b9c62a5337c6654d263abbe3ed1e71b2e42351bebec48896e6c78f725e517c5203d5e19f76030ea7b3194b6031c3001b05d0d763e2779907a2cf96478bc383987c01400000dff01000100000b00040300010216030108d30b0008cf0008cc0003de
(22)   Message-Authenticator = 0x00000000000000000000000000000000
(22)   State = 0x0302951d01648cfb984a4f42c0fe7f5f
(22) Finished request
Thread 3 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 1 got semaphore
Thread 1 handling request 23, (5 handled so far)
(23) <running>: Received Access-Request Id 88 from 192.168.1.30:50040 to 172.17.0.4:1812 length 199
(23) <running>:   User-Name = "mike"
(23) <running>:   NAS-IP-Address = 192.168.1.30
(23) <running>:   NAS-Identifier = "Ericsson"
(23) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(23) <running>:   NAS-Port-Type = Wireless-802.11
(23) <running>:   NAS-Port = 0
(23) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(23) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(23) <running>:   Acct-Session-Id = "003E2DE6-0000004A"
(23) <running>:   Framed-MTU = 1400
(23) <running>:   EAP-Message = 0x026600061900
(23) <running>:   State = 0x0302951d01648cfb984a4f42c0fe7f5f
(23) <running>:   Message-Authenticator = 0xb250fceb181aa8d58da4dc4a27d66eba
(23) <running>: session-state: No cached attributes
(23) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(23) <running>:   authorize {
(23) <running>:     policy filter_username {
(23) <running>:       if (!&User-Name) {
(23) <running>:       if (!&User-Name)  -> FALSE
(23) <running>:       if (&User-Name =~ / /) {
(23) <running>:       if (&User-Name =~ / /)  -> FALSE
(23) <running>:       if (&User-Name =~ /@.*@/ ) {
(23) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(23) <running>:       if (&User-Name =~ /\.\./ ) {
(23) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(23) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(23) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(23) <running>:       if (&User-Name =~ /\.$/)  {
(23) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(23) <running>:       if (&User-Name =~ /@\./)  {
(23) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(23) <running>:     } # policy filter_username = notfound
(23)     [preprocess] = ok
(23)     [chap] = noop
(23)     [mschap] = noop
(23)     [digest] = noop
(23) suffix: Checking for suffix after "@"
(23) suffix: No '@' in User-Name = "mike", looking up realm NULL
(23) suffix: No such realm "NULL"
(23)     [suffix] = noop
(23) eap: Peer sent EAP Response (code 2) ID 102 length 6
(23) eap: Continuing tunnel setup
(23)     [eap] = ok
(23)   } # authorize = ok
(23) Found Auth-Type = EAP
(23) # Executing group from file /etc/freeradius/sites-enabled/default
(23)   authenticate {
(23) eap: Expiring EAP session with state 0x0302951d01648cfb
(23) eap: Finished EAP session with state 0x0302951d01648cfb
(23) eap: Previous EAP request found for state 0x0302951d01648cfb, released from the list
(23) eap: Peer sent packet with method EAP PEAP (25)
(23) eap: Calling submodule eap_peap to process data
(23) eap_peap: Continuing EAP-TLS
(23) eap_peap: Peer ACKed our handshake fragment
(23) eap_peap: [eaptls verify] = request
(23) eap_peap: [eaptls process] = handled
(23) eap: Sending EAP Request (code 1) ID 103 length 1000
(23) eap: EAP session adding &reply:State = 0x0302951d00658cfb
(23)     [eap] = handled
(23)   } # authenticate = handled
(23) Using Post-Auth-Type Challenge
(23) Post-Auth-Type sub-section not found.  Ignoring.
(23) # Executing group from file /etc/freeradius/sites-enabled/default
(23) Sent Access-Challenge Id 88 from 172.17.0.4:1812 to 192.168.1.30:50040 length 0
(23)   EAP-Message = 0x016703e819400dd0405955c762981948527048701681d313d3cc6629a5557b66df2aae22c8590ab99d66ec8d3792a72e30596410f5d1e81f5a774969a1ce9ad6bd01d42da65536016e80a905c662a71ef5c075b8bdf0127a0cf1bd4c91290e15edffa035febde0185096bdc1e553090004e8308204e430
(23)   Message-Authenticator = 0x00000000000000000000000000000000
(23)   State = 0x0302951d00658cfb984a4f42c0fe7f5f
(23) Finished request
Thread 1 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 2 got semaphore
Thread 2 handling request 24, (5 handled so far)
(24) <running>: Received Access-Request Id 89 from 192.168.1.30:50040 to 172.17.0.4:1812 length 199
(24) <running>:   User-Name = "mike"
(24) <running>:   NAS-IP-Address = 192.168.1.30
(24) <running>:   NAS-Identifier = "Ericsson"
(24) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(24) <running>:   NAS-Port-Type = Wireless-802.11
(24) <running>:   NAS-Port = 0
(24) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(24) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(24) <running>:   Acct-Session-Id = "003E2DE6-0000004A"
(24) <running>:   Framed-MTU = 1400
(24) <running>:   EAP-Message = 0x026700061900
(24) <running>:   State = 0x0302951d00658cfb984a4f42c0fe7f5f
(24) <running>:   Message-Authenticator = 0x830d97cefe437683655136e6b6d607a3
(24) <running>: session-state: No cached attributes
(24) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(24) <running>:   authorize {
(24) <running>:     policy filter_username {
(24) <running>:       if (!&User-Name) {
(24) <running>:       if (!&User-Name)  -> FALSE
(24) <running>:       if (&User-Name =~ / /) {
(24) <running>:       if (&User-Name =~ / /)  -> FALSE
(24) <running>:       if (&User-Name =~ /@.*@/ ) {
(24) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(24) <running>:       if (&User-Name =~ /\.\./ ) {
(24) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(24) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(24) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(24) <running>:       if (&User-Name =~ /\.$/)  {
(24) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(24) <running>:       if (&User-Name =~ /@\./)  {
(24) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(24) <running>:     } # policy filter_username = notfound
(24)     [preprocess] = ok
(24)     [chap] = noop
(24)     [mschap] = noop
(24)     [digest] = noop
(24) suffix: Checking for suffix after "@"
(24) suffix: No '@' in User-Name = "mike", looking up realm NULL
(24) suffix: No such realm "NULL"
(24)     [suffix] = noop
(24) eap: Peer sent EAP Response (code 2) ID 103 length 6
(24) eap: Continuing tunnel setup
(24)     [eap] = ok
(24)   } # authorize = ok
(24) Found Auth-Type = EAP
(24) # Executing group from file /etc/freeradius/sites-enabled/default
(24)   authenticate {
(24) eap: Expiring EAP session with state 0x0302951d00658cfb
(24) eap: Finished EAP session with state 0x0302951d00658cfb
(24) eap: Previous EAP request found for state 0x0302951d00658cfb, released from the list
(24) eap: Peer sent packet with method EAP PEAP (25)
(24) eap: Calling submodule eap_peap to process data
(24) eap_peap: Continuing EAP-TLS
(24) eap_peap: Peer ACKed our handshake fragment
(24) eap_peap: [eaptls verify] = request
(24) eap_peap: [eaptls process] = handled
(24) eap: Sending EAP Request (code 1) ID 104 length 721
(24) eap: EAP session adding &reply:State = 0x0302951d076a8cfb
(24)     [eap] = handled
(24)   } # authenticate = handled
(24) Using Post-Auth-Type Challenge
(24) Post-Auth-Type sub-section not found.  Ignoring.
(24) # Executing group from file /etc/freeradius/sites-enabled/default
(24) Sent Access-Challenge Id 89 from 172.17.0.4:1812 to 192.168.1.30:50040 length 0
(24)   EAP-Message = 0x016802d1190020417574686f72697479820900c3fc536eef83d741300f0603551d130101ff040530030101ff30360603551d1f042f302d302ba029a0278625687474703a2f2f7777772e6578616d706c652e6f72672f6578616d706c655f63612e63726c300d06092a864886f70d01010b050003820101
(24)   Message-Authenticator = 0x00000000000000000000000000000000
(24)   State = 0x0302951d076a8cfb984a4f42c0fe7f5f
(24) Finished request
Thread 2 waiting to be assigned a request
(10) Cleaning up request packet ID 75 with timestamp +7
(11) Cleaning up request packet ID 76 with timestamp +7
Thread 5 got semaphore
Thread 5 handling request 25, (6 handled so far)
(25) <running>: Received Access-Request Id 90 from 192.168.1.30:50040 to 172.17.0.4:1812 length 337
(25) <running>:   User-Name = "mike"
(25) <running>:   NAS-IP-Address = 192.168.1.30
(25) <running>:   NAS-Identifier = "Ericsson"
(25) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(25) <running>:   NAS-Port-Type = Wireless-802.11
(25) <running>:   NAS-Port = 0
(25) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(25) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(25) <running>:   Acct-Session-Id = "003E2DE6-0000004A"
(25) <running>:   Framed-MTU = 1400
(25) <running>:   EAP-Message = 0x026800901980000000861603010046100000424104cba6de3d6b25778ad4a3e48f31ccea947c81baac154a1f86be0471ae48240ff1a91271f2eb72c19cc92b7ec585f4775c347c4dd4e2f7d2dbfe47d5541a7f32221403010001011603010030360ad5b3bbe944ec5c3f0ffb8022cd3a9ed846b39987d1
(25) <running>:   State = 0x0302951d076a8cfb984a4f42c0fe7f5f
(25) <running>:   Message-Authenticator = 0xfdc0f499d4e93f25f1706fc80d4792cc
(25) <running>: session-state: No cached attributes
(25) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(25) <running>:   authorize {
(25) <running>:     policy filter_username {
(25) <running>:       if (!&User-Name) {
(25) <running>:       if (!&User-Name)  -> FALSE
(25) <running>:       if (&User-Name =~ / /) {
(25) <running>:       if (&User-Name =~ / /)  -> FALSE
(25) <running>:       if (&User-Name =~ /@.*@/ ) {
(25) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(25) <running>:       if (&User-Name =~ /\.\./ ) {
(25) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(25) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(25) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(25) <running>:       if (&User-Name =~ /\.$/)  {
(25) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(25) <running>:       if (&User-Name =~ /@\./)  {
(25) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(25) <running>:     } # policy filter_username = notfound
(25)     [preprocess] = ok
(25)     [chap] = noop
(25)     [mschap] = noop
(25)     [digest] = noop
(25) suffix: Checking for suffix after "@"
(25) suffix: No '@' in User-Name = "mike", looking up realm NULL
(25) suffix: No such realm "NULL"
(25)     [suffix] = noop
(25) eap: Peer sent EAP Response (code 2) ID 104 length 144
(25) eap: Continuing tunnel setup
(25)     [eap] = ok
(25)   } # authorize = ok
(25) Found Auth-Type = EAP
(25) # Executing group from file /etc/freeradius/sites-enabled/default
(25)   authenticate {
(25) eap: Expiring EAP session with state 0x0302951d076a8cfb
(25) eap: Finished EAP session with state 0x0302951d076a8cfb
(25) eap: Previous EAP request found for state 0x0302951d076a8cfb, released from the list
(25) eap: Peer sent packet with method EAP PEAP (25)
(25) eap: Calling submodule eap_peap to process data
(25) eap_peap: Continuing EAP-TLS
(25) eap_peap: Peer indicated complete TLS record size will be 134 bytes
(25) eap_peap: Got complete TLS record (134 bytes)
(25) eap_peap: [eaptls verify] = length included
(25) eap_peap: <<< TLS 1.0 Handshake [length 0046], ClientKeyExchange 
(25) eap_peap: TLS_accept: SSLv3 read client key exchange A
(25) eap_peap: <<< TLS 1.0 ChangeCipherSpec [length 0001] 
(25) eap_peap: <<< TLS 1.0 Handshake [length 0010], Finished 
(25) eap_peap: TLS_accept: SSLv3 read finished A
(25) eap_peap: >>> TLS 1.0 ChangeCipherSpec [length 0001] 
(25) eap_peap: TLS_accept: SSLv3 write change cipher spec A
(25) eap_peap: >>> TLS 1.0 Handshake [length 0010], Finished 
(25) eap_peap: TLS_accept: SSLv3 write finished A
(25) eap_peap: TLS_accept: SSLv3 flush data
(25) eap_peap: (other): SSL negotiation finished successfully
(25) eap_peap: SSL Connection Established
(25) eap_peap: [eaptls process] = handled
(25) eap: Sending EAP Request (code 1) ID 105 length 65
(25) eap: EAP session adding &reply:State = 0x0302951d066b8cfb
(25)     [eap] = handled
(25)   } # authenticate = handled
(25) Using Post-Auth-Type Challenge
(25) Post-Auth-Type sub-section not found.  Ignoring.
(25) # Executing group from file /etc/freeradius/sites-enabled/default
(25) Sent Access-Challenge Id 90 from 172.17.0.4:1812 to 192.168.1.30:50040 length 0
(25)   EAP-Message = 0x01690041190014030100010116030100305211de6c02e0738bbe76cfbbc1e99c14e61e27572b513164f14f63cf20e983eb3154c08dcbc54946ee9ee713cefcfb61
(25)   Message-Authenticator = 0x00000000000000000000000000000000
(25)   State = 0x0302951d066b8cfb984a4f42c0fe7f5f
(25) Finished request
Thread 5 waiting to be assigned a request
Thread 4 got semaphore
Thread 4 handling request 26, (6 handled so far)
(26) <running>: Received Access-Request Id 91 from 192.168.1.30:50040 to 172.17.0.4:1812 length 199
(26) <running>:   User-Name = "mike"
(26) <running>:   NAS-IP-Address = 192.168.1.30
(26) <running>:   NAS-Identifier = "Ericsson"
(26) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(26) <running>:   NAS-Port-Type = Wireless-802.11
(26) <running>:   NAS-Port = 0
(26) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(26) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(26) <running>:   Acct-Session-Id = "003E2DE6-0000004A"
(26) <running>:   Framed-MTU = 1400
(26) <running>:   EAP-Message = 0x026900061900
(26) <running>:   State = 0x0302951d066b8cfb984a4f42c0fe7f5f
(26) <running>:   Message-Authenticator = 0x3c33927bc5967bfc81763797b11610c3
(26) <running>: session-state: No cached attributes
(26) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(26) <running>:   authorize {
(26) <running>:     policy filter_username {
(26) <running>:       if (!&User-Name) {
(26) <running>:       if (!&User-Name)  -> FALSE
(26) <running>:       if (&User-Name =~ / /) {
(26) <running>:       if (&User-Name =~ / /)  -> FALSE
(26) <running>:       if (&User-Name =~ /@.*@/ ) {
(26) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(26) <running>:       if (&User-Name =~ /\.\./ ) {
(26) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(26) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(26) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(26) <running>:       if (&User-Name =~ /\.$/)  {
(26) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(26) <running>:       if (&User-Name =~ /@\./)  {
(26) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(26) <running>:     } # policy filter_username = notfound
(26)     [preprocess] = ok
(26)     [chap] = noop
(26)     [mschap] = noop
(26)     [digest] = noop
(26) suffix: Checking for suffix after "@"
(26) suffix: No '@' in User-Name = "mike", looking up realm NULL
(26) suffix: No such realm "NULL"
(26)     [suffix] = noop
(26) eap: Peer sent EAP Response (code 2) ID 105 length 6
(26) eap: Continuing tunnel setup
(26)     [eap] = ok
(26)   } # authorize = ok
(26) Found Auth-Type = EAP
(26) # Executing group from file /etc/freeradius/sites-enabled/default
(26)   authenticate {
(26) eap: Expiring EAP session with state 0x0302951d066b8cfb
(26) eap: Finished EAP session with state 0x0302951d066b8cfb
(26) eap: Previous EAP request found for state 0x0302951d066b8cfb, released from the list
(26) eap: Peer sent packet with method EAP PEAP (25)
(26) eap: Calling submodule eap_peap to process data
(26) eap_peap: Continuing EAP-TLS
(26) eap_peap: Peer ACKed our handshake fragment.  handshake is finished
(26) eap_peap: [eaptls verify] = success
(26) eap_peap: [eaptls process] = success
(26) eap_peap: Session established.  Decoding tunneled attributes
(26) eap_peap: PEAP state TUNNEL ESTABLISHED
(26) eap: Sending EAP Request (code 1) ID 106 length 43
(26) eap: EAP session adding &reply:State = 0x0302951d05688cfb
(26)     [eap] = handled
(26)   } # authenticate = handled
(26) Using Post-Auth-Type Challenge
(12) Cleaning up request packet ID 77 with timestamp +7
(26) Post-Auth-Type sub-section not found.  Ignoring.
(26) # Executing group from file /etc/freeradius/sites-enabled/default
(26) Sent Access-Challenge Id 91 from 172.17.0.4:1812 to 192.168.1.30:50040 length 0
(26)   EAP-Message = 0x016a002b1900170301002028789a703fc6d710def0c62f1b088fb80ea70368435f7ed42fe73ff7609f763a
(26)   Message-Authenticator = 0x00000000000000000000000000000000
(26)   State = 0x0302951d05688cfb984a4f42c0fe7f5f
(26) Finished request
Thread 4 waiting to be assigned a request
Thread 3 got semaphore
Thread 3 handling request 27, (6 handled so far)
(27) <running>: Received Access-Request Id 92 from 192.168.1.30:50040 to 172.17.0.4:1812 length 236
(27) <running>:   User-Name = "mike"
(27) <running>:   NAS-IP-Address = 192.168.1.30
(27) <running>:   NAS-Identifier = "Ericsson"
(27) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(27) <running>:   NAS-Port-Type = Wireless-802.11
(27) <running>:   NAS-Port = 0
(27) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(27) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(27) <running>:   Acct-Session-Id = "003E2DE6-0000004A"
(27) <running>:   Framed-MTU = 1400
(27) <running>:   EAP-Message = 0x026a002b19001703010020fec3ae9987a613b69e8affeeb41fadda2b94970d50616af9eaf97a34346756bf
(27) <running>:   State = 0x0302951d05688cfb984a4f42c0fe7f5f
(27) <running>:   Message-Authenticator = 0x51b0fd087ff35a3a70103d98d6f65cb9
(27) <running>: session-state: No cached attributes
(27) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(27) <running>:   authorize {
(27) <running>:     policy filter_username {
(27) <running>:       if (!&User-Name) {
(27) <running>:       if (!&User-Name)  -> FALSE
(27) <running>:       if (&User-Name =~ / /) {
(27) <running>:       if (&User-Name =~ / /)  -> FALSE
(27) <running>:       if (&User-Name =~ /@.*@/ ) {
(27) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(27) <running>:       if (&User-Name =~ /\.\./ ) {
(27) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(27) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(27) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(27) <running>:       if (&User-Name =~ /\.$/)  {
(27) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(27) <running>:       if (&User-Name =~ /@\./)  {
(27) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(27) <running>:     } # policy filter_username = notfound
(27)     [preprocess] = ok
(27)     [chap] = noop
(27)     [mschap] = noop
(27)     [digest] = noop
(27) suffix: Checking for suffix after "@"
(27) suffix: No '@' in User-Name = "mike", looking up realm NULL
(27) suffix: No such realm "NULL"
(27)     [suffix] = noop
(27) eap: Peer sent EAP Response (code 2) ID 106 length 43
(27) eap: Continuing tunnel setup
(27)     [eap] = ok
(27)   } # authorize = ok
(27) Found Auth-Type = EAP
(27) # Executing group from file /etc/freeradius/sites-enabled/default
(27)   authenticate {
(27) eap: Expiring EAP session with state 0x0302951d05688cfb
(27) eap: Finished EAP session with state 0x0302951d05688cfb
(27) eap: Previous EAP request found for state 0x0302951d05688cfb, released from the list
(27) eap: Peer sent packet with method EAP PEAP (25)
(27) eap: Calling submodule eap_peap to process data
(27) eap_peap: Continuing EAP-TLS
(27) eap_peap: [eaptls verify] = ok
(27) eap_peap: Done initial handshake
(27) eap_peap: [eaptls process] = ok
(27) eap_peap: Session established.  Decoding tunneled attributes
(27) eap_peap: PEAP state WAITING FOR INNER IDENTITY
(27) eap_peap: Identity - mike
(27) eap_peap: Got inner identity 'mike'
(27) eap_peap: Setting default EAP type for tunneled EAP session
(27) eap_peap: Got tunneled request
(27) eap_peap:   EAP-Message = 0x026a0009016d696b65
(27) eap_peap: Setting User-Name to mike
(27) eap_peap: Sending tunneled request to inner-tunnel
(27) eap_peap:   EAP-Message = 0x026a0009016d696b65
(27) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(27) eap_peap:   User-Name = "mike"
(27) Virtual server inner-tunnel received request
(27)   EAP-Message = 0x026a0009016d696b65
(27)   FreeRADIUS-Proxied-To = 127.0.0.1
(27)   User-Name = "mike"
(27) server inner-tunnel {
(27)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(27)     authorize {
(27)       [chap] = noop
(27)       [mschap] = noop
(27) suffix: Checking for suffix after "@"
(27) suffix: No '@' in User-Name = "mike", looking up realm NULL
(27) suffix: No such realm "NULL"
(27)       [suffix] = noop
(27)       update control {
(27)         &Proxy-To-Realm := LOCAL
(27)       } # update control = noop
(27) eap: Peer sent EAP Response (code 2) ID 106 length 9
(27) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(27)       [eap] = ok
(27)     } # authorize = ok
(27)   Found Auth-Type = EAP
(27)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(27)     authenticate {
(27) eap: Peer sent packet with method EAP Identity (1)
(27) eap: Calling submodule eap_mschapv2 to process data
(27) eap_mschapv2: Issuing Challenge
(27) eap: Sending EAP Request (code 1) ID 107 length 43
(27) eap: EAP session adding &reply:State = 0x0c4542890c2e582f
(27)       [eap] = handled
(27)     } # authenticate = handled
(27) } # server inner-tunnel
(27) Virtual server sending reply
(27)   EAP-Message = 0x016b002b1a016b0026109281adc4d1ff94a81b099eb0980fda3b667265657261646975732d332e302e3130
(27)   Message-Authenticator = 0x00000000000000000000000000000000
(27)   State = 0x0c4542890c2e582f788e5f9d99dd7c40
(27) eap_peap: Got tunneled reply code 11
(27) eap_peap:   EAP-Message = 0x016b002b1a016b0026109281adc4d1ff94a81b099eb0980fda3b667265657261646975732d332e302e3130
(27) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(27) eap_peap:   State = 0x0c4542890c2e582f788e5f9d99dd7c40
(27) eap_peap: Got tunneled Access-Challenge
(27) eap: Sending EAP Request (code 1) ID 107 length 75
(27) eap: EAP session adding &reply:State = 0x0302951d04698cfb
(27)     [eap] = handled
(27)   } # authenticate = handled
(27) Using Post-Auth-Type Challenge
(27) Post-Auth-Type sub-section not found.  Ignoring.
(27) # Executing group from file /etc/freeradius/sites-enabled/default
(27) Sent Access-Challenge Id 92 from 172.17.0.4:1812 to 192.168.1.30:50040 length 0
(27)   EAP-Message = 0x016b004b19001703010040cd37e6dc86f82f66f32afeaf6fcec6e3742a1aacccc6b8ff03999ceb0839b01bb0bb2ed5da069e2fe3a561bfae747cc8857b209fcc4d811c7af47b06581b62f0
(27)   Message-Authenticator = 0x00000000000000000000000000000000
(27)   State = 0x0302951d04698cfb984a4f42c0fe7f5f
(27) Finished request
Thread 3 waiting to be assigned a request
Thread 1 got semaphore
Thread 1 handling request 28, (6 handled so far)
(28) <running>: Received Access-Request Id 93 from 192.168.1.30:50040 to 172.17.0.4:1812 length 284
(28) <running>:   User-Name = "mike"
(28) <running>:   NAS-IP-Address = 192.168.1.30
(28) <running>:   NAS-Identifier = "Ericsson"
(28) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(28) <running>:   NAS-Port-Type = Wireless-802.11
(28) <running>:   NAS-Port = 0
(28) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(28) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(28) <running>:   Acct-Session-Id = "003E2DE6-0000004A"
(28) <running>:   Framed-MTU = 1400
(28) <running>:   EAP-Message = 0x026b005b19001703010050d8a2346ec7be48d2c86d8e55472ad3390ad9ca1a2272235a1d6d8cdd542cd7512d123c1414c0a6aab4eef637b09a6b915c2132be557a1cb375cac54c5cee7f54f62314fed321cc606eed9b688dd89137
(28) <running>:   State = 0x0302951d04698cfb984a4f42c0fe7f5f
(28) <running>:   Message-Authenticator = 0xdf32bac5a811899d8d0eb926ef89ebf4
(28) <running>: session-state: No cached attributes
(28) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(28) <running>:   authorize {
(28) <running>:     policy filter_username {
(28) <running>:       if (!&User-Name) {
(28) <running>:       if (!&User-Name)  -> FALSE
(28) <running>:       if (&User-Name =~ / /) {
(28) <running>:       if (&User-Name =~ / /)  -> FALSE
(28) <running>:       if (&User-Name =~ /@.*@/ ) {
(28) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(28) <running>:       if (&User-Name =~ /\.\./ ) {
(28) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(28) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(28) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(28) <running>:       if (&User-Name =~ /\.$/)  {
(28) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(28) <running>:       if (&User-Name =~ /@\./)  {
(28) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(28) <running>:     } # policy filter_username = notfound
(28)     [preprocess] = ok
(28)     [chap] = noop
(28)     [mschap] = noop
(28)     [digest] = noop
(28) suffix: Checking for suffix after "@"
(28) suffix: No '@' in User-Name = "mike", looking up realm NULL
(28) suffix: No such realm "NULL"
(28)     [suffix] = noop
(28) eap: Peer sent EAP Response (code 2) ID 107 length 91
(28) eap: Continuing tunnel setup
(28)     [eap] = ok
(28)   } # authorize = ok
(28) Found Auth-Type = EAP
(28) # Executing group from file /etc/freeradius/sites-enabled/default
(28)   authenticate {
(28) eap: Expiring EAP session with state 0x0c4542890c2e582f
(28) eap: Finished EAP session with state 0x0302951d04698cfb
(28) eap: Previous EAP request found for state 0x0302951d04698cfb, released from the list
(28) eap: Peer sent packet with method EAP PEAP (25)
(28) eap: Calling submodule eap_peap to process data
(28) eap_peap: Continuing EAP-TLS
(28) eap_peap: [eaptls verify] = ok
(28) eap_peap: Done initial handshake
(28) eap_peap: [eaptls process] = ok
(28) eap_peap: Session established.  Decoding tunneled attributes
(28) eap_peap: PEAP state phase2
(28) eap_peap: EAP method MSCHAPv2 (26)
(28) eap_peap: Got tunneled request
(28) eap_peap:   EAP-Message = 0x026b003f1a026b003a31cba52408f543b2b2e523f5734e70a9490000000000000000f1e808073a905b98ca9684acfae576d7bc54a5a0984ff460006d696b65
(28) eap_peap: Setting User-Name to mike
(28) eap_peap: Sending tunneled request to inner-tunnel
(28) eap_peap:   EAP-Message = 0x026b003f1a026b003a31cba52408f543b2b2e523f5734e70a9490000000000000000f1e808073a905b98ca9684acfae576d7bc54a5a0984ff460006d696b65
(28) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(28) eap_peap:   User-Name = "mike"
(28) eap_peap:   State = 0x0c4542890c2e582f788e5f9d99dd7c40
(28) Virtual server inner-tunnel received request
(28)   EAP-Message = 0x026b003f1a026b003a31cba52408f543b2b2e523f5734e70a9490000000000000000f1e808073a905b98ca9684acfae576d7bc54a5a0984ff460006d696b65
(28)   FreeRADIUS-Proxied-To = 127.0.0.1
(28)   User-Name = "mike"
(28)   State = 0x0c4542890c2e582f788e5f9d99dd7c40
(28) server inner-tunnel {
(28)   session-state: No cached attributes
(28)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(28)     authorize {
(28)       [chap] = noop
(28)       [mschap] = noop
(28) suffix: Checking for suffix after "@"
(28) suffix: No '@' in User-Name = "mike", looking up realm NULL
(28) suffix: No such realm "NULL"
(28)       [suffix] = noop
(28)       update control {
(28)         &Proxy-To-Realm := LOCAL
(28)       } # update control = noop
(28) eap: Peer sent EAP Response (code 2) ID 107 length 63
(28) eap: No EAP Start, assuming it's an on-going EAP conversation
(28)       [eap] = updated
(28) files: users: Matched entry mike at line 221
(28)       [files] = ok
(28)       [expiration] = noop
(28)       [logintime] = noop
(28) pap: WARNING: Auth-Type already set.  Not setting to PAP
(28)       [pap] = noop
(28)     } # authorize = updated
(28)   Found Auth-Type = EAP
(28)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(28)     authenticate {
(28) eap: Expiring EAP session with state 0x0c4542890c2e582f
(28) eap: Finished EAP session with state 0x0c4542890c2e582f
(28) eap: Previous EAP request found for state 0x0c4542890c2e582f, released from the list
(28) eap: Peer sent packet with method EAP MSCHAPv2 (26)
(28) eap: Calling submodule eap_mschapv2 to process data
(28) eap_mschapv2: # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(28) eap_mschapv2:   Auth-Type MS-CHAP {
(28) mschap: Found Cleartext-Password, hashing to create NT-Password
(28) mschap: Found Cleartext-Password, hashing to create LM-Password
(28) mschap: Creating challenge hash with username: mike
(28) mschap: Client is using MS-CHAPv2
(28) mschap: Adding MS-CHAPv2 MPPE keys
(28)     [mschap] = ok
(28)   } # Auth-Type MS-CHAP = ok
(28) MSCHAP Success
(28) eap: Sending EAP Request (code 1) ID 108 length 51
(28) eap: EAP session adding &reply:State = 0x0c4542890d29582f
(28)       [eap] = handled
(28)     } # authenticate = handled
(28) } # server inner-tunnel
(28) Virtual server sending reply
(28)   EAP-Message = 0x016c00331a036b002e533d32343233413946383033394646334544433930344535393037413538434232333131413039394637
(28)   Message-Authenticator = 0x00000000000000000000000000000000
(28)   State = 0x0c4542890d29582f788e5f9d99dd7c40
(28) eap_peap: Got tunneled reply code 11
(28) eap_peap:   EAP-Message = 0x016c00331a036b002e533d32343233413946383033394646334544433930344535393037413538434232333131413039394637
(28) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(28) eap_peap:   State = 0x0c4542890d29582f788e5f9d99dd7c40
(28) eap_peap: Got tunneled Access-Challenge
(28) eap: Sending EAP Request (code 1) ID 108 length 91
(13) Cleaning up request packet ID 78 with timestamp +7
(28) eap: EAP session adding &reply:State = 0x0302951d0b6e8cfb
(28)     [eap] = handled
(28)   } # authenticate = handled
(28) Using Post-Auth-Type Challenge
(28) Post-Auth-Type sub-section not found.  Ignoring.
(28) # Executing group from file /etc/freeradius/sites-enabled/default
(28) Sent Access-Challenge Id 93 from 172.17.0.4:1812 to 192.168.1.30:50040 length 0
(28)   EAP-Message = 0x016c005b190017030100505bf41d66a0db8a75fa9947639964e394a43fab3a462043b436eb2e47aa9acec91ff01109a04590d3bbc271a3b42f01a10528ea920e26080a48423710dfac38a5e0cc4780f1dc6eee67d36fcc188b5a85
(28)   Message-Authenticator = 0x00000000000000000000000000000000
(28)   State = 0x0302951d0b6e8cfb984a4f42c0fe7f5f
(28) Finished request
Thread 1 waiting to be assigned a request
Thread 2 got semaphore
Thread 2 handling request 29, (6 handled so far)
(29) <running>: Received Access-Request Id 94 from 192.168.1.30:50040 to 172.17.0.4:1812 length 236
(29) <running>:   User-Name = "mike"
(29) <running>:   NAS-IP-Address = 192.168.1.30
(29) <running>:   NAS-Identifier = "Ericsson"
(29) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(29) <running>:   NAS-Port-Type = Wireless-802.11
(29) <running>:   NAS-Port = 0
(29) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(29) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(29) <running>:   Acct-Session-Id = "003E2DE6-0000004A"
(29) <running>:   Framed-MTU = 1400
(29) <running>:   EAP-Message = 0x026c002b1900170301002003694751c6c5ac16cec38e511b4fb6d6931872bb9bae29ad57e0d91beaaffee4
(29) <running>:   State = 0x0302951d0b6e8cfb984a4f42c0fe7f5f
(29) <running>:   Message-Authenticator = 0x29e673719b86d7d50e5f43c17b22ecdb
(29) <running>: session-state: No cached attributes
(29) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(29) <running>:   authorize {
(29) <running>:     policy filter_username {
(29) <running>:       if (!&User-Name) {
(29) <running>:       if (!&User-Name)  -> FALSE
(29) <running>:       if (&User-Name =~ / /) {
(29) <running>:       if (&User-Name =~ / /)  -> FALSE
(29) <running>:       if (&User-Name =~ /@.*@/ ) {
(29) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(29) <running>:       if (&User-Name =~ /\.\./ ) {
(29) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(29) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(29) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(29) <running>:       if (&User-Name =~ /\.$/)  {
(29) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(29) <running>:       if (&User-Name =~ /@\./)  {
(29) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(29) <running>:     } # policy filter_username = notfound
(29)     [preprocess] = ok
(29)     [chap] = noop
(29)     [mschap] = noop
(29)     [digest] = noop
(29) suffix: Checking for suffix after "@"
(29) suffix: No '@' in User-Name = "mike", looking up realm NULL
(29) suffix: No such realm "NULL"
(29)     [suffix] = noop
(29) eap: Peer sent EAP Response (code 2) ID 108 length 43
(29) eap: Continuing tunnel setup
(29)     [eap] = ok
(29)   } # authorize = ok
(29) Found Auth-Type = EAP
(29) # Executing group from file /etc/freeradius/sites-enabled/default
(29)   authenticate {
(29) eap: Expiring EAP session with state 0x0c4542890d29582f
(29) eap: Finished EAP session with state 0x0302951d0b6e8cfb
(29) eap: Previous EAP request found for state 0x0302951d0b6e8cfb, released from the list
(29) eap: Peer sent packet with method EAP PEAP (25)
(29) eap: Calling submodule eap_peap to process data
(29) eap_peap: Continuing EAP-TLS
(29) eap_peap: [eaptls verify] = ok
(29) eap_peap: Done initial handshake
(29) eap_peap: [eaptls process] = ok
(29) eap_peap: Session established.  Decoding tunneled attributes
(29) eap_peap: PEAP state phase2
(29) eap_peap: EAP method MSCHAPv2 (26)
(29) eap_peap: Got tunneled request
(29) eap_peap:   EAP-Message = 0x026c00061a03
(29) eap_peap: Setting User-Name to mike
(29) eap_peap: Sending tunneled request to inner-tunnel
(29) eap_peap:   EAP-Message = 0x026c00061a03
(29) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(29) eap_peap:   User-Name = "mike"
(29) eap_peap:   State = 0x0c4542890d29582f788e5f9d99dd7c40
(29) Virtual server inner-tunnel received request
(29)   EAP-Message = 0x026c00061a03
(29)   FreeRADIUS-Proxied-To = 127.0.0.1
(29)   User-Name = "mike"
(29)   State = 0x0c4542890d29582f788e5f9d99dd7c40
(29) server inner-tunnel {
(29)   session-state: No cached attributes
(29)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(29)     authorize {
(29)       [chap] = noop
(29)       [mschap] = noop
(29) suffix: Checking for suffix after "@"
(29) suffix: No '@' in User-Name = "mike", looking up realm NULL
(29) suffix: No such realm "NULL"
(29)       [suffix] = noop
(29)       update control {
(29)         &Proxy-To-Realm := LOCAL
(29)       } # update control = noop
(29) eap: Peer sent EAP Response (code 2) ID 108 length 6
(29) eap: No EAP Start, assuming it's an on-going EAP conversation
(29)       [eap] = updated
(29) files: users: Matched entry mike at line 221
(29)       [files] = ok
(29)       [expiration] = noop
(29)       [logintime] = noop
(29) pap: WARNING: Auth-Type already set.  Not setting to PAP
(29)       [pap] = noop
(29)     } # authorize = updated
(29)   Found Auth-Type = EAP
(29)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(29)     authenticate {
(29) eap: Expiring EAP session with state 0x0c4542890d29582f
(29) eap: Finished EAP session with state 0x0c4542890d29582f
(29) eap: Previous EAP request found for state 0x0c4542890d29582f, released from the list
(29) eap: Peer sent packet with method EAP MSCHAPv2 (26)
(29) eap: Calling submodule eap_mschapv2 to process data
(29) eap: Sending EAP Success (code 3) ID 108 length 4
(29) eap: Freeing handler
(29)       [eap] = ok
(29)     } # authenticate = ok
(29)   # Executing section post-auth from file /etc/freeradius/sites-enabled/inner-tunnel
(29)     post-auth { ... } # empty sub-section is ignored
(29) } # server inner-tunnel
(29) Virtual server sending reply
(29)   MS-MPPE-Encryption-Policy = Encryption-Allowed
(29)   MS-MPPE-Encryption-Types = RC4-40or128-bit-Allowed
(29)   MS-MPPE-Send-Key = 0x3de54d268041638bc889b29a0fc6ac5c
(29)   MS-MPPE-Recv-Key = 0x66f70e0b5775a4de9bc7a75b7ddd7880
(29)   EAP-Message = 0x036c0004
(29)   Message-Authenticator = 0x00000000000000000000000000000000
(29)   User-Name = "mike"
(29) eap_peap: Got tunneled reply code 2
(29) eap_peap:   MS-MPPE-Encryption-Policy = Encryption-Allowed
(29) eap_peap:   MS-MPPE-Encryption-Types = RC4-40or128-bit-Allowed
(29) eap_peap:   MS-MPPE-Send-Key = 0x3de54d268041638bc889b29a0fc6ac5c
(29) eap_peap:   MS-MPPE-Recv-Key = 0x66f70e0b5775a4de9bc7a75b7ddd7880
(29) eap_peap:   EAP-Message = 0x036c0004
(29) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(29) eap_peap:   User-Name = "mike"
(29) eap_peap: Tunneled authentication was successful
(29) eap_peap: SUCCESS
(29) eap: Sending EAP Request (code 1) ID 109 length 43
(29) eap: EAP session adding &reply:State = 0x0302951d0a6f8cfb
(29)     [eap] = handled
(29)   } # authenticate = handled
(29) Using Post-Auth-Type Challenge
(29) Post-Auth-Type sub-section not found.  Ignoring.
(29) # Executing group from file /etc/freeradius/sites-enabled/default
(29) Sent Access-Challenge Id 94 from 172.17.0.4:1812 to 192.168.1.30:50040 length 0
(29)   EAP-Message = 0x016d002b19001703010020a96a72237ec4806ed9712b04f963e12c3f5121ec787e7f1671629bf5928016fa
(29)   Message-Authenticator = 0x00000000000000000000000000000000
(29)   State = 0x0302951d0a6f8cfb984a4f42c0fe7f5f
(29) Finished request
Thread 2 waiting to be assigned a request
Thread 5 got semaphore
Thread 5 handling request 30, (7 handled so far)
(30) <running>: Received Access-Request Id 95 from 192.168.1.30:50040 to 172.17.0.4:1812 length 236
(30) <running>:   User-Name = "mike"
(30) <running>:   NAS-IP-Address = 192.168.1.30
(30) <running>:   NAS-Identifier = "Ericsson"
(30) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(30) <running>:   NAS-Port-Type = Wireless-802.11
(30) <running>:   NAS-Port = 0
(30) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(30) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(30) <running>:   Acct-Session-Id = "003E2DE6-0000004A"
(30) <running>:   Framed-MTU = 1400
(30) <running>:   EAP-Message = 0x026d002b19001703010020da05be65997d87a7ce55d73991cf4b573930881352fa4285058ee988a3ca26ae
(30) <running>:   State = 0x0302951d0a6f8cfb984a4f42c0fe7f5f
(30) <running>:   Message-Authenticator = 0x8772d6d54645aa59e66421af835d7ec3
(30) <running>: session-state: No cached attributes
(30) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(30) <running>:   authorize {
(30) <running>:     policy filter_username {
(30) <running>:       if (!&User-Name) {
(30) <running>:       if (!&User-Name)  -> FALSE
(30) <running>:       if (&User-Name =~ / /) {
(30) <running>:       if (&User-Name =~ / /)  -> FALSE
(30) <running>:       if (&User-Name =~ /@.*@/ ) {
(30) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(30) <running>:       if (&User-Name =~ /\.\./ ) {
(30) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(30) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(30) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(30) <running>:       if (&User-Name =~ /\.$/)  {
(30) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(30) <running>:       if (&User-Name =~ /@\./)  {
(30) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(30) <running>:     } # policy filter_username = notfound
(30)     [preprocess] = ok
(30)     [chap] = noop
(30)     [mschap] = noop
(30)     [digest] = noop
(30) suffix: Checking for suffix after "@"
(30) suffix: No '@' in User-Name = "mike", looking up realm NULL
(30) suffix: No such realm "NULL"
(30)     [suffix] = noop
(30) eap: Peer sent EAP Response (code 2) ID 109 length 43
(30) eap: Continuing tunnel setup
(30)     [eap] = ok
(30)   } # authorize = ok
(30) Found Auth-Type = EAP
(30) # Executing group from file /etc/freeradius/sites-enabled/default
(30)   authenticate {
(30) eap: Expiring EAP session with state 0x0302951d0a6f8cfb
(30) eap: Finished EAP session with state 0x0302951d0a6f8cfb
(30) eap: Previous EAP request found for state 0x0302951d0a6f8cfb, released from the list
(30) eap: Peer sent packet with method EAP PEAP (25)
(30) eap: Calling submodule eap_peap to process data
(30) eap_peap: Continuing EAP-TLS
(30) eap_peap: [eaptls verify] = ok
(30) eap_peap: Done initial handshake
(30) eap_peap: [eaptls process] = ok
(30) eap_peap: Session established.  Decoding tunneled attributes
(30) eap_peap: PEAP state send tlv success
(30) eap_peap: Received EAP-TLV response
(30) eap_peap: Success
(30) eap_peap: No information to cache: session caching will be disabled for session 3d5e19f76030ea7b3194b6031c3001b05d0d763e2779907a2cf96478bc383987
(30) eap: Sending EAP Success (code 3) ID 109 length 4
(30) eap: Freeing handler
(30)     [eap] = ok
(30)   } # authenticate = ok
(30) # Executing section post-auth from file /etc/freeradius/sites-enabled/default
(30)   post-auth {
(30)     update {
(30)       No attributes updated
(30)     } # update = noop
(30)     [exec] = noop
(30)     policy remove_reply_message_if_eap {
(30)       if (&reply:EAP-Message && &reply:Reply-Message) {
(30)       if (&reply:EAP-Message && &reply:Reply-Message)  -> FALSE
(30)       else {
(30)         [noop] = noop
(30)       } # else = noop
(30)     } # policy remove_reply_message_if_eap = noop
(30)   } # post-auth = noop
(30) Sent Access-Accept Id 95 from 172.17.0.4:1812 to 192.168.1.30:50040 length 0
(30)   MS-MPPE-Recv-Key = 0xbb1b8661ebb76fa6a50272fb01516849899f43b0e79a9d386dfceb846158d2aa
(30)   MS-MPPE-Send-Key = 0x2dbb170e0b5442526d27c51077fb52e8a821604f7127d7ebafa4e3f6339bdfc3
(30)   EAP-Message = 0x036d0004
(30)   Message-Authenticator = 0x00000000000000000000000000000000
(30)   User-Name = "mike"
(30) Finished request
Thread 5 waiting to be assigned a request
(14) Cleaning up request packet ID 79 with timestamp +7
(15) Cleaning up request packet ID 80 with timestamp +7
(16) Cleaning up request packet ID 81 with timestamp +7
(17) Cleaning up request packet ID 82 with timestamp +7
(18) Cleaning up request packet ID 83 with timestamp +7
(19) Cleaning up request packet ID 84 with timestamp +7
Waking up in 4.0 seconds.
(20) Cleaning up request packet ID 85 with timestamp +11
(21) Cleaning up request packet ID 86 with timestamp +11
(22) Cleaning up request packet ID 87 with timestamp +11
(23) Cleaning up request packet ID 88 with timestamp +11
(24) Cleaning up request packet ID 89 with timestamp +11
Waking up in 0.4 seconds.
(25) Cleaning up request packet ID 90 with timestamp +12
(26) Cleaning up request packet ID 91 with timestamp +12
(27) Cleaning up request packet ID 92 with timestamp +12
(28) Cleaning up request packet ID 93 with timestamp +12
(29) Cleaning up request packet ID 94 with timestamp +12
(30) Cleaning up request packet ID 95 with timestamp +12
Ready to process requests
main {
	name = "freeradius"
	prefix = "/usr"
	localstatedir = "/var"
	sbindir = "/usr/sbin"
	logdir = "/var/log/freeradius"
	run_dir = "/var/run/freeradius"
	libdir = "/usr/lib/freeradius"
	radacctdir = "/var/log/freeradius/radacct"
	hostname_lookups = no
	max_request_time = 30
	cleanup_delay = 5
	max_requests = 16384
	pidfile = "/var/run/freeradius/freeradius.pid"
	checkrad = "/usr/sbin/checkrad"
	debug_level = 0
	proxy_requests = yes
 log {
 	stripped_names = no
 	auth = no
 	auth_badpass = no
 	auth_goodpass = no
 	colourise = yes
 	msg_denied = "You are already logged in - access denied"
 }
 resources {
 }
 security {
 	max_attributes = 200
 	reject_delay = 1.000000
 	status_server = yes
 }
}
radiusd: #### Loading Realms and Home Servers ####
 proxy server {
 	retry_delay = 5
 	retry_count = 3
 	default_fallback = no
 	dead_time = 120
 	wake_all_if_all_dead = no
 }
 home_server localhost {
 	ipaddr = 127.0.0.1
 	port = 1812
 	type = "auth"
 	secret = <<< secret >>>
 	response_window = 20.000000
 	response_timeouts = 1
 	max_outstanding = 65536
 	zombie_period = 40
 	status_check = "status-server"
 	ping_interval = 30
 	check_interval = 30
 	check_timeout = 4
 	num_answers_to_alive = 3
 	revive_interval = 120
  limit {
  	max_connections = 16
  	max_requests = 0
  	lifetime = 0
  	idle_timeout = 0
  }
  coa {
  	irt = 2
  	mrt = 16
  	mrc = 5
  	mrd = 30
  }
 }
 home_server_pool my_auth_failover {
	type = fail-over
	home_server = localhost
 }
 realm example.com {
	auth_pool = my_auth_failover
 }
 realm LOCAL {
 }
radiusd: #### Loading Clients ####
 client localhost {
 	ipaddr = 127.0.0.1
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	nas_type = "other"
 	proto = "*"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client localhost_ipv6 {
 	ipv6addr = ::1
 	require_message_authenticator = no
 	secret = <<< secret >>>
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client 192.168.1.0/24 {
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	shortname = "roocell-ap"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
No 'ipaddr' or 'ipv4addr' or 'ipv6addr' field found in client 192.168.1.0/24. Please fix your configuration
Support for old-style clients will be removed in a future release
Debug state unknown (cap_sys_ptrace capability not set)
 # Creating Auth-Type = digest
radiusd: #### Instantiating modules ####
  # Loaded module rlm_always
  # Loading module "reject" from file /etc/freeradius/mods-enabled/always
  always reject {
  	rcode = "reject"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "fail" from file /etc/freeradius/mods-enabled/always
  always fail {
  	rcode = "fail"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "ok" from file /etc/freeradius/mods-enabled/always
  always ok {
  	rcode = "ok"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "handled" from file /etc/freeradius/mods-enabled/always
  always handled {
  	rcode = "handled"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "invalid" from file /etc/freeradius/mods-enabled/always
  always invalid {
  	rcode = "invalid"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "userlock" from file /etc/freeradius/mods-enabled/always
  always userlock {
  	rcode = "userlock"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "notfound" from file /etc/freeradius/mods-enabled/always
  always notfound {
  	rcode = "notfound"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "noop" from file /etc/freeradius/mods-enabled/always
  always noop {
  	rcode = "noop"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "updated" from file /etc/freeradius/mods-enabled/always
  always updated {
  	rcode = "updated"
  	simulcount = 0
  	mpp = no
  }
  # Loaded module rlm_attr_filter
  # Loading module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.post-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/post-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.pre-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/pre-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_reject {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_reject"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_challenge {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_challenge"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.accounting_response {
  	filename = "/etc/freeradius/mods-config/attr_filter/accounting_response"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loaded module rlm_cache
  # Loading module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
  cache cache_eap {
  	driver = "rlm_cache_rbtree"
  	key = "%{%{control:State}:-%{%{reply:State}:-%{State}}}"
  	ttl = 15
  	max_entries = 0
  	epoch = 0
  	add_stats = no
  }
  # Loaded module rlm_chap
  # Loading module "chap" from file /etc/freeradius/mods-enabled/chap
  # Loaded module rlm_detail
  # Loading module "detail" from file /etc/freeradius/mods-enabled/detail
  detail {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
  detail auth_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/auth-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  detail reply_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/reply-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail pre_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/pre-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail post_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/post-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loaded module rlm_digest
  # Loading module "digest" from file /etc/freeradius/mods-enabled/digest
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_eap
  # Loading module "eap" from file /etc/freeradius/mods-enabled/eap
  eap {
  	default_eap_type = "md5"
  	timer_expire = 60
  	ignore_unknown_eap_types = no
  	cisco_accounting_username_bug = no
  	max_sessions = 16384
  }
  # Loaded module rlm_exec
  # Loading module "echo" from file /etc/freeradius/mods-enabled/echo
  exec echo {
  	wait = yes
  	program = "/bin/echo %{User-Name}"
  	input_pairs = "request"
  	output_pairs = "reply"
  	shell_escape = yes
  }
  # Loading module "exec" from file /etc/freeradius/mods-enabled/exec
  exec {
  	wait = no
  	input_pairs = "request"
  	shell_escape = yes
  	timeout = 10
  }
  # Loaded module rlm_expiration
  # Loading module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Loaded module rlm_expr
  # Loading module "expr" from file /etc/freeradius/mods-enabled/expr
  expr {
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /äéöüàâæçèéêëîïôœùûüaÿÄÉÖÜßÀÂÆÇÈÉÊËÎÏÔŒÙÛÜŸ"
  }
  # Loaded module rlm_files
  # Loading module "files" from file /etc/freeradius/mods-enabled/files
  files {
  	filename = "/etc/freeradius/mods-config/files/authorize"
  	acctusersfile = "/etc/freeradius/mods-config/files/accounting"
  	preproxy_usersfile = "/etc/freeradius/mods-config/files/pre-proxy"
  }
  # Loaded module rlm_linelog
  # Loading module "linelog" from file /etc/freeradius/mods-enabled/linelog
  linelog {
  	filename = "/var/log/freeradius/linelog"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = "This is a log message for %{User-Name}"
  	reference = "messages.%{%{reply:Packet-Type}:-default}"
  }
  # Loading module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  linelog log_accounting {
  	filename = "/var/log/freeradius/linelog-accounting"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = ""
  	reference = "Accounting-Request.%{%{Acct-Status-Type}:-unknown}"
  }
  # Loaded module rlm_logintime
  # Loading module "logintime" from file /etc/freeradius/mods-enabled/logintime
  logintime {
  	minimum_timeout = 60
  }
  # Loaded module rlm_mschap
  # Loading module "mschap" from file /etc/freeradius/mods-enabled/mschap
  mschap {
  	use_mppe = yes
  	require_encryption = no
  	require_strong = no
  	with_ntdomain_hack = yes
   passchange {
   }
  	allow_retry = yes
  }
  # Loading module "ntlm_auth" from file /etc/freeradius/mods-enabled/ntlm_auth
  exec ntlm_auth {
  	wait = yes
  	program = "/path/to/ntlm_auth --request-nt-key --domain=MYDOMAIN --username=%{mschap:User-Name} --password=%{User-Password}"
  	shell_escape = yes
  }
  # Loaded module rlm_pap
  # Loading module "pap" from file /etc/freeradius/mods-enabled/pap
  pap {
  	normalise = yes
  }
  # Loaded module rlm_passwd
  # Loading module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
  passwd etc_passwd {
  	filename = "/etc/passwd"
  	format = "*User-Name:Crypt-Password:"
  	delimiter = ":"
  	ignore_nislike = no
  	ignore_empty = yes
  	allow_multiple_keys = no
  	hash_size = 100
  }
  # Loaded module rlm_preprocess
  # Loading module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
  preprocess {
  	huntgroups = "/etc/freeradius/mods-config/preprocess/huntgroups"
  	hints = "/etc/freeradius/mods-config/preprocess/hints"
  	with_ascend_hack = no
  	ascend_channels_per_line = 23
  	with_ntdomain_hack = no
  	with_specialix_jetstream_hack = no
  	with_cisco_vsa_hack = no
  	with_alvarion_vsa_hack = no
  }
  # Loaded module rlm_radutmp
  # Loading module "radutmp" from file /etc/freeradius/mods-enabled/radutmp
  radutmp {
  	filename = "/var/log/freeradius/radutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 384
  	caller_id = yes
  }
  # Loaded module rlm_realm
  # Loading module "IPASS" from file /etc/freeradius/mods-enabled/realm
  realm IPASS {
  	format = "prefix"
  	delimiter = "/"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "suffix" from file /etc/freeradius/mods-enabled/realm
  realm suffix {
  	format = "suffix"
  	delimiter = "@"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  realm realmpercent {
  	format = "suffix"
  	delimiter = "%"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "ntdomain" from file /etc/freeradius/mods-enabled/realm
  realm ntdomain {
  	format = "prefix"
  	delimiter = "\\"
  	ignore_default = no
  	ignore_null = no
  }
  # Loaded module rlm_replicate
  # Loading module "replicate" from file /etc/freeradius/mods-enabled/replicate
  # Loaded module rlm_soh
  # Loading module "soh" from file /etc/freeradius/mods-enabled/soh
  soh {
  	dhcp = yes
  }
  # Loaded module rlm_sql
  # Loading module "sql" from file /etc/freeradius/mods-enabled/sql
  sql {
  	driver = "rlm_sql_null"
  	server = "172.17.0.2"
  	port = 0
  	login = ""
  	password = <<< secret >>>
  	radius_db = "radius"
  	read_groups = yes
  	read_profiles = yes
  	read_clients = no
  	delete_stale_sessions = yes
  	sql_user_name = "%{User-Name}"
  	default_user_profile = ""
  	client_query = "SELECT id, nasname, shortname, type, secret, server FROM nas"
  	authorize_check_query = "SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id"
  	authorize_reply_query = "SELECT id, username, attribute, value, op FROM radreply WHERE username = '%{SQL-User-Name}' ORDER BY id"
  	authorize_group_check_query = "SELECT id, groupname, attribute, Value, op FROM radgroupcheck WHERE groupname = '%{SQL-Group}' ORDER BY id"
  	authorize_group_reply_query = "SELECT id, groupname, attribute, value, op FROM radgroupreply WHERE groupname = '%{SQL-Group}' ORDER BY id"
  	group_membership_query = "SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority"
  	simul_verify_query = "SELECT radacctid, acctsessionid, username, nasipaddress, nasportid, framedipaddress, callingstationid, framedprotocol FROM radacct WHERE username = '%{SQL-Group}' AND acctstoptime IS NULL"
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /"
   accounting {
   	reference = "%{tolower:type.%{Acct-Status-Type}.query}"
    type {
     accounting-on {
     	query = "UPDATE radacct SET acctstoptime = %{%{integer:Event-Timestamp}:-date('now')}, acctsessiontime	= (%{%{integer:Event-Timestamp}:-strftime('%%s', 'now')} - strftime('%%s', acctstarttime)), acctterminatecause = '%{Acct-Terminate-Cause}' WHERE acctstoptime IS NULL AND nasipaddress   = '%{NAS-IP-Address}' AND acctstarttime <= %{integer:Event-Timestamp}"
     }
     accounting-off {
     	query = "UPDATE radacct SET acctstoptime = %{%{integer:Event-Timestamp}:-date('now')}, acctsessiontime	= (%{%{integer:Event-Timestamp}:-strftime('%%s', 'now')} - strftime('%%s', acctstarttime)), acctterminatecause = '%{Acct-Terminate-Cause}' WHERE acctstoptime IS NULL AND nasipaddress   = '%{NAS-IP-Address}' AND acctstarttime <= %{integer:Event-Timestamp}"
     }
     start {
     	query = "INSERT INTO radacct (acctsessionid, acctuniqueid, username, realm, nasipaddress, nasportid, nasporttype, acctstarttime, acctupdatetime, acctstoptime, acctsessiontime, acctauthentic, connectinfo_start, connectinfo_stop, acctinputoctets, acctoutputoctets, calledstationid, callingstationid, acctterminatecause, servicetype, framedprotocol, framedipaddress) VALUES ('%{Acct-Session-Id}', '%{Acct-Unique-Session-Id}', '%{SQL-User-Name}', '%{Realm}', '%{NAS-IP-Address}', '%{%{NAS-Port-ID}:-%{NAS-Port}}', '%{NAS-Port-Type}', %{%{integer:Event-Timestamp}:-date('now')}, %{%{integer:Event-Timestamp}:-date('now')}, NULL, '0', '%{Acct-Authentic}', '%{Connect-Info}', '', '0', '0', '%{Called-Station-Id}', '%{Calling-Station-Id}', '', '%{Service-Type}', '%{Framed-Protocol}', '%{Framed-IP-Address}')"
     }
     interim-update {
     	query = "UPDATE radacct SET acctupdatetime  = %{%{integer:Event-Timestamp}:-date('now')}, acctinterval    = 0, framedipaddress = '%{Framed-IP-Address}', acctsessiontime = %{%{Acct-Session-Time}:-NULL}, acctinputoctets = %{%{Acct-Input-Gigawords}:-0} << 32 | %{%{Acct-Input-Octets}:-0}, acctoutputoctets = %{%{Acct-Output-Gigawords}:-0} << 32 | %{%{Acct-Output-Octets}:-0} WHERE AcctUniqueId = '%{Acct-Unique-Session-Id}'"
     }
     stop {
     	query = "UPDATE radacct SET acctstoptime	= %{%{integer:Event-Timestamp}:-date('now')}, acctsessiontime	= %{%{Acct-Session-Time}:-NULL}, acctinputoctets	= %{%{Acct-Input-Gigawords}:-0} << 32 | %{%{Acct-Input-Octets}:-0}, acctoutputoctets = %{%{Acct-Output-Gigawords}:-0} << 32 | %{%{Acct-Output-Octets}:-0}, acctterminatecause = '%{Acct-Terminate-Cause}', connectinfo_stop = '%{Connect-Info}' WHERE AcctUniqueId = '%{Acct-Unique-Session-Id}'"
     }
    }
   }
   post-auth {
   	reference = ".query"
   	query = "INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')"
   }
  }
rlm_sql (sql): Driver rlm_sql_null (module rlm_sql_null) loaded and linked
Creating attribute SQL-Group
  # Loading module "sradutmp" from file /etc/freeradius/mods-enabled/sradutmp
  radutmp sradutmp {
  	filename = "/var/log/freeradius/sradutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 420
  	caller_id = no
  }
  # Loaded module rlm_unix
  # Loading module "unix" from file /etc/freeradius/mods-enabled/unix
  unix {
  	radwtmp = "/var/log/freeradius/radwtmp"
  }
Creating attribute Unix-Group
  # Loaded module rlm_unpack
  # Loading module "unpack" from file /etc/freeradius/mods-enabled/unpack
  # Loaded module rlm_utf8
  # Loading module "utf8" from file /etc/freeradius/mods-enabled/utf8
 instantiate {
 }
 modules {
  # Instantiating module "reject" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "fail" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "ok" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "handled" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "invalid" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "userlock" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "notfound" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "noop" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "updated" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/post-proxy
  # Instantiating module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/pre-proxy
  # Instantiating module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_reject
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay" 	found in filter list for realm "DEFAULT". 
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay-USec" 	found in filter list for realm "DEFAULT". 
  # Instantiating module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_challenge
  # Instantiating module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/accounting_response
  # Instantiating module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
rlm_cache (cache_eap): Driver rlm_cache_rbtree (module rlm_cache_rbtree) loaded and linked
  # Instantiating module "detail" from file /etc/freeradius/mods-enabled/detail
  # Instantiating module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
rlm_detail (auth_log): 'User-Password' suppressed, will not appear in detail output
  # Instantiating module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "eap" from file /etc/freeradius/mods-enabled/eap
   # Linked to sub-module rlm_eap_md5
   # Linked to sub-module rlm_eap_leap
   # Linked to sub-module rlm_eap_gtc
   gtc {
   	challenge = "Password: "
   	auth_type = "PAP"
   }
   # Linked to sub-module rlm_eap_tls
   tls {
   	tls = "tls-common"
   }
   tls-config tls-common {
   	rsa_key_exchange = no
   	dh_key_exchange = yes
   	rsa_key_length = 512
   	dh_key_length = 512
   	verify_depth = 0
   	ca_path = "/etc/freeradius/certs"
   	pem_file_type = yes
   	private_key_file = "/etc/freeradius/certs/server.pem"
   	certificate_file = "/etc/freeradius/certs/server.pem"
   	ca_file = "/etc/freeradius/certs/ca.pem"
   	private_key_password = <<< secret >>>
   	dh_file = "/etc/freeradius/certs/dh"
   	fragment_size = 1024
   	include_length = yes
   	check_crl = no
   	check_all_crl = no
   	cipher_list = "DEFAULT"
   	ecdh_curve = "prime256v1"
    cache {
    	enable = yes
    	lifetime = 24
    	max_entries = 255
    }
    verify {
    }
    ocsp {
    	enable = no
    	override_cert_url = yes
    	url = "http://127.0.0.1/ocsp/"
    	use_nonce = yes
    	timeout = 0
    	softfail = no
    }
   }
   # Linked to sub-module rlm_eap_ttls
   ttls {
   	tls = "tls-common"
   	default_eap_type = "md5"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	virtual_server = "inner-tunnel"
   	include_length = yes
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_peap
   peap {
   	tls = "tls-common"
   	default_eap_type = "mschapv2"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	proxy_tunneled_request_as_eap = yes
   	virtual_server = "inner-tunnel"
   	soh = no
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_mschapv2
   mschapv2 {
   	with_ntdomain_hack = no
   	send_error = no
   }
  # Instantiating module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Instantiating module "files" from file /etc/freeradius/mods-enabled/files
reading pairlist file /etc/freeradius/mods-config/files/authorize
reading pairlist file /etc/freeradius/mods-config/files/accounting
reading pairlist file /etc/freeradius/mods-config/files/pre-proxy
  # Instantiating module "linelog" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "logintime" from file /etc/freeradius/mods-enabled/logintime
  # Instantiating module "mschap" from file /etc/freeradius/mods-enabled/mschap
rlm_mschap (mschap): using internal authentication
  # Instantiating module "pap" from file /etc/freeradius/mods-enabled/pap
  # Instantiating module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
rlm_passwd: nfields: 3 keyfield 0(User-Name) listable: no
  # Instantiating module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
reading pairlist file /etc/freeradius/mods-config/preprocess/huntgroups
reading pairlist file /etc/freeradius/mods-config/preprocess/hints
  # Instantiating module "IPASS" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "suffix" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "ntdomain" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "sql" from file /etc/freeradius/mods-enabled/sql
rlm_sql (sql): Attempting to connect to database "radius"
rlm_sql (sql): Initialising connection pool
   pool {
   	start = 5
   	min = 3
   	max = 32
   	spare = 10
   	uses = 0
   	lifetime = 0
   	cleanup_interval = 30
   	idle_timeout = 60
   	retry_delay = 30
   	spread = no
   }
rlm_sql (sql): Opening additional connection (0), 1 of 32 pending slots used
rlm_sql (sql): Opening additional connection (1), 1 of 31 pending slots used
rlm_sql (sql): Opening additional connection (2), 1 of 30 pending slots used
rlm_sql (sql): Opening additional connection (3), 1 of 29 pending slots used
rlm_sql (sql): Opening additional connection (4), 1 of 28 pending slots used
 } # modules
radiusd: #### Loading Virtual Servers ####
server { # from file /etc/freeradius/radiusd.conf
} # server
server default { # from file /etc/freeradius/sites-enabled/default
 # Loading authenticate {...}
 # Loading authorize {...}
Ignoring "ldap" (see raddb/mods-available/README.rst)
 # Loading preacct {...}
 # Loading accounting {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server default
server inner-tunnel { # from file /etc/freeradius/sites-enabled/inner-tunnel
 # Loading authenticate {...}
 # Loading authorize {...}
 # Loading session {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server inner-tunnel
 thread pool {
 	start_servers = 5
 	max_servers = 32
 	min_spare_servers = 3
 	max_spare_servers = 10
 	max_requests_per_server = 0
 	cleanup_delay = 5
 	max_queue_size = 65536
 	auto_limit_acct = no
 }
Thread spawned new child 1. Total threads in pool: 1
Thread spawned new child 2. Total threads in pool: 2
Thread spawned new child 3. Total threads in pool: 3
Thread spawned new child 4. Total threads in pool: 4
Thread spawned new child 5. Total threads in pool: 5
Thread pool initialized
radiusd: #### Opening IP addresses and Ports ####
listen {
  	type = "auth"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
Thread 3 waiting to be assigned a request
Thread 4 waiting to be assigned a request
Thread 2 waiting to be assigned a request
Thread 1 waiting to be assigned a request
Thread 5 waiting to be assigned a request
}
listen {
  	type = "acct"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "acct"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipaddr = 127.0.0.1
  	port = 18120
}
Listening on auth address * port 1812 bound to server default
Listening on acct address * port 1813 bound to server default
Listening on auth address :: port 1812 bound to server default
Listening on acct address :: port 1813 bound to server default
Listening on auth address 127.0.0.1 port 18120 bound to server inner-tunnel
Listening on proxy address * port 43377
Listening on proxy address :: port 37358
Ready to process requests
Threads: total/active/spare threads = 5/0/5
Thread 5 got semaphore
Thread 5 handling request 0, (1 handled so far)
(0) <running>: Received Access-Request Id 96 from 192.168.1.30:50041 to 172.17.0.4:1812 length 190
(0) <running>:   User-Name = "emiruss"
(0) <running>:   NAS-IP-Address = 192.168.1.30
(0) <running>:   NAS-Identifier = "Ericsson"
(0) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(0) <running>:   NAS-Port-Type = Wireless-802.11
(0) <running>:   NAS-Port = 0
(0) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(0) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(0) <running>:   Acct-Session-Id = "003E2DE6-0000004B"
(0) <running>:   Framed-MTU = 1400
(0) <running>:   EAP-Message = 0x02ac000c01656d6972757373
(0) <running>:   Message-Authenticator = 0xf510af023997deead5320c2a99dd24d7
(0) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(0) <running>:   authorize {
(0) <running>:     policy filter_username {
(0) <running>:       if (!&User-Name) {
(0) <running>:       if (!&User-Name)  -> FALSE
(0) <running>:       if (&User-Name =~ / /) {
(0) <running>:       if (&User-Name =~ / /)  -> FALSE
(0) <running>:       if (&User-Name =~ /@.*@/ ) {
(0) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(0) <running>:       if (&User-Name =~ /\.\./ ) {
(0) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(0) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(0) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(0) <running>:       if (&User-Name =~ /\.$/)  {
(0) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(0) <running>:       if (&User-Name =~ /@\./)  {
(0) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(0) <running>:     } # policy filter_username = notfound
(0)     [preprocess] = ok
(0)     [chap] = noop
(0)     [mschap] = noop
(0)     [digest] = noop
(0) suffix: Checking for suffix after "@"
(0) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(0) suffix: No such realm "NULL"
(0)     [suffix] = noop
(0) eap: Peer sent EAP Response (code 2) ID 172 length 12
(0) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(0)     [eap] = ok
(0)   } # authorize = ok
(0) Found Auth-Type = EAP
(0) # Executing group from file /etc/freeradius/sites-enabled/default
(0)   authenticate {
(0) eap: Peer sent packet with method EAP Identity (1)
(0) eap: Calling submodule eap_md5 to process data
(0) eap_md5: Issuing MD5 Challenge
(0) eap: Sending EAP Request (code 1) ID 173 length 22
(0) eap: EAP session adding &reply:State = 0xaaad3105aa003589
(0)     [eap] = handled
(0)   } # authenticate = handled
(0) Using Post-Auth-Type Challenge
(0) Post-Auth-Type sub-section not found.  Ignoring.
(0) # Executing group from file /etc/freeradius/sites-enabled/default
(0) Sent Access-Challenge Id 96 from 172.17.0.4:1812 to 192.168.1.30:50041 length 0
(0)   EAP-Message = 0x01ad0016041044945a5a95a8e2329f9346abd8d64d9b
(0)   Message-Authenticator = 0x00000000000000000000000000000000
(0)   State = 0xaaad3105aa00358954502e0c529c1109
(0) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.3 seconds.
Thread 4 got semaphore
Thread 4 handling request 1, (1 handled so far)
(1) <running>: Received Access-Request Id 97 from 192.168.1.30:50041 to 172.17.0.4:1812 length 204
(1) <running>:   User-Name = "emiruss"
(1) <running>:   NAS-IP-Address = 192.168.1.30
(1) <running>:   NAS-Identifier = "Ericsson"
(1) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(1) <running>:   NAS-Port-Type = Wireless-802.11
(1) <running>:   NAS-Port = 0
(1) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(1) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(1) <running>:   Acct-Session-Id = "003E2DE6-0000004B"
(1) <running>:   Framed-MTU = 1400
(1) <running>:   EAP-Message = 0x02ad00080319152b
(1) <running>:   State = 0xaaad3105aa00358954502e0c529c1109
(1) <running>:   Message-Authenticator = 0xace85e0ef50b4c83b365dec6d9dde34e
(1) <running>: session-state: No cached attributes
(1) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(1) <running>:   authorize {
(1) <running>:     policy filter_username {
(1) <running>:       if (!&User-Name) {
(1) <running>:       if (!&User-Name)  -> FALSE
(1) <running>:       if (&User-Name =~ / /) {
(1) <running>:       if (&User-Name =~ / /)  -> FALSE
(1) <running>:       if (&User-Name =~ /@.*@/ ) {
(1) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(1) <running>:       if (&User-Name =~ /\.\./ ) {
(1) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(1) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(1) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(1) <running>:       if (&User-Name =~ /\.$/)  {
(1) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(1) <running>:       if (&User-Name =~ /@\./)  {
(1) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(1) <running>:     } # policy filter_username = notfound
(1)     [preprocess] = ok
(1)     [chap] = noop
(1)     [mschap] = noop
(1)     [digest] = noop
(1) suffix: Checking for suffix after "@"
(1) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(1) suffix: No such realm "NULL"
(1)     [suffix] = noop
(1) eap: Peer sent EAP Response (code 2) ID 173 length 8
(1) eap: No EAP Start, assuming it's an on-going EAP conversation
(1)     [eap] = updated
(1)     [files] = noop
(1) sql: EXPAND %{User-Name}
(1) sql:    --> emiruss
(1) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Reserved connection (0)
Waking up in 0.2 seconds.
(1) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(1) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(1) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(1) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(1) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(1) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(1) sql: User not found in any groups
rlm_sql (sql): Released connection (0)
rlm_sql (sql): Need 5 more connections to reach 10 spares
rlm_sql (sql): Opening additional connection (5), 1 of 27 pending slots used
(1)     [sql] = notfound
(1)     [expiration] = noop
(1)     [logintime] = noop
(1) pap: WARNING: No "known good" password found for the user.  Not setting Auth-Type
(1) pap: WARNING: Authentication will fail unless a "known good" password is available
(1)     [pap] = noop
(1)   } # authorize = updated
(1) Found Auth-Type = EAP
(1) # Executing group from file /etc/freeradius/sites-enabled/default
(1)   authenticate {
(1) eap: Expiring EAP session with state 0xaaad3105aa003589
(1) eap: Finished EAP session with state 0xaaad3105aa003589
(1) eap: Previous EAP request found for state 0xaaad3105aa003589, released from the list
(1) eap: Peer sent packet with method EAP NAK (3)
(1) eap: Found mutually acceptable type PEAP (25)
(1) eap: Calling submodule eap_peap to process data
(1) eap_peap: Initiating new EAP-TLS session
(1) eap_peap: Flushing SSL sessions (of #0)
(1) eap_peap: [eaptls start] = request
(1) eap: Sending EAP Request (code 1) ID 174 length 6
(1) eap: EAP session adding &reply:State = 0xaaad3105ab032889
(1)     [eap] = handled
(1)   } # authenticate = handled
(1) Using Post-Auth-Type Challenge
(1) Post-Auth-Type sub-section not found.  Ignoring.
(1) # Executing group from file /etc/freeradius/sites-enabled/default
(1) Sent Access-Challenge Id 97 from 172.17.0.4:1812 to 192.168.1.30:50041 length 0
(1)   EAP-Message = 0x01ae00061920
(1)   Message-Authenticator = 0x00000000000000000000000000000000
(1)   State = 0xaaad3105ab03288954502e0c529c1109
(1) Finished request
Thread 4 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 3 got semaphore
Thread 3 handling request 2, (1 handled so far)
(2) <running>: Received Access-Request Id 98 from 192.168.1.30:50041 to 172.17.0.4:1812 length 339
(2) <running>:   User-Name = "emiruss"
(2) <running>:   NAS-IP-Address = 192.168.1.30
(2) <running>:   NAS-Identifier = "Ericsson"
(2) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(2) <running>:   NAS-Port-Type = Wireless-802.11
(2) <running>:   NAS-Port = 0
(2) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(2) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(2) <running>:   Acct-Session-Id = "003E2DE6-0000004B"
(2) <running>:   Framed-MTU = 1400
(2) <running>:   EAP-Message = 0x02ae008f19800000008516030100800100007c030156552bb43e1c962da2a984c87b915105570ea4948de526928d194227a401248c00003400ffc02cc02bc024c023c00ac009c008c030c02fc028c027c014c013c012009d009c003d003c0035002f000ac007c011000500040100001f000a0008000600
(2) <running>:   State = 0xaaad3105ab03288954502e0c529c1109
(2) <running>:   Message-Authenticator = 0x352c67411188165ad78e0dc88d4a0f24
(2) <running>: session-state: No cached attributes
(2) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(2) <running>:   authorize {
(2) <running>:     policy filter_username {
(2) <running>:       if (!&User-Name) {
(2) <running>:       if (!&User-Name)  -> FALSE
(2) <running>:       if (&User-Name =~ / /) {
(2) <running>:       if (&User-Name =~ / /)  -> FALSE
(2) <running>:       if (&User-Name =~ /@.*@/ ) {
(2) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(2) <running>:       if (&User-Name =~ /\.\./ ) {
(2) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(2) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(2) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(2) <running>:       if (&User-Name =~ /\.$/)  {
(2) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(2) <running>:       if (&User-Name =~ /@\./)  {
(2) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(2) <running>:     } # policy filter_username = notfound
(2)     [preprocess] = ok
(2)     [chap] = noop
(2)     [mschap] = noop
(2)     [digest] = noop
(2) suffix: Checking for suffix after "@"
(2) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(2) suffix: No such realm "NULL"
(2)     [suffix] = noop
(2) eap: Peer sent EAP Response (code 2) ID 174 length 143
(2) eap: Continuing tunnel setup
(2)     [eap] = ok
(2)   } # authorize = ok
(2) Found Auth-Type = EAP
(2) # Executing group from file /etc/freeradius/sites-enabled/default
(2)   authenticate {
(2) eap: Expiring EAP session with state 0xaaad3105ab032889
(2) eap: Finished EAP session with state 0xaaad3105ab032889
(2) eap: Previous EAP request found for state 0xaaad3105ab032889, released from the list
(2) eap: Peer sent packet with method EAP PEAP (25)
(2) eap: Calling submodule eap_peap to process data
(2) eap_peap: Continuing EAP-TLS
(2) eap_peap: Peer indicated complete TLS record size will be 133 bytes
(2) eap_peap: Got complete TLS record (133 bytes)
(2) eap_peap: [eaptls verify] = length included
(2) eap_peap: (other): before/accept initialization
(2) eap_peap: TLS_accept: before/accept initialization
(2) eap_peap: <<< TLS 1.0 Handshake [length 0080], ClientHello 
(2) eap_peap: TLS_accept: SSLv3 read client hello A
(2) eap_peap: >>> TLS 1.0 Handshake [length 0059], ServerHello 
(2) eap_peap: TLS_accept: SSLv3 write server hello A
(2) eap_peap: >>> TLS 1.0 Handshake [length 08d3], Certificate 
(2) eap_peap: TLS_accept: SSLv3 write certificate A
(2) eap_peap: >>> TLS 1.0 Handshake [length 014b], ServerKeyExchange 
(2) eap_peap: TLS_accept: SSLv3 write key exchange A
(2) eap_peap: >>> TLS 1.0 Handshake [length 0004], ServerHelloDone 
(2) eap_peap: TLS_accept: SSLv3 write server done A
(2) eap_peap: TLS_accept: SSLv3 flush data
(2) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(2) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(2) eap_peap: In SSL Handshake Phase
(2) eap_peap: In SSL Accept mode
(2) eap_peap: [eaptls process] = handled
(2) eap: Sending EAP Request (code 1) ID 175 length 1004
(2) eap: EAP session adding &reply:State = 0xaaad3105a8022889
(2)     [eap] = handled
(2)   } # authenticate = handled
(2) Using Post-Auth-Type Challenge
(2) Post-Auth-Type sub-section not found.  Ignoring.
(2) # Executing group from file /etc/freeradius/sites-enabled/default
(2) Sent Access-Challenge Id 98 from 172.17.0.4:1812 to 192.168.1.30:50041 length 0
(2)   EAP-Message = 0x01af03ec19c000000a8f1603010059020000550301f867dad3520f48ebf05de0e3ebf8f5d9183d3f8f8faebd2d9aae6c5ac8d05af72014c449968662dbb8d7b7ef2aa2f92217f7477fe990b3b6813d15e57fe94adc12c01400000dff01000100000b00040300010216030108d30b0008cf0008cc0003de
(2)   Message-Authenticator = 0x00000000000000000000000000000000
(2)   State = 0xaaad3105a802288954502e0c529c1109
(2) Finished request
Thread 3 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 2 got semaphore
Thread 2 handling request 3, (1 handled so far)
(3) <running>: Received Access-Request Id 99 from 192.168.1.30:50041 to 172.17.0.4:1812 length 202
(3) <running>:   User-Name = "emiruss"
(3) <running>:   NAS-IP-Address = 192.168.1.30
(3) <running>:   NAS-Identifier = "Ericsson"
(3) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(3) <running>:   NAS-Port-Type = Wireless-802.11
(3) <running>:   NAS-Port = 0
(3) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(3) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(3) <running>:   Acct-Session-Id = "003E2DE6-0000004B"
(3) <running>:   Framed-MTU = 1400
(3) <running>:   EAP-Message = 0x02af00061900
(3) <running>:   State = 0xaaad3105a802288954502e0c529c1109
(3) <running>:   Message-Authenticator = 0xa44ed9a462012ee7dc9a48bb499e52db
(3) <running>: session-state: No cached attributes
(3) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(3) <running>:   authorize {
(3) <running>:     policy filter_username {
(3) <running>:       if (!&User-Name) {
(3) <running>:       if (!&User-Name)  -> FALSE
(3) <running>:       if (&User-Name =~ / /) {
(3) <running>:       if (&User-Name =~ / /)  -> FALSE
(3) <running>:       if (&User-Name =~ /@.*@/ ) {
(3) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(3) <running>:       if (&User-Name =~ /\.\./ ) {
(3) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(3) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(3) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(3) <running>:       if (&User-Name =~ /\.$/)  {
(3) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(3) <running>:       if (&User-Name =~ /@\./)  {
(3) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(3) <running>:     } # policy filter_username = notfound
(3)     [preprocess] = ok
(3)     [chap] = noop
(3)     [mschap] = noop
(3)     [digest] = noop
(3) suffix: Checking for suffix after "@"
(3) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(3) suffix: No such realm "NULL"
(3)     [suffix] = noop
(3) eap: Peer sent EAP Response (code 2) ID 175 length 6
(3) eap: Continuing tunnel setup
(3)     [eap] = ok
(3)   } # authorize = ok
(3) Found Auth-Type = EAP
(3) # Executing group from file /etc/freeradius/sites-enabled/default
(3)   authenticate {
(3) eap: Expiring EAP session with state 0xaaad3105a8022889
(3) eap: Finished EAP session with state 0xaaad3105a8022889
(3) eap: Previous EAP request found for state 0xaaad3105a8022889, released from the list
(3) eap: Peer sent packet with method EAP PEAP (25)
(3) eap: Calling submodule eap_peap to process data
(3) eap_peap: Continuing EAP-TLS
(3) eap_peap: Peer ACKed our handshake fragment
(3) eap_peap: [eaptls verify] = request
(3) eap_peap: [eaptls process] = handled
(3) eap: Sending EAP Request (code 1) ID 176 length 1000
(3) eap: EAP session adding &reply:State = 0xaaad3105a91d2889
(3)     [eap] = handled
(3)   } # authenticate = handled
(3) Using Post-Auth-Type Challenge
(3) Post-Auth-Type sub-section not found.  Ignoring.
(3) # Executing group from file /etc/freeradius/sites-enabled/default
(3) Sent Access-Challenge Id 99 from 172.17.0.4:1812 to 192.168.1.30:50041 length 0
(3)   EAP-Message = 0x01b003e819400dd0405955c762981948527048701681d313d3cc6629a5557b66df2aae22c8590ab99d66ec8d3792a72e30596410f5d1e81f5a774969a1ce9ad6bd01d42da65536016e80a905c662a71ef5c075b8bdf0127a0cf1bd4c91290e15edffa035febde0185096bdc1e553090004e8308204e430
(3)   Message-Authenticator = 0x00000000000000000000000000000000
(3)   State = 0xaaad3105a91d288954502e0c529c1109
(3) Finished request
Thread 2 waiting to be assigned a request
Thread 1 got semaphore
Thread 1 handling request 4, (1 handled so far)
(4) <running>: Received Access-Request Id 100 from 192.168.1.30:50041 to 172.17.0.4:1812 length 202
(4) <running>:   User-Name = "emiruss"
(4) <running>:   NAS-IP-Address = 192.168.1.30
(4) <running>:   NAS-Identifier = "Ericsson"
(4) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(4) <running>:   NAS-Port-Type = Wireless-802.11
(4) <running>:   NAS-Port = 0
(4) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(4) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(4) <running>:   Acct-Session-Id = "003E2DE6-0000004B"
(4) <running>:   Framed-MTU = 1400
(4) <running>:   EAP-Message = 0x02b000061900
(4) <running>:   State = 0xaaad3105a91d288954502e0c529c1109
(4) <running>:   Message-Authenticator = 0xc3d479c1158a568dcd727bfafbe84c26
(4) <running>: session-state: No cached attributes
(4) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(4) <running>:   authorize {
(4) <running>:     policy filter_username {
(4) <running>:       if (!&User-Name) {
(4) <running>:       if (!&User-Name)  -> FALSE
(4) <running>:       if (&User-Name =~ / /) {
(4) <running>:       if (&User-Name =~ / /)  -> FALSE
(4) <running>:       if (&User-Name =~ /@.*@/ ) {
(4) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(4) <running>:       if (&User-Name =~ /\.\./ ) {
(4) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(4) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(4) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(4) <running>:       if (&User-Name =~ /\.$/)  {
(4) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(4) <running>:       if (&User-Name =~ /@\./)  {
(4) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(4) <running>:     } # policy filter_username = notfound
(4)     [preprocess] = ok
(4)     [chap] = noop
(4)     [mschap] = noop
(4)     [digest] = noop
(4) suffix: Checking for suffix after "@"
(4) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(4) suffix: No such realm "NULL"
(4)     [suffix] = noop
(4) eap: Peer sent EAP Response (code 2) ID 176 length 6
(4) eap: Continuing tunnel setup
(4)     [eap] = ok
(4)   } # authorize = ok
(4) Found Auth-Type = EAP
(4) # Executing group from file /etc/freeradius/sites-enabled/default
(4)   authenticate {
(4) eap: Expiring EAP session with state 0xaaad3105a91d2889
(4) eap: Finished EAP session with state 0xaaad3105a91d2889
(4) eap: Previous EAP request found for state 0xaaad3105a91d2889, released from the list
(4) eap: Peer sent packet with method EAP PEAP (25)
(4) eap: Calling submodule eap_peap to process data
(4) eap_peap: Continuing EAP-TLS
(4) eap_peap: Peer ACKed our handshake fragment
(4) eap_peap: [eaptls verify] = request
(4) eap_peap: [eaptls process] = handled
(4) eap: Sending EAP Request (code 1) ID 177 length 721
(4) eap: EAP session adding &reply:State = 0xaaad3105ae1c2889
(4)     [eap] = handled
(4)   } # authenticate = handled
(4) Using Post-Auth-Type Challenge
(4) Post-Auth-Type sub-section not found.  Ignoring.
(4) # Executing group from file /etc/freeradius/sites-enabled/default
(4) Sent Access-Challenge Id 100 from 172.17.0.4:1812 to 192.168.1.30:50041 length 0
(4)   EAP-Message = 0x01b102d1190020417574686f72697479820900c3fc536eef83d741300f0603551d130101ff040530030101ff30360603551d1f042f302d302ba029a0278625687474703a2f2f7777772e6578616d706c652e6f72672f6578616d706c655f63612e63726c300d06092a864886f70d01010b050003820101
(4)   Message-Authenticator = 0x00000000000000000000000000000000
(4)   State = 0xaaad3105ae1c288954502e0c529c1109
(4) Finished request
Thread 1 waiting to be assigned a request
Waking up in 4.4 seconds.
Waking up in 0.3 seconds.
Thread 5 got semaphore
Thread 5 handling request 5, (2 handled so far)
(5) <running>: Received Access-Request Id 101 from 192.168.1.30:50041 to 172.17.0.4:1812 length 340
(5) <running>:   User-Name = "emiruss"
(5) <running>:   NAS-IP-Address = 192.168.1.30
(5) <running>:   NAS-Identifier = "Ericsson"
(5) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(5) <running>:   NAS-Port-Type = Wireless-802.11
(5) <running>:   NAS-Port = 0
(5) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(5) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(5) <running>:   Acct-Session-Id = "003E2DE6-0000004B"
(5) <running>:   Framed-MTU = 1400
(5) <running>:   EAP-Message = 0x02b100901980000000861603010046100000424104b39f8b00e4295d408e8d6487f70ac0b1b7adb629fe7620f9c5a5ae68ce1b01cef5cc8dd1700ab378331d5545595add50dccf4ca3217491f67bd98d10dd474bc01403010001011603010030b75f1739255f84b649fa52e91188ec79c7beddeb07a6ae
(5) <running>:   State = 0xaaad3105ae1c288954502e0c529c1109
(5) <running>:   Message-Authenticator = 0x2bb4f581f402602eee49ce80d58a2257
(5) <running>: session-state: No cached attributes
(5) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(5) <running>:   authorize {
(5) <running>:     policy filter_username {
(5) <running>:       if (!&User-Name) {
(5) <running>:       if (!&User-Name)  -> FALSE
(5) <running>:       if (&User-Name =~ / /) {
(5) <running>:       if (&User-Name =~ / /)  -> FALSE
(5) <running>:       if (&User-Name =~ /@.*@/ ) {
(5) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(5) <running>:       if (&User-Name =~ /\.\./ ) {
(5) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(5) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(5) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(5) <running>:       if (&User-Name =~ /\.$/)  {
(5) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(5) <running>:       if (&User-Name =~ /@\./)  {
(5) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(5) <running>:     } # policy filter_username = notfound
(5)     [preprocess] = ok
(5)     [chap] = noop
(5)     [mschap] = noop
(5)     [digest] = noop
(5) suffix: Checking for suffix after "@"
(5) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(5) suffix: No such realm "NULL"
(5)     [suffix] = noop
(5) eap: Peer sent EAP Response (code 2) ID 177 length 144
(5) eap: Continuing tunnel setup
(5)     [eap] = ok
(5)   } # authorize = ok
(5) Found Auth-Type = EAP
(5) # Executing group from file /etc/freeradius/sites-enabled/default
(5)   authenticate {
(5) eap: Expiring EAP session with state 0xaaad3105ae1c2889
(5) eap: Finished EAP session with state 0xaaad3105ae1c2889
(5) eap: Previous EAP request found for state 0xaaad3105ae1c2889, released from the list
(5) eap: Peer sent packet with method EAP PEAP (25)
(5) eap: Calling submodule eap_peap to process data
(5) eap_peap: Continuing EAP-TLS
(5) eap_peap: Peer indicated complete TLS record size will be 134 bytes
(5) eap_peap: Got complete TLS record (134 bytes)
(5) eap_peap: [eaptls verify] = length included
(5) eap_peap: <<< TLS 1.0 Handshake [length 0046], ClientKeyExchange 
(5) eap_peap: TLS_accept: SSLv3 read client key exchange A
(5) eap_peap: <<< TLS 1.0 ChangeCipherSpec [length 0001] 
(5) eap_peap: <<< TLS 1.0 Handshake [length 0010], Finished 
(5) eap_peap: TLS_accept: SSLv3 read finished A
(5) eap_peap: >>> TLS 1.0 ChangeCipherSpec [length 0001] 
(5) eap_peap: TLS_accept: SSLv3 write change cipher spec A
(5) eap_peap: >>> TLS 1.0 Handshake [length 0010], Finished 
(5) eap_peap: TLS_accept: SSLv3 write finished A
(5) eap_peap: TLS_accept: SSLv3 flush data
(5) eap_peap: (other): SSL negotiation finished successfully
(5) eap_peap: SSL Connection Established
(5) eap_peap: [eaptls process] = handled
(5) eap: Sending EAP Request (code 1) ID 178 length 65
(5) eap: EAP session adding &reply:State = 0xaaad3105af1f2889
(5)     [eap] = handled
(5)   } # authenticate = handled
(5) Using Post-Auth-Type Challenge
(5) Post-Auth-Type sub-section not found.  Ignoring.
(5) # Executing group from file /etc/freeradius/sites-enabled/default
(5) Sent Access-Challenge Id 101 from 172.17.0.4:1812 to 192.168.1.30:50041 length 0
(5)   EAP-Message = 0x01b20041190014030100010116030100303f1cad85da255c6901c73c431a522cf843fbaa076229a4dce0a09d9a6e8888f74decef46424017ffeef8cabc09d7c1af
(5)   Message-Authenticator = 0x00000000000000000000000000000000
(5)   State = 0xaaad3105af1f288954502e0c529c1109
(5) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.3 seconds.
Thread 4 got semaphore
Thread 4 handling request 6, (2 handled so far)
(6) <running>: Received Access-Request Id 102 from 192.168.1.30:50041 to 172.17.0.4:1812 length 202
(6) <running>:   User-Name = "emiruss"
(6) <running>:   NAS-IP-Address = 192.168.1.30
(6) <running>:   NAS-Identifier = "Ericsson"
(6) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(6) <running>:   NAS-Port-Type = Wireless-802.11
(6) <running>:   NAS-Port = 0
(6) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(6) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(6) <running>:   Acct-Session-Id = "003E2DE6-0000004B"
(6) <running>:   Framed-MTU = 1400
(6) <running>:   EAP-Message = 0x02b200061900
(6) <running>:   State = 0xaaad3105af1f288954502e0c529c1109
(6) <running>:   Message-Authenticator = 0xa12aed40d3ddc25d2b6cc388993f8a4a
(6) <running>: session-state: No cached attributes
(6) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(6) <running>:   authorize {
(6) <running>:     policy filter_username {
(6) <running>:       if (!&User-Name) {
(6) <running>:       if (!&User-Name)  -> FALSE
(6) <running>:       if (&User-Name =~ / /) {
(6) <running>:       if (&User-Name =~ / /)  -> FALSE
(6) <running>:       if (&User-Name =~ /@.*@/ ) {
(6) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(6) <running>:       if (&User-Name =~ /\.\./ ) {
(6) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(6) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(6) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(6) <running>:       if (&User-Name =~ /\.$/)  {
(6) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(6) <running>:       if (&User-Name =~ /@\./)  {
(6) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(6) <running>:     } # policy filter_username = notfound
(6)     [preprocess] = ok
(6)     [chap] = noop
(6)     [mschap] = noop
(6)     [digest] = noop
(6) suffix: Checking for suffix after "@"
(6) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(6) suffix: No such realm "NULL"
(6)     [suffix] = noop
(6) eap: Peer sent EAP Response (code 2) ID 178 length 6
(6) eap: Continuing tunnel setup
(6)     [eap] = ok
(6)   } # authorize = ok
(6) Found Auth-Type = EAP
(6) # Executing group from file /etc/freeradius/sites-enabled/default
(6)   authenticate {
(6) eap: Expiring EAP session with state 0xaaad3105af1f2889
(6) eap: Finished EAP session with state 0xaaad3105af1f2889
(6) eap: Previous EAP request found for state 0xaaad3105af1f2889, released from the list
(6) eap: Peer sent packet with method EAP PEAP (25)
(6) eap: Calling submodule eap_peap to process data
(6) eap_peap: Continuing EAP-TLS
(6) eap_peap: Peer ACKed our handshake fragment.  handshake is finished
(6) eap_peap: [eaptls verify] = success
(6) eap_peap: [eaptls process] = success
(6) eap_peap: Session established.  Decoding tunneled attributes
(6) eap_peap: PEAP state TUNNEL ESTABLISHED
(6) eap: Sending EAP Request (code 1) ID 179 length 43
(6) eap: EAP session adding &reply:State = 0xaaad3105ac1e2889
(6)     [eap] = handled
(6)   } # authenticate = handled
(6) Using Post-Auth-Type Challenge
(6) Post-Auth-Type sub-section not found.  Ignoring.
(6) # Executing group from file /etc/freeradius/sites-enabled/default
(6) Sent Access-Challenge Id 102 from 172.17.0.4:1812 to 192.168.1.30:50041 length 0
(6)   EAP-Message = 0x01b3002b19001703010020f35db92c24b5d01bff1301f987295d6d381d3208def1b85342c96cd97edb350d
(6)   Message-Authenticator = 0x00000000000000000000000000000000
(6)   State = 0xaaad3105ac1e288954502e0c529c1109
(6) Finished request
Thread 4 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 3 got semaphore
Thread 3 handling request 7, (2 handled so far)
(7) <running>: Received Access-Request Id 103 from 192.168.1.30:50041 to 172.17.0.4:1812 length 239
(7) <running>:   User-Name = "emiruss"
(7) <running>:   NAS-IP-Address = 192.168.1.30
(7) <running>:   NAS-Identifier = "Ericsson"
(7) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(7) <running>:   NAS-Port-Type = Wireless-802.11
(7) <running>:   NAS-Port = 0
(7) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(7) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(7) <running>:   Acct-Session-Id = "003E2DE6-0000004B"
(7) <running>:   Framed-MTU = 1400
(7) <running>:   EAP-Message = 0x02b3002b19001703010020fc4ad2ed7eef83bdce7db2a7deb1912264baac82968d2ebc03f18b9d0613df4d
(7) <running>:   State = 0xaaad3105ac1e288954502e0c529c1109
(7) <running>:   Message-Authenticator = 0xc7eb3317707eaeab12d3259d596beb5b
(7) <running>: session-state: No cached attributes
(7) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(7) <running>:   authorize {
(7) <running>:     policy filter_username {
(7) <running>:       if (!&User-Name) {
(7) <running>:       if (!&User-Name)  -> FALSE
(7) <running>:       if (&User-Name =~ / /) {
(7) <running>:       if (&User-Name =~ / /)  -> FALSE
(7) <running>:       if (&User-Name =~ /@.*@/ ) {
(7) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(7) <running>:       if (&User-Name =~ /\.\./ ) {
(7) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(7) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(7) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(7) <running>:       if (&User-Name =~ /\.$/)  {
(7) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(7) <running>:       if (&User-Name =~ /@\./)  {
(7) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(7) <running>:     } # policy filter_username = notfound
(7)     [preprocess] = ok
(7)     [chap] = noop
(7)     [mschap] = noop
(7)     [digest] = noop
(7) suffix: Checking for suffix after "@"
(7) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(7) suffix: No such realm "NULL"
(7)     [suffix] = noop
(7) eap: Peer sent EAP Response (code 2) ID 179 length 43
(7) eap: Continuing tunnel setup
(7)     [eap] = ok
(7)   } # authorize = ok
(7) Found Auth-Type = EAP
(7) # Executing group from file /etc/freeradius/sites-enabled/default
(7)   authenticate {
(7) eap: Expiring EAP session with state 0xaaad3105ac1e2889
(7) eap: Finished EAP session with state 0xaaad3105ac1e2889
(7) eap: Previous EAP request found for state 0xaaad3105ac1e2889, released from the list
(7) eap: Peer sent packet with method EAP PEAP (25)
(7) eap: Calling submodule eap_peap to process data
(7) eap_peap: Continuing EAP-TLS
(7) eap_peap: [eaptls verify] = ok
(7) eap_peap: Done initial handshake
(7) eap_peap: [eaptls process] = ok
(7) eap_peap: Session established.  Decoding tunneled attributes
(7) eap_peap: PEAP state WAITING FOR INNER IDENTITY
(7) eap_peap: Identity - emiruss
(7) eap_peap: Got inner identity 'emiruss'
(7) eap_peap: Setting default EAP type for tunneled EAP session
(7) eap_peap: Got tunneled request
(7) eap_peap:   EAP-Message = 0x02b3000c01656d6972757373
(7) eap_peap: Setting User-Name to emiruss
(7) eap_peap: Sending tunneled request to inner-tunnel
(7) eap_peap:   EAP-Message = 0x02b3000c01656d6972757373
(7) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(7) eap_peap:   User-Name = "emiruss"
(7) Virtual server inner-tunnel received request
(7)   EAP-Message = 0x02b3000c01656d6972757373
(7)   FreeRADIUS-Proxied-To = 127.0.0.1
(7)   User-Name = "emiruss"
(7) server inner-tunnel {
(7)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(7)     authorize {
(7)       [chap] = noop
(7)       [mschap] = noop
(7) suffix: Checking for suffix after "@"
(7) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(7) suffix: No such realm "NULL"
(7)       [suffix] = noop
(7)       update control {
(7)         &Proxy-To-Realm := LOCAL
(7)       } # update control = noop
(7) eap: Peer sent EAP Response (code 2) ID 179 length 12
(7) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(7)       [eap] = ok
(7)     } # authorize = ok
(7)   Found Auth-Type = EAP
(7)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(7)     authenticate {
(7) eap: Peer sent packet with method EAP Identity (1)
(7) eap: Calling submodule eap_mschapv2 to process data
(7) eap_mschapv2: Issuing Challenge
(7) eap: Sending EAP Request (code 1) ID 180 length 43
(7) eap: EAP session adding &reply:State = 0x9f3052b99f8448f1
(7)       [eap] = handled
(7)     } # authenticate = handled
(7) } # server inner-tunnel
(7) Virtual server sending reply
(7)   EAP-Message = 0x01b4002b1a01b400261011c4c4d8b259f5bcccae45cf2107d9c8667265657261646975732d332e302e3130
(7)   Message-Authenticator = 0x00000000000000000000000000000000
(7)   State = 0x9f3052b99f8448f1796a7aab57a5215e
(7) eap_peap: Got tunneled reply code 11
(7) eap_peap:   EAP-Message = 0x01b4002b1a01b400261011c4c4d8b259f5bcccae45cf2107d9c8667265657261646975732d332e302e3130
(7) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(7) eap_peap:   State = 0x9f3052b99f8448f1796a7aab57a5215e
(7) eap_peap: Got tunneled Access-Challenge
(7) eap: Sending EAP Request (code 1) ID 180 length 75
(7) eap: EAP session adding &reply:State = 0xaaad3105ad192889
(7)     [eap] = handled
(7)   } # authenticate = handled
(7) Using Post-Auth-Type Challenge
(7) Post-Auth-Type sub-section not found.  Ignoring.
(7) # Executing group from file /etc/freeradius/sites-enabled/default
(7) Sent Access-Challenge Id 103 from 172.17.0.4:1812 to 192.168.1.30:50041 length 0
(7)   EAP-Message = 0x01b4004b19001703010040342cc614c13be45c479f06a5256664118e7d916d0730c968cc8826a3c2ea0949db1df46845630dce4f707ab8b97721557a8e960d39c14d3610f5320d06fca9b8
(7)   Message-Authenticator = 0x00000000000000000000000000000000
(7)   State = 0xaaad3105ad19288954502e0c529c1109
(7) Finished request
Thread 3 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 2 got semaphore
Thread 2 handling request 8, (2 handled so far)
(8) <running>: Received Access-Request Id 104 from 192.168.1.30:50041 to 172.17.0.4:1812 length 303
(8) <running>:   User-Name = "emiruss"
(8) <running>:   NAS-IP-Address = 192.168.1.30
(8) <running>:   NAS-Identifier = "Ericsson"
(8) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(8) <running>:   NAS-Port-Type = Wireless-802.11
(8) <running>:   NAS-Port = 0
(8) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(8) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(8) <running>:   Acct-Session-Id = "003E2DE6-0000004B"
(8) <running>:   Framed-MTU = 1400
(8) <running>:   EAP-Message = 0x02b4006b190017030100602432fff2116c502eedc6a115eb1528bcd904d59599f6f0f6d8df194b17d23dd5fb181401ca45e13bb23cae72e1700773d8943dea32a506cd2d8dbb8ca6694b26420bc505c570934aa7f1bcf6f8fbc7c615baa2535501a23a5ab3a1c55bf01ef8
(8) <running>:   State = 0xaaad3105ad19288954502e0c529c1109
(8) <running>:   Message-Authenticator = 0x3e83eb0904be8f1ccb64f49d8e1f8637
(8) <running>: session-state: No cached attributes
(8) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(8) <running>:   authorize {
(8) <running>:     policy filter_username {
(8) <running>:       if (!&User-Name) {
(8) <running>:       if (!&User-Name)  -> FALSE
(8) <running>:       if (&User-Name =~ / /) {
(8) <running>:       if (&User-Name =~ / /)  -> FALSE
(8) <running>:       if (&User-Name =~ /@.*@/ ) {
(8) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(8) <running>:       if (&User-Name =~ /\.\./ ) {
(8) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(8) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(8) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(8) <running>:       if (&User-Name =~ /\.$/)  {
(8) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(8) <running>:       if (&User-Name =~ /@\./)  {
(8) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(8) <running>:     } # policy filter_username = notfound
(8)     [preprocess] = ok
(8)     [chap] = noop
(8)     [mschap] = noop
(8)     [digest] = noop
(8) suffix: Checking for suffix after "@"
(8) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(8) suffix: No such realm "NULL"
(8)     [suffix] = noop
(8) eap: Peer sent EAP Response (code 2) ID 180 length 107
(8) eap: Continuing tunnel setup
(8)     [eap] = ok
(8)   } # authorize = ok
(8) Found Auth-Type = EAP
(8) # Executing group from file /etc/freeradius/sites-enabled/default
(8)   authenticate {
(8) eap: Expiring EAP session with state 0x9f3052b99f8448f1
(8) eap: Finished EAP session with state 0xaaad3105ad192889
(8) eap: Previous EAP request found for state 0xaaad3105ad192889, released from the list
(8) eap: Peer sent packet with method EAP PEAP (25)
(8) eap: Calling submodule eap_peap to process data
(8) eap_peap: Continuing EAP-TLS
(8) eap_peap: [eaptls verify] = ok
(8) eap_peap: Done initial handshake
(8) eap_peap: [eaptls process] = ok
(8) eap_peap: Session established.  Decoding tunneled attributes
(8) eap_peap: PEAP state phase2
(8) eap_peap: EAP method MSCHAPv2 (26)
(8) eap_peap: Got tunneled request
(8) eap_peap:   EAP-Message = 0x02b400421a02b4003d3116ec2e831afe7c6e68f212d50f73f2280000000000000000166b2ca17d2d2dd7105a77d4110d86779d0478ef61a26f0b00656d6972757373
(8) eap_peap: Setting User-Name to emiruss
(8) eap_peap: Sending tunneled request to inner-tunnel
(8) eap_peap:   EAP-Message = 0x02b400421a02b4003d3116ec2e831afe7c6e68f212d50f73f2280000000000000000166b2ca17d2d2dd7105a77d4110d86779d0478ef61a26f0b00656d6972757373
(8) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(8) eap_peap:   User-Name = "emiruss"
(8) eap_peap:   State = 0x9f3052b99f8448f1796a7aab57a5215e
(8) Virtual server inner-tunnel received request
(8)   EAP-Message = 0x02b400421a02b4003d3116ec2e831afe7c6e68f212d50f73f2280000000000000000166b2ca17d2d2dd7105a77d4110d86779d0478ef61a26f0b00656d6972757373
(8)   FreeRADIUS-Proxied-To = 127.0.0.1
(8)   User-Name = "emiruss"
(8)   State = 0x9f3052b99f8448f1796a7aab57a5215e
(8) server inner-tunnel {
(8)   session-state: No cached attributes
(8)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(8)     authorize {
(8)       [chap] = noop
(8)       [mschap] = noop
(8) suffix: Checking for suffix after "@"
(8) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(8) suffix: No such realm "NULL"
(8)       [suffix] = noop
(8)       update control {
(8)         &Proxy-To-Realm := LOCAL
(8)       } # update control = noop
(8) eap: Peer sent EAP Response (code 2) ID 180 length 66
(8) eap: No EAP Start, assuming it's an on-going EAP conversation
(8)       [eap] = updated
(8)       [files] = noop
(8) sql: EXPAND %{User-Name}
(8) sql:    --> emiruss
(8) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Reserved connection (1)
(8) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(8) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(8) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(8) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(8) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(8) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(8) sql: User not found in any groups
rlm_sql (sql): Released connection (1)
rlm_sql (sql): Need 4 more connections to reach 10 spares
rlm_sql (sql): Opening additional connection (6), 1 of 26 pending slots used
(8)       [sql] = notfound
(8)       [expiration] = noop
(8)       [logintime] = noop
(8)       [pap] = noop
(8)     } # authorize = updated
(8)   Found Auth-Type = EAP
(8)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(8)     authenticate {
(8) eap: Expiring EAP session with state 0x9f3052b99f8448f1
(8) eap: Finished EAP session with state 0x9f3052b99f8448f1
(8) eap: Previous EAP request found for state 0x9f3052b99f8448f1, released from the list
(8) eap: Peer sent packet with method EAP MSCHAPv2 (26)
(8) eap: Calling submodule eap_mschapv2 to process data
(8) eap_mschapv2: # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(8) eap_mschapv2:   Auth-Type MS-CHAP {
(8) mschap: WARNING: No Cleartext-Password configured.  Cannot create NT-Password
(8) mschap: WARNING: No Cleartext-Password configured.  Cannot create LM-Password
(8) mschap: Creating challenge hash with username: emiruss
(8) mschap: Client is using MS-CHAPv2
(8) mschap: ERROR: FAILED: No NT/LM-Password.  Cannot perform authentication
(8) mschap: ERROR: MS-CHAP2-Response is incorrect
(8)     [mschap] = reject
(8)   } # Auth-Type MS-CHAP = reject
(8) eap: Sending EAP Failure (code 4) ID 180 length 4
(8) eap: Freeing handler
(8)       [eap] = reject
(8)     } # authenticate = reject
(8)   Failed to authenticate the user
(8)   Using Post-Auth-Type Reject
(8)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(8)     Post-Auth-Type REJECT {
(8) sql: EXPAND .query
(8) sql:    --> .query
(8) sql: Using query template 'query'
rlm_sql (sql): Reserved connection (2)
(8) sql: EXPAND %{User-Name}
(8) sql:    --> emiruss
(8) sql: SQL-User-Name set to 'emiruss'
(8) sql: EXPAND INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')
(8) sql:    --> INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:12:53')
(8) sql: Executing query: INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:12:53')
(8) sql: SQL query returned: success
(8) sql: 1 record(s) updated
rlm_sql (sql): Released connection (2)
(8)       [sql] = ok
(8) attr_filter.access_reject: EXPAND %{User-Name}
(8) attr_filter.access_reject:    --> emiruss
(8) attr_filter.access_reject: Matched entry DEFAULT at line 11
(8)       [attr_filter.access_reject] = updated
(8)       update outer.session-state {
(8)         &Module-Failure-Message := &request:Module-Failure-Message -> 'mschap: FAILED: No NT/LM-Password.  Cannot perform authentication'
(8)       } # update outer.session-state = noop
(8)     } # Post-Auth-Type REJECT = updated
(8) } # server inner-tunnel
(8) Virtual server sending reply
(8)   MS-CHAP-Error = "\264E=691 R=1 C=0f459c394b922342ba6e1f70593a5e12 V=3 M=Authentication failed"
(8)   EAP-Message = 0x04b40004
(8)   Message-Authenticator = 0x00000000000000000000000000000000
(8) eap_peap: Got tunneled reply code 3
(8) eap_peap:   MS-CHAP-Error = "\264E=691 R=1 C=0f459c394b922342ba6e1f70593a5e12 V=3 M=Authentication failed"
(8) eap_peap:   EAP-Message = 0x04b40004
(8) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(8) eap_peap: Tunneled authentication was rejected
(8) eap_peap: FAILURE
(8) eap: Sending EAP Request (code 1) ID 181 length 43
(8) eap: EAP session adding &reply:State = 0xaaad3105a2182889
(8)     [eap] = handled
(8)   } # authenticate = handled
(8) Using Post-Auth-Type Challenge
(8) Post-Auth-Type sub-section not found.  Ignoring.
(8) # Executing group from file /etc/freeradius/sites-enabled/default
(8) session-state: Saving cached attributes
(8)   Module-Failure-Message := "mschap: FAILED: No NT/LM-Password.  Cannot perform authentication"
(8) Sent Access-Challenge Id 104 from 172.17.0.4:1812 to 192.168.1.30:50041 length 0
(8)   EAP-Message = 0x01b5002b19001703010020b01cc401c7ee668096cb2227bb79b18bbd6651dcbab077e2bca02525d2fcad2d
(8)   Message-Authenticator = 0x00000000000000000000000000000000
(8)   State = 0xaaad3105a218288954502e0c529c1109
(8) Finished request
Thread 2 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 1 got semaphore
Thread 1 handling request 9, (2 handled so far)
(9) <running>: Received Access-Request Id 105 from 192.168.1.30:50041 to 172.17.0.4:1812 length 239
(9) <running>:   User-Name = "emiruss"
(9) <running>:   NAS-IP-Address = 192.168.1.30
(9) <running>:   NAS-Identifier = "Ericsson"
(9) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(9) <running>:   NAS-Port-Type = Wireless-802.11
(9) <running>:   NAS-Port = 0
(9) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(9) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(9) <running>:   Acct-Session-Id = "003E2DE6-0000004B"
(9) <running>:   Framed-MTU = 1400
(9) <running>:   EAP-Message = 0x02b5002b190017030100200cccfc32550d1fae7b004c6b1c094aea2edb63f804b635826db728da49af211b
(9) <running>:   State = 0xaaad3105a218288954502e0c529c1109
(9) <running>:   Message-Authenticator = 0x31ab8777905782641fe10360e6df19bb
(9) <running>: session-state: Found cached attributes
(9) <running>:   Module-Failure-Message := "mschap: FAILED: No NT/LM-Password.  Cannot perform authentication"
(9) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(9) <running>:   authorize {
(9) <running>:     policy filter_username {
(9) <running>:       if (!&User-Name) {
(9) <running>:       if (!&User-Name)  -> FALSE
(9) <running>:       if (&User-Name =~ / /) {
(9) <running>:       if (&User-Name =~ / /)  -> FALSE
(9) <running>:       if (&User-Name =~ /@.*@/ ) {
(9) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(9) <running>:       if (&User-Name =~ /\.\./ ) {
(9) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(9) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(9) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(9) <running>:       if (&User-Name =~ /\.$/)  {
(9) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(9) <running>:       if (&User-Name =~ /@\./)  {
(9) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(9) <running>:     } # policy filter_username = notfound
(9)     [preprocess] = ok
(9)     [chap] = noop
(9)     [mschap] = noop
(9)     [digest] = noop
(9) suffix: Checking for suffix after "@"
(9) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(9) suffix: No such realm "NULL"
(9)     [suffix] = noop
(9) eap: Peer sent EAP Response (code 2) ID 181 length 43
(9) eap: Continuing tunnel setup
(9)     [eap] = ok
(9)   } # authorize = ok
(9) Found Auth-Type = EAP
(9) # Executing group from file /etc/freeradius/sites-enabled/default
(9)   authenticate {
(9) eap: Expiring EAP session with state 0xaaad3105a2182889
(9) eap: Finished EAP session with state 0xaaad3105a2182889
(9) eap: Previous EAP request found for state 0xaaad3105a2182889, released from the list
(9) eap: Peer sent packet with method EAP PEAP (25)
(9) eap: Calling submodule eap_peap to process data
(9) eap_peap: Continuing EAP-TLS
(9) eap_peap: [eaptls verify] = ok
(9) eap_peap: Done initial handshake
(9) eap_peap: [eaptls process] = ok
(9) eap_peap: Session established.  Decoding tunneled attributes
(9) eap_peap: PEAP state send tlv failure
(9) eap_peap: Received EAP-TLV response
(9) eap_peap:   The users session was previously rejected: returning reject (again.)
(9) eap_peap:   This means you need to read the PREVIOUS messages in the debug output
(9) eap_peap:   to find out the reason why the user was rejected
(9) eap_peap:   Look for "reject" or "fail".  Those earlier messages will tell you
(9) eap_peap:   what went wrong, and how to fix the problem
(9) eap: ERROR: Failed continuing EAP PEAP (25) session.  EAP sub-module failed
(9) eap: Sending EAP Failure (code 4) ID 181 length 4
(9) eap: Failed in EAP select
(9)     [eap] = invalid
(9)   } # authenticate = invalid
(9) Failed to authenticate the user
(9) Using Post-Auth-Type Reject
(9) # Executing group from file /etc/freeradius/sites-enabled/default
(9)   Post-Auth-Type REJECT {
(9) sql: EXPAND .query
(9) sql:    --> .query
(9) sql: Using query template 'query'
rlm_sql (sql): Reserved connection (3)
(9) sql: EXPAND %{User-Name}
(9) sql:    --> emiruss
(9) sql: SQL-User-Name set to 'emiruss'
(9) sql: EXPAND INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')
(9) sql:    --> INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:12:53')
(9) sql: Executing query: INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:12:53')
(9) sql: SQL query returned: success
(9) sql: 1 record(s) updated
rlm_sql (sql): Released connection (3)
(9)     [sql] = ok
(9) attr_filter.access_reject: EXPAND %{User-Name}
(9) attr_filter.access_reject:    --> emiruss
(9) attr_filter.access_reject: Matched entry DEFAULT at line 11
(9)     [attr_filter.access_reject] = updated
(9)     [eap] = noop
(9)     policy remove_reply_message_if_eap {
(9)       if (&reply:EAP-Message && &reply:Reply-Message) {
(9)       if (&reply:EAP-Message && &reply:Reply-Message)  -> FALSE
(9)       else {
(9)         [noop] = noop
(9)       } # else = noop
(9)     } # policy remove_reply_message_if_eap = noop
(9)   } # Post-Auth-Type REJECT = updated
(9) Delaying response for 1.000000 seconds
Thread 1 waiting to be assigned a request
(9) Discarding duplicate request from client roocell-ap port 50041 - ID: 105 due to delayed response
Waking up in 0.6 seconds.
(9) Discarding duplicate request from client roocell-ap port 50041 - ID: 105 due to delayed response
Waking up in 0.3 seconds.
(9) Sending delayed response
(9) Sent Access-Reject Id 105 from 172.17.0.4:1812 to 192.168.1.30:50041 length 44
(9)   EAP-Message = 0x04b50004
(9)   Message-Authenticator = 0x00000000000000000000000000000000
Waking up in 1.6 seconds.
Thread 5 got semaphore
Thread 5 handling request 10, (3 handled so far)
(10) <running>: Received Access-Request Id 106 from 192.168.1.30:50041 to 172.17.0.4:1812 length 190
(10) <running>:   User-Name = "emiruss"
(10) <running>:   NAS-IP-Address = 192.168.1.30
(10) <running>:   NAS-Identifier = "Ericsson"
(10) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(10) <running>:   NAS-Port-Type = Wireless-802.11
(10) <running>:   NAS-Port = 0
(10) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(10) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(10) <running>:   Acct-Session-Id = "003E2DE6-0000004C"
(10) <running>:   Framed-MTU = 1400
(10) <running>:   EAP-Message = 0x027e000c01656d6972757373
(10) <running>:   Message-Authenticator = 0xf20dc5187ff6fde0d70aeb7197761d53
(10) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(10) <running>:   authorize {
(10) <running>:     policy filter_username {
(10) <running>:       if (!&User-Name) {
(10) <running>:       if (!&User-Name)  -> FALSE
(10) <running>:       if (&User-Name =~ / /) {
(10) <running>:       if (&User-Name =~ / /)  -> FALSE
(10) <running>:       if (&User-Name =~ /@.*@/ ) {
(10) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(10) <running>:       if (&User-Name =~ /\.\./ ) {
(10) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(10) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(10) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(10) <running>:       if (&User-Name =~ /\.$/)  {
(10) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(10) <running>:       if (&User-Name =~ /@\./)  {
(10) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(10) <running>:     } # policy filter_username = notfound
(10)     [preprocess] = ok
(10)     [chap] = noop
(10)     [mschap] = noop
(10)     [digest] = noop
(10) suffix: Checking for suffix after "@"
Waking up in 0.3 seconds.
(10) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(10) suffix: No such realm "NULL"
(10)     [suffix] = noop
(10) eap: Peer sent EAP Response (code 2) ID 126 length 12
(10) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(10)     [eap] = ok
(10)   } # authorize = ok
(10) Found Auth-Type = EAP
(10) # Executing group from file /etc/freeradius/sites-enabled/default
(10)   authenticate {
(10) eap: Peer sent packet with method EAP Identity (1)
(10) eap: Calling submodule eap_md5 to process data
(10) eap_md5: Issuing MD5 Challenge
(10) eap: Sending EAP Request (code 1) ID 127 length 22
(10) eap: EAP session adding &reply:State = 0xe4ae9b67e4d19f5f
(10)     [eap] = handled
(10)   } # authenticate = handled
(10) Using Post-Auth-Type Challenge
(10) Post-Auth-Type sub-section not found.  Ignoring.
(10) # Executing group from file /etc/freeradius/sites-enabled/default
(10) Sent Access-Challenge Id 106 from 172.17.0.4:1812 to 192.168.1.30:50041 length 0
(10)   EAP-Message = 0x017f001604107613a43c0556f602ded223f1b6a3bf9c
(10)   Message-Authenticator = 0x00000000000000000000000000000000
(10)   State = 0xe4ae9b67e4d19f5f26819f9afa086b5c
(10) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.3 seconds.
Thread 4 got semaphore
Thread 4 handling request 11, (3 handled so far)
(11) <running>: Received Access-Request Id 107 from 192.168.1.30:50041 to 172.17.0.4:1812 length 204
(11) <running>:   User-Name = "emiruss"
(11) <running>:   NAS-IP-Address = 192.168.1.30
(11) <running>:   NAS-Identifier = "Ericsson"
(11) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(11) <running>:   NAS-Port-Type = Wireless-802.11
(11) <running>:   NAS-Port = 0
(11) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(11) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(11) <running>:   Acct-Session-Id = "003E2DE6-0000004C"
(11) <running>:   Framed-MTU = 1400
(11) <running>:   EAP-Message = 0x027f00080319152b
(11) <running>:   State = 0xe4ae9b67e4d19f5f26819f9afa086b5c
(11) <running>:   Message-Authenticator = 0xf28f76cd44639e81e0d3ee033023b30f
(11) <running>: session-state: No cached attributes
(11) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(11) <running>:   authorize {
(11) <running>:     policy filter_username {
(11) <running>:       if (!&User-Name) {
(11) <running>:       if (!&User-Name)  -> FALSE
(11) <running>:       if (&User-Name =~ / /) {
(11) <running>:       if (&User-Name =~ / /)  -> FALSE
(11) <running>:       if (&User-Name =~ /@.*@/ ) {
(11) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(11) <running>:       if (&User-Name =~ /\.\./ ) {
(11) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(11) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(11) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(11) <running>:       if (&User-Name =~ /\.$/)  {
(11) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(11) <running>:       if (&User-Name =~ /@\./)  {
(11) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(11) <running>:     } # policy filter_username = notfound
(11)     [preprocess] = ok
(11)     [chap] = noop
(11)     [mschap] = noop
(11)     [digest] = noop
(11) suffix: Checking for suffix after "@"
(11) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(11) suffix: No such realm "NULL"
(11)     [suffix] = noop
(11) eap: Peer sent EAP Response (code 2) ID 127 length 8
(11) eap: No EAP Start, assuming it's an on-going EAP conversation
(11)     [eap] = updated
(11)     [files] = noop
(11) sql: EXPAND %{User-Name}
(11) sql:    --> emiruss
(11) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Reserved connection (4)
(11) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(11) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(11) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(11) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(11) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(11) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(11) sql: User not found in any groups
rlm_sql (sql): Released connection (4)
rlm_sql (sql): Need 3 more connections to reach 10 spares
rlm_sql (sql): Opening additional connection (7), 1 of 25 pending slots used
(11)     [sql] = notfound
(11)     [expiration] = noop
(11)     [logintime] = noop
(11) pap: WARNING: No "known good" password found for the user.  Not setting Auth-Type
(11) pap: WARNING: Authentication will fail unless a "known good" password is available
(11)     [pap] = noop
(11)   } # authorize = updated
(11) Found Auth-Type = EAP
(11) # Executing group from file /etc/freeradius/sites-enabled/default
(11)   authenticate {
(11) eap: Expiring EAP session with state 0xe4ae9b67e4d19f5f
(11) eap: Finished EAP session with state 0xe4ae9b67e4d19f5f
(11) eap: Previous EAP request found for state 0xe4ae9b67e4d19f5f, released from the list
(11) eap: Peer sent packet with method EAP NAK (3)
(11) eap: Found mutually acceptable type PEAP (25)
(11) eap: Calling submodule eap_peap to process data
(11) eap_peap: Initiating new EAP-TLS session
(11) eap_peap: [eaptls start] = request
(11) eap: Sending EAP Request (code 1) ID 128 length 6
(11) eap: EAP session adding &reply:State = 0xe4ae9b67e52e825f
(11)     [eap] = handled
(11)   } # authenticate = handled
(11) Using Post-Auth-Type Challenge
(11) Post-Auth-Type sub-section not found.  Ignoring.
(11) # Executing group from file /etc/freeradius/sites-enabled/default
(11) Sent Access-Challenge Id 107 from 172.17.0.4:1812 to 192.168.1.30:50041 length 0
(11)   EAP-Message = 0x018000061920
(11)   Message-Authenticator = 0x00000000000000000000000000000000
(11)   State = 0xe4ae9b67e52e825f26819f9afa086b5c
(11) Finished request
Thread 4 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 3 got semaphore
Thread 3 handling request 12, (3 handled so far)
(12) <running>: Received Access-Request Id 108 from 192.168.1.30:50041 to 172.17.0.4:1812 length 339
(12) <running>:   User-Name = "emiruss"
(12) <running>:   NAS-IP-Address = 192.168.1.30
(12) <running>:   NAS-Identifier = "Ericsson"
(12) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(12) <running>:   NAS-Port-Type = Wireless-802.11
(12) <running>:   NAS-Port = 0
(12) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(12) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(12) <running>:   Acct-Session-Id = "003E2DE6-0000004C"
(12) <running>:   Framed-MTU = 1400
(12) <running>:   EAP-Message = 0x0280008f19800000008516030100800100007c030156552bc511a51b0267cc7afcbc62766b91c8d346332ea77c24ce02a9380fe3c100003400ffc02cc02bc024c023c00ac009c008c030c02fc028c027c014c013c012009d009c003d003c0035002f000ac007c011000500040100001f000a0008000600
(12) <running>:   State = 0xe4ae9b67e52e825f26819f9afa086b5c
(12) <running>:   Message-Authenticator = 0x0cc2ed2c922a079da2f547036ac7c987
(12) <running>: session-state: No cached attributes
(12) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(12) <running>:   authorize {
(12) <running>:     policy filter_username {
(12) <running>:       if (!&User-Name) {
(12) <running>:       if (!&User-Name)  -> FALSE
(12) <running>:       if (&User-Name =~ / /) {
(12) <running>:       if (&User-Name =~ / /)  -> FALSE
(12) <running>:       if (&User-Name =~ /@.*@/ ) {
(12) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(12) <running>:       if (&User-Name =~ /\.\./ ) {
(12) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(12) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(12) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(12) <running>:       if (&User-Name =~ /\.$/)  {
(12) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(12) <running>:       if (&User-Name =~ /@\./)  {
(12) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(12) <running>:     } # policy filter_username = notfound
(12)     [preprocess] = ok
(12)     [chap] = noop
(12)     [mschap] = noop
(12)     [digest] = noop
(12) suffix: Checking for suffix after "@"
(12) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(12) suffix: No such realm "NULL"
(12)     [suffix] = noop
(12) eap: Peer sent EAP Response (code 2) ID 128 length 143
(12) eap: Continuing tunnel setup
(12)     [eap] = ok
(12)   } # authorize = ok
(12) Found Auth-Type = EAP
(12) # Executing group from file /etc/freeradius/sites-enabled/default
(12)   authenticate {
(12) eap: Expiring EAP session with state 0xe4ae9b67e52e825f
(12) eap: Finished EAP session with state 0xe4ae9b67e52e825f
(12) eap: Previous EAP request found for state 0xe4ae9b67e52e825f, released from the list
(12) eap: Peer sent packet with method EAP PEAP (25)
(12) eap: Calling submodule eap_peap to process data
(12) eap_peap: Continuing EAP-TLS
(12) eap_peap: Peer indicated complete TLS record size will be 133 bytes
(12) eap_peap: Got complete TLS record (133 bytes)
(12) eap_peap: [eaptls verify] = length included
(12) eap_peap: (other): before/accept initialization
(12) eap_peap: TLS_accept: before/accept initialization
(12) eap_peap: <<< TLS 1.0 Handshake [length 0080], ClientHello 
(12) eap_peap: TLS_accept: SSLv3 read client hello A
(12) eap_peap: >>> TLS 1.0 Handshake [length 0059], ServerHello 
(12) eap_peap: TLS_accept: SSLv3 write server hello A
(12) eap_peap: >>> TLS 1.0 Handshake [length 08d3], Certificate 
(12) eap_peap: TLS_accept: SSLv3 write certificate A
(12) eap_peap: >>> TLS 1.0 Handshake [length 014b], ServerKeyExchange 
(12) eap_peap: TLS_accept: SSLv3 write key exchange A
(12) eap_peap: >>> TLS 1.0 Handshake [length 0004], ServerHelloDone 
(12) eap_peap: TLS_accept: SSLv3 write server done A
(12) eap_peap: TLS_accept: SSLv3 flush data
(12) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(12) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(12) eap_peap: In SSL Handshake Phase
(12) eap_peap: In SSL Accept mode
(12) eap_peap: [eaptls process] = handled
(12) eap: Sending EAP Request (code 1) ID 129 length 1004
(12) eap: EAP session adding &reply:State = 0xe4ae9b67e62f825f
(12)     [eap] = handled
(12)   } # authenticate = handled
(12) Using Post-Auth-Type Challenge
(12) Post-Auth-Type sub-section not found.  Ignoring.
(12) # Executing group from file /etc/freeradius/sites-enabled/default
(12) Sent Access-Challenge Id 108 from 172.17.0.4:1812 to 192.168.1.30:50041 length 0
(12)   EAP-Message = 0x018103ec19c000000a8f160301005902000055030163e2b902b4d6e6133016d1bce610c70e17cce91a47cfc903883df1afd3c6e07520a202f0d3f2eca7bc81f717895d629a15e891a0679eb3dc3d5e40bc77591e45efc01400000dff01000100000b00040300010216030108d30b0008cf0008cc0003de
(12)   Message-Authenticator = 0x00000000000000000000000000000000
(12)   State = 0xe4ae9b67e62f825f26819f9afa086b5c
(12) Finished request
Thread 3 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 2 got semaphore
Thread 2 handling request 13, (3 handled so far)
(13) <running>: Received Access-Request Id 109 from 192.168.1.30:50041 to 172.17.0.4:1812 length 202
(13) <running>:   User-Name = "emiruss"
(13) <running>:   NAS-IP-Address = 192.168.1.30
(13) <running>:   NAS-Identifier = "Ericsson"
(13) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(13) <running>:   NAS-Port-Type = Wireless-802.11
(13) <running>:   NAS-Port = 0
(13) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(13) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(13) <running>:   Acct-Session-Id = "003E2DE6-0000004C"
(13) <running>:   Framed-MTU = 1400
(13) <running>:   EAP-Message = 0x028100061900
(13) <running>:   State = 0xe4ae9b67e62f825f26819f9afa086b5c
(13) <running>:   Message-Authenticator = 0x27e3f871c1604bfac8300242fbd1c0af
(13) <running>: session-state: No cached attributes
(13) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(13) <running>:   authorize {
(13) <running>:     policy filter_username {
(13) <running>:       if (!&User-Name) {
(13) <running>:       if (!&User-Name)  -> FALSE
(13) <running>:       if (&User-Name =~ / /) {
(13) <running>:       if (&User-Name =~ / /)  -> FALSE
(13) <running>:       if (&User-Name =~ /@.*@/ ) {
(13) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(13) <running>:       if (&User-Name =~ /\.\./ ) {
(13) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(13) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(13) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(13) <running>:       if (&User-Name =~ /\.$/)  {
(13) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(13) <running>:       if (&User-Name =~ /@\./)  {
(13) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(13) <running>:     } # policy filter_username = notfound
(13)     [preprocess] = ok
(13)     [chap] = noop
(13)     [mschap] = noop
(13)     [digest] = noop
(13) suffix: Checking for suffix after "@"
(13) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(13) suffix: No such realm "NULL"
(13)     [suffix] = noop
(13) eap: Peer sent EAP Response (code 2) ID 129 length 6
(13) eap: Continuing tunnel setup
(13)     [eap] = ok
(13)   } # authorize = ok
(13) Found Auth-Type = EAP
(13) # Executing group from file /etc/freeradius/sites-enabled/default
(13)   authenticate {
(13) eap: Expiring EAP session with state 0xe4ae9b67e62f825f
(13) eap: Finished EAP session with state 0xe4ae9b67e62f825f
(13) eap: Previous EAP request found for state 0xe4ae9b67e62f825f, released from the list
(13) eap: Peer sent packet with method EAP PEAP (25)
(13) eap: Calling submodule eap_peap to process data
(13) eap_peap: Continuing EAP-TLS
(13) eap_peap: Peer ACKed our handshake fragment
(13) eap_peap: [eaptls verify] = request
(13) eap_peap: [eaptls process] = handled
(13) eap: Sending EAP Request (code 1) ID 130 length 1000
(13) eap: EAP session adding &reply:State = 0xe4ae9b67e72c825f
(13)     [eap] = handled
(13)   } # authenticate = handled
(13) Using Post-Auth-Type Challenge
(13) Post-Auth-Type sub-section not found.  Ignoring.
(13) # Executing group from file /etc/freeradius/sites-enabled/default
(13) Sent Access-Challenge Id 109 from 172.17.0.4:1812 to 192.168.1.30:50041 length 0
(13)   EAP-Message = 0x018203e819400dd0405955c762981948527048701681d313d3cc6629a5557b66df2aae22c8590ab99d66ec8d3792a72e30596410f5d1e81f5a774969a1ce9ad6bd01d42da65536016e80a905c662a71ef5c075b8bdf0127a0cf1bd4c91290e15edffa035febde0185096bdc1e553090004e8308204e430
(13)   Message-Authenticator = 0x00000000000000000000000000000000
(13)   State = 0xe4ae9b67e72c825f26819f9afa086b5c
(13) Finished request
Thread 2 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 1 got semaphore
Thread 1 handling request 14, (3 handled so far)
(14) <running>: Received Access-Request Id 110 from 192.168.1.30:50041 to 172.17.0.4:1812 length 202
(14) <running>:   User-Name = "emiruss"
(14) <running>:   NAS-IP-Address = 192.168.1.30
(14) <running>:   NAS-Identifier = "Ericsson"
(14) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(14) <running>:   NAS-Port-Type = Wireless-802.11
(14) <running>:   NAS-Port = 0
(14) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(14) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(14) <running>:   Acct-Session-Id = "003E2DE6-0000004C"
(14) <running>:   Framed-MTU = 1400
(14) <running>:   EAP-Message = 0x028200061900
(14) <running>:   State = 0xe4ae9b67e72c825f26819f9afa086b5c
(14) <running>:   Message-Authenticator = 0x359c49c6ba9065410e71a337463a256d
(14) <running>: session-state: No cached attributes
(14) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(14) <running>:   authorize {
(14) <running>:     policy filter_username {
(14) <running>:       if (!&User-Name) {
(14) <running>:       if (!&User-Name)  -> FALSE
(14) <running>:       if (&User-Name =~ / /) {
(14) <running>:       if (&User-Name =~ / /)  -> FALSE
(14) <running>:       if (&User-Name =~ /@.*@/ ) {
(14) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(14) <running>:       if (&User-Name =~ /\.\./ ) {
(14) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(14) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(14) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(14) <running>:       if (&User-Name =~ /\.$/)  {
(14) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(14) <running>:       if (&User-Name =~ /@\./)  {
(14) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(14) <running>:     } # policy filter_username = notfound
(14)     [preprocess] = ok
(14)     [chap] = noop
(14)     [mschap] = noop
(14)     [digest] = noop
(14) suffix: Checking for suffix after "@"
(14) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(14) suffix: No such realm "NULL"
(14)     [suffix] = noop
(14) eap: Peer sent EAP Response (code 2) ID 130 length 6
(14) eap: Continuing tunnel setup
(14)     [eap] = ok
(14)   } # authorize = ok
(14) Found Auth-Type = EAP
(14) # Executing group from file /etc/freeradius/sites-enabled/default
(14)   authenticate {
(14) eap: Expiring EAP session with state 0xe4ae9b67e72c825f
(14) eap: Finished EAP session with state 0xe4ae9b67e72c825f
(14) eap: Previous EAP request found for state 0xe4ae9b67e72c825f, released from the list
(14) eap: Peer sent packet with method EAP PEAP (25)
(14) eap: Calling submodule eap_peap to process data
(14) eap_peap: Continuing EAP-TLS
(14) eap_peap: Peer ACKed our handshake fragment
(14) eap_peap: [eaptls verify] = request
(14) eap_peap: [eaptls process] = handled
(14) eap: Sending EAP Request (code 1) ID 131 length 721
(14) eap: EAP session adding &reply:State = 0xe4ae9b67e02d825f
(14)     [eap] = handled
(14)   } # authenticate = handled
(14) Using Post-Auth-Type Challenge
(14) Post-Auth-Type sub-section not found.  Ignoring.
(14) # Executing group from file /etc/freeradius/sites-enabled/default
(14) Sent Access-Challenge Id 110 from 172.17.0.4:1812 to 192.168.1.30:50041 length 0
(14)   EAP-Message = 0x018302d1190020417574686f72697479820900c3fc536eef83d741300f0603551d130101ff040530030101ff30360603551d1f042f302d302ba029a0278625687474703a2f2f7777772e6578616d706c652e6f72672f6578616d706c655f63612e63726c300d06092a864886f70d01010b050003820101
(14)   Message-Authenticator = 0x00000000000000000000000000000000
(14)   State = 0xe4ae9b67e02d825f26819f9afa086b5c
(14) Finished request
Thread 1 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 5 got semaphore
Thread 5 handling request 15, (4 handled so far)
(15) <running>: Received Access-Request Id 111 from 192.168.1.30:50041 to 172.17.0.4:1812 length 340
(15) <running>:   User-Name = "emiruss"
(15) <running>:   NAS-IP-Address = 192.168.1.30
(15) <running>:   NAS-Identifier = "Ericsson"
(15) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(15) <running>:   NAS-Port-Type = Wireless-802.11
(15) <running>:   NAS-Port = 0
(15) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(15) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(15) <running>:   Acct-Session-Id = "003E2DE6-0000004C"
(15) <running>:   Framed-MTU = 1400
(15) <running>:   EAP-Message = 0x0283009019800000008616030100461000004241046da7140fa757c2ac8174ec2d044828c5bd469c938eefc07c79b459e702abcbda2172bfd296699ef2c01147eb460178f269d467d25268c9d57b2556d047b9709a1403010001011603010030b533d63a5da241b842258e9180fcf540c7942bd34150b6
(15) <running>:   State = 0xe4ae9b67e02d825f26819f9afa086b5c
(15) <running>:   Message-Authenticator = 0x50394416faeb060bbef97e1920a80515
(15) <running>: session-state: No cached attributes
(15) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(15) <running>:   authorize {
(15) <running>:     policy filter_username {
(15) <running>:       if (!&User-Name) {
(15) <running>:       if (!&User-Name)  -> FALSE
(15) <running>:       if (&User-Name =~ / /) {
(15) <running>:       if (&User-Name =~ / /)  -> FALSE
(15) <running>:       if (&User-Name =~ /@.*@/ ) {
(15) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(15) <running>:       if (&User-Name =~ /\.\./ ) {
(15) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(15) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(15) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(15) <running>:       if (&User-Name =~ /\.$/)  {
(15) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(15) <running>:       if (&User-Name =~ /@\./)  {
(15) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(15) <running>:     } # policy filter_username = notfound
(15)     [preprocess] = ok
(15)     [chap] = noop
(15)     [mschap] = noop
(15)     [digest] = noop
(15) suffix: Checking for suffix after "@"
(15) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(15) suffix: No such realm "NULL"
(15)     [suffix] = noop
(15) eap: Peer sent EAP Response (code 2) ID 131 length 144
(15) eap: Continuing tunnel setup
(15)     [eap] = ok
(15)   } # authorize = ok
(15) Found Auth-Type = EAP
(15) # Executing group from file /etc/freeradius/sites-enabled/default
(15)   authenticate {
(15) eap: Expiring EAP session with state 0xe4ae9b67e02d825f
(15) eap: Finished EAP session with state 0xe4ae9b67e02d825f
(15) eap: Previous EAP request found for state 0xe4ae9b67e02d825f, released from the list
(15) eap: Peer sent packet with method EAP PEAP (25)
(15) eap: Calling submodule eap_peap to process data
(15) eap_peap: Continuing EAP-TLS
(15) eap_peap: Peer indicated complete TLS record size will be 134 bytes
(15) eap_peap: Got complete TLS record (134 bytes)
(15) eap_peap: [eaptls verify] = length included
(15) eap_peap: <<< TLS 1.0 Handshake [length 0046], ClientKeyExchange 
(15) eap_peap: TLS_accept: SSLv3 read client key exchange A
(15) eap_peap: <<< TLS 1.0 ChangeCipherSpec [length 0001] 
(15) eap_peap: <<< TLS 1.0 Handshake [length 0010], Finished 
(15) eap_peap: TLS_accept: SSLv3 read finished A
(15) eap_peap: >>> TLS 1.0 ChangeCipherSpec [length 0001] 
(15) eap_peap: TLS_accept: SSLv3 write change cipher spec A
(15) eap_peap: >>> TLS 1.0 Handshake [length 0010], Finished 
(15) eap_peap: TLS_accept: SSLv3 write finished A
(15) eap_peap: TLS_accept: SSLv3 flush data
(15) eap_peap: (other): SSL negotiation finished successfully
(15) eap_peap: SSL Connection Established
(15) eap_peap: [eaptls process] = handled
(15) eap: Sending EAP Request (code 1) ID 132 length 65
(15) eap: EAP session adding &reply:State = 0xe4ae9b67e12a825f
(15)     [eap] = handled
(15)   } # authenticate = handled
(15) Using Post-Auth-Type Challenge
(15) Post-Auth-Type sub-section not found.  Ignoring.
(15) # Executing group from file /etc/freeradius/sites-enabled/default
(15) Sent Access-Challenge Id 111 from 172.17.0.4:1812 to 192.168.1.30:50041 length 0
(15)   EAP-Message = 0x01840041190014030100010116030100309d854d342930b0eaa14af119a826870d88d580a3d201d7e21d9a48b346507c5b6ce733ba05e95405e39aad43f6f3d3b5
(15)   Message-Authenticator = 0x00000000000000000000000000000000
(15)   State = 0xe4ae9b67e12a825f26819f9afa086b5c
(15) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 4 got semaphore
Thread 4 handling request 16, (4 handled so far)
(16) <running>: Received Access-Request Id 112 from 192.168.1.30:50041 to 172.17.0.4:1812 length 202
(16) <running>:   User-Name = "emiruss"
(16) <running>:   NAS-IP-Address = 192.168.1.30
(16) <running>:   NAS-Identifier = "Ericsson"
(16) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(16) <running>:   NAS-Port-Type = Wireless-802.11
(16) <running>:   NAS-Port = 0
(16) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(16) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(16) <running>:   Acct-Session-Id = "003E2DE6-0000004C"
(16) <running>:   Framed-MTU = 1400
(16) <running>:   EAP-Message = 0x028400061900
(16) <running>:   State = 0xe4ae9b67e12a825f26819f9afa086b5c
(16) <running>:   Message-Authenticator = 0x0a57d190e1bb766f35f738cca7b1d21c
(16) <running>: session-state: No cached attributes
(16) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(16) <running>:   authorize {
(16) <running>:     policy filter_username {
(16) <running>:       if (!&User-Name) {
(16) <running>:       if (!&User-Name)  -> FALSE
(16) <running>:       if (&User-Name =~ / /) {
(16) <running>:       if (&User-Name =~ / /)  -> FALSE
(16) <running>:       if (&User-Name =~ /@.*@/ ) {
(16) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(16) <running>:       if (&User-Name =~ /\.\./ ) {
(16) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(16) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(16) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(16) <running>:       if (&User-Name =~ /\.$/)  {
(16) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(16) <running>:       if (&User-Name =~ /@\./)  {
(16) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(16) <running>:     } # policy filter_username = notfound
(16)     [preprocess] = ok
(16)     [chap] = noop
(16)     [mschap] = noop
(16)     [digest] = noop
(16) suffix: Checking for suffix after "@"
(16) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(16) suffix: No such realm "NULL"
(16)     [suffix] = noop
(16) eap: Peer sent EAP Response (code 2) ID 132 length 6
(16) eap: Continuing tunnel setup
(16)     [eap] = ok
(16)   } # authorize = ok
(16) Found Auth-Type = EAP
(16) # Executing group from file /etc/freeradius/sites-enabled/default
(16)   authenticate {
(16) eap: Expiring EAP session with state 0xe4ae9b67e12a825f
(16) eap: Finished EAP session with state 0xe4ae9b67e12a825f
(16) eap: Previous EAP request found for state 0xe4ae9b67e12a825f, released from the list
(16) eap: Peer sent packet with method EAP PEAP (25)
(16) eap: Calling submodule eap_peap to process data
(16) eap_peap: Continuing EAP-TLS
(16) eap_peap: Peer ACKed our handshake fragment.  handshake is finished
(16) eap_peap: [eaptls verify] = success
(16) eap_peap: [eaptls process] = success
(16) eap_peap: Session established.  Decoding tunneled attributes
(16) eap_peap: PEAP state TUNNEL ESTABLISHED
(16) eap: Sending EAP Request (code 1) ID 133 length 43
(16) eap: EAP session adding &reply:State = 0xe4ae9b67e22b825f
(16)     [eap] = handled
(16)   } # authenticate = handled
(16) Using Post-Auth-Type Challenge
(16) Post-Auth-Type sub-section not found.  Ignoring.
(16) # Executing group from file /etc/freeradius/sites-enabled/default
(16) Sent Access-Challenge Id 112 from 172.17.0.4:1812 to 192.168.1.30:50041 length 0
(16)   EAP-Message = 0x0185002b19001703010020e16d8efd70a52e621ceec09fd5e75623d6c94d7dde3c047f2404fbaf43c0620c
(16)   Message-Authenticator = 0x00000000000000000000000000000000
(16)   State = 0xe4ae9b67e22b825f26819f9afa086b5c
(16) Finished request
Thread 4 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 3 got semaphore
Thread 3 handling request 17, (4 handled so far)
(17) <running>: Received Access-Request Id 113 from 192.168.1.30:50041 to 172.17.0.4:1812 length 239
(17) <running>:   User-Name = "emiruss"
(17) <running>:   NAS-IP-Address = 192.168.1.30
(17) <running>:   NAS-Identifier = "Ericsson"
(17) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(17) <running>:   NAS-Port-Type = Wireless-802.11
(17) <running>:   NAS-Port = 0
(17) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(17) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(17) <running>:   Acct-Session-Id = "003E2DE6-0000004C"
(17) <running>:   Framed-MTU = 1400
(17) <running>:   EAP-Message = 0x0285002b19001703010020866c6c6da07c8caf8e3a6feb90a17b6120d726c914b0ea7840a690fc574fbfe6
(17) <running>:   State = 0xe4ae9b67e22b825f26819f9afa086b5c
(17) <running>:   Message-Authenticator = 0xd994d664abd6f3bee503d14ebb1a7cf8
(17) <running>: session-state: No cached attributes
(17) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(17) <running>:   authorize {
(17) <running>:     policy filter_username {
(17) <running>:       if (!&User-Name) {
(17) <running>:       if (!&User-Name)  -> FALSE
(17) <running>:       if (&User-Name =~ / /) {
(17) <running>:       if (&User-Name =~ / /)  -> FALSE
(17) <running>:       if (&User-Name =~ /@.*@/ ) {
(17) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(17) <running>:       if (&User-Name =~ /\.\./ ) {
(17) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(17) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(17) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(17) <running>:       if (&User-Name =~ /\.$/)  {
(17) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(17) <running>:       if (&User-Name =~ /@\./)  {
(17) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(17) <running>:     } # policy filter_username = notfound
(17)     [preprocess] = ok
(17)     [chap] = noop
(17)     [mschap] = noop
(17)     [digest] = noop
(17) suffix: Checking for suffix after "@"
(17) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(17) suffix: No such realm "NULL"
(17)     [suffix] = noop
(17) eap: Peer sent EAP Response (code 2) ID 133 length 43
(17) eap: Continuing tunnel setup
(17)     [eap] = ok
(17)   } # authorize = ok
(17) Found Auth-Type = EAP
(17) # Executing group from file /etc/freeradius/sites-enabled/default
(17)   authenticate {
(17) eap: Expiring EAP session with state 0xe4ae9b67e22b825f
(17) eap: Finished EAP session with state 0xe4ae9b67e22b825f
(17) eap: Previous EAP request found for state 0xe4ae9b67e22b825f, released from the list
(17) eap: Peer sent packet with method EAP PEAP (25)
(17) eap: Calling submodule eap_peap to process data
(17) eap_peap: Continuing EAP-TLS
(17) eap_peap: [eaptls verify] = ok
(17) eap_peap: Done initial handshake
(17) eap_peap: [eaptls process] = ok
(17) eap_peap: Session established.  Decoding tunneled attributes
(17) eap_peap: PEAP state WAITING FOR INNER IDENTITY
(17) eap_peap: Identity - emiruss
(17) eap_peap: Got inner identity 'emiruss'
(17) eap_peap: Setting default EAP type for tunneled EAP session
(17) eap_peap: Got tunneled request
(17) eap_peap:   EAP-Message = 0x0285000c01656d6972757373
(17) eap_peap: Setting User-Name to emiruss
(17) eap_peap: Sending tunneled request to inner-tunnel
(17) eap_peap:   EAP-Message = 0x0285000c01656d6972757373
(17) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(17) eap_peap:   User-Name = "emiruss"
(17) Virtual server inner-tunnel received request
(17)   EAP-Message = 0x0285000c01656d6972757373
(17)   FreeRADIUS-Proxied-To = 127.0.0.1
(17)   User-Name = "emiruss"
(17) server inner-tunnel {
(17)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(17)     authorize {
(17)       [chap] = noop
(17)       [mschap] = noop
(17) suffix: Checking for suffix after "@"
(17) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(17) suffix: No such realm "NULL"
(17)       [suffix] = noop
(17)       update control {
(17)         &Proxy-To-Realm := LOCAL
(17)       } # update control = noop
(17) eap: Peer sent EAP Response (code 2) ID 133 length 12
(17) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(17)       [eap] = ok
(17)     } # authorize = ok
(17)   Found Auth-Type = EAP
(17)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(17)     authenticate {
(17) eap: Peer sent packet with method EAP Identity (1)
(17) eap: Calling submodule eap_mschapv2 to process data
(17) eap_mschapv2: Issuing Challenge
(17) eap: Sending EAP Request (code 1) ID 134 length 43
(17) eap: EAP session adding &reply:State = 0xada2aa79ad24b02c
(17)       [eap] = handled
(17)     } # authenticate = handled
(17) } # server inner-tunnel
(17) Virtual server sending reply
(17)   EAP-Message = 0x0186002b1a0186002610cd325599199e581156e6c53fe5087036667265657261646975732d332e302e3130
(17)   Message-Authenticator = 0x00000000000000000000000000000000
(17)   State = 0xada2aa79ad24b02ced09bfe806141c38
(17) eap_peap: Got tunneled reply code 11
(17) eap_peap:   EAP-Message = 0x0186002b1a0186002610cd325599199e581156e6c53fe5087036667265657261646975732d332e302e3130
(17) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(17) eap_peap:   State = 0xada2aa79ad24b02ced09bfe806141c38
(17) eap_peap: Got tunneled Access-Challenge
(17) eap: Sending EAP Request (code 1) ID 134 length 75
(17) eap: EAP session adding &reply:State = 0xe4ae9b67e328825f
(17)     [eap] = handled
(17)   } # authenticate = handled
(17) Using Post-Auth-Type Challenge
(17) Post-Auth-Type sub-section not found.  Ignoring.
(17) # Executing group from file /etc/freeradius/sites-enabled/default
(17) Sent Access-Challenge Id 113 from 172.17.0.4:1812 to 192.168.1.30:50041 length 0
(17)   EAP-Message = 0x0186004b190017030100409d4b9535c099d06088583df929eda0e57d7b47253c3c36df1e2ebc02a340e61b060f1ec6c862b0fa0954fdb0eff35750a1a7741194ad52197d52768295163c97
(17)   Message-Authenticator = 0x00000000000000000000000000000000
(17)   State = 0xe4ae9b67e328825f26819f9afa086b5c
(17) Finished request
Thread 3 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 2 got semaphore
Thread 2 handling request 18, (4 handled so far)
(18) <running>: Received Access-Request Id 114 from 192.168.1.30:50041 to 172.17.0.4:1812 length 303
(18) <running>:   User-Name = "emiruss"
(18) <running>:   NAS-IP-Address = 192.168.1.30
(18) <running>:   NAS-Identifier = "Ericsson"
(18) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(18) <running>:   NAS-Port-Type = Wireless-802.11
(18) <running>:   NAS-Port = 0
(18) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(18) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(18) <running>:   Acct-Session-Id = "003E2DE6-0000004C"
(18) <running>:   Framed-MTU = 1400
(18) <running>:   EAP-Message = 0x0286006b190017030100605d0e23f81f6a52f2fd6bc498232b886128e2a4b5824ffd4cebcf71cd4c95fd59003123cf5323ad747ba492d6c072137ad5f21b2cc0c369de5cf129335215649002d15cc09ff2d62b75ff679ae2952c68e89f89e6ab5933f3937a131db521eb28
(18) <running>:   State = 0xe4ae9b67e328825f26819f9afa086b5c
(18) <running>:   Message-Authenticator = 0x01799dddb943f398c81b695e3d8be791
(18) <running>: session-state: No cached attributes
(18) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(18) <running>:   authorize {
(18) <running>:     policy filter_username {
(18) <running>:       if (!&User-Name) {
(18) <running>:       if (!&User-Name)  -> FALSE
(18) <running>:       if (&User-Name =~ / /) {
(18) <running>:       if (&User-Name =~ / /)  -> FALSE
(18) <running>:       if (&User-Name =~ /@.*@/ ) {
(18) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(18) <running>:       if (&User-Name =~ /\.\./ ) {
(18) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(18) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(18) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(18) <running>:       if (&User-Name =~ /\.$/)  {
(18) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(18) <running>:       if (&User-Name =~ /@\./)  {
(18) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(18) <running>:     } # policy filter_username = notfound
(18)     [preprocess] = ok
(18)     [chap] = noop
(18)     [mschap] = noop
(18)     [digest] = noop
(18) suffix: Checking for suffix after "@"
(18) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(18) suffix: No such realm "NULL"
(18)     [suffix] = noop
(18) eap: Peer sent EAP Response (code 2) ID 134 length 107
(18) eap: Continuing tunnel setup
(18)     [eap] = ok
(18)   } # authorize = ok
(18) Found Auth-Type = EAP
(18) # Executing group from file /etc/freeradius/sites-enabled/default
(18)   authenticate {
(18) eap: Expiring EAP session with state 0xada2aa79ad24b02c
(18) eap: Finished EAP session with state 0xe4ae9b67e328825f
(18) eap: Previous EAP request found for state 0xe4ae9b67e328825f, released from the list
(18) eap: Peer sent packet with method EAP PEAP (25)
(18) eap: Calling submodule eap_peap to process data
(18) eap_peap: Continuing EAP-TLS
(18) eap_peap: [eaptls verify] = ok
(18) eap_peap: Done initial handshake
(18) eap_peap: [eaptls process] = ok
(18) eap_peap: Session established.  Decoding tunneled attributes
(18) eap_peap: PEAP state phase2
(18) eap_peap: EAP method MSCHAPv2 (26)
(18) eap_peap: Got tunneled request
(18) eap_peap:   EAP-Message = 0x028600421a0286003d3123bba495c4ec42662fc4785ac9626b3e0000000000000000e393ff9a4ed997f3948084b9cf7c62e5ed4ff7f2b9110c2600656d6972757373
(18) eap_peap: Setting User-Name to emiruss
(18) eap_peap: Sending tunneled request to inner-tunnel
(18) eap_peap:   EAP-Message = 0x028600421a0286003d3123bba495c4ec42662fc4785ac9626b3e0000000000000000e393ff9a4ed997f3948084b9cf7c62e5ed4ff7f2b9110c2600656d6972757373
(18) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(18) eap_peap:   User-Name = "emiruss"
(18) eap_peap:   State = 0xada2aa79ad24b02ced09bfe806141c38
(18) Virtual server inner-tunnel received request
(18)   EAP-Message = 0x028600421a0286003d3123bba495c4ec42662fc4785ac9626b3e0000000000000000e393ff9a4ed997f3948084b9cf7c62e5ed4ff7f2b9110c2600656d6972757373
(18)   FreeRADIUS-Proxied-To = 127.0.0.1
(18)   User-Name = "emiruss"
(18)   State = 0xada2aa79ad24b02ced09bfe806141c38
(18) server inner-tunnel {
(18)   session-state: No cached attributes
(18)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(18)     authorize {
(18)       [chap] = noop
(18)       [mschap] = noop
(18) suffix: Checking for suffix after "@"
(18) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(18) suffix: No such realm "NULL"
(18)       [suffix] = noop
(18)       update control {
(18)         &Proxy-To-Realm := LOCAL
(18)       } # update control = noop
(18) eap: Peer sent EAP Response (code 2) ID 134 length 66
(18) eap: No EAP Start, assuming it's an on-going EAP conversation
(18)       [eap] = updated
(18)       [files] = noop
(18) sql: EXPAND %{User-Name}
(18) sql:    --> emiruss
(18) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Reserved connection (0)
(18) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(18) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(18) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(18) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(18) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(18) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(18) sql: User not found in any groups
rlm_sql (sql): Released connection (0)
(18)       [sql] = notfound
(18)       [expiration] = noop
(18)       [logintime] = noop
(18)       [pap] = noop
(18)     } # authorize = updated
(18)   Found Auth-Type = EAP
(18)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(18)     authenticate {
(18) eap: Expiring EAP session with state 0xada2aa79ad24b02c
(18) eap: Finished EAP session with state 0xada2aa79ad24b02c
(18) eap: Previous EAP request found for state 0xada2aa79ad24b02c, released from the list
(18) eap: Peer sent packet with method EAP MSCHAPv2 (26)
(18) eap: Calling submodule eap_mschapv2 to process data
(18) eap_mschapv2: # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(18) eap_mschapv2:   Auth-Type MS-CHAP {
(18) mschap: WARNING: No Cleartext-Password configured.  Cannot create NT-Password
(18) mschap: WARNING: No Cleartext-Password configured.  Cannot create LM-Password
(18) mschap: Creating challenge hash with username: emiruss
(18) mschap: Client is using MS-CHAPv2
(18) mschap: ERROR: FAILED: No NT/LM-Password.  Cannot perform authentication
(18) mschap: ERROR: MS-CHAP2-Response is incorrect
(18)     [mschap] = reject
(18)   } # Auth-Type MS-CHAP = reject
(18) eap: Sending EAP Failure (code 4) ID 134 length 4
(18) eap: Freeing handler
(18)       [eap] = reject
(18)     } # authenticate = reject
(18)   Failed to authenticate the user
(18)   Using Post-Auth-Type Reject
(18)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(18)     Post-Auth-Type REJECT {
(18) sql: EXPAND .query
(18) sql:    --> .query
(18) sql: Using query template 'query'
rlm_sql (sql): Reserved connection (5)
(18) sql: EXPAND %{User-Name}
(18) sql:    --> emiruss
(18) sql: SQL-User-Name set to 'emiruss'
(18) sql: EXPAND INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')
(18) sql:    --> INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:12:54')
(18) sql: Executing query: INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:12:54')
(18) sql: SQL query returned: success
(18) sql: 1 record(s) updated
rlm_sql (sql): Released connection (5)
(18)       [sql] = ok
(18) attr_filter.access_reject: EXPAND %{User-Name}
(18) attr_filter.access_reject:    --> emiruss
(18) attr_filter.access_reject: Matched entry DEFAULT at line 11
(18)       [attr_filter.access_reject] = updated
(18)       update outer.session-state {
(18)         &Module-Failure-Message := &request:Module-Failure-Message -> 'mschap: FAILED: No NT/LM-Password.  Cannot perform authentication'
(18)       } # update outer.session-state = noop
(18)     } # Post-Auth-Type REJECT = updated
(18) } # server inner-tunnel
(18) Virtual server sending reply
(18)   MS-CHAP-Error = "\206E=691 R=1 C=3137ef582586f2905cc33efc83f9218c V=3 M=Authentication failed"
(18)   EAP-Message = 0x04860004
(18)   Message-Authenticator = 0x00000000000000000000000000000000
(18) eap_peap: Got tunneled reply code 3
(18) eap_peap:   MS-CHAP-Error = "\206E=691 R=1 C=3137ef582586f2905cc33efc83f9218c V=3 M=Authentication failed"
(18) eap_peap:   EAP-Message = 0x04860004
(18) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(18) eap_peap: Tunneled authentication was rejected
(18) eap_peap: FAILURE
(18) eap: Sending EAP Request (code 1) ID 135 length 43
(18) eap: EAP session adding &reply:State = 0xe4ae9b67ec29825f
(18)     [eap] = handled
(18)   } # authenticate = handled
(18) Using Post-Auth-Type Challenge
(18) Post-Auth-Type sub-section not found.  Ignoring.
(18) # Executing group from file /etc/freeradius/sites-enabled/default
(18) session-state: Saving cached attributes
(18)   Module-Failure-Message := "mschap: FAILED: No NT/LM-Password.  Cannot perform authentication"
(18) Sent Access-Challenge Id 114 from 172.17.0.4:1812 to 192.168.1.30:50041 length 0
(18)   EAP-Message = 0x0187002b1900170301002078ec7b15e67762cde0d2fb2aeed2509a849feadfdf160ff83e26cc74b6ceea9f
(18)   Message-Authenticator = 0x00000000000000000000000000000000
(18)   State = 0xe4ae9b67ec29825f26819f9afa086b5c
(18) Finished request
Thread 2 waiting to be assigned a request
Thread 1 got semaphore
Thread 1 handling request 19, (4 handled so far)
(19) <running>: Received Access-Request Id 115 from 192.168.1.30:50041 to 172.17.0.4:1812 length 239
(19) <running>:   User-Name = "emiruss"
(19) <running>:   NAS-IP-Address = 192.168.1.30
(19) <running>:   NAS-Identifier = "Ericsson"
(19) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(19) <running>:   NAS-Port-Type = Wireless-802.11
(19) <running>:   NAS-Port = 0
(19) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(19) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(19) <running>:   Acct-Session-Id = "003E2DE6-0000004C"
(19) <running>:   Framed-MTU = 1400
(19) <running>:   EAP-Message = 0x0287002b190017030100206a224befb1dc294d74777924e59c09bce1b3fdcf84717b4912ff121da59e57e3
(19) <running>:   State = 0xe4ae9b67ec29825f26819f9afa086b5c
(19) <running>:   Message-Authenticator = 0x5416c08aa92a7da089ca9b3dfa37252c
(19) <running>: session-state: Found cached attributes
(19) <running>:   Module-Failure-Message := "mschap: FAILED: No NT/LM-Password.  Cannot perform authentication"
(19) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(19) <running>:   authorize {
(19) <running>:     policy filter_username {
(19) <running>:       if (!&User-Name) {
(19) <running>:       if (!&User-Name)  -> FALSE
(19) <running>:       if (&User-Name =~ / /) {
(19) <running>:       if (&User-Name =~ / /)  -> FALSE
(19) <running>:       if (&User-Name =~ /@.*@/ ) {
(19) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(19) <running>:       if (&User-Name =~ /\.\./ ) {
(19) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(19) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(19) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(19) <running>:       if (&User-Name =~ /\.$/)  {
(19) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(19) <running>:       if (&User-Name =~ /@\./)  {
(19) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(19) <running>:     } # policy filter_username = notfound
(19)     [preprocess] = ok
(19)     [chap] = noop
(19)     [mschap] = noop
(19)     [digest] = noop
(19) suffix: Checking for suffix after "@"
(19) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(19) suffix: No such realm "NULL"
(19)     [suffix] = noop
(19) eap: Peer sent EAP Response (code 2) ID 135 length 43
(19) eap: Continuing tunnel setup
(19)     [eap] = ok
(19)   } # authorize = ok
(19) Found Auth-Type = EAP
(19) # Executing group from file /etc/freeradius/sites-enabled/default
(19)   authenticate {
(19) eap: Expiring EAP session with state 0xe4ae9b67ec29825f
(19) eap: Finished EAP session with state 0xe4ae9b67ec29825f
(19) eap: Previous EAP request found for state 0xe4ae9b67ec29825f, released from the list
(19) eap: Peer sent packet with method EAP PEAP (25)
(19) eap: Calling submodule eap_peap to process data
(19) eap_peap: Continuing EAP-TLS
(19) eap_peap: [eaptls verify] = ok
(19) eap_peap: Done initial handshake
(19) eap_peap: [eaptls process] = ok
(19) eap_peap: Session established.  Decoding tunneled attributes
(19) eap_peap: PEAP state send tlv failure
(19) eap_peap: Received EAP-TLV response
(19) eap_peap:   The users session was previously rejected: returning reject (again.)
(19) eap_peap:   This means you need to read the PREVIOUS messages in the debug output
(19) eap_peap:   to find out the reason why the user was rejected
(19) eap_peap:   Look for "reject" or "fail".  Those earlier messages will tell you
(19) eap_peap:   what went wrong, and how to fix the problem
(19) eap: ERROR: Failed continuing EAP PEAP (25) session.  EAP sub-module failed
(19) eap: Sending EAP Failure (code 4) ID 135 length 4
(19) eap: Failed in EAP select
(19)     [eap] = invalid
(19)   } # authenticate = invalid
(19) Failed to authenticate the user
(19) Using Post-Auth-Type Reject
(19) # Executing group from file /etc/freeradius/sites-enabled/default
(19)   Post-Auth-Type REJECT {
(19) sql: EXPAND .query
(19) sql:    --> .query
(19) sql: Using query template 'query'
rlm_sql (sql): Reserved connection (1)
(19) sql: EXPAND %{User-Name}
(19) sql:    --> emiruss
(19) sql: SQL-User-Name set to 'emiruss'
(19) sql: EXPAND INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')
(19) sql:    --> INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:12:54')
(19) sql: Executing query: INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:12:54')
(19) sql: SQL query returned: success
(19) sql: 1 record(s) updated
rlm_sql (sql): Released connection (1)
(19)     [sql] = ok
(19) attr_filter.access_reject: EXPAND %{User-Name}
(19) attr_filter.access_reject:    --> emiruss
(19) attr_filter.access_reject: Matched entry DEFAULT at line 11
(19)     [attr_filter.access_reject] = updated
(19)     [eap] = noop
(19)     policy remove_reply_message_if_eap {
(19)       if (&reply:EAP-Message && &reply:Reply-Message) {
(19)       if (&reply:EAP-Message && &reply:Reply-Message)  -> FALSE
(19)       else {
(19)         [noop] = noop
(19)       } # else = noop
(19)     } # policy remove_reply_message_if_eap = noop
(19)   } # Post-Auth-Type REJECT = updated
(19) Delaying response for 1.000000 seconds
Thread 1 waiting to be assigned a request
(19) Discarding duplicate request from client roocell-ap port 50041 - ID: 115 due to delayed response
Waking up in 0.6 seconds.
(19) Sending delayed response
(19) Sent Access-Reject Id 115 from 172.17.0.4:1812 to 192.168.1.30:50041 length 44
(19)   EAP-Message = 0x04870004
(19)   Message-Authenticator = 0x00000000000000000000000000000000
Waking up in 0.3 seconds.
(0) Cleaning up request packet ID 96 with timestamp +6
(1) Cleaning up request packet ID 97 with timestamp +6
(2) Cleaning up request packet ID 98 with timestamp +6
(3) Cleaning up request packet ID 99 with timestamp +6
(4) Cleaning up request packet ID 100 with timestamp +6
Waking up in 1.9 seconds.
Thread 5 got semaphore
Thread 5 handling request 20, (5 handled so far)
(20) <running>: Received Access-Request Id 116 from 192.168.1.30:50042 to 172.17.0.4:1812 length 190
(20) <running>:   User-Name = "emiruss"
(20) <running>:   NAS-IP-Address = 192.168.1.30
(20) <running>:   NAS-Identifier = "Ericsson"
(20) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(20) <running>:   NAS-Port-Type = Wireless-802.11
(20) <running>:   NAS-Port = 0
(20) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(20) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(20) <running>:   Acct-Session-Id = "003E2DE6-0000004D"
(20) <running>:   Framed-MTU = 1400
(20) <running>:   EAP-Message = 0x02b9000c01656d6972757373
(20) <running>:   Message-Authenticator = 0x5d6a0103fb0502a0b13cce5ab00bbeed
(20) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(20) <running>:   authorize {
(20) <running>:     policy filter_username {
(20) <running>:       if (!&User-Name) {
(20) <running>:       if (!&User-Name)  -> FALSE
(20) <running>:       if (&User-Name =~ / /) {
(20) <running>:       if (&User-Name =~ / /)  -> FALSE
(20) <running>:       if (&User-Name =~ /@.*@/ ) {
(20) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(20) <running>:       if (&User-Name =~ /\.\./ ) {
(20) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(20) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(20) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(20) <running>:       if (&User-Name =~ /\.$/)  {
(20) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(20) <running>:       if (&User-Name =~ /@\./)  {
(20) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(20) <running>:     } # policy filter_username = notfound
(20)     [preprocess] = ok
(20)     [chap] = noop
(20)     [mschap] = noop
(20)     [digest] = noop
(20) suffix: Checking for suffix after "@"
Waking up in 0.3 seconds.
(20) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(20) suffix: No such realm "NULL"
(20)     [suffix] = noop
(20) eap: Peer sent EAP Response (code 2) ID 185 length 12
(20) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(20)     [eap] = ok
(20)   } # authorize = ok
(20) Found Auth-Type = EAP
(20) # Executing group from file /etc/freeradius/sites-enabled/default
(20)   authenticate {
(20) eap: Peer sent packet with method EAP Identity (1)
(20) eap: Calling submodule eap_md5 to process data
(20) eap_md5: Issuing MD5 Challenge
(20) eap: Sending EAP Request (code 1) ID 186 length 22
(20) eap: EAP session adding &reply:State = 0xa991428aa92b46a7
(20)     [eap] = handled
(20)   } # authenticate = handled
(20) Using Post-Auth-Type Challenge
(20) Post-Auth-Type sub-section not found.  Ignoring.
(20) # Executing group from file /etc/freeradius/sites-enabled/default
(20) Sent Access-Challenge Id 116 from 172.17.0.4:1812 to 192.168.1.30:50042 length 0
(20)   EAP-Message = 0x01ba00160410f13affde1d56d1b45f9e8803c1cb07f2
(20)   Message-Authenticator = 0x00000000000000000000000000000000
(20)   State = 0xa991428aa92b46a7af2a92c79b660f37
(20) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.3 seconds.
Thread 4 got semaphore
Thread 4 handling request 21, (5 handled so far)
(21) <running>: Received Access-Request Id 117 from 192.168.1.30:50042 to 172.17.0.4:1812 length 204
(21) <running>:   User-Name = "emiruss"
(21) <running>:   NAS-IP-Address = 192.168.1.30
(21) <running>:   NAS-Identifier = "Ericsson"
(21) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(21) <running>:   NAS-Port-Type = Wireless-802.11
(21) <running>:   NAS-Port = 0
(21) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(21) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(21) <running>:   Acct-Session-Id = "003E2DE6-0000004D"
(21) <running>:   Framed-MTU = 1400
(21) <running>:   EAP-Message = 0x02ba00080319152b
(21) <running>:   State = 0xa991428aa92b46a7af2a92c79b660f37
(21) <running>:   Message-Authenticator = 0xdb9062c4383668ee637920d64653efe6
(21) <running>: session-state: No cached attributes
(21) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(21) <running>:   authorize {
(21) <running>:     policy filter_username {
(21) <running>:       if (!&User-Name) {
(21) <running>:       if (!&User-Name)  -> FALSE
(21) <running>:       if (&User-Name =~ / /) {
(21) <running>:       if (&User-Name =~ / /)  -> FALSE
(21) <running>:       if (&User-Name =~ /@.*@/ ) {
(21) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(21) <running>:       if (&User-Name =~ /\.\./ ) {
(21) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(21) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(21) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(21) <running>:       if (&User-Name =~ /\.$/)  {
(21) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(21) <running>:       if (&User-Name =~ /@\./)  {
(21) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(21) <running>:     } # policy filter_username = notfound
(21)     [preprocess] = ok
(21)     [chap] = noop
(21)     [mschap] = noop
(21)     [digest] = noop
(21) suffix: Checking for suffix after "@"
(21) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(21) suffix: No such realm "NULL"
(21)     [suffix] = noop
(21) eap: Peer sent EAP Response (code 2) ID 186 length 8
(21) eap: No EAP Start, assuming it's an on-going EAP conversation
(21)     [eap] = updated
(21)     [files] = noop
(21) sql: EXPAND %{User-Name}
(21) sql:    --> emiruss
(21) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Reserved connection (6)
(21) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(21) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(21) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(21) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(21) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(21) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(21) sql: User not found in any groups
rlm_sql (sql): Released connection (6)
rlm_sql (sql): Need 2 more connections to reach 10 spares
rlm_sql (sql): Opening additional connection (8), 1 of 24 pending slots used
(21)     [sql] = notfound
(21)     [expiration] = noop
(21)     [logintime] = noop
(21) pap: WARNING: No "known good" password found for the user.  Not setting Auth-Type
(21) pap: WARNING: Authentication will fail unless a "known good" password is available
(21)     [pap] = noop
(21)   } # authorize = updated
(21) Found Auth-Type = EAP
(21) # Executing group from file /etc/freeradius/sites-enabled/default
(21)   authenticate {
(21) eap: Expiring EAP session with state 0xa991428aa92b46a7
(21) eap: Finished EAP session with state 0xa991428aa92b46a7
(21) eap: Previous EAP request found for state 0xa991428aa92b46a7, released from the list
(21) eap: Peer sent packet with method EAP NAK (3)
(21) eap: Found mutually acceptable type PEAP (25)
(21) eap: Calling submodule eap_peap to process data
(21) eap_peap: Initiating new EAP-TLS session
(21) eap_peap: [eaptls start] = request
(21) eap: Sending EAP Request (code 1) ID 187 length 6
(21) eap: EAP session adding &reply:State = 0xa991428aa82a5ba7
(21)     [eap] = handled
(21)   } # authenticate = handled
(21) Using Post-Auth-Type Challenge
(21) Post-Auth-Type sub-section not found.  Ignoring.
(21) # Executing group from file /etc/freeradius/sites-enabled/default
(21) Sent Access-Challenge Id 117 from 172.17.0.4:1812 to 192.168.1.30:50042 length 0
(21)   EAP-Message = 0x01bb00061920
(21)   Message-Authenticator = 0x00000000000000000000000000000000
(21)   State = 0xa991428aa82a5ba7af2a92c79b660f37
(21) Finished request
Thread 4 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 3 got semaphore
Thread 3 handling request 22, (5 handled so far)
(22) <running>: Received Access-Request Id 118 from 192.168.1.30:50042 to 172.17.0.4:1812 length 339
(22) <running>:   User-Name = "emiruss"
(22) <running>:   NAS-IP-Address = 192.168.1.30
(22) <running>:   NAS-Identifier = "Ericsson"
(22) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(22) <running>:   NAS-Port-Type = Wireless-802.11
(22) <running>:   NAS-Port = 0
(22) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(22) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(22) <running>:   Acct-Session-Id = "003E2DE6-0000004D"
(22) <running>:   Framed-MTU = 1400
(22) <running>:   EAP-Message = 0x02bb008f19800000008516030100800100007c030156552bda15ef10bf641a278687e80b362407e49599381dbd71cc0bedd2de3f0b00003400ffc02cc02bc024c023c00ac009c008c030c02fc028c027c014c013c012009d009c003d003c0035002f000ac007c011000500040100001f000a0008000600
(22) <running>:   State = 0xa991428aa82a5ba7af2a92c79b660f37
(22) <running>:   Message-Authenticator = 0xea9b16dd83fff9a9e18e5cb5dada8465
(22) <running>: session-state: No cached attributes
(22) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(22) <running>:   authorize {
(22) <running>:     policy filter_username {
(22) <running>:       if (!&User-Name) {
(22) <running>:       if (!&User-Name)  -> FALSE
(22) <running>:       if (&User-Name =~ / /) {
(22) <running>:       if (&User-Name =~ / /)  -> FALSE
(22) <running>:       if (&User-Name =~ /@.*@/ ) {
(22) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(22) <running>:       if (&User-Name =~ /\.\./ ) {
(22) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(22) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(22) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(22) <running>:       if (&User-Name =~ /\.$/)  {
(22) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(22) <running>:       if (&User-Name =~ /@\./)  {
(22) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(22) <running>:     } # policy filter_username = notfound
(22)     [preprocess] = ok
(22)     [chap] = noop
(22)     [mschap] = noop
(22)     [digest] = noop
(22) suffix: Checking for suffix after "@"
(22) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(22) suffix: No such realm "NULL"
(22)     [suffix] = noop
(22) eap: Peer sent EAP Response (code 2) ID 187 length 143
(22) eap: Continuing tunnel setup
(22)     [eap] = ok
(22)   } # authorize = ok
(22) Found Auth-Type = EAP
(22) # Executing group from file /etc/freeradius/sites-enabled/default
(22)   authenticate {
(22) eap: Expiring EAP session with state 0xa991428aa82a5ba7
(22) eap: Finished EAP session with state 0xa991428aa82a5ba7
(22) eap: Previous EAP request found for state 0xa991428aa82a5ba7, released from the list
(22) eap: Peer sent packet with method EAP PEAP (25)
(22) eap: Calling submodule eap_peap to process data
(22) eap_peap: Continuing EAP-TLS
(22) eap_peap: Peer indicated complete TLS record size will be 133 bytes
(22) eap_peap: Got complete TLS record (133 bytes)
(22) eap_peap: [eaptls verify] = length included
(22) eap_peap: (other): before/accept initialization
(22) eap_peap: TLS_accept: before/accept initialization
(22) eap_peap: <<< TLS 1.0 Handshake [length 0080], ClientHello 
(22) eap_peap: TLS_accept: SSLv3 read client hello A
(22) eap_peap: >>> TLS 1.0 Handshake [length 0059], ServerHello 
(22) eap_peap: TLS_accept: SSLv3 write server hello A
(22) eap_peap: >>> TLS 1.0 Handshake [length 08d3], Certificate 
(22) eap_peap: TLS_accept: SSLv3 write certificate A
(22) eap_peap: >>> TLS 1.0 Handshake [length 014b], ServerKeyExchange 
(22) eap_peap: TLS_accept: SSLv3 write key exchange A
(22) eap_peap: >>> TLS 1.0 Handshake [length 0004], ServerHelloDone 
(22) eap_peap: TLS_accept: SSLv3 write server done A
(22) eap_peap: TLS_accept: SSLv3 flush data
(22) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(22) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(22) eap_peap: In SSL Handshake Phase
(22) eap_peap: In SSL Accept mode
(22) eap_peap: [eaptls process] = handled
(22) eap: Sending EAP Request (code 1) ID 188 length 1004
(22) eap: EAP session adding &reply:State = 0xa991428aab2d5ba7
(22)     [eap] = handled
(22)   } # authenticate = handled
(22) Using Post-Auth-Type Challenge
(22) Post-Auth-Type sub-section not found.  Ignoring.
(22) # Executing group from file /etc/freeradius/sites-enabled/default
(22) Sent Access-Challenge Id 118 from 172.17.0.4:1812 to 192.168.1.30:50042 length 0
(22)   EAP-Message = 0x01bc03ec19c000000a8f1603010059020000550301bfe0bb4bafd237b07793875a031b57fcc8d4cac02b077eaf09c015ad412a157020ff5899c556ddb7dcdb66eadc4a11ce2eeb1660418f058967d5f8e8a919a03febc01400000dff01000100000b00040300010216030108d30b0008cf0008cc0003de
(22)   Message-Authenticator = 0x00000000000000000000000000000000
(22)   State = 0xa991428aab2d5ba7af2a92c79b660f37
(22) Finished request
Thread 3 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 2 got semaphore
Thread 2 handling request 23, (5 handled so far)
(23) <running>: Received Access-Request Id 119 from 192.168.1.30:50042 to 172.17.0.4:1812 length 202
(23) <running>:   User-Name = "emiruss"
(23) <running>:   NAS-IP-Address = 192.168.1.30
(23) <running>:   NAS-Identifier = "Ericsson"
(23) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(23) <running>:   NAS-Port-Type = Wireless-802.11
(23) <running>:   NAS-Port = 0
(23) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(23) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(23) <running>:   Acct-Session-Id = "003E2DE6-0000004D"
(23) <running>:   Framed-MTU = 1400
(23) <running>:   EAP-Message = 0x02bc00061900
(23) <running>:   State = 0xa991428aab2d5ba7af2a92c79b660f37
(23) <running>:   Message-Authenticator = 0x9849d78d958937e73588e1ba0bf7d133
(23) <running>: session-state: No cached attributes
(23) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(23) <running>:   authorize {
(23) <running>:     policy filter_username {
(23) <running>:       if (!&User-Name) {
(23) <running>:       if (!&User-Name)  -> FALSE
(23) <running>:       if (&User-Name =~ / /) {
(23) <running>:       if (&User-Name =~ / /)  -> FALSE
(23) <running>:       if (&User-Name =~ /@.*@/ ) {
(23) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(23) <running>:       if (&User-Name =~ /\.\./ ) {
(23) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(23) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(23) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(23) <running>:       if (&User-Name =~ /\.$/)  {
(23) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(23) <running>:       if (&User-Name =~ /@\./)  {
(23) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(23) <running>:     } # policy filter_username = notfound
(23)     [preprocess] = ok
(23)     [chap] = noop
(23)     [mschap] = noop
(23)     [digest] = noop
(23) suffix: Checking for suffix after "@"
(23) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(23) suffix: No such realm "NULL"
(23)     [suffix] = noop
(23) eap: Peer sent EAP Response (code 2) ID 188 length 6
(23) eap: Continuing tunnel setup
(23)     [eap] = ok
(23)   } # authorize = ok
(23) Found Auth-Type = EAP
(23) # Executing group from file /etc/freeradius/sites-enabled/default
(23)   authenticate {
(23) eap: Expiring EAP session with state 0xa991428aab2d5ba7
(23) eap: Finished EAP session with state 0xa991428aab2d5ba7
(23) eap: Previous EAP request found for state 0xa991428aab2d5ba7, released from the list
(23) eap: Peer sent packet with method EAP PEAP (25)
(23) eap: Calling submodule eap_peap to process data
(23) eap_peap: Continuing EAP-TLS
(23) eap_peap: Peer ACKed our handshake fragment
(23) eap_peap: [eaptls verify] = request
(23) eap_peap: [eaptls process] = handled
(23) eap: Sending EAP Request (code 1) ID 189 length 1000
(23) eap: EAP session adding &reply:State = 0xa991428aaa2c5ba7
(23)     [eap] = handled
(23)   } # authenticate = handled
(23) Using Post-Auth-Type Challenge
(23) Post-Auth-Type sub-section not found.  Ignoring.
(23) # Executing group from file /etc/freeradius/sites-enabled/default
(23) Sent Access-Challenge Id 119 from 172.17.0.4:1812 to 192.168.1.30:50042 length 0
(23)   EAP-Message = 0x01bd03e819400dd0405955c762981948527048701681d313d3cc6629a5557b66df2aae22c8590ab99d66ec8d3792a72e30596410f5d1e81f5a774969a1ce9ad6bd01d42da65536016e80a905c662a71ef5c075b8bdf0127a0cf1bd4c91290e15edffa035febde0185096bdc1e553090004e8308204e430
(23)   Message-Authenticator = 0x00000000000000000000000000000000
(23)   State = 0xa991428aaa2c5ba7af2a92c79b660f37
(23) Finished request
Thread 2 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 1 got semaphore
Thread 1 handling request 24, (5 handled so far)
(24) <running>: Received Access-Request Id 120 from 192.168.1.30:50042 to 172.17.0.4:1812 length 202
(24) <running>:   User-Name = "emiruss"
(24) <running>:   NAS-IP-Address = 192.168.1.30
(24) <running>:   NAS-Identifier = "Ericsson"
(24) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(24) <running>:   NAS-Port-Type = Wireless-802.11
(24) <running>:   NAS-Port = 0
(24) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(24) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(24) <running>:   Acct-Session-Id = "003E2DE6-0000004D"
(24) <running>:   Framed-MTU = 1400
(24) <running>:   EAP-Message = 0x02bd00061900
(24) <running>:   State = 0xa991428aaa2c5ba7af2a92c79b660f37
(24) <running>:   Message-Authenticator = 0xa2792e61a1e3c50e841616fa624f2ccd
(24) <running>: session-state: No cached attributes
(24) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(24) <running>:   authorize {
(24) <running>:     policy filter_username {
(24) <running>:       if (!&User-Name) {
(24) <running>:       if (!&User-Name)  -> FALSE
(24) <running>:       if (&User-Name =~ / /) {
(24) <running>:       if (&User-Name =~ / /)  -> FALSE
(24) <running>:       if (&User-Name =~ /@.*@/ ) {
(24) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(24) <running>:       if (&User-Name =~ /\.\./ ) {
(24) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(24) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(24) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(24) <running>:       if (&User-Name =~ /\.$/)  {
(24) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(24) <running>:       if (&User-Name =~ /@\./)  {
(24) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(24) <running>:     } # policy filter_username = notfound
(24)     [preprocess] = ok
(24)     [chap] = noop
(24)     [mschap] = noop
(24)     [digest] = noop
(24) suffix: Checking for suffix after "@"
(24) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(24) suffix: No such realm "NULL"
(24)     [suffix] = noop
(24) eap: Peer sent EAP Response (code 2) ID 189 length 6
(24) eap: Continuing tunnel setup
(24)     [eap] = ok
(24)   } # authorize = ok
(24) Found Auth-Type = EAP
(24) # Executing group from file /etc/freeradius/sites-enabled/default
(24)   authenticate {
(24) eap: Expiring EAP session with state 0xa991428aaa2c5ba7
(24) eap: Finished EAP session with state 0xa991428aaa2c5ba7
(24) eap: Previous EAP request found for state 0xa991428aaa2c5ba7, released from the list
(24) eap: Peer sent packet with method EAP PEAP (25)
(24) eap: Calling submodule eap_peap to process data
(24) eap_peap: Continuing EAP-TLS
(24) eap_peap: Peer ACKed our handshake fragment
(24) eap_peap: [eaptls verify] = request
(24) eap_peap: [eaptls process] = handled
(24) eap: Sending EAP Request (code 1) ID 190 length 721
(24) eap: EAP session adding &reply:State = 0xa991428aad2f5ba7
(24)     [eap] = handled
(24)   } # authenticate = handled
(24) Using Post-Auth-Type Challenge
(24) Post-Auth-Type sub-section not found.  Ignoring.
(24) # Executing group from file /etc/freeradius/sites-enabled/default
(24) Sent Access-Challenge Id 120 from 172.17.0.4:1812 to 192.168.1.30:50042 length 0
(24)   EAP-Message = 0x01be02d1190020417574686f72697479820900c3fc536eef83d741300f0603551d130101ff040530030101ff30360603551d1f042f302d302ba029a0278625687474703a2f2f7777772e6578616d706c652e6f72672f6578616d706c655f63612e63726c300d06092a864886f70d01010b050003820101
(24)   Message-Authenticator = 0x00000000000000000000000000000000
(24)   State = 0xa991428aad2f5ba7af2a92c79b660f37
(24) Finished request
Thread 1 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 5 got semaphore
Thread 5 handling request 25, (6 handled so far)
(25) <running>: Received Access-Request Id 121 from 192.168.1.30:50042 to 172.17.0.4:1812 length 340
(25) <running>:   User-Name = "emiruss"
(25) <running>:   NAS-IP-Address = 192.168.1.30
(25) <running>:   NAS-Identifier = "Ericsson"
(25) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(25) <running>:   NAS-Port-Type = Wireless-802.11
(25) <running>:   NAS-Port = 0
(25) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(25) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(25) <running>:   Acct-Session-Id = "003E2DE6-0000004D"
(25) <running>:   Framed-MTU = 1400
(25) <running>:   EAP-Message = 0x02be009019800000008616030100461000004241049debb104114d8902eac018d2593d549607f22ad911af2b803eb6e9b39aa2be97b85ad25625da0bacdac41b02e0df700525aaa130fbeeae21a0a75ff9bf5443941403010001011603010030c4a0ce9b09bc3c03fa69fa14b71f53371dee2f138adcd2
(25) <running>:   State = 0xa991428aad2f5ba7af2a92c79b660f37
(25) <running>:   Message-Authenticator = 0x398afb82ef786f01d090b62cbc6a2af4
(25) <running>: session-state: No cached attributes
(25) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(25) <running>:   authorize {
(25) <running>:     policy filter_username {
(25) <running>:       if (!&User-Name) {
(25) <running>:       if (!&User-Name)  -> FALSE
(25) <running>:       if (&User-Name =~ / /) {
(25) <running>:       if (&User-Name =~ / /)  -> FALSE
(25) <running>:       if (&User-Name =~ /@.*@/ ) {
(25) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(25) <running>:       if (&User-Name =~ /\.\./ ) {
(25) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(25) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(25) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(25) <running>:       if (&User-Name =~ /\.$/)  {
(25) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(25) <running>:       if (&User-Name =~ /@\./)  {
(25) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(25) <running>:     } # policy filter_username = notfound
(25)     [preprocess] = ok
(25)     [chap] = noop
(25)     [mschap] = noop
(25)     [digest] = noop
(25) suffix: Checking for suffix after "@"
(25) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(25) suffix: No such realm "NULL"
(25)     [suffix] = noop
(25) eap: Peer sent EAP Response (code 2) ID 190 length 144
(25) eap: Continuing tunnel setup
(25)     [eap] = ok
(25)   } # authorize = ok
(25) Found Auth-Type = EAP
(25) # Executing group from file /etc/freeradius/sites-enabled/default
(25)   authenticate {
(25) eap: Expiring EAP session with state 0xa991428aad2f5ba7
(25) eap: Finished EAP session with state 0xa991428aad2f5ba7
(25) eap: Previous EAP request found for state 0xa991428aad2f5ba7, released from the list
(25) eap: Peer sent packet with method EAP PEAP (25)
(25) eap: Calling submodule eap_peap to process data
(25) eap_peap: Continuing EAP-TLS
(25) eap_peap: Peer indicated complete TLS record size will be 134 bytes
(25) eap_peap: Got complete TLS record (134 bytes)
(25) eap_peap: [eaptls verify] = length included
(25) eap_peap: <<< TLS 1.0 Handshake [length 0046], ClientKeyExchange 
(25) eap_peap: TLS_accept: SSLv3 read client key exchange A
(25) eap_peap: <<< TLS 1.0 ChangeCipherSpec [length 0001] 
(25) eap_peap: <<< TLS 1.0 Handshake [length 0010], Finished 
(25) eap_peap: TLS_accept: SSLv3 read finished A
(25) eap_peap: >>> TLS 1.0 ChangeCipherSpec [length 0001] 
(25) eap_peap: TLS_accept: SSLv3 write change cipher spec A
(25) eap_peap: >>> TLS 1.0 Handshake [length 0010], Finished 
(25) eap_peap: TLS_accept: SSLv3 write finished A
(25) eap_peap: TLS_accept: SSLv3 flush data
(25) eap_peap: (other): SSL negotiation finished successfully
(25) eap_peap: SSL Connection Established
(25) eap_peap: [eaptls process] = handled
(25) eap: Sending EAP Request (code 1) ID 191 length 65
(25) eap: EAP session adding &reply:State = 0xa991428aac2e5ba7
(25)     [eap] = handled
(25)   } # authenticate = handled
(25) Using Post-Auth-Type Challenge
(25) Post-Auth-Type sub-section not found.  Ignoring.
(25) # Executing group from file /etc/freeradius/sites-enabled/default
(25) Sent Access-Challenge Id 121 from 172.17.0.4:1812 to 192.168.1.30:50042 length 0
(25)   EAP-Message = 0x01bf004119001403010001011603010030de2b318f1f3284fe3956cf8d9c45d836369d6127ecb4c5f52f7b3c59889e42064e084946f21b15c00c7d4cfe08410496
(25)   Message-Authenticator = 0x00000000000000000000000000000000
(25)   State = 0xa991428aac2e5ba7af2a92c79b660f37
(25) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 4 got semaphore
Thread 4 handling request 26, (6 handled so far)
(26) <running>: Received Access-Request Id 122 from 192.168.1.30:50042 to 172.17.0.4:1812 length 202
(26) <running>:   User-Name = "emiruss"
(26) <running>:   NAS-IP-Address = 192.168.1.30
(26) <running>:   NAS-Identifier = "Ericsson"
(26) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(26) <running>:   NAS-Port-Type = Wireless-802.11
(26) <running>:   NAS-Port = 0
(26) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(26) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(26) <running>:   Acct-Session-Id = "003E2DE6-0000004D"
(26) <running>:   Framed-MTU = 1400
(26) <running>:   EAP-Message = 0x02bf00061900
(26) <running>:   State = 0xa991428aac2e5ba7af2a92c79b660f37
(26) <running>:   Message-Authenticator = 0x85b82b657aed98ca9f9a5fced1025373
(26) <running>: session-state: No cached attributes
(26) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(26) <running>:   authorize {
(26) <running>:     policy filter_username {
(26) <running>:       if (!&User-Name) {
(26) <running>:       if (!&User-Name)  -> FALSE
(26) <running>:       if (&User-Name =~ / /) {
(26) <running>:       if (&User-Name =~ / /)  -> FALSE
(26) <running>:       if (&User-Name =~ /@.*@/ ) {
(26) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(26) <running>:       if (&User-Name =~ /\.\./ ) {
(26) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(26) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(26) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(26) <running>:       if (&User-Name =~ /\.$/)  {
(26) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(26) <running>:       if (&User-Name =~ /@\./)  {
(26) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(26) <running>:     } # policy filter_username = notfound
(26)     [preprocess] = ok
(26)     [chap] = noop
(26)     [mschap] = noop
(26)     [digest] = noop
(26) suffix: Checking for suffix after "@"
(26) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(26) suffix: No such realm "NULL"
(26)     [suffix] = noop
(26) eap: Peer sent EAP Response (code 2) ID 191 length 6
(26) eap: Continuing tunnel setup
(26)     [eap] = ok
(26)   } # authorize = ok
(26) Found Auth-Type = EAP
(26) # Executing group from file /etc/freeradius/sites-enabled/default
(26)   authenticate {
(26) eap: Expiring EAP session with state 0xa991428aac2e5ba7
(26) eap: Finished EAP session with state 0xa991428aac2e5ba7
(26) eap: Previous EAP request found for state 0xa991428aac2e5ba7, released from the list
(26) eap: Peer sent packet with method EAP PEAP (25)
(26) eap: Calling submodule eap_peap to process data
(26) eap_peap: Continuing EAP-TLS
(26) eap_peap: Peer ACKed our handshake fragment.  handshake is finished
(26) eap_peap: [eaptls verify] = success
(26) eap_peap: [eaptls process] = success
(26) eap_peap: Session established.  Decoding tunneled attributes
(26) eap_peap: PEAP state TUNNEL ESTABLISHED
(26) eap: Sending EAP Request (code 1) ID 192 length 43
(26) eap: EAP session adding &reply:State = 0xa991428aaf515ba7
(26)     [eap] = handled
(26)   } # authenticate = handled
(26) Using Post-Auth-Type Challenge
(26) Post-Auth-Type sub-section not found.  Ignoring.
(26) # Executing group from file /etc/freeradius/sites-enabled/default
(26) Sent Access-Challenge Id 122 from 172.17.0.4:1812 to 192.168.1.30:50042 length 0
(26)   EAP-Message = 0x01c0002b19001703010020fef7dc6185c3abeae9a0545d107b6728c31984a3e5cf4e014dd72b6d8cb83fd2
(26)   Message-Authenticator = 0x00000000000000000000000000000000
(26)   State = 0xa991428aaf515ba7af2a92c79b660f37
(26) Finished request
Thread 4 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 3 got semaphore
Thread 3 handling request 27, (6 handled so far)
(27) <running>: Received Access-Request Id 123 from 192.168.1.30:50042 to 172.17.0.4:1812 length 239
(27) <running>:   User-Name = "emiruss"
(27) <running>:   NAS-IP-Address = 192.168.1.30
(27) <running>:   NAS-Identifier = "Ericsson"
(27) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(27) <running>:   NAS-Port-Type = Wireless-802.11
(27) <running>:   NAS-Port = 0
(27) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(27) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(27) <running>:   Acct-Session-Id = "003E2DE6-0000004D"
(27) <running>:   Framed-MTU = 1400
(27) <running>:   EAP-Message = 0x02c0002b190017030100209814ed1e49c320bc40e60d337fce4708daf8b66aa2401d2b08b9658d3f80080a
(27) <running>:   State = 0xa991428aaf515ba7af2a92c79b660f37
(27) <running>:   Message-Authenticator = 0x5383f132fc08bfb888588cddb753592f
(27) <running>: session-state: No cached attributes
(27) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(27) <running>:   authorize {
(27) <running>:     policy filter_username {
(27) <running>:       if (!&User-Name) {
(27) <running>:       if (!&User-Name)  -> FALSE
(27) <running>:       if (&User-Name =~ / /) {
(27) <running>:       if (&User-Name =~ / /)  -> FALSE
(27) <running>:       if (&User-Name =~ /@.*@/ ) {
(27) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(27) <running>:       if (&User-Name =~ /\.\./ ) {
(27) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(27) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(27) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(27) <running>:       if (&User-Name =~ /\.$/)  {
(27) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(27) <running>:       if (&User-Name =~ /@\./)  {
(27) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(27) <running>:     } # policy filter_username = notfound
(27)     [preprocess] = ok
(27)     [chap] = noop
(27)     [mschap] = noop
(27)     [digest] = noop
(27) suffix: Checking for suffix after "@"
(27) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(27) suffix: No such realm "NULL"
(27)     [suffix] = noop
(27) eap: Peer sent EAP Response (code 2) ID 192 length 43
(27) eap: Continuing tunnel setup
(27)     [eap] = ok
(27)   } # authorize = ok
(27) Found Auth-Type = EAP
(27) # Executing group from file /etc/freeradius/sites-enabled/default
(27)   authenticate {
(27) eap: Expiring EAP session with state 0xa991428aaf515ba7
(27) eap: Finished EAP session with state 0xa991428aaf515ba7
(27) eap: Previous EAP request found for state 0xa991428aaf515ba7, released from the list
(27) eap: Peer sent packet with method EAP PEAP (25)
(27) eap: Calling submodule eap_peap to process data
(27) eap_peap: Continuing EAP-TLS
(27) eap_peap: [eaptls verify] = ok
(27) eap_peap: Done initial handshake
(27) eap_peap: [eaptls process] = ok
(27) eap_peap: Session established.  Decoding tunneled attributes
(27) eap_peap: PEAP state WAITING FOR INNER IDENTITY
(27) eap_peap: Identity - emiruss
(27) eap_peap: Got inner identity 'emiruss'
(27) eap_peap: Setting default EAP type for tunneled EAP session
(27) eap_peap: Got tunneled request
(27) eap_peap:   EAP-Message = 0x02c0000c01656d6972757373
(27) eap_peap: Setting User-Name to emiruss
(27) eap_peap: Sending tunneled request to inner-tunnel
(27) eap_peap:   EAP-Message = 0x02c0000c01656d6972757373
(27) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(27) eap_peap:   User-Name = "emiruss"
(27) Virtual server inner-tunnel received request
(27)   EAP-Message = 0x02c0000c01656d6972757373
(27)   FreeRADIUS-Proxied-To = 127.0.0.1
(27)   User-Name = "emiruss"
(27) server inner-tunnel {
(27)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(27)     authorize {
(27)       [chap] = noop
(27)       [mschap] = noop
(27) suffix: Checking for suffix after "@"
(27) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(27) suffix: No such realm "NULL"
(27)       [suffix] = noop
(27)       update control {
(27)         &Proxy-To-Realm := LOCAL
(27)       } # update control = noop
(27) eap: Peer sent EAP Response (code 2) ID 192 length 12
(27) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(27)       [eap] = ok
(27)     } # authorize = ok
(27)   Found Auth-Type = EAP
(27)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(27)     authenticate {
(27) eap: Peer sent packet with method EAP Identity (1)
(27) eap: Calling submodule eap_mschapv2 to process data
(27) eap_mschapv2: Issuing Challenge
(27) eap: Sending EAP Request (code 1) ID 193 length 43
(27) eap: EAP session adding &reply:State = 0x62b457ea62754de9
(27)       [eap] = handled
(27)     } # authenticate = handled
(27) } # server inner-tunnel
(27) Virtual server sending reply
(27)   EAP-Message = 0x01c1002b1a01c10026104cb6c263e17b96f7b03e92d9762611d1667265657261646975732d332e302e3130
(27)   Message-Authenticator = 0x00000000000000000000000000000000
(27)   State = 0x62b457ea62754de93944e38c7b093f11
(27) eap_peap: Got tunneled reply code 11
(27) eap_peap:   EAP-Message = 0x01c1002b1a01c10026104cb6c263e17b96f7b03e92d9762611d1667265657261646975732d332e302e3130
(27) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(27) eap_peap:   State = 0x62b457ea62754de93944e38c7b093f11
(27) eap_peap: Got tunneled Access-Challenge
(27) eap: Sending EAP Request (code 1) ID 193 length 75
(27) eap: EAP session adding &reply:State = 0xa991428aae505ba7
(27)     [eap] = handled
(27)   } # authenticate = handled
(27) Using Post-Auth-Type Challenge
(27) Post-Auth-Type sub-section not found.  Ignoring.
(27) # Executing group from file /etc/freeradius/sites-enabled/default
(27) Sent Access-Challenge Id 123 from 172.17.0.4:1812 to 192.168.1.30:50042 length 0
(27)   EAP-Message = 0x01c1004b19001703010040efe87031835dbdc6de59350d2ea8d084a3d0c8087c15d6ba13551e2ef6d98e784ab2652c7d38eae4bd9a6a854b426bec2051828ef1c9a90c31d7254415f87292
(27)   Message-Authenticator = 0x00000000000000000000000000000000
(27)   State = 0xa991428aae505ba7af2a92c79b660f37
(27) Finished request
Thread 3 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 2 got semaphore
Thread 2 handling request 28, (6 handled so far)
(28) <running>: Received Access-Request Id 124 from 192.168.1.30:50042 to 172.17.0.4:1812 length 303
(28) <running>:   User-Name = "emiruss"
(28) <running>:   NAS-IP-Address = 192.168.1.30
(28) <running>:   NAS-Identifier = "Ericsson"
(28) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(28) <running>:   NAS-Port-Type = Wireless-802.11
(28) <running>:   NAS-Port = 0
(28) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(28) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(28) <running>:   Acct-Session-Id = "003E2DE6-0000004D"
(28) <running>:   Framed-MTU = 1400
(28) <running>:   EAP-Message = 0x02c1006b19001703010060120d1bb22d2dab3ca8454db19b1ded961dc35cfe80ad5e36c4c569ff76b2ff5485c2f088020804619397ab5775f3e9a7550f79674e8a0e8186953219cc93536313e41c1630a43716181462fcf188ad0df667eaad124e0499a14c9ee9e3ab280e
(28) <running>:   State = 0xa991428aae505ba7af2a92c79b660f37
(28) <running>:   Message-Authenticator = 0x284ca5ad62ccac84cc1020f3ad0c0033
(28) <running>: session-state: No cached attributes
(28) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(28) <running>:   authorize {
(28) <running>:     policy filter_username {
(28) <running>:       if (!&User-Name) {
(28) <running>:       if (!&User-Name)  -> FALSE
(28) <running>:       if (&User-Name =~ / /) {
(28) <running>:       if (&User-Name =~ / /)  -> FALSE
(28) <running>:       if (&User-Name =~ /@.*@/ ) {
(28) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(28) <running>:       if (&User-Name =~ /\.\./ ) {
(28) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(28) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(28) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(28) <running>:       if (&User-Name =~ /\.$/)  {
(28) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(28) <running>:       if (&User-Name =~ /@\./)  {
(28) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(28) <running>:     } # policy filter_username = notfound
(28)     [preprocess] = ok
(28)     [chap] = noop
(28)     [mschap] = noop
(28)     [digest] = noop
(28) suffix: Checking for suffix after "@"
(28) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(28) suffix: No such realm "NULL"
(28)     [suffix] = noop
(28) eap: Peer sent EAP Response (code 2) ID 193 length 107
(28) eap: Continuing tunnel setup
(28)     [eap] = ok
(28)   } # authorize = ok
(28) Found Auth-Type = EAP
(28) # Executing group from file /etc/freeradius/sites-enabled/default
(28)   authenticate {
(28) eap: Expiring EAP session with state 0x62b457ea62754de9
(28) eap: Finished EAP session with state 0xa991428aae505ba7
(28) eap: Previous EAP request found for state 0xa991428aae505ba7, released from the list
(28) eap: Peer sent packet with method EAP PEAP (25)
(28) eap: Calling submodule eap_peap to process data
(28) eap_peap: Continuing EAP-TLS
(28) eap_peap: [eaptls verify] = ok
(28) eap_peap: Done initial handshake
(28) eap_peap: [eaptls process] = ok
(28) eap_peap: Session established.  Decoding tunneled attributes
(28) eap_peap: PEAP state phase2
(28) eap_peap: EAP method MSCHAPv2 (26)
(28) eap_peap: Got tunneled request
(28) eap_peap:   EAP-Message = 0x02c100421a02c1003d31fe6be65da94e66d5a8d63a09d2ed69520000000000000000d6c91637d3e7a67733c340bff05bdf11a388361e628aa33a00656d6972757373
(28) eap_peap: Setting User-Name to emiruss
(28) eap_peap: Sending tunneled request to inner-tunnel
(28) eap_peap:   EAP-Message = 0x02c100421a02c1003d31fe6be65da94e66d5a8d63a09d2ed69520000000000000000d6c91637d3e7a67733c340bff05bdf11a388361e628aa33a00656d6972757373
(28) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(28) eap_peap:   User-Name = "emiruss"
(28) eap_peap:   State = 0x62b457ea62754de93944e38c7b093f11
(28) Virtual server inner-tunnel received request
(28)   EAP-Message = 0x02c100421a02c1003d31fe6be65da94e66d5a8d63a09d2ed69520000000000000000d6c91637d3e7a67733c340bff05bdf11a388361e628aa33a00656d6972757373
(28)   FreeRADIUS-Proxied-To = 127.0.0.1
(28)   User-Name = "emiruss"
(28)   State = 0x62b457ea62754de93944e38c7b093f11
(28) server inner-tunnel {
(28)   session-state: No cached attributes
(28)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(28)     authorize {
(28)       [chap] = noop
(28)       [mschap] = noop
(28) suffix: Checking for suffix after "@"
(28) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(28) suffix: No such realm "NULL"
(28)       [suffix] = noop
(28)       update control {
(28)         &Proxy-To-Realm := LOCAL
(28)       } # update control = noop
(28) eap: Peer sent EAP Response (code 2) ID 193 length 66
(28) eap: No EAP Start, assuming it's an on-going EAP conversation
(28)       [eap] = updated
(28)       [files] = noop
(28) sql: EXPAND %{User-Name}
(28) sql:    --> emiruss
(28) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Reserved connection (2)
(28) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(28) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(28) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(28) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(28) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(28) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(28) sql: User not found in any groups
rlm_sql (sql): Released connection (2)
(28)       [sql] = notfound
(28)       [expiration] = noop
(28)       [logintime] = noop
(28)       [pap] = noop
(28)     } # authorize = updated
(28)   Found Auth-Type = EAP
(28)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(28)     authenticate {
(28) eap: Expiring EAP session with state 0x62b457ea62754de9
(28) eap: Finished EAP session with state 0x62b457ea62754de9
(28) eap: Previous EAP request found for state 0x62b457ea62754de9, released from the list
(28) eap: Peer sent packet with method EAP MSCHAPv2 (26)
(28) eap: Calling submodule eap_mschapv2 to process data
(28) eap_mschapv2: # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(28) eap_mschapv2:   Auth-Type MS-CHAP {
(28) mschap: WARNING: No Cleartext-Password configured.  Cannot create NT-Password
(28) mschap: WARNING: No Cleartext-Password configured.  Cannot create LM-Password
(28) mschap: Creating challenge hash with username: emiruss
(28) mschap: Client is using MS-CHAPv2
(28) mschap: ERROR: FAILED: No NT/LM-Password.  Cannot perform authentication
(28) mschap: ERROR: MS-CHAP2-Response is incorrect
(28)     [mschap] = reject
(28)   } # Auth-Type MS-CHAP = reject
(28) eap: Sending EAP Failure (code 4) ID 193 length 4
(28) eap: Freeing handler
(28)       [eap] = reject
(28)     } # authenticate = reject
(28)   Failed to authenticate the user
(28)   Using Post-Auth-Type Reject
(28)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(28)     Post-Auth-Type REJECT {
(28) sql: EXPAND .query
(28) sql:    --> .query
(28) sql: Using query template 'query'
rlm_sql (sql): Reserved connection (3)
(28) sql: EXPAND %{User-Name}
(28) sql:    --> emiruss
(28) sql: SQL-User-Name set to 'emiruss'
(28) sql: EXPAND INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')
(28) sql:    --> INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:12:57')
(28) sql: Executing query: INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:12:57')
(28) sql: SQL query returned: success
(28) sql: 1 record(s) updated
rlm_sql (sql): Released connection (3)
(28)       [sql] = ok
(28) attr_filter.access_reject: EXPAND %{User-Name}
(28) attr_filter.access_reject:    --> emiruss
(28) attr_filter.access_reject: Matched entry DEFAULT at line 11
(28)       [attr_filter.access_reject] = updated
(28)       update outer.session-state {
(28)         &Module-Failure-Message := &request:Module-Failure-Message -> 'mschap: FAILED: No NT/LM-Password.  Cannot perform authentication'
(28)       } # update outer.session-state = noop
(28)     } # Post-Auth-Type REJECT = updated
(28) } # server inner-tunnel
(28) Virtual server sending reply
(28)   MS-CHAP-Error = "\301E=691 R=1 C=daa47c7ec8069055e6c8a362a969a927 V=3 M=Authentication failed"
(28)   EAP-Message = 0x04c10004
(28)   Message-Authenticator = 0x00000000000000000000000000000000
(28) eap_peap: Got tunneled reply code 3
(28) eap_peap:   MS-CHAP-Error = "\301E=691 R=1 C=daa47c7ec8069055e6c8a362a969a927 V=3 M=Authentication failed"
(28) eap_peap:   EAP-Message = 0x04c10004
(28) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(28) eap_peap: Tunneled authentication was rejected
(28) eap_peap: FAILURE
(28) eap: Sending EAP Request (code 1) ID 194 length 43
(28) eap: EAP session adding &reply:State = 0xa991428aa1535ba7
(28)     [eap] = handled
(28)   } # authenticate = handled
(28) Using Post-Auth-Type Challenge
(28) Post-Auth-Type sub-section not found.  Ignoring.
(28) # Executing group from file /etc/freeradius/sites-enabled/default
(28) session-state: Saving cached attributes
(28)   Module-Failure-Message := "mschap: FAILED: No NT/LM-Password.  Cannot perform authentication"
(28) Sent Access-Challenge Id 124 from 172.17.0.4:1812 to 192.168.1.30:50042 length 0
(28)   EAP-Message = 0x01c2002b19001703010020dbe032dbea43ef12b9613a430df51c18d84c0d00e527e23486846508e10e4215
(28)   Message-Authenticator = 0x00000000000000000000000000000000
(28)   State = 0xa991428aa1535ba7af2a92c79b660f37
(28) Finished request
Thread 2 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 1 got semaphore
Thread 1 handling request 29, (6 handled so far)
(29) <running>: Received Access-Request Id 125 from 192.168.1.30:50042 to 172.17.0.4:1812 length 239
(29) <running>:   User-Name = "emiruss"
(29) <running>:   NAS-IP-Address = 192.168.1.30
(29) <running>:   NAS-Identifier = "Ericsson"
(29) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(29) <running>:   NAS-Port-Type = Wireless-802.11
(29) <running>:   NAS-Port = 0
(29) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(29) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(29) <running>:   Acct-Session-Id = "003E2DE6-0000004D"
(29) <running>:   Framed-MTU = 1400
(29) <running>:   EAP-Message = 0x02c2002b1900170301002067e5315fd5936ee92eb329c4480d1b457a31e71cc39506a16dd03761b9ec8088
(29) <running>:   State = 0xa991428aa1535ba7af2a92c79b660f37
(29) <running>:   Message-Authenticator = 0xae664a22b7a9225b984a8757e35583be
(29) <running>: session-state: Found cached attributes
(29) <running>:   Module-Failure-Message := "mschap: FAILED: No NT/LM-Password.  Cannot perform authentication"
(29) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(29) <running>:   authorize {
(29) <running>:     policy filter_username {
(29) <running>:       if (!&User-Name) {
(29) <running>:       if (!&User-Name)  -> FALSE
(29) <running>:       if (&User-Name =~ / /) {
(29) <running>:       if (&User-Name =~ / /)  -> FALSE
(29) <running>:       if (&User-Name =~ /@.*@/ ) {
(29) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(29) <running>:       if (&User-Name =~ /\.\./ ) {
(29) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(29) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(29) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(29) <running>:       if (&User-Name =~ /\.$/)  {
(29) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(29) <running>:       if (&User-Name =~ /@\./)  {
(29) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(29) <running>:     } # policy filter_username = notfound
(29)     [preprocess] = ok
(29)     [chap] = noop
(29)     [mschap] = noop
(29)     [digest] = noop
(29) suffix: Checking for suffix after "@"
(29) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(29) suffix: No such realm "NULL"
(29)     [suffix] = noop
(29) eap: Peer sent EAP Response (code 2) ID 194 length 43
(29) eap: Continuing tunnel setup
(29)     [eap] = ok
(29)   } # authorize = ok
(29) Found Auth-Type = EAP
(29) # Executing group from file /etc/freeradius/sites-enabled/default
(29)   authenticate {
(29) eap: Expiring EAP session with state 0xa991428aa1535ba7
(29) eap: Finished EAP session with state 0xa991428aa1535ba7
(29) eap: Previous EAP request found for state 0xa991428aa1535ba7, released from the list
(29) eap: Peer sent packet with method EAP PEAP (25)
(29) eap: Calling submodule eap_peap to process data
(29) eap_peap: Continuing EAP-TLS
(29) eap_peap: [eaptls verify] = ok
(29) eap_peap: Done initial handshake
(29) eap_peap: [eaptls process] = ok
(29) eap_peap: Session established.  Decoding tunneled attributes
(29) eap_peap: PEAP state send tlv failure
(29) eap_peap: Received EAP-TLV response
(29) eap_peap:   The users session was previously rejected: returning reject (again.)
(29) eap_peap:   This means you need to read the PREVIOUS messages in the debug output
(29) eap_peap:   to find out the reason why the user was rejected
(29) eap_peap:   Look for "reject" or "fail".  Those earlier messages will tell you
(29) eap_peap:   what went wrong, and how to fix the problem
(29) eap: ERROR: Failed continuing EAP PEAP (25) session.  EAP sub-module failed
(29) eap: Sending EAP Failure (code 4) ID 194 length 4
(29) eap: Failed in EAP select
(29)     [eap] = invalid
(29)   } # authenticate = invalid
(29) Failed to authenticate the user
(29) Using Post-Auth-Type Reject
(29) # Executing group from file /etc/freeradius/sites-enabled/default
(29)   Post-Auth-Type REJECT {
(29) sql: EXPAND .query
(29) sql:    --> .query
(29) sql: Using query template 'query'
rlm_sql (sql): Reserved connection (4)
(29) sql: EXPAND %{User-Name}
(29) sql:    --> emiruss
(29) sql: SQL-User-Name set to 'emiruss'
(29) sql: EXPAND INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')
(29) sql:    --> INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:12:57')
(29) sql: Executing query: INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:12:57')
(29) sql: SQL query returned: success
(29) sql: 1 record(s) updated
rlm_sql (sql): Released connection (4)
(29)     [sql] = ok
(29) attr_filter.access_reject: EXPAND %{User-Name}
(29) attr_filter.access_reject:    --> emiruss
(29) attr_filter.access_reject: Matched entry DEFAULT at line 11
(29)     [attr_filter.access_reject] = updated
(29)     [eap] = noop
(29)     policy remove_reply_message_if_eap {
(29)       if (&reply:EAP-Message && &reply:Reply-Message) {
(29)       if (&reply:EAP-Message && &reply:Reply-Message)  -> FALSE
(29)       else {
(29)         [noop] = noop
(29)       } # else = noop
(29)     } # policy remove_reply_message_if_eap = noop
(29)   } # Post-Auth-Type REJECT = updated
(29) Delaying response for 1.000000 seconds
Thread 1 waiting to be assigned a request
(29) Discarding duplicate request from client roocell-ap port 50042 - ID: 125 due to delayed response
Waking up in 0.6 seconds.
(29) Sending delayed response
(29) Sent Access-Reject Id 125 from 172.17.0.4:1812 to 192.168.1.30:50042 length 44
(29)   EAP-Message = 0x04c20004
(29)   Message-Authenticator = 0x00000000000000000000000000000000
Waking up in 0.1 seconds.
(5) Cleaning up request packet ID 101 with timestamp +8
(6) Cleaning up request packet ID 102 with timestamp +8
(7) Cleaning up request packet ID 103 with timestamp +8
(8) Cleaning up request packet ID 104 with timestamp +8
(9) Cleaning up request packet ID 105 with timestamp +8
Waking up in 1.0 seconds.
(10) Cleaning up request packet ID 106 with timestamp +9
(11) Cleaning up request packet ID 107 with timestamp +9
(12) Cleaning up request packet ID 108 with timestamp +9
(13) Cleaning up request packet ID 109 with timestamp +9
(14) Cleaning up request packet ID 110 with timestamp +9
(15) Cleaning up request packet ID 111 with timestamp +9
(16) Cleaning up request packet ID 112 with timestamp +9
(17) Cleaning up request packet ID 113 with timestamp +9
(18) Cleaning up request packet ID 114 with timestamp +9
(19) Cleaning up request packet ID 115 with timestamp +9
Waking up in 2.2 seconds.
(20) Cleaning up request packet ID 116 with timestamp +12
(21) Cleaning up request packet ID 117 with timestamp +12
(22) Cleaning up request packet ID 118 with timestamp +12
(23) Cleaning up request packet ID 119 with timestamp +12
(24) Cleaning up request packet ID 120 with timestamp +12
(25) Cleaning up request packet ID 121 with timestamp +12
(26) Cleaning up request packet ID 122 with timestamp +12
(27) Cleaning up request packet ID 123 with timestamp +12
(28) Cleaning up request packet ID 124 with timestamp +12
(29) Cleaning up request packet ID 125 with timestamp +12
Ready to process requests
Thread 5 got semaphore
Thread 5 handling request 30, (7 handled so far)
(30) <running>: Received Access-Request Id 126 from 192.168.1.30:50043 to 172.17.0.4:1812 length 190
(30) <running>:   User-Name = "emiruss"
(30) <running>:   NAS-IP-Address = 192.168.1.30
(30) <running>:   NAS-Identifier = "Ericsson"
(30) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(30) <running>:   NAS-Port-Type = Wireless-802.11
(30) <running>:   NAS-Port = 0
(30) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(30) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(30) <running>:   Acct-Session-Id = "003E2DE6-0000004E"
(30) <running>:   Framed-MTU = 1400
(30) <running>:   EAP-Message = 0x02e2000c01656d6972757373
(30) <running>:   Message-Authenticator = 0xc7b4f45068eaa182ce9ac27e5cf738b6
(30) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(30) <running>:   authorize {
(30) <running>:     policy filter_username {
(30) <running>:       if (!&User-Name) {
(30) <running>:       if (!&User-Name)  -> FALSE
(30) <running>:       if (&User-Name =~ / /) {
(30) <running>:       if (&User-Name =~ / /)  -> FALSE
(30) <running>:       if (&User-Name =~ /@.*@/ ) {
(30) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(30) <running>:       if (&User-Name =~ /\.\./ ) {
(30) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(30) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(30) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(30) <running>:       if (&User-Name =~ /\.$/)  {
(30) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(30) <running>:       if (&User-Name =~ /@\./)  {
(30) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(30) <running>:     } # policy filter_username = notfound
(30)     [preprocess] = ok
Waking up in 0.3 seconds.
(30)     [chap] = noop
(30)     [mschap] = noop
(30)     [digest] = noop
(30) suffix: Checking for suffix after "@"
(30) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(30) suffix: No such realm "NULL"
(30)     [suffix] = noop
(30) eap: Peer sent EAP Response (code 2) ID 226 length 12
(30) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(30)     [eap] = ok
(30)   } # authorize = ok
(30) Found Auth-Type = EAP
(30) # Executing group from file /etc/freeradius/sites-enabled/default
(30)   authenticate {
(30) eap: Peer sent packet with method EAP Identity (1)
(30) eap: Calling submodule eap_md5 to process data
(30) eap_md5: Issuing MD5 Challenge
(30) eap: Sending EAP Request (code 1) ID 227 length 22
(30) eap: EAP session adding &reply:State = 0xa19f7a40a17c7ee6
(30)     [eap] = handled
(30)   } # authenticate = handled
(30) Using Post-Auth-Type Challenge
(30) Post-Auth-Type sub-section not found.  Ignoring.
(30) # Executing group from file /etc/freeradius/sites-enabled/default
(30) Sent Access-Challenge Id 126 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(30)   EAP-Message = 0x01e3001604103db6b40944256de978c88f9007bc0b87
(30)   Message-Authenticator = 0x00000000000000000000000000000000
(30)   State = 0xa19f7a40a17c7ee6dbd710ea8eb11326
(30) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.3 seconds.
Thread 4 got semaphore
Thread 4 handling request 31, (7 handled so far)
(31) <running>: Received Access-Request Id 127 from 192.168.1.30:50043 to 172.17.0.4:1812 length 204
(31) <running>:   User-Name = "emiruss"
(31) <running>:   NAS-IP-Address = 192.168.1.30
(31) <running>:   NAS-Identifier = "Ericsson"
(31) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(31) <running>:   NAS-Port-Type = Wireless-802.11
(31) <running>:   NAS-Port = 0
(31) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(31) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(31) <running>:   Acct-Session-Id = "003E2DE6-0000004E"
(31) <running>:   Framed-MTU = 1400
(31) <running>:   EAP-Message = 0x02e300080319152b
(31) <running>:   State = 0xa19f7a40a17c7ee6dbd710ea8eb11326
(31) <running>:   Message-Authenticator = 0x25cf30fae24a2f7707590e214ebad5b0
(31) <running>: session-state: No cached attributes
(31) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(31) <running>:   authorize {
(31) <running>:     policy filter_username {
(31) <running>:       if (!&User-Name) {
(31) <running>:       if (!&User-Name)  -> FALSE
(31) <running>:       if (&User-Name =~ / /) {
(31) <running>:       if (&User-Name =~ / /)  -> FALSE
(31) <running>:       if (&User-Name =~ /@.*@/ ) {
(31) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(31) <running>:       if (&User-Name =~ /\.\./ ) {
(31) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(31) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(31) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(31) <running>:       if (&User-Name =~ /\.$/)  {
(31) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(31) <running>:       if (&User-Name =~ /@\./)  {
(31) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(31) <running>:     } # policy filter_username = notfound
(31)     [preprocess] = ok
(31)     [chap] = noop
(31)     [mschap] = noop
(31)     [digest] = noop
(31) suffix: Checking for suffix after "@"
(31) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(31) suffix: No such realm "NULL"
(31)     [suffix] = noop
(31) eap: Peer sent EAP Response (code 2) ID 227 length 8
(31) eap: No EAP Start, assuming it's an on-going EAP conversation
(31)     [eap] = updated
(31)     [files] = noop
(31) sql: EXPAND %{User-Name}
(31) sql:    --> emiruss
(31) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Closing connection (7): Hit idle_timeout, was idle for 1240 seconds
rlm_sql (sql): Closing connection (0): Hit idle_timeout, was idle for 1240 seconds
rlm_sql (sql): Closing connection (5): Hit idle_timeout, was idle for 1240 seconds
rlm_sql (sql): Closing connection (1): Hit idle_timeout, was idle for 1240 seconds
rlm_sql (sql): Closing connection (6): Hit idle_timeout, was idle for 1237 seconds
rlm_sql (sql): Closing connection (8): Hit idle_timeout, was idle for 1237 seconds
rlm_sql (sql): Closing connection (2): Hit idle_timeout, was idle for 1237 seconds
rlm_sql (sql): You probably need to lower "min"
rlm_sql (sql): Closing connection (3): Hit idle_timeout, was idle for 1237 seconds
rlm_sql (sql): You probably need to lower "min"
rlm_sql (sql): Closing connection (4): Hit idle_timeout, was idle for 1237 seconds
rlm_sql (sql): You probably need to lower "min"
rlm_sql (sql): 0 of 0 connections in use.  You  may need to increase "spare"
rlm_sql (sql): Opening additional connection (9), 1 of 32 pending slots used
rlm_sql (sql): Reserved connection (9)
(31) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(31) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(31) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(31) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(31) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(31) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(31) sql: User not found in any groups
rlm_sql (sql): Released connection (9)
rlm_sql (sql): Need 2 more connections to reach 10 spares
rlm_sql (sql): Opening additional connection (10), 1 of 31 pending slots used
(31)     [sql] = notfound
(31)     [expiration] = noop
(31)     [logintime] = noop
(31) pap: WARNING: No "known good" password found for the user.  Not setting Auth-Type
(31) pap: WARNING: Authentication will fail unless a "known good" password is available
(31)     [pap] = noop
(31)   } # authorize = updated
(31) Found Auth-Type = EAP
(31) # Executing group from file /etc/freeradius/sites-enabled/default
(31)   authenticate {
(31) eap: Expiring EAP session with state 0xa19f7a40a17c7ee6
(31) eap: Finished EAP session with state 0xa19f7a40a17c7ee6
(31) eap: Previous EAP request found for state 0xa19f7a40a17c7ee6, released from the list
(31) eap: Peer sent packet with method EAP NAK (3)
(31) eap: Found mutually acceptable type PEAP (25)
(31) eap: Calling submodule eap_peap to process data
(31) eap_peap: Initiating new EAP-TLS session
(31) eap_peap: [eaptls start] = request
(31) eap: Sending EAP Request (code 1) ID 228 length 6
(31) eap: EAP session adding &reply:State = 0xa19f7a40a07b63e6
(31)     [eap] = handled
(31)   } # authenticate = handled
(31) Using Post-Auth-Type Challenge
(31) Post-Auth-Type sub-section not found.  Ignoring.
(31) # Executing group from file /etc/freeradius/sites-enabled/default
(31) Sent Access-Challenge Id 127 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(31)   EAP-Message = 0x01e400061920
(31)   Message-Authenticator = 0x00000000000000000000000000000000
(31)   State = 0xa19f7a40a07b63e6dbd710ea8eb11326
(31) Finished request
Thread 4 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 3 got semaphore
Thread 3 handling request 32, (7 handled so far)
(32) <running>: Received Access-Request Id 128 from 192.168.1.30:50043 to 172.17.0.4:1812 length 339
(32) <running>:   User-Name = "emiruss"
(32) <running>:   NAS-IP-Address = 192.168.1.30
(32) <running>:   NAS-Identifier = "Ericsson"
(32) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(32) <running>:   NAS-Port-Type = Wireless-802.11
(32) <running>:   NAS-Port = 0
(32) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(32) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(32) <running>:   Acct-Session-Id = "003E2DE6-0000004E"
(32) <running>:   Framed-MTU = 1400
(32) <running>:   EAP-Message = 0x02e4008f19800000008516030100800100007c030156552c90a99758bc3b79fd71b279ec3594e32dbdccbeb42d73d609d535c9b2d400003400ffc02cc02bc024c023c00ac009c008c030c02fc028c027c014c013c012009d009c003d003c0035002f000ac007c011000500040100001f000a0008000600
(32) <running>:   State = 0xa19f7a40a07b63e6dbd710ea8eb11326
(32) <running>:   Message-Authenticator = 0xe6a5f4daa71906f2b034ec7255598591
(32) <running>: session-state: No cached attributes
(32) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(32) <running>:   authorize {
(32) <running>:     policy filter_username {
(32) <running>:       if (!&User-Name) {
(32) <running>:       if (!&User-Name)  -> FALSE
(32) <running>:       if (&User-Name =~ / /) {
(32) <running>:       if (&User-Name =~ / /)  -> FALSE
(32) <running>:       if (&User-Name =~ /@.*@/ ) {
(32) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(32) <running>:       if (&User-Name =~ /\.\./ ) {
(32) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(32) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(32) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(32) <running>:       if (&User-Name =~ /\.$/)  {
(32) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(32) <running>:       if (&User-Name =~ /@\./)  {
(32) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(32) <running>:     } # policy filter_username = notfound
(32)     [preprocess] = ok
(32)     [chap] = noop
(32)     [mschap] = noop
(32)     [digest] = noop
(32) suffix: Checking for suffix after "@"
(32) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(32) suffix: No such realm "NULL"
(32)     [suffix] = noop
(32) eap: Peer sent EAP Response (code 2) ID 228 length 143
(32) eap: Continuing tunnel setup
(32)     [eap] = ok
(32)   } # authorize = ok
(32) Found Auth-Type = EAP
(32) # Executing group from file /etc/freeradius/sites-enabled/default
(32)   authenticate {
(32) eap: Expiring EAP session with state 0xa19f7a40a07b63e6
(32) eap: Finished EAP session with state 0xa19f7a40a07b63e6
(32) eap: Previous EAP request found for state 0xa19f7a40a07b63e6, released from the list
(32) eap: Peer sent packet with method EAP PEAP (25)
(32) eap: Calling submodule eap_peap to process data
(32) eap_peap: Continuing EAP-TLS
(32) eap_peap: Peer indicated complete TLS record size will be 133 bytes
(32) eap_peap: Got complete TLS record (133 bytes)
(32) eap_peap: [eaptls verify] = length included
(32) eap_peap: (other): before/accept initialization
(32) eap_peap: TLS_accept: before/accept initialization
(32) eap_peap: <<< TLS 1.0 Handshake [length 0080], ClientHello 
(32) eap_peap: TLS_accept: SSLv3 read client hello A
(32) eap_peap: >>> TLS 1.0 Handshake [length 0059], ServerHello 
(32) eap_peap: TLS_accept: SSLv3 write server hello A
(32) eap_peap: >>> TLS 1.0 Handshake [length 08d3], Certificate 
(32) eap_peap: TLS_accept: SSLv3 write certificate A
(32) eap_peap: >>> TLS 1.0 Handshake [length 014b], ServerKeyExchange 
(32) eap_peap: TLS_accept: SSLv3 write key exchange A
(32) eap_peap: >>> TLS 1.0 Handshake [length 0004], ServerHelloDone 
(32) eap_peap: TLS_accept: SSLv3 write server done A
(32) eap_peap: TLS_accept: SSLv3 flush data
(32) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(32) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(32) eap_peap: In SSL Handshake Phase
(32) eap_peap: In SSL Accept mode
(32) eap_peap: [eaptls process] = handled
(32) eap: Sending EAP Request (code 1) ID 229 length 1004
(32) eap: EAP session adding &reply:State = 0xa19f7a40a37a63e6
(32)     [eap] = handled
(32)   } # authenticate = handled
(32) Using Post-Auth-Type Challenge
(32) Post-Auth-Type sub-section not found.  Ignoring.
(32) # Executing group from file /etc/freeradius/sites-enabled/default
(32) Sent Access-Challenge Id 128 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(32)   EAP-Message = 0x01e503ec19c000000a8f1603010059020000550301a4107c36a0142d18001e3c99e76d34e119ae7bb57c95c019e0e31032e4ed43e12068cf5e7c22db091d93e64fd91a6cd26239e4db08ced2c73e6aea40ad90468073c01400000dff01000100000b00040300010216030108d30b0008cf0008cc0003de
(32)   Message-Authenticator = 0x00000000000000000000000000000000
(32)   State = 0xa19f7a40a37a63e6dbd710ea8eb11326
(32) Finished request
Thread 3 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 2 got semaphore
Thread 2 handling request 33, (7 handled so far)
(33) <running>: Received Access-Request Id 129 from 192.168.1.30:50043 to 172.17.0.4:1812 length 202
(33) <running>:   User-Name = "emiruss"
(33) <running>:   NAS-IP-Address = 192.168.1.30
(33) <running>:   NAS-Identifier = "Ericsson"
(33) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(33) <running>:   NAS-Port-Type = Wireless-802.11
(33) <running>:   NAS-Port = 0
(33) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(33) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(33) <running>:   Acct-Session-Id = "003E2DE6-0000004E"
(33) <running>:   Framed-MTU = 1400
(33) <running>:   EAP-Message = 0x02e500061900
(33) <running>:   State = 0xa19f7a40a37a63e6dbd710ea8eb11326
(33) <running>:   Message-Authenticator = 0x92b1ef501fcd5dfe84f6eec03be80619
(33) <running>: session-state: No cached attributes
(33) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(33) <running>:   authorize {
(33) <running>:     policy filter_username {
(33) <running>:       if (!&User-Name) {
(33) <running>:       if (!&User-Name)  -> FALSE
(33) <running>:       if (&User-Name =~ / /) {
(33) <running>:       if (&User-Name =~ / /)  -> FALSE
(33) <running>:       if (&User-Name =~ /@.*@/ ) {
(33) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(33) <running>:       if (&User-Name =~ /\.\./ ) {
(33) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(33) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(33) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(33) <running>:       if (&User-Name =~ /\.$/)  {
(33) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(33) <running>:       if (&User-Name =~ /@\./)  {
(33) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(33) <running>:     } # policy filter_username = notfound
(33)     [preprocess] = ok
(33)     [chap] = noop
(33)     [mschap] = noop
(33)     [digest] = noop
(33) suffix: Checking for suffix after "@"
(33) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(33) suffix: No such realm "NULL"
(33)     [suffix] = noop
(33) eap: Peer sent EAP Response (code 2) ID 229 length 6
(33) eap: Continuing tunnel setup
(33)     [eap] = ok
(33)   } # authorize = ok
(33) Found Auth-Type = EAP
(33) # Executing group from file /etc/freeradius/sites-enabled/default
(33)   authenticate {
(33) eap: Expiring EAP session with state 0xa19f7a40a37a63e6
(33) eap: Finished EAP session with state 0xa19f7a40a37a63e6
(33) eap: Previous EAP request found for state 0xa19f7a40a37a63e6, released from the list
(33) eap: Peer sent packet with method EAP PEAP (25)
(33) eap: Calling submodule eap_peap to process data
(33) eap_peap: Continuing EAP-TLS
(33) eap_peap: Peer ACKed our handshake fragment
(33) eap_peap: [eaptls verify] = request
(33) eap_peap: [eaptls process] = handled
(33) eap: Sending EAP Request (code 1) ID 230 length 1000
(33) eap: EAP session adding &reply:State = 0xa19f7a40a27963e6
(33)     [eap] = handled
(33)   } # authenticate = handled
(33) Using Post-Auth-Type Challenge
(33) Post-Auth-Type sub-section not found.  Ignoring.
(33) # Executing group from file /etc/freeradius/sites-enabled/default
(33) Sent Access-Challenge Id 129 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(33)   EAP-Message = 0x01e603e819400dd0405955c762981948527048701681d313d3cc6629a5557b66df2aae22c8590ab99d66ec8d3792a72e30596410f5d1e81f5a774969a1ce9ad6bd01d42da65536016e80a905c662a71ef5c075b8bdf0127a0cf1bd4c91290e15edffa035febde0185096bdc1e553090004e8308204e430
(33)   Message-Authenticator = 0x00000000000000000000000000000000
(33)   State = 0xa19f7a40a27963e6dbd710ea8eb11326
(33) Finished request
Thread 2 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 1 got semaphore
Thread 1 handling request 34, (7 handled so far)
(34) <running>: Received Access-Request Id 130 from 192.168.1.30:50043 to 172.17.0.4:1812 length 202
(34) <running>:   User-Name = "emiruss"
(34) <running>:   NAS-IP-Address = 192.168.1.30
(34) <running>:   NAS-Identifier = "Ericsson"
(34) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(34) <running>:   NAS-Port-Type = Wireless-802.11
(34) <running>:   NAS-Port = 0
(34) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(34) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(34) <running>:   Acct-Session-Id = "003E2DE6-0000004E"
(34) <running>:   Framed-MTU = 1400
(34) <running>:   EAP-Message = 0x02e600061900
(34) <running>:   State = 0xa19f7a40a27963e6dbd710ea8eb11326
(34) <running>:   Message-Authenticator = 0xcfc1cb91ec682c3d03f35f43e00d826e
(34) <running>: session-state: No cached attributes
(34) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(34) <running>:   authorize {
(34) <running>:     policy filter_username {
(34) <running>:       if (!&User-Name) {
(34) <running>:       if (!&User-Name)  -> FALSE
(34) <running>:       if (&User-Name =~ / /) {
(34) <running>:       if (&User-Name =~ / /)  -> FALSE
(34) <running>:       if (&User-Name =~ /@.*@/ ) {
(34) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(34) <running>:       if (&User-Name =~ /\.\./ ) {
(34) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(34) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(34) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(34) <running>:       if (&User-Name =~ /\.$/)  {
(34) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(34) <running>:       if (&User-Name =~ /@\./)  {
(34) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(34) <running>:     } # policy filter_username = notfound
(34)     [preprocess] = ok
(34)     [chap] = noop
(34)     [mschap] = noop
(34)     [digest] = noop
(34) suffix: Checking for suffix after "@"
(34) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(34) suffix: No such realm "NULL"
(34)     [suffix] = noop
(34) eap: Peer sent EAP Response (code 2) ID 230 length 6
(34) eap: Continuing tunnel setup
(34)     [eap] = ok
(34)   } # authorize = ok
(34) Found Auth-Type = EAP
(34) # Executing group from file /etc/freeradius/sites-enabled/default
(34)   authenticate {
(34) eap: Expiring EAP session with state 0xa19f7a40a27963e6
(34) eap: Finished EAP session with state 0xa19f7a40a27963e6
(34) eap: Previous EAP request found for state 0xa19f7a40a27963e6, released from the list
(34) eap: Peer sent packet with method EAP PEAP (25)
(34) eap: Calling submodule eap_peap to process data
(34) eap_peap: Continuing EAP-TLS
(34) eap_peap: Peer ACKed our handshake fragment
(34) eap_peap: [eaptls verify] = request
(34) eap_peap: [eaptls process] = handled
(34) eap: Sending EAP Request (code 1) ID 231 length 721
(34) eap: EAP session adding &reply:State = 0xa19f7a40a57863e6
(34)     [eap] = handled
(34)   } # authenticate = handled
(34) Using Post-Auth-Type Challenge
(34) Post-Auth-Type sub-section not found.  Ignoring.
(34) # Executing group from file /etc/freeradius/sites-enabled/default
(34) Sent Access-Challenge Id 130 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(34)   EAP-Message = 0x01e702d1190020417574686f72697479820900c3fc536eef83d741300f0603551d130101ff040530030101ff30360603551d1f042f302d302ba029a0278625687474703a2f2f7777772e6578616d706c652e6f72672f6578616d706c655f63612e63726c300d06092a864886f70d01010b050003820101
(34)   Message-Authenticator = 0x00000000000000000000000000000000
(34)   State = 0xa19f7a40a57863e6dbd710ea8eb11326
(34) Finished request
Thread 1 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 5 got semaphore
Thread 5 handling request 35, (8 handled so far)
(35) <running>: Received Access-Request Id 131 from 192.168.1.30:50043 to 172.17.0.4:1812 length 340
(35) <running>:   User-Name = "emiruss"
(35) <running>:   NAS-IP-Address = 192.168.1.30
(35) <running>:   NAS-Identifier = "Ericsson"
(35) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(35) <running>:   NAS-Port-Type = Wireless-802.11
(35) <running>:   NAS-Port = 0
(35) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(35) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(35) <running>:   Acct-Session-Id = "003E2DE6-0000004E"
(35) <running>:   Framed-MTU = 1400
(35) <running>:   EAP-Message = 0x02e700901980000000861603010046100000424104cd2ee5a1a7729c0d157e33328fbefb156d2d06c6da7fea6aa2190d970f48a9086ae1b9597ed92eb3a07bbcd5c19f1ac9042b6abfbabd4d1a7ae01ef374310eed14030100010116030100303533b4c26a80e33138e50b96114d0cd29b41b452da18ee
(35) <running>:   State = 0xa19f7a40a57863e6dbd710ea8eb11326
(35) <running>:   Message-Authenticator = 0xd72fc62392e093d3edfee9c661a5faa1
(35) <running>: session-state: No cached attributes
(35) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(35) <running>:   authorize {
(35) <running>:     policy filter_username {
(35) <running>:       if (!&User-Name) {
(35) <running>:       if (!&User-Name)  -> FALSE
(35) <running>:       if (&User-Name =~ / /) {
(35) <running>:       if (&User-Name =~ / /)  -> FALSE
(35) <running>:       if (&User-Name =~ /@.*@/ ) {
(35) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(35) <running>:       if (&User-Name =~ /\.\./ ) {
(35) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(35) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(35) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(35) <running>:       if (&User-Name =~ /\.$/)  {
(35) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(35) <running>:       if (&User-Name =~ /@\./)  {
(35) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(35) <running>:     } # policy filter_username = notfound
(35)     [preprocess] = ok
(35)     [chap] = noop
(35)     [mschap] = noop
(35)     [digest] = noop
(35) suffix: Checking for suffix after "@"
(35) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(35) suffix: No such realm "NULL"
(35)     [suffix] = noop
(35) eap: Peer sent EAP Response (code 2) ID 231 length 144
(35) eap: Continuing tunnel setup
(35)     [eap] = ok
(35)   } # authorize = ok
(35) Found Auth-Type = EAP
(35) # Executing group from file /etc/freeradius/sites-enabled/default
(35)   authenticate {
(35) eap: Expiring EAP session with state 0xa19f7a40a57863e6
(35) eap: Finished EAP session with state 0xa19f7a40a57863e6
(35) eap: Previous EAP request found for state 0xa19f7a40a57863e6, released from the list
(35) eap: Peer sent packet with method EAP PEAP (25)
(35) eap: Calling submodule eap_peap to process data
(35) eap_peap: Continuing EAP-TLS
(35) eap_peap: Peer indicated complete TLS record size will be 134 bytes
(35) eap_peap: Got complete TLS record (134 bytes)
(35) eap_peap: [eaptls verify] = length included
(35) eap_peap: <<< TLS 1.0 Handshake [length 0046], ClientKeyExchange 
(35) eap_peap: TLS_accept: SSLv3 read client key exchange A
(35) eap_peap: <<< TLS 1.0 ChangeCipherSpec [length 0001] 
(35) eap_peap: <<< TLS 1.0 Handshake [length 0010], Finished 
(35) eap_peap: TLS_accept: SSLv3 read finished A
(35) eap_peap: >>> TLS 1.0 ChangeCipherSpec [length 0001] 
(35) eap_peap: TLS_accept: SSLv3 write change cipher spec A
(35) eap_peap: >>> TLS 1.0 Handshake [length 0010], Finished 
(35) eap_peap: TLS_accept: SSLv3 write finished A
(35) eap_peap: TLS_accept: SSLv3 flush data
(35) eap_peap: (other): SSL negotiation finished successfully
(35) eap_peap: SSL Connection Established
(35) eap_peap: [eaptls process] = handled
(35) eap: Sending EAP Request (code 1) ID 232 length 65
(35) eap: EAP session adding &reply:State = 0xa19f7a40a47763e6
(35)     [eap] = handled
(35)   } # authenticate = handled
(35) Using Post-Auth-Type Challenge
(35) Post-Auth-Type sub-section not found.  Ignoring.
(35) # Executing group from file /etc/freeradius/sites-enabled/default
(35) Sent Access-Challenge Id 131 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(35)   EAP-Message = 0x01e8004119001403010001011603010030907026fb5827918a587d42e9a59c735d91adcdc164b672aae186730aef9cefdd804dfd65a582021fd2f3702fb9bda01f
(35)   Message-Authenticator = 0x00000000000000000000000000000000
(35)   State = 0xa19f7a40a47763e6dbd710ea8eb11326
(35) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 4 got semaphore
Thread 4 handling request 36, (8 handled so far)
(36) <running>: Received Access-Request Id 132 from 192.168.1.30:50043 to 172.17.0.4:1812 length 202
(36) <running>:   User-Name = "emiruss"
(36) <running>:   NAS-IP-Address = 192.168.1.30
(36) <running>:   NAS-Identifier = "Ericsson"
(36) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(36) <running>:   NAS-Port-Type = Wireless-802.11
(36) <running>:   NAS-Port = 0
(36) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(36) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(36) <running>:   Acct-Session-Id = "003E2DE6-0000004E"
(36) <running>:   Framed-MTU = 1400
(36) <running>:   EAP-Message = 0x02e800061900
(36) <running>:   State = 0xa19f7a40a47763e6dbd710ea8eb11326
(36) <running>:   Message-Authenticator = 0x9b7d6d5e036f3ffd527b0db7c30650a7
(36) <running>: session-state: No cached attributes
(36) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(36) <running>:   authorize {
(36) <running>:     policy filter_username {
(36) <running>:       if (!&User-Name) {
(36) <running>:       if (!&User-Name)  -> FALSE
(36) <running>:       if (&User-Name =~ / /) {
(36) <running>:       if (&User-Name =~ / /)  -> FALSE
(36) <running>:       if (&User-Name =~ /@.*@/ ) {
(36) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(36) <running>:       if (&User-Name =~ /\.\./ ) {
(36) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(36) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(36) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(36) <running>:       if (&User-Name =~ /\.$/)  {
(36) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(36) <running>:       if (&User-Name =~ /@\./)  {
(36) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(36) <running>:     } # policy filter_username = notfound
(36)     [preprocess] = ok
(36)     [chap] = noop
(36)     [mschap] = noop
(36)     [digest] = noop
(36) suffix: Checking for suffix after "@"
(36) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(36) suffix: No such realm "NULL"
(36)     [suffix] = noop
(36) eap: Peer sent EAP Response (code 2) ID 232 length 6
(36) eap: Continuing tunnel setup
(36)     [eap] = ok
(36)   } # authorize = ok
(36) Found Auth-Type = EAP
(36) # Executing group from file /etc/freeradius/sites-enabled/default
(36)   authenticate {
(36) eap: Expiring EAP session with state 0xa19f7a40a47763e6
(36) eap: Finished EAP session with state 0xa19f7a40a47763e6
(36) eap: Previous EAP request found for state 0xa19f7a40a47763e6, released from the list
(36) eap: Peer sent packet with method EAP PEAP (25)
(36) eap: Calling submodule eap_peap to process data
(36) eap_peap: Continuing EAP-TLS
(36) eap_peap: Peer ACKed our handshake fragment.  handshake is finished
(36) eap_peap: [eaptls verify] = success
(36) eap_peap: [eaptls process] = success
(36) eap_peap: Session established.  Decoding tunneled attributes
(36) eap_peap: PEAP state TUNNEL ESTABLISHED
(36) eap: Sending EAP Request (code 1) ID 233 length 43
(36) eap: EAP session adding &reply:State = 0xa19f7a40a77663e6
(36)     [eap] = handled
(36)   } # authenticate = handled
(36) Using Post-Auth-Type Challenge
(36) Post-Auth-Type sub-section not found.  Ignoring.
(36) # Executing group from file /etc/freeradius/sites-enabled/default
(36) Sent Access-Challenge Id 132 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(36)   EAP-Message = 0x01e9002b19001703010020d93a3adff87828129607b4e93dd032330141c7cb9680448a2f87741f241134e9
(36)   Message-Authenticator = 0x00000000000000000000000000000000
(36)   State = 0xa19f7a40a77663e6dbd710ea8eb11326
(36) Finished request
Thread 4 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 3 got semaphore
Thread 3 handling request 37, (8 handled so far)
(37) <running>: Received Access-Request Id 133 from 192.168.1.30:50043 to 172.17.0.4:1812 length 239
(37) <running>:   User-Name = "emiruss"
(37) <running>:   NAS-IP-Address = 192.168.1.30
(37) <running>:   NAS-Identifier = "Ericsson"
(37) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(37) <running>:   NAS-Port-Type = Wireless-802.11
(37) <running>:   NAS-Port = 0
(37) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(37) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(37) <running>:   Acct-Session-Id = "003E2DE6-0000004E"
(37) <running>:   Framed-MTU = 1400
(37) <running>:   EAP-Message = 0x02e9002b19001703010020a3bb5de2770010e781945d7c0b6b5425eb1404325f08e6f2e20be42f3a34a313
(37) <running>:   State = 0xa19f7a40a77663e6dbd710ea8eb11326
(37) <running>:   Message-Authenticator = 0x1d685ac05362e27a06fe2cbd9762f59b
(37) <running>: session-state: No cached attributes
(37) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(37) <running>:   authorize {
(37) <running>:     policy filter_username {
(37) <running>:       if (!&User-Name) {
(37) <running>:       if (!&User-Name)  -> FALSE
(37) <running>:       if (&User-Name =~ / /) {
(37) <running>:       if (&User-Name =~ / /)  -> FALSE
(37) <running>:       if (&User-Name =~ /@.*@/ ) {
(37) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(37) <running>:       if (&User-Name =~ /\.\./ ) {
(37) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(37) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(37) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(37) <running>:       if (&User-Name =~ /\.$/)  {
(37) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(37) <running>:       if (&User-Name =~ /@\./)  {
(37) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(37) <running>:     } # policy filter_username = notfound
(37)     [preprocess] = ok
(37)     [chap] = noop
(37)     [mschap] = noop
(37)     [digest] = noop
(37) suffix: Checking for suffix after "@"
(37) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(37) suffix: No such realm "NULL"
(37)     [suffix] = noop
(37) eap: Peer sent EAP Response (code 2) ID 233 length 43
(37) eap: Continuing tunnel setup
(37)     [eap] = ok
(37)   } # authorize = ok
(37) Found Auth-Type = EAP
(37) # Executing group from file /etc/freeradius/sites-enabled/default
(37)   authenticate {
(37) eap: Expiring EAP session with state 0xa19f7a40a77663e6
(37) eap: Finished EAP session with state 0xa19f7a40a77663e6
(37) eap: Previous EAP request found for state 0xa19f7a40a77663e6, released from the list
(37) eap: Peer sent packet with method EAP PEAP (25)
(37) eap: Calling submodule eap_peap to process data
(37) eap_peap: Continuing EAP-TLS
(37) eap_peap: [eaptls verify] = ok
(37) eap_peap: Done initial handshake
(37) eap_peap: [eaptls process] = ok
(37) eap_peap: Session established.  Decoding tunneled attributes
(37) eap_peap: PEAP state WAITING FOR INNER IDENTITY
(37) eap_peap: Identity - emiruss
(37) eap_peap: Got inner identity 'emiruss'
(37) eap_peap: Setting default EAP type for tunneled EAP session
(37) eap_peap: Got tunneled request
(37) eap_peap:   EAP-Message = 0x02e9000c01656d6972757373
(37) eap_peap: Setting User-Name to emiruss
(37) eap_peap: Sending tunneled request to inner-tunnel
(37) eap_peap:   EAP-Message = 0x02e9000c01656d6972757373
(37) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(37) eap_peap:   User-Name = "emiruss"
(37) Virtual server inner-tunnel received request
(37)   EAP-Message = 0x02e9000c01656d6972757373
(37)   FreeRADIUS-Proxied-To = 127.0.0.1
(37)   User-Name = "emiruss"
(37) server inner-tunnel {
(37)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(37)     authorize {
(37)       [chap] = noop
(37)       [mschap] = noop
(37) suffix: Checking for suffix after "@"
(37) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(37) suffix: No such realm "NULL"
(37)       [suffix] = noop
(37)       update control {
(37)         &Proxy-To-Realm := LOCAL
(37)       } # update control = noop
(37) eap: Peer sent EAP Response (code 2) ID 233 length 12
(37) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(37)       [eap] = ok
(37)     } # authorize = ok
(37)   Found Auth-Type = EAP
(37)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(37)     authenticate {
(37) eap: Peer sent packet with method EAP Identity (1)
(37) eap: Calling submodule eap_mschapv2 to process data
(37) eap_mschapv2: Issuing Challenge
(37) eap: Sending EAP Request (code 1) ID 234 length 43
(37) eap: EAP session adding &reply:State = 0x02a15b29024b41af
(37)       [eap] = handled
(37)     } # authenticate = handled
(37) } # server inner-tunnel
(37) Virtual server sending reply
(37)   EAP-Message = 0x01ea002b1a01ea002610d209801ff3a63a0d5d77de0c7f604e28667265657261646975732d332e302e3130
(37)   Message-Authenticator = 0x00000000000000000000000000000000
(37)   State = 0x02a15b29024b41af9bdd878e00c87e30
(37) eap_peap: Got tunneled reply code 11
(37) eap_peap:   EAP-Message = 0x01ea002b1a01ea002610d209801ff3a63a0d5d77de0c7f604e28667265657261646975732d332e302e3130
(37) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(37) eap_peap:   State = 0x02a15b29024b41af9bdd878e00c87e30
(37) eap_peap: Got tunneled Access-Challenge
(37) eap: Sending EAP Request (code 1) ID 234 length 75
(37) eap: EAP session adding &reply:State = 0xa19f7a40a67563e6
(37)     [eap] = handled
(37)   } # authenticate = handled
(37) Using Post-Auth-Type Challenge
(37) Post-Auth-Type sub-section not found.  Ignoring.
(37) # Executing group from file /etc/freeradius/sites-enabled/default
(37) Sent Access-Challenge Id 133 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(37)   EAP-Message = 0x01ea004b190017030100405da593a4eec3cb9b060f2ef9a6cf118adafbded5a247fd56fff834301335a1910491f1977da171400f389724b271bcb9fabfceb184127a2e82d6d75e7c04b54e
(37)   Message-Authenticator = 0x00000000000000000000000000000000
(37)   State = 0xa19f7a40a67563e6dbd710ea8eb11326
(37) Finished request
Thread 3 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 2 got semaphore
Thread 2 handling request 38, (8 handled so far)
(38) <running>: Received Access-Request Id 134 from 192.168.1.30:50043 to 172.17.0.4:1812 length 303
(38) <running>:   User-Name = "emiruss"
(38) <running>:   NAS-IP-Address = 192.168.1.30
(38) <running>:   NAS-Identifier = "Ericsson"
(38) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(38) <running>:   NAS-Port-Type = Wireless-802.11
(38) <running>:   NAS-Port = 0
(38) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(38) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(38) <running>:   Acct-Session-Id = "003E2DE6-0000004E"
(38) <running>:   Framed-MTU = 1400
(38) <running>:   EAP-Message = 0x02ea006b1900170301006002a17d92cfa6ae3f18a091dd0effe153df52845db56b05678993df3973d844094bdbb2e6c9baf4cf0bf5c9404ca61252d6d4ef3c28396a1aed6616dd1732527eb10805bdf3aaaee5eb418ceffa3e1225c4890d12d4c4d906b7bbd827b3eab6d4
(38) <running>:   State = 0xa19f7a40a67563e6dbd710ea8eb11326
(38) <running>:   Message-Authenticator = 0xcaedf09208742f373d095baf514a3612
(38) <running>: session-state: No cached attributes
(38) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(38) <running>:   authorize {
(38) <running>:     policy filter_username {
(38) <running>:       if (!&User-Name) {
(38) <running>:       if (!&User-Name)  -> FALSE
(38) <running>:       if (&User-Name =~ / /) {
(38) <running>:       if (&User-Name =~ / /)  -> FALSE
(38) <running>:       if (&User-Name =~ /@.*@/ ) {
(38) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(38) <running>:       if (&User-Name =~ /\.\./ ) {
(38) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(38) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(38) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(38) <running>:       if (&User-Name =~ /\.$/)  {
(38) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(38) <running>:       if (&User-Name =~ /@\./)  {
(38) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(38) <running>:     } # policy filter_username = notfound
(38)     [preprocess] = ok
(38)     [chap] = noop
(38)     [mschap] = noop
(38)     [digest] = noop
(38) suffix: Checking for suffix after "@"
(38) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(38) suffix: No such realm "NULL"
(38)     [suffix] = noop
(38) eap: Peer sent EAP Response (code 2) ID 234 length 107
(38) eap: Continuing tunnel setup
(38)     [eap] = ok
(38)   } # authorize = ok
(38) Found Auth-Type = EAP
(38) # Executing group from file /etc/freeradius/sites-enabled/default
(38)   authenticate {
(38) eap: Expiring EAP session with state 0x02a15b29024b41af
(38) eap: Finished EAP session with state 0xa19f7a40a67563e6
(38) eap: Previous EAP request found for state 0xa19f7a40a67563e6, released from the list
(38) eap: Peer sent packet with method EAP PEAP (25)
(38) eap: Calling submodule eap_peap to process data
(38) eap_peap: Continuing EAP-TLS
(38) eap_peap: [eaptls verify] = ok
(38) eap_peap: Done initial handshake
(38) eap_peap: [eaptls process] = ok
(38) eap_peap: Session established.  Decoding tunneled attributes
(38) eap_peap: PEAP state phase2
(38) eap_peap: EAP method MSCHAPv2 (26)
(38) eap_peap: Got tunneled request
(38) eap_peap:   EAP-Message = 0x02ea00421a02ea003d311f7894a41fbcf9eb8e1f09b4d7a766c700000000000000006c97b09831fdd69014cab1f5f8355b096f4f63d51496b47500656d6972757373
(38) eap_peap: Setting User-Name to emiruss
(38) eap_peap: Sending tunneled request to inner-tunnel
(38) eap_peap:   EAP-Message = 0x02ea00421a02ea003d311f7894a41fbcf9eb8e1f09b4d7a766c700000000000000006c97b09831fdd69014cab1f5f8355b096f4f63d51496b47500656d6972757373
(38) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(38) eap_peap:   User-Name = "emiruss"
(38) eap_peap:   State = 0x02a15b29024b41af9bdd878e00c87e30
(38) Virtual server inner-tunnel received request
(38)   EAP-Message = 0x02ea00421a02ea003d311f7894a41fbcf9eb8e1f09b4d7a766c700000000000000006c97b09831fdd69014cab1f5f8355b096f4f63d51496b47500656d6972757373
(38)   FreeRADIUS-Proxied-To = 127.0.0.1
(38)   User-Name = "emiruss"
(38)   State = 0x02a15b29024b41af9bdd878e00c87e30
(38) server inner-tunnel {
(38)   session-state: No cached attributes
(38)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(38)     authorize {
(38)       [chap] = noop
(38)       [mschap] = noop
(38) suffix: Checking for suffix after "@"
(38) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(38) suffix: No such realm "NULL"
(38)       [suffix] = noop
(38)       update control {
(38)         &Proxy-To-Realm := LOCAL
(38)       } # update control = noop
(38) eap: Peer sent EAP Response (code 2) ID 234 length 66
(38) eap: No EAP Start, assuming it's an on-going EAP conversation
(38)       [eap] = updated
(38)       [files] = noop
(38) sql: EXPAND %{User-Name}
(38) sql:    --> emiruss
(38) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Reserved connection (9)
(38) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(38) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(38) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(38) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(38) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(38) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(38) sql: User not found in any groups
rlm_sql (sql): Released connection (9)
(38)       [sql] = notfound
(38)       [expiration] = noop
(38)       [logintime] = noop
(38)       [pap] = noop
(38)     } # authorize = updated
(38)   Found Auth-Type = EAP
(38)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(38)     authenticate {
(38) eap: Expiring EAP session with state 0x02a15b29024b41af
(38) eap: Finished EAP session with state 0x02a15b29024b41af
(38) eap: Previous EAP request found for state 0x02a15b29024b41af, released from the list
(38) eap: Peer sent packet with method EAP MSCHAPv2 (26)
(38) eap: Calling submodule eap_mschapv2 to process data
(38) eap_mschapv2: # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(38) eap_mschapv2:   Auth-Type MS-CHAP {
(38) mschap: WARNING: No Cleartext-Password configured.  Cannot create NT-Password
(38) mschap: WARNING: No Cleartext-Password configured.  Cannot create LM-Password
(38) mschap: Creating challenge hash with username: emiruss
(38) mschap: Client is using MS-CHAPv2
(38) mschap: ERROR: FAILED: No NT/LM-Password.  Cannot perform authentication
(38) mschap: ERROR: MS-CHAP2-Response is incorrect
(38)     [mschap] = reject
(38)   } # Auth-Type MS-CHAP = reject
(38) eap: Sending EAP Failure (code 4) ID 234 length 4
(38) eap: Freeing handler
(38)       [eap] = reject
(38)     } # authenticate = reject
(38)   Failed to authenticate the user
(38)   Using Post-Auth-Type Reject
(38)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(38)     Post-Auth-Type REJECT {
(38) sql: EXPAND .query
(38) sql:    --> .query
(38) sql: Using query template 'query'
rlm_sql (sql): Reserved connection (10)
(38) sql: EXPAND %{User-Name}
(38) sql:    --> emiruss
(38) sql: SQL-User-Name set to 'emiruss'
(38) sql: EXPAND INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')
(38) sql:    --> INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:33:34')
(38) sql: Executing query: INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:33:34')
(38) sql: SQL query returned: success
(38) sql: 1 record(s) updated
rlm_sql (sql): Released connection (10)
(38)       [sql] = ok
(38) attr_filter.access_reject: EXPAND %{User-Name}
(38) attr_filter.access_reject:    --> emiruss
(38) attr_filter.access_reject: Matched entry DEFAULT at line 11
(38)       [attr_filter.access_reject] = updated
(38)       update outer.session-state {
(38)         &Module-Failure-Message := &request:Module-Failure-Message -> 'mschap: FAILED: No NT/LM-Password.  Cannot perform authentication'
(38)       } # update outer.session-state = noop
(38)     } # Post-Auth-Type REJECT = updated
(38) } # server inner-tunnel
(38) Virtual server sending reply
(38)   MS-CHAP-Error = "\352E=691 R=1 C=c53fd5519d1ce682216aff4ac42ae338 V=3 M=Authentication failed"
(38)   EAP-Message = 0x04ea0004
(38)   Message-Authenticator = 0x00000000000000000000000000000000
(38) eap_peap: Got tunneled reply code 3
(38) eap_peap:   MS-CHAP-Error = "\352E=691 R=1 C=c53fd5519d1ce682216aff4ac42ae338 V=3 M=Authentication failed"
(38) eap_peap:   EAP-Message = 0x04ea0004
(38) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(38) eap_peap: Tunneled authentication was rejected
(38) eap_peap: FAILURE
(38) eap: Sending EAP Request (code 1) ID 235 length 43
(38) eap: EAP session adding &reply:State = 0xa19f7a40a97463e6
(38)     [eap] = handled
(38)   } # authenticate = handled
(38) Using Post-Auth-Type Challenge
(38) Post-Auth-Type sub-section not found.  Ignoring.
(38) # Executing group from file /etc/freeradius/sites-enabled/default
(38) session-state: Saving cached attributes
(38)   Module-Failure-Message := "mschap: FAILED: No NT/LM-Password.  Cannot perform authentication"
(38) Sent Access-Challenge Id 134 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(38)   EAP-Message = 0x01eb002b19001703010020619dffb6a457ec385a7199139a430e1d893ce373a83b0fe755dc6d8daef10362
(38)   Message-Authenticator = 0x00000000000000000000000000000000
(38)   State = 0xa19f7a40a97463e6dbd710ea8eb11326
(38) Finished request
Thread 2 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 1 got semaphore
Thread 1 handling request 39, (8 handled so far)
(39) <running>: Received Access-Request Id 135 from 192.168.1.30:50043 to 172.17.0.4:1812 length 239
(39) <running>:   User-Name = "emiruss"
(39) <running>:   NAS-IP-Address = 192.168.1.30
(39) <running>:   NAS-Identifier = "Ericsson"
(39) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(39) <running>:   NAS-Port-Type = Wireless-802.11
(39) <running>:   NAS-Port = 0
(39) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(39) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(39) <running>:   Acct-Session-Id = "003E2DE6-0000004E"
(39) <running>:   Framed-MTU = 1400
(39) <running>:   EAP-Message = 0x02eb002b190017030100209951a63e989640ebd6011406d2ba8c3985d3b4e796ef1f069c49e5a686ad4ecc
(39) <running>:   State = 0xa19f7a40a97463e6dbd710ea8eb11326
(39) <running>:   Message-Authenticator = 0x3f7bb720887a4b91033ffe6c7d9a329e
(39) <running>: session-state: Found cached attributes
(39) <running>:   Module-Failure-Message := "mschap: FAILED: No NT/LM-Password.  Cannot perform authentication"
(39) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(39) <running>:   authorize {
(39) <running>:     policy filter_username {
(39) <running>:       if (!&User-Name) {
(39) <running>:       if (!&User-Name)  -> FALSE
(39) <running>:       if (&User-Name =~ / /) {
(39) <running>:       if (&User-Name =~ / /)  -> FALSE
(39) <running>:       if (&User-Name =~ /@.*@/ ) {
(39) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(39) <running>:       if (&User-Name =~ /\.\./ ) {
(39) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(39) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(39) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(39) <running>:       if (&User-Name =~ /\.$/)  {
(39) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(39) <running>:       if (&User-Name =~ /@\./)  {
(39) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(39) <running>:     } # policy filter_username = notfound
(39)     [preprocess] = ok
(39)     [chap] = noop
(39)     [mschap] = noop
(39)     [digest] = noop
(39) suffix: Checking for suffix after "@"
(39) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(39) suffix: No such realm "NULL"
(39)     [suffix] = noop
(39) eap: Peer sent EAP Response (code 2) ID 235 length 43
(39) eap: Continuing tunnel setup
(39)     [eap] = ok
(39)   } # authorize = ok
(39) Found Auth-Type = EAP
(39) # Executing group from file /etc/freeradius/sites-enabled/default
(39)   authenticate {
(39) eap: Expiring EAP session with state 0xa19f7a40a97463e6
(39) eap: Finished EAP session with state 0xa19f7a40a97463e6
(39) eap: Previous EAP request found for state 0xa19f7a40a97463e6, released from the list
(39) eap: Peer sent packet with method EAP PEAP (25)
(39) eap: Calling submodule eap_peap to process data
(39) eap_peap: Continuing EAP-TLS
(39) eap_peap: [eaptls verify] = ok
(39) eap_peap: Done initial handshake
(39) eap_peap: [eaptls process] = ok
(39) eap_peap: Session established.  Decoding tunneled attributes
(39) eap_peap: PEAP state send tlv failure
(39) eap_peap: Received EAP-TLV response
(39) eap_peap:   The users session was previously rejected: returning reject (again.)
(39) eap_peap:   This means you need to read the PREVIOUS messages in the debug output
(39) eap_peap:   to find out the reason why the user was rejected
(39) eap_peap:   Look for "reject" or "fail".  Those earlier messages will tell you
(39) eap_peap:   what went wrong, and how to fix the problem
(39) eap: ERROR: Failed continuing EAP PEAP (25) session.  EAP sub-module failed
(39) eap: Sending EAP Failure (code 4) ID 235 length 4
(39) eap: Failed in EAP select
(39)     [eap] = invalid
(39)   } # authenticate = invalid
(39) Failed to authenticate the user
(39) Using Post-Auth-Type Reject
(39) # Executing group from file /etc/freeradius/sites-enabled/default
(39)   Post-Auth-Type REJECT {
(39) sql: EXPAND .query
(39) sql:    --> .query
(39) sql: Using query template 'query'
rlm_sql (sql): Reserved connection (9)
(39) sql: EXPAND %{User-Name}
(39) sql:    --> emiruss
(39) sql: SQL-User-Name set to 'emiruss'
(39) sql: EXPAND INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')
(39) sql:    --> INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:33:34')
(39) sql: Executing query: INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:33:34')
(39) sql: SQL query returned: success
(39) sql: 1 record(s) updated
rlm_sql (sql): Released connection (9)
(39)     [sql] = ok
(39) attr_filter.access_reject: EXPAND %{User-Name}
(39) attr_filter.access_reject:    --> emiruss
(39) attr_filter.access_reject: Matched entry DEFAULT at line 11
(39)     [attr_filter.access_reject] = updated
(39)     [eap] = noop
(39)     policy remove_reply_message_if_eap {
(39)       if (&reply:EAP-Message && &reply:Reply-Message) {
(39)       if (&reply:EAP-Message && &reply:Reply-Message)  -> FALSE
(39)       else {
(39)         [noop] = noop
(39)       } # else = noop
(39)     } # policy remove_reply_message_if_eap = noop
(39)   } # Post-Auth-Type REJECT = updated
(39) Delaying response for 1.000000 seconds
Thread 1 waiting to be assigned a request
(39) Discarding duplicate request from client roocell-ap port 50043 - ID: 135 due to delayed response
Waking up in 0.6 seconds.
(39) Sending delayed response
(39) Sent Access-Reject Id 135 from 172.17.0.4:1812 to 192.168.1.30:50043 length 44
(39)   EAP-Message = 0x04eb0004
(39)   Message-Authenticator = 0x00000000000000000000000000000000
Waking up in 3.7 seconds.
Thread 5 got semaphore
Thread 5 handling request 40, (9 handled so far)
(40) <running>: Received Access-Request Id 136 from 192.168.1.30:50043 to 172.17.0.4:1812 length 190
(40) <running>:   User-Name = "emiruss"
(40) <running>:   NAS-IP-Address = 192.168.1.30
(40) <running>:   NAS-Identifier = "Ericsson"
(40) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(40) <running>:   NAS-Port-Type = Wireless-802.11
(40) <running>:   NAS-Port = 0
(40) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(40) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(40) <running>:   Acct-Session-Id = "003E2DE6-0000004F"
(40) <running>:   Framed-MTU = 1400
(40) <running>:   EAP-Message = 0x02ab000c01656d6972757373
(40) <running>:   Message-Authenticator = 0x41db44adc9d289a28e696c15d0eeda6a
(40) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(40) <running>:   authorize {
(40) <running>:     policy filter_username {
(40) <running>:       if (!&User-Name) {
(40) <running>:       if (!&User-Name)  -> FALSE
(40) <running>:       if (&User-Name =~ / /) {
(40) <running>:       if (&User-Name =~ / /)  -> FALSE
(40) <running>:       if (&User-Name =~ /@.*@/ ) {
(40) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(40) <running>:       if (&User-Name =~ /\.\./ ) {
(40) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(40) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(40) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(40) <running>:       if (&User-Name =~ /\.$/)  {
(40) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(40) <running>:       if (&User-Name =~ /@\./)  {
(40) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(40) <running>:     } # policy filter_username = notfound
(40)     [preprocess] = ok
(40)     [chap] = noop
(40)     [mschap] = noop
Waking up in 0.3 seconds.
(40)     [digest] = noop
(40) suffix: Checking for suffix after "@"
(40) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(40) suffix: No such realm "NULL"
(40)     [suffix] = noop
(40) eap: Peer sent EAP Response (code 2) ID 171 length 12
(40) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(40)     [eap] = ok
(40)   } # authorize = ok
(40) Found Auth-Type = EAP
(40) # Executing group from file /etc/freeradius/sites-enabled/default
(40)   authenticate {
(40) eap: Peer sent packet with method EAP Identity (1)
(40) eap: Calling submodule eap_md5 to process data
(40) eap_md5: Issuing MD5 Challenge
(40) eap: Sending EAP Request (code 1) ID 172 length 22
(40) eap: EAP session adding &reply:State = 0xd17c1a43d1d01e5d
(40)     [eap] = handled
(40)   } # authenticate = handled
(40) Using Post-Auth-Type Challenge
(40) Post-Auth-Type sub-section not found.  Ignoring.
(40) # Executing group from file /etc/freeradius/sites-enabled/default
(40) Sent Access-Challenge Id 136 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(40)   EAP-Message = 0x01ac00160410e2725fa93bf2bdaa689c8c885324bfd5
(40)   Message-Authenticator = 0x00000000000000000000000000000000
(40)   State = 0xd17c1a43d1d01e5da5f6b580ea2cb257
(40) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.3 seconds.
Thread 4 got semaphore
Thread 4 handling request 41, (9 handled so far)
(41) <running>: Received Access-Request Id 137 from 192.168.1.30:50043 to 172.17.0.4:1812 length 204
(41) <running>:   User-Name = "emiruss"
(41) <running>:   NAS-IP-Address = 192.168.1.30
(41) <running>:   NAS-Identifier = "Ericsson"
(41) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(41) <running>:   NAS-Port-Type = Wireless-802.11
(41) <running>:   NAS-Port = 0
(41) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(41) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(41) <running>:   Acct-Session-Id = "003E2DE6-0000004F"
(41) <running>:   Framed-MTU = 1400
(41) <running>:   EAP-Message = 0x02ac00080319152b
(41) <running>:   State = 0xd17c1a43d1d01e5da5f6b580ea2cb257
(41) <running>:   Message-Authenticator = 0xa215bb8b5ebd402f7975c20616ba74b5
(41) <running>: session-state: No cached attributes
(41) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(41) <running>:   authorize {
(41) <running>:     policy filter_username {
(41) <running>:       if (!&User-Name) {
(41) <running>:       if (!&User-Name)  -> FALSE
(41) <running>:       if (&User-Name =~ / /) {
(41) <running>:       if (&User-Name =~ / /)  -> FALSE
(41) <running>:       if (&User-Name =~ /@.*@/ ) {
(41) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(41) <running>:       if (&User-Name =~ /\.\./ ) {
(41) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(41) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(41) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(41) <running>:       if (&User-Name =~ /\.$/)  {
(41) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(41) <running>:       if (&User-Name =~ /@\./)  {
(41) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(41) <running>:     } # policy filter_username = notfound
(41)     [preprocess] = ok
(41)     [chap] = noop
(41)     [mschap] = noop
(41)     [digest] = noop
(41) suffix: Checking for suffix after "@"
(41) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(41) suffix: No such realm "NULL"
(41)     [suffix] = noop
(41) eap: Peer sent EAP Response (code 2) ID 172 length 8
(41) eap: No EAP Start, assuming it's an on-going EAP conversation
(41)     [eap] = updated
(41)     [files] = noop
(41) sql: EXPAND %{User-Name}
(41) sql:    --> emiruss
(41) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Reserved connection (10)
(41) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(41) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(41) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(41) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(41) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(41) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(41) sql: User not found in any groups
rlm_sql (sql): Released connection (10)
rlm_sql (sql): Need 1 more connections to reach 10 spares
rlm_sql (sql): Opening additional connection (11), 1 of 30 pending slots used
(41)     [sql] = notfound
(41)     [expiration] = noop
(41)     [logintime] = noop
(41) pap: WARNING: No "known good" password found for the user.  Not setting Auth-Type
(41) pap: WARNING: Authentication will fail unless a "known good" password is available
(41)     [pap] = noop
(41)   } # authorize = updated
(41) Found Auth-Type = EAP
(41) # Executing group from file /etc/freeradius/sites-enabled/default
(41)   authenticate {
(41) eap: Expiring EAP session with state 0xd17c1a43d1d01e5d
(41) eap: Finished EAP session with state 0xd17c1a43d1d01e5d
(41) eap: Previous EAP request found for state 0xd17c1a43d1d01e5d, released from the list
(41) eap: Peer sent packet with method EAP NAK (3)
(41) eap: Found mutually acceptable type PEAP (25)
(41) eap: Calling submodule eap_peap to process data
(41) eap_peap: Initiating new EAP-TLS session
(41) eap_peap: [eaptls start] = request
(41) eap: Sending EAP Request (code 1) ID 173 length 6
(41) eap: EAP session adding &reply:State = 0xd17c1a43d0d1035d
(41)     [eap] = handled
(41)   } # authenticate = handled
(41) Using Post-Auth-Type Challenge
(41) Post-Auth-Type sub-section not found.  Ignoring.
(41) # Executing group from file /etc/freeradius/sites-enabled/default
(41) Sent Access-Challenge Id 137 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(41)   EAP-Message = 0x01ad00061920
(41)   Message-Authenticator = 0x00000000000000000000000000000000
(41)   State = 0xd17c1a43d0d1035da5f6b580ea2cb257
(41) Finished request
Thread 4 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 3 got semaphore
Thread 3 handling request 42, (9 handled so far)
(42) <running>: Received Access-Request Id 138 from 192.168.1.30:50043 to 172.17.0.4:1812 length 339
(42) <running>:   User-Name = "emiruss"
(42) <running>:   NAS-IP-Address = 192.168.1.30
(42) <running>:   NAS-Identifier = "Ericsson"
(42) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(42) <running>:   NAS-Port-Type = Wireless-802.11
(42) <running>:   NAS-Port = 0
(42) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(42) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(42) <running>:   Acct-Session-Id = "003E2DE6-0000004F"
(42) <running>:   Framed-MTU = 1400
(42) <running>:   EAP-Message = 0x02ad008f19800000008516030100800100007c030156552ca00724efeb81ca013247d10827b85999e1fd991a77afafdea717e6e64700003400ffc02cc02bc024c023c00ac009c008c030c02fc028c027c014c013c012009d009c003d003c0035002f000ac007c011000500040100001f000a0008000600
(42) <running>:   State = 0xd17c1a43d0d1035da5f6b580ea2cb257
(42) <running>:   Message-Authenticator = 0xffd6098f4d42de0f89312fd65397363a
(42) <running>: session-state: No cached attributes
(42) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(42) <running>:   authorize {
(42) <running>:     policy filter_username {
(42) <running>:       if (!&User-Name) {
(42) <running>:       if (!&User-Name)  -> FALSE
(42) <running>:       if (&User-Name =~ / /) {
(42) <running>:       if (&User-Name =~ / /)  -> FALSE
(42) <running>:       if (&User-Name =~ /@.*@/ ) {
(42) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(42) <running>:       if (&User-Name =~ /\.\./ ) {
(42) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(42) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(42) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(42) <running>:       if (&User-Name =~ /\.$/)  {
(42) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(42) <running>:       if (&User-Name =~ /@\./)  {
(42) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(42) <running>:     } # policy filter_username = notfound
(42)     [preprocess] = ok
(42)     [chap] = noop
(42)     [mschap] = noop
(42)     [digest] = noop
(42) suffix: Checking for suffix after "@"
(42) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(42) suffix: No such realm "NULL"
(42)     [suffix] = noop
(42) eap: Peer sent EAP Response (code 2) ID 173 length 143
(42) eap: Continuing tunnel setup
(42)     [eap] = ok
(42)   } # authorize = ok
(42) Found Auth-Type = EAP
(42) # Executing group from file /etc/freeradius/sites-enabled/default
(42)   authenticate {
(42) eap: Expiring EAP session with state 0xd17c1a43d0d1035d
(42) eap: Finished EAP session with state 0xd17c1a43d0d1035d
(42) eap: Previous EAP request found for state 0xd17c1a43d0d1035d, released from the list
(42) eap: Peer sent packet with method EAP PEAP (25)
(42) eap: Calling submodule eap_peap to process data
(42) eap_peap: Continuing EAP-TLS
(42) eap_peap: Peer indicated complete TLS record size will be 133 bytes
(42) eap_peap: Got complete TLS record (133 bytes)
(42) eap_peap: [eaptls verify] = length included
(42) eap_peap: (other): before/accept initialization
(42) eap_peap: TLS_accept: before/accept initialization
(42) eap_peap: <<< TLS 1.0 Handshake [length 0080], ClientHello 
(42) eap_peap: TLS_accept: SSLv3 read client hello A
(42) eap_peap: >>> TLS 1.0 Handshake [length 0059], ServerHello 
(42) eap_peap: TLS_accept: SSLv3 write server hello A
(42) eap_peap: >>> TLS 1.0 Handshake [length 08d3], Certificate 
(42) eap_peap: TLS_accept: SSLv3 write certificate A
(42) eap_peap: >>> TLS 1.0 Handshake [length 014b], ServerKeyExchange 
(42) eap_peap: TLS_accept: SSLv3 write key exchange A
(42) eap_peap: >>> TLS 1.0 Handshake [length 0004], ServerHelloDone 
(42) eap_peap: TLS_accept: SSLv3 write server done A
(42) eap_peap: TLS_accept: SSLv3 flush data
(42) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(42) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(42) eap_peap: In SSL Handshake Phase
(42) eap_peap: In SSL Accept mode
(42) eap_peap: [eaptls process] = handled
(42) eap: Sending EAP Request (code 1) ID 174 length 1004
(42) eap: EAP session adding &reply:State = 0xd17c1a43d3d2035d
(42)     [eap] = handled
(42)   } # authenticate = handled
(42) Using Post-Auth-Type Challenge
(42) Post-Auth-Type sub-section not found.  Ignoring.
(42) # Executing group from file /etc/freeradius/sites-enabled/default
(42) Sent Access-Challenge Id 138 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(42)   EAP-Message = 0x01ae03ec19c000000a8f1603010059020000550301c252fde71e0c06f4c6d15b47ecdffca7badc9c3cf9bfa0f4f4831b3d3454860f20e2c117a2958a8157f591f6906db9f31f24eef27ed8ea1a201cfbbd6b1ba929ffc01400000dff01000100000b00040300010216030108d30b0008cf0008cc0003de
(42)   Message-Authenticator = 0x00000000000000000000000000000000
(42)   State = 0xd17c1a43d3d2035da5f6b580ea2cb257
(42) Finished request
Thread 3 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 2 got semaphore
Thread 2 handling request 43, (9 handled so far)
(43) <running>: Received Access-Request Id 139 from 192.168.1.30:50043 to 172.17.0.4:1812 length 202
(43) <running>:   User-Name = "emiruss"
(43) <running>:   NAS-IP-Address = 192.168.1.30
(43) <running>:   NAS-Identifier = "Ericsson"
(43) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(43) <running>:   NAS-Port-Type = Wireless-802.11
(43) <running>:   NAS-Port = 0
(43) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(43) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(43) <running>:   Acct-Session-Id = "003E2DE6-0000004F"
(43) <running>:   Framed-MTU = 1400
(43) <running>:   EAP-Message = 0x02ae00061900
(43) <running>:   State = 0xd17c1a43d3d2035da5f6b580ea2cb257
(43) <running>:   Message-Authenticator = 0x51d5be93f5d346da2c76f9e64136986b
(43) <running>: session-state: No cached attributes
(43) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(43) <running>:   authorize {
(43) <running>:     policy filter_username {
(43) <running>:       if (!&User-Name) {
(43) <running>:       if (!&User-Name)  -> FALSE
(43) <running>:       if (&User-Name =~ / /) {
(43) <running>:       if (&User-Name =~ / /)  -> FALSE
(43) <running>:       if (&User-Name =~ /@.*@/ ) {
(43) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(43) <running>:       if (&User-Name =~ /\.\./ ) {
(43) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(43) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(43) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(43) <running>:       if (&User-Name =~ /\.$/)  {
(43) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(43) <running>:       if (&User-Name =~ /@\./)  {
(43) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(43) <running>:     } # policy filter_username = notfound
(43)     [preprocess] = ok
(43)     [chap] = noop
(43)     [mschap] = noop
(43)     [digest] = noop
(43) suffix: Checking for suffix after "@"
(43) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(43) suffix: No such realm "NULL"
(43)     [suffix] = noop
(43) eap: Peer sent EAP Response (code 2) ID 174 length 6
(43) eap: Continuing tunnel setup
(43)     [eap] = ok
(43)   } # authorize = ok
(43) Found Auth-Type = EAP
(43) # Executing group from file /etc/freeradius/sites-enabled/default
(43)   authenticate {
(43) eap: Expiring EAP session with state 0xd17c1a43d3d2035d
(43) eap: Finished EAP session with state 0xd17c1a43d3d2035d
(43) eap: Previous EAP request found for state 0xd17c1a43d3d2035d, released from the list
(43) eap: Peer sent packet with method EAP PEAP (25)
(43) eap: Calling submodule eap_peap to process data
(43) eap_peap: Continuing EAP-TLS
(43) eap_peap: Peer ACKed our handshake fragment
(43) eap_peap: [eaptls verify] = request
(43) eap_peap: [eaptls process] = handled
(43) eap: Sending EAP Request (code 1) ID 175 length 1000
(43) eap: EAP session adding &reply:State = 0xd17c1a43d2d3035d
(43)     [eap] = handled
(43)   } # authenticate = handled
(43) Using Post-Auth-Type Challenge
(43) Post-Auth-Type sub-section not found.  Ignoring.
(43) # Executing group from file /etc/freeradius/sites-enabled/default
(43) Sent Access-Challenge Id 139 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(43)   EAP-Message = 0x01af03e819400dd0405955c762981948527048701681d313d3cc6629a5557b66df2aae22c8590ab99d66ec8d3792a72e30596410f5d1e81f5a774969a1ce9ad6bd01d42da65536016e80a905c662a71ef5c075b8bdf0127a0cf1bd4c91290e15edffa035febde0185096bdc1e553090004e8308204e430
(43)   Message-Authenticator = 0x00000000000000000000000000000000
(43)   State = 0xd17c1a43d2d3035da5f6b580ea2cb257
(43) Finished request
Thread 2 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 1 got semaphore
Thread 1 handling request 44, (9 handled so far)
(44) <running>: Received Access-Request Id 140 from 192.168.1.30:50043 to 172.17.0.4:1812 length 202
(44) <running>:   User-Name = "emiruss"
(44) <running>:   NAS-IP-Address = 192.168.1.30
(44) <running>:   NAS-Identifier = "Ericsson"
(44) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(44) <running>:   NAS-Port-Type = Wireless-802.11
(44) <running>:   NAS-Port = 0
(44) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(44) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(44) <running>:   Acct-Session-Id = "003E2DE6-0000004F"
(44) <running>:   Framed-MTU = 1400
(44) <running>:   EAP-Message = 0x02af00061900
(44) <running>:   State = 0xd17c1a43d2d3035da5f6b580ea2cb257
(44) <running>:   Message-Authenticator = 0x2cdebd500a5e166040702693cad47830
(44) <running>: session-state: No cached attributes
(44) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(44) <running>:   authorize {
(44) <running>:     policy filter_username {
(44) <running>:       if (!&User-Name) {
(44) <running>:       if (!&User-Name)  -> FALSE
(44) <running>:       if (&User-Name =~ / /) {
(44) <running>:       if (&User-Name =~ / /)  -> FALSE
(44) <running>:       if (&User-Name =~ /@.*@/ ) {
(44) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(44) <running>:       if (&User-Name =~ /\.\./ ) {
(44) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(44) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(44) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(44) <running>:       if (&User-Name =~ /\.$/)  {
(44) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(44) <running>:       if (&User-Name =~ /@\./)  {
(44) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(44) <running>:     } # policy filter_username = notfound
(44)     [preprocess] = ok
(44)     [chap] = noop
(44)     [mschap] = noop
(44)     [digest] = noop
(44) suffix: Checking for suffix after "@"
(44) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(44) suffix: No such realm "NULL"
(44)     [suffix] = noop
(44) eap: Peer sent EAP Response (code 2) ID 175 length 6
(44) eap: Continuing tunnel setup
(44)     [eap] = ok
(44)   } # authorize = ok
(44) Found Auth-Type = EAP
(44) # Executing group from file /etc/freeradius/sites-enabled/default
(44)   authenticate {
(44) eap: Expiring EAP session with state 0xd17c1a43d2d3035d
(44) eap: Finished EAP session with state 0xd17c1a43d2d3035d
(44) eap: Previous EAP request found for state 0xd17c1a43d2d3035d, released from the list
(44) eap: Peer sent packet with method EAP PEAP (25)
(44) eap: Calling submodule eap_peap to process data
(44) eap_peap: Continuing EAP-TLS
(44) eap_peap: Peer ACKed our handshake fragment
(44) eap_peap: [eaptls verify] = request
(44) eap_peap: [eaptls process] = handled
(44) eap: Sending EAP Request (code 1) ID 176 length 721
(44) eap: EAP session adding &reply:State = 0xd17c1a43d5cc035d
(44)     [eap] = handled
(44)   } # authenticate = handled
(44) Using Post-Auth-Type Challenge
(44) Post-Auth-Type sub-section not found.  Ignoring.
(44) # Executing group from file /etc/freeradius/sites-enabled/default
(44) Sent Access-Challenge Id 140 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(44)   EAP-Message = 0x01b002d1190020417574686f72697479820900c3fc536eef83d741300f0603551d130101ff040530030101ff30360603551d1f042f302d302ba029a0278625687474703a2f2f7777772e6578616d706c652e6f72672f6578616d706c655f63612e63726c300d06092a864886f70d01010b050003820101
(44)   Message-Authenticator = 0x00000000000000000000000000000000
(44)   State = 0xd17c1a43d5cc035da5f6b580ea2cb257
(44) Finished request
Thread 1 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 5 got semaphore
Thread 5 handling request 45, (10 handled so far)
(45) <running>: Received Access-Request Id 141 from 192.168.1.30:50043 to 172.17.0.4:1812 length 340
(45) <running>:   User-Name = "emiruss"
(45) <running>:   NAS-IP-Address = 192.168.1.30
(45) <running>:   NAS-Identifier = "Ericsson"
(45) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(45) <running>:   NAS-Port-Type = Wireless-802.11
(45) <running>:   NAS-Port = 0
(45) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(45) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(45) <running>:   Acct-Session-Id = "003E2DE6-0000004F"
(45) <running>:   Framed-MTU = 1400
(45) <running>:   EAP-Message = 0x02b0009019800000008616030100461000004241046516511bb388472e971cf0c49645e887771361bb810061f10a97c912d5b5125e42a6578714fc174950750a01d0f1ae840bfc7a1a9b57a79028e5a60255d0878714030100010116030100301ca261446bee2203f604fc2776ad178fb60af1019c5981
(45) <running>:   State = 0xd17c1a43d5cc035da5f6b580ea2cb257
(45) <running>:   Message-Authenticator = 0xbd1d1b749ff2ddcbdcbf8e5d226418f1
(45) <running>: session-state: No cached attributes
(45) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(45) <running>:   authorize {
(45) <running>:     policy filter_username {
(45) <running>:       if (!&User-Name) {
(45) <running>:       if (!&User-Name)  -> FALSE
(45) <running>:       if (&User-Name =~ / /) {
(45) <running>:       if (&User-Name =~ / /)  -> FALSE
(45) <running>:       if (&User-Name =~ /@.*@/ ) {
(45) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(45) <running>:       if (&User-Name =~ /\.\./ ) {
(45) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(45) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(45) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(45) <running>:       if (&User-Name =~ /\.$/)  {
(45) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(45) <running>:       if (&User-Name =~ /@\./)  {
(45) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(45) <running>:     } # policy filter_username = notfound
(45)     [preprocess] = ok
(45)     [chap] = noop
(45)     [mschap] = noop
(45)     [digest] = noop
(45) suffix: Checking for suffix after "@"
(45) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(45) suffix: No such realm "NULL"
(45)     [suffix] = noop
(45) eap: Peer sent EAP Response (code 2) ID 176 length 144
(45) eap: Continuing tunnel setup
(45)     [eap] = ok
(45)   } # authorize = ok
(45) Found Auth-Type = EAP
(45) # Executing group from file /etc/freeradius/sites-enabled/default
(45)   authenticate {
(45) eap: Expiring EAP session with state 0xd17c1a43d5cc035d
(45) eap: Finished EAP session with state 0xd17c1a43d5cc035d
(45) eap: Previous EAP request found for state 0xd17c1a43d5cc035d, released from the list
(45) eap: Peer sent packet with method EAP PEAP (25)
(45) eap: Calling submodule eap_peap to process data
(45) eap_peap: Continuing EAP-TLS
(45) eap_peap: Peer indicated complete TLS record size will be 134 bytes
(45) eap_peap: Got complete TLS record (134 bytes)
(45) eap_peap: [eaptls verify] = length included
(45) eap_peap: <<< TLS 1.0 Handshake [length 0046], ClientKeyExchange 
(45) eap_peap: TLS_accept: SSLv3 read client key exchange A
(45) eap_peap: <<< TLS 1.0 ChangeCipherSpec [length 0001] 
(45) eap_peap: <<< TLS 1.0 Handshake [length 0010], Finished 
(45) eap_peap: TLS_accept: SSLv3 read finished A
(45) eap_peap: >>> TLS 1.0 ChangeCipherSpec [length 0001] 
(45) eap_peap: TLS_accept: SSLv3 write change cipher spec A
(45) eap_peap: >>> TLS 1.0 Handshake [length 0010], Finished 
(45) eap_peap: TLS_accept: SSLv3 write finished A
(45) eap_peap: TLS_accept: SSLv3 flush data
(45) eap_peap: (other): SSL negotiation finished successfully
(45) eap_peap: SSL Connection Established
(45) eap_peap: [eaptls process] = handled
(45) eap: Sending EAP Request (code 1) ID 177 length 65
(45) eap: EAP session adding &reply:State = 0xd17c1a43d4cd035d
(45)     [eap] = handled
(45)   } # authenticate = handled
(45) Using Post-Auth-Type Challenge
(45) Post-Auth-Type sub-section not found.  Ignoring.
(45) # Executing group from file /etc/freeradius/sites-enabled/default
(45) Sent Access-Challenge Id 141 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(45)   EAP-Message = 0x01b1004119001403010001011603010030e58019b1d47f80dd43da4334e5186fee77b30bc79821234c00c7315228096220e441039e9cd8f94926b73e05b27c512b
(45)   Message-Authenticator = 0x00000000000000000000000000000000
(45)   State = 0xd17c1a43d4cd035da5f6b580ea2cb257
(45) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 4 got semaphore
Thread 4 handling request 46, (10 handled so far)
(46) <running>: Received Access-Request Id 142 from 192.168.1.30:50043 to 172.17.0.4:1812 length 202
(46) <running>:   User-Name = "emiruss"
(46) <running>:   NAS-IP-Address = 192.168.1.30
(46) <running>:   NAS-Identifier = "Ericsson"
(46) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(46) <running>:   NAS-Port-Type = Wireless-802.11
(46) <running>:   NAS-Port = 0
(46) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(46) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(46) <running>:   Acct-Session-Id = "003E2DE6-0000004F"
(46) <running>:   Framed-MTU = 1400
(46) <running>:   EAP-Message = 0x02b100061900
(46) <running>:   State = 0xd17c1a43d4cd035da5f6b580ea2cb257
(46) <running>:   Message-Authenticator = 0x6e4bb353d451c2ec4a67774372a04a1c
(46) <running>: session-state: No cached attributes
(46) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(46) <running>:   authorize {
(46) <running>:     policy filter_username {
(46) <running>:       if (!&User-Name) {
(46) <running>:       if (!&User-Name)  -> FALSE
(46) <running>:       if (&User-Name =~ / /) {
(46) <running>:       if (&User-Name =~ / /)  -> FALSE
(46) <running>:       if (&User-Name =~ /@.*@/ ) {
(46) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(46) <running>:       if (&User-Name =~ /\.\./ ) {
(46) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(46) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(46) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(46) <running>:       if (&User-Name =~ /\.$/)  {
(46) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(46) <running>:       if (&User-Name =~ /@\./)  {
(46) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(46) <running>:     } # policy filter_username = notfound
(46)     [preprocess] = ok
(46)     [chap] = noop
(46)     [mschap] = noop
(46)     [digest] = noop
(46) suffix: Checking for suffix after "@"
(46) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(46) suffix: No such realm "NULL"
(46)     [suffix] = noop
(46) eap: Peer sent EAP Response (code 2) ID 177 length 6
(46) eap: Continuing tunnel setup
(46)     [eap] = ok
(46)   } # authorize = ok
(46) Found Auth-Type = EAP
(46) # Executing group from file /etc/freeradius/sites-enabled/default
(46)   authenticate {
(46) eap: Expiring EAP session with state 0xd17c1a43d4cd035d
(46) eap: Finished EAP session with state 0xd17c1a43d4cd035d
(46) eap: Previous EAP request found for state 0xd17c1a43d4cd035d, released from the list
(46) eap: Peer sent packet with method EAP PEAP (25)
(46) eap: Calling submodule eap_peap to process data
(46) eap_peap: Continuing EAP-TLS
(46) eap_peap: Peer ACKed our handshake fragment.  handshake is finished
(46) eap_peap: [eaptls verify] = success
(46) eap_peap: [eaptls process] = success
(46) eap_peap: Session established.  Decoding tunneled attributes
(46) eap_peap: PEAP state TUNNEL ESTABLISHED
(46) eap: Sending EAP Request (code 1) ID 178 length 43
(46) eap: EAP session adding &reply:State = 0xd17c1a43d7ce035d
(46)     [eap] = handled
(46)   } # authenticate = handled
(46) Using Post-Auth-Type Challenge
(46) Post-Auth-Type sub-section not found.  Ignoring.
(46) # Executing group from file /etc/freeradius/sites-enabled/default
(46) Sent Access-Challenge Id 142 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(46)   EAP-Message = 0x01b2002b190017030100201ee9f48e5b096b8e462e81278fbe9cafc31156e9f6d347702af87230050c5a75
(46)   Message-Authenticator = 0x00000000000000000000000000000000
(46)   State = 0xd17c1a43d7ce035da5f6b580ea2cb257
(46) Finished request
Thread 4 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 3 got semaphore
Thread 3 handling request 47, (10 handled so far)
(47) <running>: Received Access-Request Id 143 from 192.168.1.30:50043 to 172.17.0.4:1812 length 239
(47) <running>:   User-Name = "emiruss"
(47) <running>:   NAS-IP-Address = 192.168.1.30
(47) <running>:   NAS-Identifier = "Ericsson"
(47) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(47) <running>:   NAS-Port-Type = Wireless-802.11
(47) <running>:   NAS-Port = 0
(47) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(47) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(47) <running>:   Acct-Session-Id = "003E2DE6-0000004F"
(47) <running>:   Framed-MTU = 1400
(47) <running>:   EAP-Message = 0x02b2002b19001703010020741832851fa92c09038c099d43a7be4207bde2005009c2315dd527df6dcb3d66
(47) <running>:   State = 0xd17c1a43d7ce035da5f6b580ea2cb257
(47) <running>:   Message-Authenticator = 0x168626f82e7452ec15f4b1846c01bc96
(47) <running>: session-state: No cached attributes
(47) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(47) <running>:   authorize {
(47) <running>:     policy filter_username {
(47) <running>:       if (!&User-Name) {
(47) <running>:       if (!&User-Name)  -> FALSE
(47) <running>:       if (&User-Name =~ / /) {
(47) <running>:       if (&User-Name =~ / /)  -> FALSE
(47) <running>:       if (&User-Name =~ /@.*@/ ) {
(47) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(47) <running>:       if (&User-Name =~ /\.\./ ) {
(47) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(47) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(47) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(47) <running>:       if (&User-Name =~ /\.$/)  {
(47) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(47) <running>:       if (&User-Name =~ /@\./)  {
(47) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(47) <running>:     } # policy filter_username = notfound
(47)     [preprocess] = ok
(47)     [chap] = noop
(47)     [mschap] = noop
(47)     [digest] = noop
(47) suffix: Checking for suffix after "@"
(47) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(47) suffix: No such realm "NULL"
(47)     [suffix] = noop
(47) eap: Peer sent EAP Response (code 2) ID 178 length 43
(47) eap: Continuing tunnel setup
(47)     [eap] = ok
(47)   } # authorize = ok
(47) Found Auth-Type = EAP
(47) # Executing group from file /etc/freeradius/sites-enabled/default
(47)   authenticate {
(47) eap: Expiring EAP session with state 0xd17c1a43d7ce035d
(47) eap: Finished EAP session with state 0xd17c1a43d7ce035d
(47) eap: Previous EAP request found for state 0xd17c1a43d7ce035d, released from the list
(47) eap: Peer sent packet with method EAP PEAP (25)
(47) eap: Calling submodule eap_peap to process data
(47) eap_peap: Continuing EAP-TLS
(47) eap_peap: [eaptls verify] = ok
(47) eap_peap: Done initial handshake
(47) eap_peap: [eaptls process] = ok
(47) eap_peap: Session established.  Decoding tunneled attributes
(47) eap_peap: PEAP state WAITING FOR INNER IDENTITY
(47) eap_peap: Identity - emiruss
(47) eap_peap: Got inner identity 'emiruss'
(47) eap_peap: Setting default EAP type for tunneled EAP session
(47) eap_peap: Got tunneled request
(47) eap_peap:   EAP-Message = 0x02b2000c01656d6972757373
(47) eap_peap: Setting User-Name to emiruss
(47) eap_peap: Sending tunneled request to inner-tunnel
(47) eap_peap:   EAP-Message = 0x02b2000c01656d6972757373
(47) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(47) eap_peap:   User-Name = "emiruss"
(47) Virtual server inner-tunnel received request
(47)   EAP-Message = 0x02b2000c01656d6972757373
(47)   FreeRADIUS-Proxied-To = 127.0.0.1
(47)   User-Name = "emiruss"
(47) server inner-tunnel {
(47)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(47)     authorize {
(47)       [chap] = noop
(47)       [mschap] = noop
(47) suffix: Checking for suffix after "@"
(47) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(47) suffix: No such realm "NULL"
(47)       [suffix] = noop
(47)       update control {
(47)         &Proxy-To-Realm := LOCAL
(47)       } # update control = noop
(47) eap: Peer sent EAP Response (code 2) ID 178 length 12
(47) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(47)       [eap] = ok
(47)     } # authorize = ok
(47)   Found Auth-Type = EAP
(47)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(47)     authenticate {
(47) eap: Peer sent packet with method EAP Identity (1)
(47) eap: Calling submodule eap_mschapv2 to process data
(47) eap_mschapv2: Issuing Challenge
(47) eap: Sending EAP Request (code 1) ID 179 length 43
(47) eap: EAP session adding &reply:State = 0xa389af3da33ab5ca
(47)       [eap] = handled
(47)     } # authenticate = handled
(47) } # server inner-tunnel
(47) Virtual server sending reply
(47)   EAP-Message = 0x01b3002b1a01b3002610c77bd4c77f4f2f45cc076216b8b39223667265657261646975732d332e302e3130
(47)   Message-Authenticator = 0x00000000000000000000000000000000
(47)   State = 0xa389af3da33ab5ca20eba501d565fae2
(47) eap_peap: Got tunneled reply code 11
(47) eap_peap:   EAP-Message = 0x01b3002b1a01b3002610c77bd4c77f4f2f45cc076216b8b39223667265657261646975732d332e302e3130
(47) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(47) eap_peap:   State = 0xa389af3da33ab5ca20eba501d565fae2
(47) eap_peap: Got tunneled Access-Challenge
(47) eap: Sending EAP Request (code 1) ID 179 length 75
(47) eap: EAP session adding &reply:State = 0xd17c1a43d6cf035d
(47)     [eap] = handled
(47)   } # authenticate = handled
(47) Using Post-Auth-Type Challenge
(47) Post-Auth-Type sub-section not found.  Ignoring.
(47) # Executing group from file /etc/freeradius/sites-enabled/default
(47) Sent Access-Challenge Id 143 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(47)   EAP-Message = 0x01b3004b19001703010040b078a7ec7bed892fffcbf8768c84af2c098185876e692819a289b66b50338be0fd906566d6266b778439f774b4fed8fd31785cd3c0c795fcf4bd69cfb5de88df
(47)   Message-Authenticator = 0x00000000000000000000000000000000
(47)   State = 0xd17c1a43d6cf035da5f6b580ea2cb257
(47) Finished request
Thread 3 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 2 got semaphore
Thread 2 handling request 48, (10 handled so far)
(48) <running>: Received Access-Request Id 144 from 192.168.1.30:50043 to 172.17.0.4:1812 length 303
(48) <running>:   User-Name = "emiruss"
(48) <running>:   NAS-IP-Address = 192.168.1.30
(48) <running>:   NAS-Identifier = "Ericsson"
(48) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(48) <running>:   NAS-Port-Type = Wireless-802.11
(48) <running>:   NAS-Port = 0
(48) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(48) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(48) <running>:   Acct-Session-Id = "003E2DE6-0000004F"
(48) <running>:   Framed-MTU = 1400
(48) <running>:   EAP-Message = 0x02b3006b190017030100602ad7ae77edcb1f470a471902de531f64c974bc74b2cbb7f1067757cfd33f9a48f94f2a9664d2495b13833daf725d5d43b38777c74a796d1a7be601333d8ba2f6942f07489a5a82d6ddb858ea477d813ca7f8e1b5867c21396f4ef6e627ced361
(48) <running>:   State = 0xd17c1a43d6cf035da5f6b580ea2cb257
(48) <running>:   Message-Authenticator = 0xe6947d19857683dde55e713b97e83a75
(48) <running>: session-state: No cached attributes
(48) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(48) <running>:   authorize {
(48) <running>:     policy filter_username {
(48) <running>:       if (!&User-Name) {
(48) <running>:       if (!&User-Name)  -> FALSE
(48) <running>:       if (&User-Name =~ / /) {
(48) <running>:       if (&User-Name =~ / /)  -> FALSE
(48) <running>:       if (&User-Name =~ /@.*@/ ) {
(48) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(48) <running>:       if (&User-Name =~ /\.\./ ) {
(48) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(48) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(48) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(48) <running>:       if (&User-Name =~ /\.$/)  {
(48) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(48) <running>:       if (&User-Name =~ /@\./)  {
(48) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(48) <running>:     } # policy filter_username = notfound
(48)     [preprocess] = ok
(48)     [chap] = noop
(48)     [mschap] = noop
(48)     [digest] = noop
(48) suffix: Checking for suffix after "@"
(48) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(48) suffix: No such realm "NULL"
(48)     [suffix] = noop
(48) eap: Peer sent EAP Response (code 2) ID 179 length 107
(48) eap: Continuing tunnel setup
(48)     [eap] = ok
(48)   } # authorize = ok
(48) Found Auth-Type = EAP
(48) # Executing group from file /etc/freeradius/sites-enabled/default
(48)   authenticate {
(48) eap: Expiring EAP session with state 0xa389af3da33ab5ca
(48) eap: Finished EAP session with state 0xd17c1a43d6cf035d
(48) eap: Previous EAP request found for state 0xd17c1a43d6cf035d, released from the list
(48) eap: Peer sent packet with method EAP PEAP (25)
(48) eap: Calling submodule eap_peap to process data
(48) eap_peap: Continuing EAP-TLS
(48) eap_peap: [eaptls verify] = ok
(48) eap_peap: Done initial handshake
(48) eap_peap: [eaptls process] = ok
(48) eap_peap: Session established.  Decoding tunneled attributes
(48) eap_peap: PEAP state phase2
(48) eap_peap: EAP method MSCHAPv2 (26)
(48) eap_peap: Got tunneled request
(48) eap_peap:   EAP-Message = 0x02b300421a02b3003d31a0f7370efc01e1395290faaea19ae3890000000000000000d019ee480b44d361723a4ece5f13bce05f6134e19ee04d8600656d6972757373
(48) eap_peap: Setting User-Name to emiruss
(48) eap_peap: Sending tunneled request to inner-tunnel
(48) eap_peap:   EAP-Message = 0x02b300421a02b3003d31a0f7370efc01e1395290faaea19ae3890000000000000000d019ee480b44d361723a4ece5f13bce05f6134e19ee04d8600656d6972757373
(48) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(48) eap_peap:   User-Name = "emiruss"
(48) eap_peap:   State = 0xa389af3da33ab5ca20eba501d565fae2
(48) Virtual server inner-tunnel received request
(48)   EAP-Message = 0x02b300421a02b3003d31a0f7370efc01e1395290faaea19ae3890000000000000000d019ee480b44d361723a4ece5f13bce05f6134e19ee04d8600656d6972757373
(48)   FreeRADIUS-Proxied-To = 127.0.0.1
(48)   User-Name = "emiruss"
(48)   State = 0xa389af3da33ab5ca20eba501d565fae2
(48) server inner-tunnel {
(48)   session-state: No cached attributes
(48)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(48)     authorize {
(48)       [chap] = noop
(48)       [mschap] = noop
(48) suffix: Checking for suffix after "@"
(48) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(48) suffix: No such realm "NULL"
(48)       [suffix] = noop
(48)       update control {
(48)         &Proxy-To-Realm := LOCAL
(48)       } # update control = noop
(48) eap: Peer sent EAP Response (code 2) ID 179 length 66
(48) eap: No EAP Start, assuming it's an on-going EAP conversation
(48)       [eap] = updated
(48)       [files] = noop
(48) sql: EXPAND %{User-Name}
(48) sql:    --> emiruss
(48) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Reserved connection (9)
(48) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(48) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(48) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(48) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(48) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(48) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(48) sql: User not found in any groups
rlm_sql (sql): Released connection (9)
(48)       [sql] = notfound
(48)       [expiration] = noop
(48)       [logintime] = noop
(48)       [pap] = noop
(48)     } # authorize = updated
(48)   Found Auth-Type = EAP
(48)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(48)     authenticate {
(48) eap: Expiring EAP session with state 0xa389af3da33ab5ca
(48) eap: Finished EAP session with state 0xa389af3da33ab5ca
(48) eap: Previous EAP request found for state 0xa389af3da33ab5ca, released from the list
(48) eap: Peer sent packet with method EAP MSCHAPv2 (26)
(48) eap: Calling submodule eap_mschapv2 to process data
(48) eap_mschapv2: # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(48) eap_mschapv2:   Auth-Type MS-CHAP {
(48) mschap: WARNING: No Cleartext-Password configured.  Cannot create NT-Password
(48) mschap: WARNING: No Cleartext-Password configured.  Cannot create LM-Password
(48) mschap: Creating challenge hash with username: emiruss
(48) mschap: Client is using MS-CHAPv2
(48) mschap: ERROR: FAILED: No NT/LM-Password.  Cannot perform authentication
(48) mschap: ERROR: MS-CHAP2-Response is incorrect
(48)     [mschap] = reject
(48)   } # Auth-Type MS-CHAP = reject
(48) eap: Sending EAP Failure (code 4) ID 179 length 4
(48) eap: Freeing handler
(48)       [eap] = reject
(48)     } # authenticate = reject
(48)   Failed to authenticate the user
(48)   Using Post-Auth-Type Reject
(48)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(48)     Post-Auth-Type REJECT {
(48) sql: EXPAND .query
(48) sql:    --> .query
(48) sql: Using query template 'query'
rlm_sql (sql): Reserved connection (10)
(48) sql: EXPAND %{User-Name}
(48) sql:    --> emiruss
(48) sql: SQL-User-Name set to 'emiruss'
(48) sql: EXPAND INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')
(48) sql:    --> INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:33:36')
(48) sql: Executing query: INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:33:36')
(48) sql: SQL query returned: success
(48) sql: 1 record(s) updated
rlm_sql (sql): Released connection (10)
(48)       [sql] = ok
(48) attr_filter.access_reject: EXPAND %{User-Name}
(48) attr_filter.access_reject:    --> emiruss
(48) attr_filter.access_reject: Matched entry DEFAULT at line 11
(48)       [attr_filter.access_reject] = updated
(48)       update outer.session-state {
(48)         &Module-Failure-Message := &request:Module-Failure-Message -> 'mschap: FAILED: No NT/LM-Password.  Cannot perform authentication'
(48)       } # update outer.session-state = noop
(48)     } # Post-Auth-Type REJECT = updated
(48) } # server inner-tunnel
(48) Virtual server sending reply
(48)   MS-CHAP-Error = "\263E=691 R=1 C=65f7c37760a7a0468171b39f0ab54a5f V=3 M=Authentication failed"
(48)   EAP-Message = 0x04b30004
(48)   Message-Authenticator = 0x00000000000000000000000000000000
(48) eap_peap: Got tunneled reply code 3
(48) eap_peap:   MS-CHAP-Error = "\263E=691 R=1 C=65f7c37760a7a0468171b39f0ab54a5f V=3 M=Authentication failed"
(48) eap_peap:   EAP-Message = 0x04b30004
(48) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(48) eap_peap: Tunneled authentication was rejected
(48) eap_peap: FAILURE
(48) eap: Sending EAP Request (code 1) ID 180 length 43
(48) eap: EAP session adding &reply:State = 0xd17c1a43d9c8035d
(48)     [eap] = handled
(48)   } # authenticate = handled
(48) Using Post-Auth-Type Challenge
(48) Post-Auth-Type sub-section not found.  Ignoring.
(48) # Executing group from file /etc/freeradius/sites-enabled/default
(48) session-state: Saving cached attributes
(48)   Module-Failure-Message := "mschap: FAILED: No NT/LM-Password.  Cannot perform authentication"
(48) Sent Access-Challenge Id 144 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(48)   EAP-Message = 0x01b4002b190017030100208d2b2ef567550b87434d9836957027cd353ac64d61f7fcf0f70d6880c5fce742
(48)   Message-Authenticator = 0x00000000000000000000000000000000
(48)   State = 0xd17c1a43d9c8035da5f6b580ea2cb257
(48) Finished request
Thread 2 waiting to be assigned a request
Thread 1 got semaphore
Thread 1 handling request 49, (10 handled so far)
(49) <running>: Received Access-Request Id 145 from 192.168.1.30:50043 to 172.17.0.4:1812 length 239
(49) <running>:   User-Name = "emiruss"
(49) <running>:   NAS-IP-Address = 192.168.1.30
(49) <running>:   NAS-Identifier = "Ericsson"
(49) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(49) <running>:   NAS-Port-Type = Wireless-802.11
(49) <running>:   NAS-Port = 0
(49) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(49) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(49) <running>:   Acct-Session-Id = "003E2DE6-0000004F"
(49) <running>:   Framed-MTU = 1400
(49) <running>:   EAP-Message = 0x02b4002b1900170301002053dbd8c3a6cddf49b892d393d9af28caef9c6c0972ec676b7bc226200da6a88e
(49) <running>:   State = 0xd17c1a43d9c8035da5f6b580ea2cb257
(49) <running>:   Message-Authenticator = 0x10c8f97ecd63cc84976db1063571bf95
(49) <running>: session-state: Found cached attributes
(49) <running>:   Module-Failure-Message := "mschap: FAILED: No NT/LM-Password.  Cannot perform authentication"
(49) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(49) <running>:   authorize {
(49) <running>:     policy filter_username {
(49) <running>:       if (!&User-Name) {
(49) <running>:       if (!&User-Name)  -> FALSE
(49) <running>:       if (&User-Name =~ / /) {
(49) <running>:       if (&User-Name =~ / /)  -> FALSE
(49) <running>:       if (&User-Name =~ /@.*@/ ) {
(49) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(49) <running>:       if (&User-Name =~ /\.\./ ) {
(49) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(49) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(49) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(49) <running>:       if (&User-Name =~ /\.$/)  {
(49) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(49) <running>:       if (&User-Name =~ /@\./)  {
(49) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(49) <running>:     } # policy filter_username = notfound
(49)     [preprocess] = ok
(49)     [chap] = noop
(49)     [mschap] = noop
(49)     [digest] = noop
(49) suffix: Checking for suffix after "@"
(49) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(49) suffix: No such realm "NULL"
(49)     [suffix] = noop
(49) eap: Peer sent EAP Response (code 2) ID 180 length 43
(49) eap: Continuing tunnel setup
(49)     [eap] = ok
(49)   } # authorize = ok
(49) Found Auth-Type = EAP
(49) # Executing group from file /etc/freeradius/sites-enabled/default
(49)   authenticate {
(49) eap: Expiring EAP session with state 0xd17c1a43d9c8035d
(49) eap: Finished EAP session with state 0xd17c1a43d9c8035d
(49) eap: Previous EAP request found for state 0xd17c1a43d9c8035d, released from the list
(49) eap: Peer sent packet with method EAP PEAP (25)
(49) eap: Calling submodule eap_peap to process data
(49) eap_peap: Continuing EAP-TLS
(49) eap_peap: [eaptls verify] = ok
(49) eap_peap: Done initial handshake
(49) eap_peap: [eaptls process] = ok
(49) eap_peap: Session established.  Decoding tunneled attributes
(49) eap_peap: PEAP state send tlv failure
(49) eap_peap: Received EAP-TLV response
(49) eap_peap:   The users session was previously rejected: returning reject (again.)
(49) eap_peap:   This means you need to read the PREVIOUS messages in the debug output
(49) eap_peap:   to find out the reason why the user was rejected
(49) eap_peap:   Look for "reject" or "fail".  Those earlier messages will tell you
(49) eap_peap:   what went wrong, and how to fix the problem
(49) eap: ERROR: Failed continuing EAP PEAP (25) session.  EAP sub-module failed
(49) eap: Sending EAP Failure (code 4) ID 180 length 4
(49) eap: Failed in EAP select
(49)     [eap] = invalid
(49)   } # authenticate = invalid
(49) Failed to authenticate the user
(49) Using Post-Auth-Type Reject
(49) # Executing group from file /etc/freeradius/sites-enabled/default
(49)   Post-Auth-Type REJECT {
(49) sql: EXPAND .query
(49) sql:    --> .query
(49) sql: Using query template 'query'
rlm_sql (sql): Reserved connection (11)
(49) sql: EXPAND %{User-Name}
(49) sql:    --> emiruss
(49) sql: SQL-User-Name set to 'emiruss'
(49) sql: EXPAND INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')
(49) sql:    --> INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:33:36')
(49) sql: Executing query: INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:33:36')
(49) sql: SQL query returned: success
(49) sql: 1 record(s) updated
rlm_sql (sql): Released connection (11)
(49)     [sql] = ok
(49) attr_filter.access_reject: EXPAND %{User-Name}
(49) attr_filter.access_reject:    --> emiruss
(49) attr_filter.access_reject: Matched entry DEFAULT at line 11
(49)     [attr_filter.access_reject] = updated
(49)     [eap] = noop
(49)     policy remove_reply_message_if_eap {
(49)       if (&reply:EAP-Message && &reply:Reply-Message) {
(49)       if (&reply:EAP-Message && &reply:Reply-Message)  -> FALSE
(49)       else {
(49)         [noop] = noop
(49)       } # else = noop
(49)     } # policy remove_reply_message_if_eap = noop
(49)   } # Post-Auth-Type REJECT = updated
(49) Delaying response for 1.000000 seconds
Thread 1 waiting to be assigned a request
Waking up in 0.6 seconds.
(49) Discarding duplicate request from client roocell-ap port 50043 - ID: 145 due to delayed response
Waking up in 0.1 seconds.
(49) Sending delayed response
(49) Sent Access-Reject Id 145 from 172.17.0.4:1812 to 192.168.1.30:50043 length 44
(49)   EAP-Message = 0x04b40004
(49)   Message-Authenticator = 0x00000000000000000000000000000000
Waking up in 1.8 seconds.
Thread 5 got semaphore
Thread 5 handling request 50, (11 handled so far)
(50) <running>: Received Access-Request Id 146 from 192.168.1.30:50043 to 172.17.0.4:1812 length 190
(50) <running>:   User-Name = "emiruss"
(50) <running>:   NAS-IP-Address = 192.168.1.30
(50) <running>:   NAS-Identifier = "Ericsson"
(50) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(50) <running>:   NAS-Port-Type = Wireless-802.11
(50) <running>:   NAS-Port = 0
(50) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(50) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(50) <running>:   Acct-Session-Id = "003E2DE6-00000050"
(50) <running>:   Framed-MTU = 1400
(50) <running>:   EAP-Message = 0x021b000c01656d6972757373
(50) <running>:   Message-Authenticator = 0x40ac18449b7329c9ba8436bd13d32558
(50) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(50) <running>:   authorize {
(50) <running>:     policy filter_username {
(50) <running>:       if (!&User-Name) {
(50) <running>:       if (!&User-Name)  -> FALSE
(50) <running>:       if (&User-Name =~ / /) {
(50) <running>:       if (&User-Name =~ / /)  -> FALSE
(50) <running>:       if (&User-Name =~ /@.*@/ ) {
(50) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(50) <running>:       if (&User-Name =~ /\.\./ ) {
(50) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(50) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(50) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(50) <running>:       if (&User-Name =~ /\.$/)  {
(50) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(50) <running>:       if (&User-Name =~ /@\./)  {
(50) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(50) <running>:     } # policy filter_username = notfound
(50)     [preprocess] = ok
(50)     [chap] = noop
(50)     [mschap] = noop
Waking up in 0.3 seconds.
(50)     [digest] = noop
(50) suffix: Checking for suffix after "@"
(50) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(50) suffix: No such realm "NULL"
(50)     [suffix] = noop
(50) eap: Peer sent EAP Response (code 2) ID 27 length 12
(50) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(50)     [eap] = ok
(50)   } # authorize = ok
(50) Found Auth-Type = EAP
(50) # Executing group from file /etc/freeradius/sites-enabled/default
(50)   authenticate {
(50) eap: Peer sent packet with method EAP Identity (1)
(50) eap: Calling submodule eap_md5 to process data
(50) eap_md5: Issuing MD5 Challenge
(50) eap: Sending EAP Request (code 1) ID 28 length 22
(50) eap: EAP session adding &reply:State = 0xa892117ca88e156a
(50)     [eap] = handled
(50)   } # authenticate = handled
(50) Using Post-Auth-Type Challenge
(50) Post-Auth-Type sub-section not found.  Ignoring.
(50) # Executing group from file /etc/freeradius/sites-enabled/default
(50) Sent Access-Challenge Id 146 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(50)   EAP-Message = 0x011c001604106f75836640f91b2dacb8f050fa677e93
(50)   Message-Authenticator = 0x00000000000000000000000000000000
(50)   State = 0xa892117ca88e156a0c39a8311fef873f
(50) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.3 seconds.
Thread 4 got semaphore
Thread 4 handling request 51, (11 handled so far)
(51) <running>: Received Access-Request Id 147 from 192.168.1.30:50043 to 172.17.0.4:1812 length 204
(51) <running>:   User-Name = "emiruss"
(51) <running>:   NAS-IP-Address = 192.168.1.30
(51) <running>:   NAS-Identifier = "Ericsson"
(51) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(51) <running>:   NAS-Port-Type = Wireless-802.11
(51) <running>:   NAS-Port = 0
(51) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(51) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(51) <running>:   Acct-Session-Id = "003E2DE6-00000050"
(51) <running>:   Framed-MTU = 1400
(51) <running>:   EAP-Message = 0x021c00080319152b
(51) <running>:   State = 0xa892117ca88e156a0c39a8311fef873f
(51) <running>:   Message-Authenticator = 0xd39fb600c488cd7ce1357f3b949a1f5f
(51) <running>: session-state: No cached attributes
(51) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(51) <running>:   authorize {
(51) <running>:     policy filter_username {
(51) <running>:       if (!&User-Name) {
(51) <running>:       if (!&User-Name)  -> FALSE
(51) <running>:       if (&User-Name =~ / /) {
(51) <running>:       if (&User-Name =~ / /)  -> FALSE
(51) <running>:       if (&User-Name =~ /@.*@/ ) {
(51) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(51) <running>:       if (&User-Name =~ /\.\./ ) {
(51) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(51) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(51) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(51) <running>:       if (&User-Name =~ /\.$/)  {
(51) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(51) <running>:       if (&User-Name =~ /@\./)  {
(51) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(51) <running>:     } # policy filter_username = notfound
(51)     [preprocess] = ok
(51)     [chap] = noop
(51)     [mschap] = noop
(51)     [digest] = noop
(51) suffix: Checking for suffix after "@"
(51) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(51) suffix: No such realm "NULL"
(51)     [suffix] = noop
(51) eap: Peer sent EAP Response (code 2) ID 28 length 8
(51) eap: No EAP Start, assuming it's an on-going EAP conversation
(51)     [eap] = updated
(51)     [files] = noop
(51) sql: EXPAND %{User-Name}
(51) sql:    --> emiruss
(51) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Reserved connection (9)
(51) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(51) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(51) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(51) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(51) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(51) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(51) sql: User not found in any groups
rlm_sql (sql): Released connection (9)
(51)     [sql] = notfound
(51)     [expiration] = noop
(51)     [logintime] = noop
(51) pap: WARNING: No "known good" password found for the user.  Not setting Auth-Type
(51) pap: WARNING: Authentication will fail unless a "known good" password is available
(51)     [pap] = noop
(51)   } # authorize = updated
(51) Found Auth-Type = EAP
(51) # Executing group from file /etc/freeradius/sites-enabled/default
(51)   authenticate {
(51) eap: Expiring EAP session with state 0xa892117ca88e156a
(51) eap: Finished EAP session with state 0xa892117ca88e156a
(51) eap: Previous EAP request found for state 0xa892117ca88e156a, released from the list
(51) eap: Peer sent packet with method EAP NAK (3)
(51) eap: Found mutually acceptable type PEAP (25)
(51) eap: Calling submodule eap_peap to process data
(51) eap_peap: Initiating new EAP-TLS session
(51) eap_peap: [eaptls start] = request
(51) eap: Sending EAP Request (code 1) ID 29 length 6
(51) eap: EAP session adding &reply:State = 0xa892117ca98f086a
(51)     [eap] = handled
(51)   } # authenticate = handled
(51) Using Post-Auth-Type Challenge
(51) Post-Auth-Type sub-section not found.  Ignoring.
(51) # Executing group from file /etc/freeradius/sites-enabled/default
(51) Sent Access-Challenge Id 147 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(51)   EAP-Message = 0x011d00061920
(51)   Message-Authenticator = 0x00000000000000000000000000000000
(51)   State = 0xa892117ca98f086a0c39a8311fef873f
(51) Finished request
Thread 4 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 3 got semaphore
Thread 3 handling request 52, (11 handled so far)
(52) <running>: Received Access-Request Id 148 from 192.168.1.30:50043 to 172.17.0.4:1812 length 339
(52) <running>:   User-Name = "emiruss"
(52) <running>:   NAS-IP-Address = 192.168.1.30
(52) <running>:   NAS-Identifier = "Ericsson"
(52) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(52) <running>:   NAS-Port-Type = Wireless-802.11
(52) <running>:   NAS-Port = 0
(52) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(52) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(52) <running>:   Acct-Session-Id = "003E2DE6-00000050"
(52) <running>:   Framed-MTU = 1400
(52) <running>:   EAP-Message = 0x021d008f19800000008516030100800100007c030156552ca487f0d80d5184ccbe91dac6c8f53cec776c9b6e2b9f7b6b817a4fb8ed00003400ffc02cc02bc024c023c00ac009c008c030c02fc028c027c014c013c012009d009c003d003c0035002f000ac007c011000500040100001f000a0008000600
(52) <running>:   State = 0xa892117ca98f086a0c39a8311fef873f
(52) <running>:   Message-Authenticator = 0xc960b0af9832793edf053b7f0ba8c3a1
(52) <running>: session-state: No cached attributes
(52) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(52) <running>:   authorize {
(52) <running>:     policy filter_username {
(52) <running>:       if (!&User-Name) {
(52) <running>:       if (!&User-Name)  -> FALSE
(52) <running>:       if (&User-Name =~ / /) {
(52) <running>:       if (&User-Name =~ / /)  -> FALSE
(52) <running>:       if (&User-Name =~ /@.*@/ ) {
(52) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(52) <running>:       if (&User-Name =~ /\.\./ ) {
(52) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(52) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(52) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(52) <running>:       if (&User-Name =~ /\.$/)  {
(52) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(52) <running>:       if (&User-Name =~ /@\./)  {
(52) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(52) <running>:     } # policy filter_username = notfound
(52)     [preprocess] = ok
(52)     [chap] = noop
(52)     [mschap] = noop
(52)     [digest] = noop
(52) suffix: Checking for suffix after "@"
(52) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(52) suffix: No such realm "NULL"
(52)     [suffix] = noop
(52) eap: Peer sent EAP Response (code 2) ID 29 length 143
(52) eap: Continuing tunnel setup
(52)     [eap] = ok
(52)   } # authorize = ok
(52) Found Auth-Type = EAP
(52) # Executing group from file /etc/freeradius/sites-enabled/default
(52)   authenticate {
(52) eap: Expiring EAP session with state 0xa892117ca98f086a
(52) eap: Finished EAP session with state 0xa892117ca98f086a
(52) eap: Previous EAP request found for state 0xa892117ca98f086a, released from the list
(52) eap: Peer sent packet with method EAP PEAP (25)
(52) eap: Calling submodule eap_peap to process data
(52) eap_peap: Continuing EAP-TLS
(52) eap_peap: Peer indicated complete TLS record size will be 133 bytes
(52) eap_peap: Got complete TLS record (133 bytes)
(52) eap_peap: [eaptls verify] = length included
(52) eap_peap: (other): before/accept initialization
(52) eap_peap: TLS_accept: before/accept initialization
(52) eap_peap: <<< TLS 1.0 Handshake [length 0080], ClientHello 
(52) eap_peap: TLS_accept: SSLv3 read client hello A
(52) eap_peap: >>> TLS 1.0 Handshake [length 0059], ServerHello 
(52) eap_peap: TLS_accept: SSLv3 write server hello A
(52) eap_peap: >>> TLS 1.0 Handshake [length 08d3], Certificate 
(52) eap_peap: TLS_accept: SSLv3 write certificate A
(52) eap_peap: >>> TLS 1.0 Handshake [length 014b], ServerKeyExchange 
(52) eap_peap: TLS_accept: SSLv3 write key exchange A
(52) eap_peap: >>> TLS 1.0 Handshake [length 0004], ServerHelloDone 
(52) eap_peap: TLS_accept: SSLv3 write server done A
(52) eap_peap: TLS_accept: SSLv3 flush data
(52) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(52) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(52) eap_peap: In SSL Handshake Phase
(52) eap_peap: In SSL Accept mode
(52) eap_peap: [eaptls process] = handled
(52) eap: Sending EAP Request (code 1) ID 30 length 1004
(52) eap: EAP session adding &reply:State = 0xa892117caa8c086a
(52)     [eap] = handled
(52)   } # authenticate = handled
(52) Using Post-Auth-Type Challenge
(52) Post-Auth-Type sub-section not found.  Ignoring.
(52) # Executing group from file /etc/freeradius/sites-enabled/default
(52) Sent Access-Challenge Id 148 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(52)   EAP-Message = 0x011e03ec19c000000a8f16030100590200005503011d6423836e0b04d2982c4c8dbc5be3e5c17bcc0713322aa91a41c47a18486d4b2064f8768dad8bbef9ff8eb3678881748dafc1e1aa8626f8cded7e92f10c238c35c01400000dff01000100000b00040300010216030108d30b0008cf0008cc0003de
(52)   Message-Authenticator = 0x00000000000000000000000000000000
(52)   State = 0xa892117caa8c086a0c39a8311fef873f
(52) Finished request
Thread 3 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 2 got semaphore
Thread 2 handling request 53, (11 handled so far)
(53) <running>: Received Access-Request Id 149 from 192.168.1.30:50043 to 172.17.0.4:1812 length 202
(53) <running>:   User-Name = "emiruss"
(53) <running>:   NAS-IP-Address = 192.168.1.30
(53) <running>:   NAS-Identifier = "Ericsson"
(53) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(53) <running>:   NAS-Port-Type = Wireless-802.11
(53) <running>:   NAS-Port = 0
(53) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(53) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(53) <running>:   Acct-Session-Id = "003E2DE6-00000050"
(53) <running>:   Framed-MTU = 1400
(53) <running>:   EAP-Message = 0x021e00061900
(53) <running>:   State = 0xa892117caa8c086a0c39a8311fef873f
(53) <running>:   Message-Authenticator = 0x3d6c7a944717ed2c16d94773875ac85e
(53) <running>: session-state: No cached attributes
(53) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(53) <running>:   authorize {
(53) <running>:     policy filter_username {
(53) <running>:       if (!&User-Name) {
(53) <running>:       if (!&User-Name)  -> FALSE
(53) <running>:       if (&User-Name =~ / /) {
(53) <running>:       if (&User-Name =~ / /)  -> FALSE
(53) <running>:       if (&User-Name =~ /@.*@/ ) {
(53) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(53) <running>:       if (&User-Name =~ /\.\./ ) {
(53) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(53) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(53) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(53) <running>:       if (&User-Name =~ /\.$/)  {
(53) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(53) <running>:       if (&User-Name =~ /@\./)  {
(53) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(53) <running>:     } # policy filter_username = notfound
(53)     [preprocess] = ok
(53)     [chap] = noop
(53)     [mschap] = noop
(53)     [digest] = noop
(53) suffix: Checking for suffix after "@"
(53) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(53) suffix: No such realm "NULL"
(53)     [suffix] = noop
(53) eap: Peer sent EAP Response (code 2) ID 30 length 6
(53) eap: Continuing tunnel setup
(53)     [eap] = ok
(53)   } # authorize = ok
(53) Found Auth-Type = EAP
(53) # Executing group from file /etc/freeradius/sites-enabled/default
(53)   authenticate {
(53) eap: Expiring EAP session with state 0xa892117caa8c086a
(53) eap: Finished EAP session with state 0xa892117caa8c086a
(53) eap: Previous EAP request found for state 0xa892117caa8c086a, released from the list
(53) eap: Peer sent packet with method EAP PEAP (25)
(53) eap: Calling submodule eap_peap to process data
(53) eap_peap: Continuing EAP-TLS
(53) eap_peap: Peer ACKed our handshake fragment
(53) eap_peap: [eaptls verify] = request
(53) eap_peap: [eaptls process] = handled
(53) eap: Sending EAP Request (code 1) ID 31 length 1000
(53) eap: EAP session adding &reply:State = 0xa892117cab8d086a
(53)     [eap] = handled
(53)   } # authenticate = handled
(53) Using Post-Auth-Type Challenge
(53) Post-Auth-Type sub-section not found.  Ignoring.
(53) # Executing group from file /etc/freeradius/sites-enabled/default
(53) Sent Access-Challenge Id 149 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(53)   EAP-Message = 0x011f03e819400dd0405955c762981948527048701681d313d3cc6629a5557b66df2aae22c8590ab99d66ec8d3792a72e30596410f5d1e81f5a774969a1ce9ad6bd01d42da65536016e80a905c662a71ef5c075b8bdf0127a0cf1bd4c91290e15edffa035febde0185096bdc1e553090004e8308204e430
(53)   Message-Authenticator = 0x00000000000000000000000000000000
(53)   State = 0xa892117cab8d086a0c39a8311fef873f
(53) Finished request
Thread 2 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 1 got semaphore
Thread 1 handling request 54, (11 handled so far)
(54) <running>: Received Access-Request Id 150 from 192.168.1.30:50043 to 172.17.0.4:1812 length 202
(54) <running>:   User-Name = "emiruss"
(54) <running>:   NAS-IP-Address = 192.168.1.30
(54) <running>:   NAS-Identifier = "Ericsson"
(54) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(54) <running>:   NAS-Port-Type = Wireless-802.11
(54) <running>:   NAS-Port = 0
(54) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(54) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(54) <running>:   Acct-Session-Id = "003E2DE6-00000050"
(54) <running>:   Framed-MTU = 1400
(54) <running>:   EAP-Message = 0x021f00061900
(54) <running>:   State = 0xa892117cab8d086a0c39a8311fef873f
(54) <running>:   Message-Authenticator = 0x8fd7acfdd0ab98fe9c1e55b69b494193
(54) <running>: session-state: No cached attributes
(54) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(54) <running>:   authorize {
(54) <running>:     policy filter_username {
(54) <running>:       if (!&User-Name) {
(54) <running>:       if (!&User-Name)  -> FALSE
(54) <running>:       if (&User-Name =~ / /) {
(54) <running>:       if (&User-Name =~ / /)  -> FALSE
(54) <running>:       if (&User-Name =~ /@.*@/ ) {
(54) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(54) <running>:       if (&User-Name =~ /\.\./ ) {
(54) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(54) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(54) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(54) <running>:       if (&User-Name =~ /\.$/)  {
(54) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(54) <running>:       if (&User-Name =~ /@\./)  {
(54) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(54) <running>:     } # policy filter_username = notfound
(54)     [preprocess] = ok
(54)     [chap] = noop
(54)     [mschap] = noop
(54)     [digest] = noop
(54) suffix: Checking for suffix after "@"
(54) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(54) suffix: No such realm "NULL"
(54)     [suffix] = noop
(54) eap: Peer sent EAP Response (code 2) ID 31 length 6
(54) eap: Continuing tunnel setup
(54)     [eap] = ok
(54)   } # authorize = ok
(54) Found Auth-Type = EAP
(54) # Executing group from file /etc/freeradius/sites-enabled/default
(54)   authenticate {
(54) eap: Expiring EAP session with state 0xa892117cab8d086a
(54) eap: Finished EAP session with state 0xa892117cab8d086a
(54) eap: Previous EAP request found for state 0xa892117cab8d086a, released from the list
(54) eap: Peer sent packet with method EAP PEAP (25)
(54) eap: Calling submodule eap_peap to process data
(54) eap_peap: Continuing EAP-TLS
(54) eap_peap: Peer ACKed our handshake fragment
(54) eap_peap: [eaptls verify] = request
(54) eap_peap: [eaptls process] = handled
(54) eap: Sending EAP Request (code 1) ID 32 length 721
(54) eap: EAP session adding &reply:State = 0xa892117cacb2086a
(54)     [eap] = handled
(54)   } # authenticate = handled
(54) Using Post-Auth-Type Challenge
(54) Post-Auth-Type sub-section not found.  Ignoring.
(54) # Executing group from file /etc/freeradius/sites-enabled/default
(54) Sent Access-Challenge Id 150 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(54)   EAP-Message = 0x012002d1190020417574686f72697479820900c3fc536eef83d741300f0603551d130101ff040530030101ff30360603551d1f042f302d302ba029a0278625687474703a2f2f7777772e6578616d706c652e6f72672f6578616d706c655f63612e63726c300d06092a864886f70d01010b050003820101
(54)   Message-Authenticator = 0x00000000000000000000000000000000
(54)   State = 0xa892117cacb2086a0c39a8311fef873f
(54) Finished request
Thread 1 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 5 got semaphore
Thread 5 handling request 55, (12 handled so far)
(55) <running>: Received Access-Request Id 151 from 192.168.1.30:50043 to 172.17.0.4:1812 length 340
(55) <running>:   User-Name = "emiruss"
(55) <running>:   NAS-IP-Address = 192.168.1.30
(55) <running>:   NAS-Identifier = "Ericsson"
(55) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(55) <running>:   NAS-Port-Type = Wireless-802.11
(55) <running>:   NAS-Port = 0
(55) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(55) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(55) <running>:   Acct-Session-Id = "003E2DE6-00000050"
(55) <running>:   Framed-MTU = 1400
(55) <running>:   EAP-Message = 0x022000901980000000861603010046100000424104e5d3049658f6f16da632a0e91d3a4f232b51772feac1b2d85942e55572d68c2b0a3c6375a100be8cdebc685eef615026521ad57682fbc944ec99e20ac80dfd6a140301000101160301003034ead534728fd5e06907777e8a02545cc707644a95312e
(55) <running>:   State = 0xa892117cacb2086a0c39a8311fef873f
(55) <running>:   Message-Authenticator = 0x7505bd3ab3b4c730b61a329015266b2f
(55) <running>: session-state: No cached attributes
(55) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(55) <running>:   authorize {
(55) <running>:     policy filter_username {
(55) <running>:       if (!&User-Name) {
(55) <running>:       if (!&User-Name)  -> FALSE
(55) <running>:       if (&User-Name =~ / /) {
(55) <running>:       if (&User-Name =~ / /)  -> FALSE
(55) <running>:       if (&User-Name =~ /@.*@/ ) {
(55) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(55) <running>:       if (&User-Name =~ /\.\./ ) {
(55) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(55) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(55) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(55) <running>:       if (&User-Name =~ /\.$/)  {
(55) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(55) <running>:       if (&User-Name =~ /@\./)  {
(55) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(55) <running>:     } # policy filter_username = notfound
(55)     [preprocess] = ok
(55)     [chap] = noop
(55)     [mschap] = noop
(55)     [digest] = noop
(55) suffix: Checking for suffix after "@"
(55) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(55) suffix: No such realm "NULL"
(55)     [suffix] = noop
(55) eap: Peer sent EAP Response (code 2) ID 32 length 144
(55) eap: Continuing tunnel setup
(55)     [eap] = ok
(55)   } # authorize = ok
(55) Found Auth-Type = EAP
(55) # Executing group from file /etc/freeradius/sites-enabled/default
(55)   authenticate {
(55) eap: Expiring EAP session with state 0xa892117cacb2086a
(55) eap: Finished EAP session with state 0xa892117cacb2086a
(55) eap: Previous EAP request found for state 0xa892117cacb2086a, released from the list
(55) eap: Peer sent packet with method EAP PEAP (25)
(55) eap: Calling submodule eap_peap to process data
(55) eap_peap: Continuing EAP-TLS
(55) eap_peap: Peer indicated complete TLS record size will be 134 bytes
(55) eap_peap: Got complete TLS record (134 bytes)
(55) eap_peap: [eaptls verify] = length included
(55) eap_peap: <<< TLS 1.0 Handshake [length 0046], ClientKeyExchange 
(55) eap_peap: TLS_accept: SSLv3 read client key exchange A
(55) eap_peap: <<< TLS 1.0 ChangeCipherSpec [length 0001] 
(55) eap_peap: <<< TLS 1.0 Handshake [length 0010], Finished 
(55) eap_peap: TLS_accept: SSLv3 read finished A
(55) eap_peap: >>> TLS 1.0 ChangeCipherSpec [length 0001] 
(55) eap_peap: TLS_accept: SSLv3 write change cipher spec A
(55) eap_peap: >>> TLS 1.0 Handshake [length 0010], Finished 
(55) eap_peap: TLS_accept: SSLv3 write finished A
(55) eap_peap: TLS_accept: SSLv3 flush data
(55) eap_peap: (other): SSL negotiation finished successfully
(55) eap_peap: SSL Connection Established
(55) eap_peap: [eaptls process] = handled
(55) eap: Sending EAP Request (code 1) ID 33 length 65
(55) eap: EAP session adding &reply:State = 0xa892117cadb3086a
(55)     [eap] = handled
(55)   } # authenticate = handled
(55) Using Post-Auth-Type Challenge
(55) Post-Auth-Type sub-section not found.  Ignoring.
(55) # Executing group from file /etc/freeradius/sites-enabled/default
(55) Sent Access-Challenge Id 151 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(55)   EAP-Message = 0x01210041190014030100010116030100309b1c477ae7c676c8b2f0ff23e7dadc01cc3e748b39d40a31f8aaf9d61bd891929d092d2846d8ddc544a2889e7ff8b8f6
(55)   Message-Authenticator = 0x00000000000000000000000000000000
(55)   State = 0xa892117cadb3086a0c39a8311fef873f
(55) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 4 got semaphore
Thread 4 handling request 56, (12 handled so far)
(56) <running>: Received Access-Request Id 152 from 192.168.1.30:50043 to 172.17.0.4:1812 length 202
(56) <running>:   User-Name = "emiruss"
(56) <running>:   NAS-IP-Address = 192.168.1.30
(56) <running>:   NAS-Identifier = "Ericsson"
(56) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(56) <running>:   NAS-Port-Type = Wireless-802.11
(56) <running>:   NAS-Port = 0
(56) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(56) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(56) <running>:   Acct-Session-Id = "003E2DE6-00000050"
(56) <running>:   Framed-MTU = 1400
(56) <running>:   EAP-Message = 0x022100061900
(56) <running>:   State = 0xa892117cadb3086a0c39a8311fef873f
(56) <running>:   Message-Authenticator = 0x1c23d21c20241f5cf2973037c155dd1b
(56) <running>: session-state: No cached attributes
(56) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(56) <running>:   authorize {
(56) <running>:     policy filter_username {
(56) <running>:       if (!&User-Name) {
(56) <running>:       if (!&User-Name)  -> FALSE
(56) <running>:       if (&User-Name =~ / /) {
(56) <running>:       if (&User-Name =~ / /)  -> FALSE
(56) <running>:       if (&User-Name =~ /@.*@/ ) {
(56) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(56) <running>:       if (&User-Name =~ /\.\./ ) {
(56) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(56) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(56) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(56) <running>:       if (&User-Name =~ /\.$/)  {
(56) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(56) <running>:       if (&User-Name =~ /@\./)  {
(56) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(56) <running>:     } # policy filter_username = notfound
(56)     [preprocess] = ok
(56)     [chap] = noop
(56)     [mschap] = noop
(56)     [digest] = noop
(56) suffix: Checking for suffix after "@"
(56) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(56) suffix: No such realm "NULL"
(56)     [suffix] = noop
(56) eap: Peer sent EAP Response (code 2) ID 33 length 6
(56) eap: Continuing tunnel setup
(56)     [eap] = ok
(56)   } # authorize = ok
(56) Found Auth-Type = EAP
(56) # Executing group from file /etc/freeradius/sites-enabled/default
(56)   authenticate {
(56) eap: Expiring EAP session with state 0xa892117cadb3086a
(56) eap: Finished EAP session with state 0xa892117cadb3086a
(56) eap: Previous EAP request found for state 0xa892117cadb3086a, released from the list
(56) eap: Peer sent packet with method EAP PEAP (25)
(56) eap: Calling submodule eap_peap to process data
(56) eap_peap: Continuing EAP-TLS
(56) eap_peap: Peer ACKed our handshake fragment.  handshake is finished
(56) eap_peap: [eaptls verify] = success
(56) eap_peap: [eaptls process] = success
(56) eap_peap: Session established.  Decoding tunneled attributes
(56) eap_peap: PEAP state TUNNEL ESTABLISHED
(56) eap: Sending EAP Request (code 1) ID 34 length 43
(56) eap: EAP session adding &reply:State = 0xa892117caeb0086a
(56)     [eap] = handled
(56)   } # authenticate = handled
(56) Using Post-Auth-Type Challenge
(56) Post-Auth-Type sub-section not found.  Ignoring.
(56) # Executing group from file /etc/freeradius/sites-enabled/default
(56) Sent Access-Challenge Id 152 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(56)   EAP-Message = 0x0122002b1900170301002077ce605b472a7e21b74def31a8b2e2905bc80b65449458171630b9ae4030c095
(56)   Message-Authenticator = 0x00000000000000000000000000000000
(56)   State = 0xa892117caeb0086a0c39a8311fef873f
(56) Finished request
Thread 4 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 3 got semaphore
Thread 3 handling request 57, (12 handled so far)
(57) <running>: Received Access-Request Id 153 from 192.168.1.30:50043 to 172.17.0.4:1812 length 239
(57) <running>:   User-Name = "emiruss"
(57) <running>:   NAS-IP-Address = 192.168.1.30
(57) <running>:   NAS-Identifier = "Ericsson"
(57) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(57) <running>:   NAS-Port-Type = Wireless-802.11
(57) <running>:   NAS-Port = 0
(57) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(57) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(57) <running>:   Acct-Session-Id = "003E2DE6-00000050"
(57) <running>:   Framed-MTU = 1400
(57) <running>:   EAP-Message = 0x0222002b190017030100206615848cded792eb5b43145b2d0023544ebe7f5386edfcea2655f0a15aaa2033
(57) <running>:   State = 0xa892117caeb0086a0c39a8311fef873f
(57) <running>:   Message-Authenticator = 0xaf1b44f4659f0cf7adfa035b2dcb288a
(57) <running>: session-state: No cached attributes
(57) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(57) <running>:   authorize {
(57) <running>:     policy filter_username {
(57) <running>:       if (!&User-Name) {
(57) <running>:       if (!&User-Name)  -> FALSE
(57) <running>:       if (&User-Name =~ / /) {
(57) <running>:       if (&User-Name =~ / /)  -> FALSE
(57) <running>:       if (&User-Name =~ /@.*@/ ) {
(57) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(57) <running>:       if (&User-Name =~ /\.\./ ) {
(57) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(57) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(57) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(57) <running>:       if (&User-Name =~ /\.$/)  {
(57) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(57) <running>:       if (&User-Name =~ /@\./)  {
(57) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(57) <running>:     } # policy filter_username = notfound
(57)     [preprocess] = ok
(57)     [chap] = noop
(57)     [mschap] = noop
(57)     [digest] = noop
(57) suffix: Checking for suffix after "@"
(57) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(57) suffix: No such realm "NULL"
(57)     [suffix] = noop
(57) eap: Peer sent EAP Response (code 2) ID 34 length 43
(57) eap: Continuing tunnel setup
(57)     [eap] = ok
(57)   } # authorize = ok
(57) Found Auth-Type = EAP
(57) # Executing group from file /etc/freeradius/sites-enabled/default
(57)   authenticate {
(57) eap: Expiring EAP session with state 0xa892117caeb0086a
(57) eap: Finished EAP session with state 0xa892117caeb0086a
(57) eap: Previous EAP request found for state 0xa892117caeb0086a, released from the list
(57) eap: Peer sent packet with method EAP PEAP (25)
(57) eap: Calling submodule eap_peap to process data
(57) eap_peap: Continuing EAP-TLS
(57) eap_peap: [eaptls verify] = ok
(57) eap_peap: Done initial handshake
(57) eap_peap: [eaptls process] = ok
(57) eap_peap: Session established.  Decoding tunneled attributes
(57) eap_peap: PEAP state WAITING FOR INNER IDENTITY
(57) eap_peap: Identity - emiruss
(57) eap_peap: Got inner identity 'emiruss'
(57) eap_peap: Setting default EAP type for tunneled EAP session
(57) eap_peap: Got tunneled request
(57) eap_peap:   EAP-Message = 0x0222000c01656d6972757373
(57) eap_peap: Setting User-Name to emiruss
(57) eap_peap: Sending tunneled request to inner-tunnel
(57) eap_peap:   EAP-Message = 0x0222000c01656d6972757373
(57) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(57) eap_peap:   User-Name = "emiruss"
(57) Virtual server inner-tunnel received request
(57)   EAP-Message = 0x0222000c01656d6972757373
(57)   FreeRADIUS-Proxied-To = 127.0.0.1
(57)   User-Name = "emiruss"
(57) server inner-tunnel {
(57)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(57)     authorize {
(57)       [chap] = noop
(57)       [mschap] = noop
(57) suffix: Checking for suffix after "@"
(57) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(57) suffix: No such realm "NULL"
(57)       [suffix] = noop
(57)       update control {
(57)         &Proxy-To-Realm := LOCAL
(57)       } # update control = noop
(57) eap: Peer sent EAP Response (code 2) ID 34 length 12
(57) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(57)       [eap] = ok
(57)     } # authorize = ok
(57)   Found Auth-Type = EAP
(57)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(57)     authenticate {
(57) eap: Peer sent packet with method EAP Identity (1)
(57) eap: Calling submodule eap_mschapv2 to process data
(57) eap_mschapv2: Issuing Challenge
(57) eap: Sending EAP Request (code 1) ID 35 length 43
(57) eap: EAP session adding &reply:State = 0x99e45cc499c746e2
(57)       [eap] = handled
(57)     } # authenticate = handled
(57) } # server inner-tunnel
(57) Virtual server sending reply
(57)   EAP-Message = 0x0123002b1a0123002610723e761ffca3bab1bd29e9e74237d764667265657261646975732d332e302e3130
(57)   Message-Authenticator = 0x00000000000000000000000000000000
(57)   State = 0x99e45cc499c746e288e4b222c3615245
(57) eap_peap: Got tunneled reply code 11
(57) eap_peap:   EAP-Message = 0x0123002b1a0123002610723e761ffca3bab1bd29e9e74237d764667265657261646975732d332e302e3130
(57) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(57) eap_peap:   State = 0x99e45cc499c746e288e4b222c3615245
(57) eap_peap: Got tunneled Access-Challenge
(57) eap: Sending EAP Request (code 1) ID 35 length 75
(57) eap: EAP session adding &reply:State = 0xa892117cafb1086a
(57)     [eap] = handled
(57)   } # authenticate = handled
(57) Using Post-Auth-Type Challenge
(57) Post-Auth-Type sub-section not found.  Ignoring.
(57) # Executing group from file /etc/freeradius/sites-enabled/default
(57) Sent Access-Challenge Id 153 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(57)   EAP-Message = 0x0123004b190017030100400e2d8c2440d1764eec784829ce4c8f715bf5c9fa8ae36b1959be995f9d13fb7cedd1f7ced8578898901bf16f256e77aef17e0cd1db1ce0ae1396cc9a7e8117ee
(57)   Message-Authenticator = 0x00000000000000000000000000000000
(57)   State = 0xa892117cafb1086a0c39a8311fef873f
(57) Finished request
Thread 3 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 2 got semaphore
Thread 2 handling request 58, (12 handled so far)
(58) <running>: Received Access-Request Id 154 from 192.168.1.30:50043 to 172.17.0.4:1812 length 303
(58) <running>:   User-Name = "emiruss"
(58) <running>:   NAS-IP-Address = 192.168.1.30
(58) <running>:   NAS-Identifier = "Ericsson"
(58) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(58) <running>:   NAS-Port-Type = Wireless-802.11
(58) <running>:   NAS-Port = 0
(58) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(58) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(58) <running>:   Acct-Session-Id = "003E2DE6-00000050"
(58) <running>:   Framed-MTU = 1400
(58) <running>:   EAP-Message = 0x0223006b190017030100601c30b50e139d64a1a27cb1f73e83020043baf48b000b470786168688d5cf2c9f00eb4c053f93bf43e5ff3e49d61f8cc3032b116268a6f800ae4d357b1b9902d8b0c6e23e98d784bb74d0ec3d74f6b430953a85a5de1c6ac6278e6f5f73ca016e
(58) <running>:   State = 0xa892117cafb1086a0c39a8311fef873f
(58) <running>:   Message-Authenticator = 0xa203ac40075c75905f3e90a447bc2e50
(58) <running>: session-state: No cached attributes
(58) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(58) <running>:   authorize {
(58) <running>:     policy filter_username {
(58) <running>:       if (!&User-Name) {
(58) <running>:       if (!&User-Name)  -> FALSE
(58) <running>:       if (&User-Name =~ / /) {
(58) <running>:       if (&User-Name =~ / /)  -> FALSE
(58) <running>:       if (&User-Name =~ /@.*@/ ) {
(58) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(58) <running>:       if (&User-Name =~ /\.\./ ) {
(58) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(58) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(58) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(58) <running>:       if (&User-Name =~ /\.$/)  {
(58) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(58) <running>:       if (&User-Name =~ /@\./)  {
(58) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(58) <running>:     } # policy filter_username = notfound
(58)     [preprocess] = ok
(58)     [chap] = noop
(58)     [mschap] = noop
(58)     [digest] = noop
(58) suffix: Checking for suffix after "@"
(58) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(58) suffix: No such realm "NULL"
(58)     [suffix] = noop
(58) eap: Peer sent EAP Response (code 2) ID 35 length 107
(58) eap: Continuing tunnel setup
(58)     [eap] = ok
(58)   } # authorize = ok
(58) Found Auth-Type = EAP
(58) # Executing group from file /etc/freeradius/sites-enabled/default
(58)   authenticate {
(58) eap: Expiring EAP session with state 0x99e45cc499c746e2
(58) eap: Finished EAP session with state 0xa892117cafb1086a
(58) eap: Previous EAP request found for state 0xa892117cafb1086a, released from the list
(58) eap: Peer sent packet with method EAP PEAP (25)
(58) eap: Calling submodule eap_peap to process data
(58) eap_peap: Continuing EAP-TLS
(58) eap_peap: [eaptls verify] = ok
(58) eap_peap: Done initial handshake
(58) eap_peap: [eaptls process] = ok
(58) eap_peap: Session established.  Decoding tunneled attributes
(58) eap_peap: PEAP state phase2
(58) eap_peap: EAP method MSCHAPv2 (26)
(58) eap_peap: Got tunneled request
(58) eap_peap:   EAP-Message = 0x022300421a0223003d31c34b11d95ab167ac40f0141c8828e0ca000000000000000020a00bbe4c2daf29329f980861557ec16912281bf2e8d0ca00656d6972757373
(58) eap_peap: Setting User-Name to emiruss
(58) eap_peap: Sending tunneled request to inner-tunnel
(58) eap_peap:   EAP-Message = 0x022300421a0223003d31c34b11d95ab167ac40f0141c8828e0ca000000000000000020a00bbe4c2daf29329f980861557ec16912281bf2e8d0ca00656d6972757373
(58) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(58) eap_peap:   User-Name = "emiruss"
(58) eap_peap:   State = 0x99e45cc499c746e288e4b222c3615245
(58) Virtual server inner-tunnel received request
(58)   EAP-Message = 0x022300421a0223003d31c34b11d95ab167ac40f0141c8828e0ca000000000000000020a00bbe4c2daf29329f980861557ec16912281bf2e8d0ca00656d6972757373
(58)   FreeRADIUS-Proxied-To = 127.0.0.1
(58)   User-Name = "emiruss"
(58)   State = 0x99e45cc499c746e288e4b222c3615245
(58) server inner-tunnel {
(58)   session-state: No cached attributes
(58)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(58)     authorize {
(58)       [chap] = noop
(58)       [mschap] = noop
(58) suffix: Checking for suffix after "@"
(58) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(58) suffix: No such realm "NULL"
(58)       [suffix] = noop
(58)       update control {
(58)         &Proxy-To-Realm := LOCAL
(58)       } # update control = noop
(58) eap: Peer sent EAP Response (code 2) ID 35 length 66
(58) eap: No EAP Start, assuming it's an on-going EAP conversation
(58)       [eap] = updated
(58)       [files] = noop
(58) sql: EXPAND %{User-Name}
(58) sql:    --> emiruss
(58) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Reserved connection (10)
(58) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(58) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(58) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(58) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(58) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(58) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(58) sql: User not found in any groups
rlm_sql (sql): Released connection (10)
(58)       [sql] = notfound
(58)       [expiration] = noop
(58)       [logintime] = noop
(58)       [pap] = noop
(58)     } # authorize = updated
(58)   Found Auth-Type = EAP
(58)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(58)     authenticate {
(58) eap: Expiring EAP session with state 0x99e45cc499c746e2
(58) eap: Finished EAP session with state 0x99e45cc499c746e2
(58) eap: Previous EAP request found for state 0x99e45cc499c746e2, released from the list
(58) eap: Peer sent packet with method EAP MSCHAPv2 (26)
(58) eap: Calling submodule eap_mschapv2 to process data
(58) eap_mschapv2: # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(58) eap_mschapv2:   Auth-Type MS-CHAP {
(58) mschap: WARNING: No Cleartext-Password configured.  Cannot create NT-Password
(58) mschap: WARNING: No Cleartext-Password configured.  Cannot create LM-Password
(58) mschap: Creating challenge hash with username: emiruss
(58) mschap: Client is using MS-CHAPv2
(58) mschap: ERROR: FAILED: No NT/LM-Password.  Cannot perform authentication
(58) mschap: ERROR: MS-CHAP2-Response is incorrect
(58)     [mschap] = reject
(58)   } # Auth-Type MS-CHAP = reject
(58) eap: Sending EAP Failure (code 4) ID 35 length 4
(58) eap: Freeing handler
(58)       [eap] = reject
(58)     } # authenticate = reject
(58)   Failed to authenticate the user
(58)   Using Post-Auth-Type Reject
(58)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(58)     Post-Auth-Type REJECT {
(58) sql: EXPAND .query
(58) sql:    --> .query
(58) sql: Using query template 'query'
rlm_sql (sql): Reserved connection (11)
(58) sql: EXPAND %{User-Name}
(58) sql:    --> emiruss
(58) sql: SQL-User-Name set to 'emiruss'
(58) sql: EXPAND INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')
(58) sql:    --> INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:33:38')
(58) sql: Executing query: INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:33:38')
(58) sql: SQL query returned: success
(58) sql: 1 record(s) updated
rlm_sql (sql): Released connection (11)
(58)       [sql] = ok
(58) attr_filter.access_reject: EXPAND %{User-Name}
(58) attr_filter.access_reject:    --> emiruss
(58) attr_filter.access_reject: Matched entry DEFAULT at line 11
(58)       [attr_filter.access_reject] = updated
(58)       update outer.session-state {
(58)         &Module-Failure-Message := &request:Module-Failure-Message -> 'mschap: FAILED: No NT/LM-Password.  Cannot perform authentication'
(58)       } # update outer.session-state = noop
(58)     } # Post-Auth-Type REJECT = updated
(58) } # server inner-tunnel
(58) Virtual server sending reply
(58)   MS-CHAP-Error = "#E=691 R=1 C=e1e889aedd8c8a4ab7d073fda203fa29 V=3 M=Authentication failed"
(58)   EAP-Message = 0x04230004
(58)   Message-Authenticator = 0x00000000000000000000000000000000
(58) eap_peap: Got tunneled reply code 3
(58) eap_peap:   MS-CHAP-Error = "#E=691 R=1 C=e1e889aedd8c8a4ab7d073fda203fa29 V=3 M=Authentication failed"
(58) eap_peap:   EAP-Message = 0x04230004
(58) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(58) eap_peap: Tunneled authentication was rejected
(58) eap_peap: FAILURE
(58) eap: Sending EAP Request (code 1) ID 36 length 43
(58) eap: EAP session adding &reply:State = 0xa892117ca0b6086a
(58)     [eap] = handled
(58)   } # authenticate = handled
(58) Using Post-Auth-Type Challenge
(58) Post-Auth-Type sub-section not found.  Ignoring.
(58) # Executing group from file /etc/freeradius/sites-enabled/default
(58) session-state: Saving cached attributes
(58)   Module-Failure-Message := "mschap: FAILED: No NT/LM-Password.  Cannot perform authentication"
(58) Sent Access-Challenge Id 154 from 172.17.0.4:1812 to 192.168.1.30:50043 length 0
(58)   EAP-Message = 0x0124002b19001703010020932e4c1025f972cef16f71dabfc37085a5c8a6ffae50ae954deee962075fe4d3
(58)   Message-Authenticator = 0x00000000000000000000000000000000
(58)   State = 0xa892117ca0b6086a0c39a8311fef873f
(58) Finished request
Thread 2 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 1 got semaphore
Thread 1 handling request 59, (12 handled so far)
(59) <running>: Received Access-Request Id 155 from 192.168.1.30:50043 to 172.17.0.4:1812 length 239
(59) <running>:   User-Name = "emiruss"
(59) <running>:   NAS-IP-Address = 192.168.1.30
(59) <running>:   NAS-Identifier = "Ericsson"
(59) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(59) <running>:   NAS-Port-Type = Wireless-802.11
(59) <running>:   NAS-Port = 0
(59) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(59) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(59) <running>:   Acct-Session-Id = "003E2DE6-00000050"
(59) <running>:   Framed-MTU = 1400
(59) <running>:   EAP-Message = 0x0224002b190017030100208730e493f84e4f2c11f3d8439b507d6477e821cb874aad256c58448558a980dd
(59) <running>:   State = 0xa892117ca0b6086a0c39a8311fef873f
(59) <running>:   Message-Authenticator = 0xced640919e28df32b5eba83b64ff2ba8
(59) <running>: session-state: Found cached attributes
(59) <running>:   Module-Failure-Message := "mschap: FAILED: No NT/LM-Password.  Cannot perform authentication"
(59) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(59) <running>:   authorize {
(59) <running>:     policy filter_username {
(59) <running>:       if (!&User-Name) {
(59) <running>:       if (!&User-Name)  -> FALSE
(59) <running>:       if (&User-Name =~ / /) {
(59) <running>:       if (&User-Name =~ / /)  -> FALSE
(59) <running>:       if (&User-Name =~ /@.*@/ ) {
(59) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(59) <running>:       if (&User-Name =~ /\.\./ ) {
(59) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(59) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(59) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(59) <running>:       if (&User-Name =~ /\.$/)  {
(59) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(59) <running>:       if (&User-Name =~ /@\./)  {
(59) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(59) <running>:     } # policy filter_username = notfound
(59)     [preprocess] = ok
(59)     [chap] = noop
(59)     [mschap] = noop
(59)     [digest] = noop
(59) suffix: Checking for suffix after "@"
(59) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(59) suffix: No such realm "NULL"
(59)     [suffix] = noop
(59) eap: Peer sent EAP Response (code 2) ID 36 length 43
(59) eap: Continuing tunnel setup
(59)     [eap] = ok
(59)   } # authorize = ok
(59) Found Auth-Type = EAP
(59) # Executing group from file /etc/freeradius/sites-enabled/default
(59)   authenticate {
(59) eap: Expiring EAP session with state 0xa892117ca0b6086a
(59) eap: Finished EAP session with state 0xa892117ca0b6086a
(59) eap: Previous EAP request found for state 0xa892117ca0b6086a, released from the list
(59) eap: Peer sent packet with method EAP PEAP (25)
(59) eap: Calling submodule eap_peap to process data
(59) eap_peap: Continuing EAP-TLS
(59) eap_peap: [eaptls verify] = ok
(59) eap_peap: Done initial handshake
(59) eap_peap: [eaptls process] = ok
(59) eap_peap: Session established.  Decoding tunneled attributes
(59) eap_peap: PEAP state send tlv failure
(59) eap_peap: Received EAP-TLV response
(59) eap_peap:   The users session was previously rejected: returning reject (again.)
(59) eap_peap:   This means you need to read the PREVIOUS messages in the debug output
(59) eap_peap:   to find out the reason why the user was rejected
(59) eap_peap:   Look for "reject" or "fail".  Those earlier messages will tell you
(59) eap_peap:   what went wrong, and how to fix the problem
(59) eap: ERROR: Failed continuing EAP PEAP (25) session.  EAP sub-module failed
(59) eap: Sending EAP Failure (code 4) ID 36 length 4
(59) eap: Failed in EAP select
(59)     [eap] = invalid
(59)   } # authenticate = invalid
(59) Failed to authenticate the user
(59) Using Post-Auth-Type Reject
(59) # Executing group from file /etc/freeradius/sites-enabled/default
(59)   Post-Auth-Type REJECT {
(59) sql: EXPAND .query
(59) sql:    --> .query
(59) sql: Using query template 'query'
rlm_sql (sql): Reserved connection (9)
(59) sql: EXPAND %{User-Name}
(59) sql:    --> emiruss
(59) sql: SQL-User-Name set to 'emiruss'
(59) sql: EXPAND INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')
(59) sql:    --> INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:33:38')
(59) sql: Executing query: INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:33:38')
(59) sql: SQL query returned: success
(59) sql: 1 record(s) updated
rlm_sql (sql): Released connection (9)
(59)     [sql] = ok
(59) attr_filter.access_reject: EXPAND %{User-Name}
(59) attr_filter.access_reject:    --> emiruss
(59) attr_filter.access_reject: Matched entry DEFAULT at line 11
(59)     [attr_filter.access_reject] = updated
(59)     [eap] = noop
(59)     policy remove_reply_message_if_eap {
(59)       if (&reply:EAP-Message && &reply:Reply-Message) {
(59)       if (&reply:EAP-Message && &reply:Reply-Message)  -> FALSE
(59)       else {
(59)         [noop] = noop
(59)       } # else = noop
(59)     } # policy remove_reply_message_if_eap = noop
(59)   } # Post-Auth-Type REJECT = updated
(59) Delaying response for 1.000000 seconds
Thread 1 waiting to be assigned a request
(59) Discarding duplicate request from client roocell-ap port 50043 - ID: 155 due to delayed response
Waking up in 0.6 seconds.
(59) Sending delayed response
(59) Sent Access-Reject Id 155 from 172.17.0.4:1812 to 192.168.1.30:50043 length 44
(59)   EAP-Message = 0x04240004
(59)   Message-Authenticator = 0x00000000000000000000000000000000
Waking up in 0.5 seconds.
(30) Cleaning up request packet ID 126 with timestamp +1249
(31) Cleaning up request packet ID 127 with timestamp +1249
(32) Cleaning up request packet ID 128 with timestamp +1249
(33) Cleaning up request packet ID 129 with timestamp +1249
(34) Cleaning up request packet ID 130 with timestamp +1249
(35) Cleaning up request packet ID 131 with timestamp +1249
(36) Cleaning up request packet ID 132 with timestamp +1249
(37) Cleaning up request packet ID 133 with timestamp +1249
(38) Cleaning up request packet ID 134 with timestamp +1249
(39) Cleaning up request packet ID 135 with timestamp +1249
Waking up in 1.6 seconds.
(40) Cleaning up request packet ID 136 with timestamp +1251
(41) Cleaning up request packet ID 137 with timestamp +1251
(42) Cleaning up request packet ID 138 with timestamp +1251
(43) Cleaning up request packet ID 139 with timestamp +1251
(44) Cleaning up request packet ID 140 with timestamp +1251
(45) Cleaning up request packet ID 141 with timestamp +1251
(46) Cleaning up request packet ID 142 with timestamp +1251
(47) Cleaning up request packet ID 143 with timestamp +1251
(48) Cleaning up request packet ID 144 with timestamp +1251
(49) Cleaning up request packet ID 145 with timestamp +1251
Waking up in 1.0 seconds.
(50) Cleaning up request packet ID 146 with timestamp +1252
(51) Cleaning up request packet ID 147 with timestamp +1252
(52) Cleaning up request packet ID 148 with timestamp +1252
(53) Cleaning up request packet ID 149 with timestamp +1252
(54) Cleaning up request packet ID 150 with timestamp +1252
(55) Cleaning up request packet ID 151 with timestamp +1252
(56) Cleaning up request packet ID 152 with timestamp +1253
(57) Cleaning up request packet ID 153 with timestamp +1253
(58) Cleaning up request packet ID 154 with timestamp +1253
(59) Cleaning up request packet ID 155 with timestamp +1253
Ready to process requests
Thread 5 got semaphore
Thread 5 handling request 60, (13 handled so far)
(60) <running>: Received Access-Request Id 156 from 192.168.1.30:50044 to 172.17.0.4:1812 length 190
(60) <running>:   User-Name = "emiruss"
(60) <running>:   NAS-IP-Address = 192.168.1.30
(60) <running>:   NAS-Identifier = "Ericsson"
(60) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(60) <running>:   NAS-Port-Type = Wireless-802.11
(60) <running>:   NAS-Port = 0
(60) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(60) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(60) <running>:   Acct-Session-Id = "003E2DE6-00000051"
(60) <running>:   Framed-MTU = 1400
(60) <running>:   EAP-Message = 0x022d000c01656d6972757373
(60) <running>:   Message-Authenticator = 0xec3f420ee19f5d8f11ef7ea0b0c20a4d
(60) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(60) <running>:   authorize {
(60) <running>:     policy filter_username {
(60) <running>:       if (!&User-Name) {
(60) <running>:       if (!&User-Name)  -> FALSE
(60) <running>:       if (&User-Name =~ / /) {
(60) <running>:       if (&User-Name =~ / /)  -> FALSE
(60) <running>:       if (&User-Name =~ /@.*@/ ) {
(60) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(60) <running>:       if (&User-Name =~ /\.\./ ) {
(60) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(60) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
Waking up in 0.3 seconds.
(60) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(60) <running>:       if (&User-Name =~ /\.$/)  {
(60) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(60) <running>:       if (&User-Name =~ /@\./)  {
(60) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(60) <running>:     } # policy filter_username = notfound
(60)     [preprocess] = ok
(60)     [chap] = noop
(60)     [mschap] = noop
(60)     [digest] = noop
(60) suffix: Checking for suffix after "@"
(60) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(60) suffix: No such realm "NULL"
(60)     [suffix] = noop
(60) eap: Peer sent EAP Response (code 2) ID 45 length 12
(60) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(60)     [eap] = ok
(60)   } # authorize = ok
(60) Found Auth-Type = EAP
(60) # Executing group from file /etc/freeradius/sites-enabled/default
(60)   authenticate {
(60) eap: Peer sent packet with method EAP Identity (1)
(60) eap: Calling submodule eap_md5 to process data
(60) eap_md5: Issuing MD5 Challenge
(60) eap: Sending EAP Request (code 1) ID 46 length 22
(60) eap: EAP session adding &reply:State = 0xb751a265b77fa665
(60)     [eap] = handled
(60)   } # authenticate = handled
(60) Using Post-Auth-Type Challenge
(60) Post-Auth-Type sub-section not found.  Ignoring.
(60) # Executing group from file /etc/freeradius/sites-enabled/default
(60) Sent Access-Challenge Id 156 from 172.17.0.4:1812 to 192.168.1.30:50044 length 0
(60)   EAP-Message = 0x012e00160410f80fa48defd7fe3369d94eed39d20943
(60)   Message-Authenticator = 0x00000000000000000000000000000000
(60)   State = 0xb751a265b77fa66513ebc464be04bba2
(60) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.3 seconds.
Thread 4 got semaphore
Thread 4 handling request 61, (13 handled so far)
(61) <running>: Received Access-Request Id 157 from 192.168.1.30:50044 to 172.17.0.4:1812 length 204
(61) <running>:   User-Name = "emiruss"
(61) <running>:   NAS-IP-Address = 192.168.1.30
(61) <running>:   NAS-Identifier = "Ericsson"
(61) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(61) <running>:   NAS-Port-Type = Wireless-802.11
(61) <running>:   NAS-Port = 0
(61) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(61) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(61) <running>:   Acct-Session-Id = "003E2DE6-00000051"
(61) <running>:   Framed-MTU = 1400
(61) <running>:   EAP-Message = 0x022e00080319152b
(61) <running>:   State = 0xb751a265b77fa66513ebc464be04bba2
(61) <running>:   Message-Authenticator = 0xf24a05056e7319fd1269bd8ad122bb9c
(61) <running>: session-state: No cached attributes
(61) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(61) <running>:   authorize {
(61) <running>:     policy filter_username {
(61) <running>:       if (!&User-Name) {
(61) <running>:       if (!&User-Name)  -> FALSE
(61) <running>:       if (&User-Name =~ / /) {
(61) <running>:       if (&User-Name =~ / /)  -> FALSE
(61) <running>:       if (&User-Name =~ /@.*@/ ) {
(61) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(61) <running>:       if (&User-Name =~ /\.\./ ) {
(61) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(61) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(61) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(61) <running>:       if (&User-Name =~ /\.$/)  {
(61) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(61) <running>:       if (&User-Name =~ /@\./)  {
(61) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(61) <running>:     } # policy filter_username = notfound
(61)     [preprocess] = ok
(61)     [chap] = noop
(61)     [mschap] = noop
(61)     [digest] = noop
(61) suffix: Checking for suffix after "@"
(61) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(61) suffix: No such realm "NULL"
(61)     [suffix] = noop
(61) eap: Peer sent EAP Response (code 2) ID 46 length 8
(61) eap: No EAP Start, assuming it's an on-going EAP conversation
(61)     [eap] = updated
(61)     [files] = noop
(61) sql: EXPAND %{User-Name}
(61) sql:    --> emiruss
(61) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Reserved connection (10)
(61) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(61) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(61) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(61) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(61) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(61) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(61) sql: User not found in any groups
rlm_sql (sql): Released connection (10)
(61)     [sql] = notfound
(61)     [expiration] = noop
(61)     [logintime] = noop
(61) pap: WARNING: No "known good" password found for the user.  Not setting Auth-Type
(61) pap: WARNING: Authentication will fail unless a "known good" password is available
(61)     [pap] = noop
(61)   } # authorize = updated
(61) Found Auth-Type = EAP
(61) # Executing group from file /etc/freeradius/sites-enabled/default
(61)   authenticate {
(61) eap: Expiring EAP session with state 0xb751a265b77fa665
(61) eap: Finished EAP session with state 0xb751a265b77fa665
(61) eap: Previous EAP request found for state 0xb751a265b77fa665, released from the list
(61) eap: Peer sent packet with method EAP NAK (3)
(61) eap: Found mutually acceptable type PEAP (25)
(61) eap: Calling submodule eap_peap to process data
(61) eap_peap: Initiating new EAP-TLS session
(61) eap_peap: [eaptls start] = request
(61) eap: Sending EAP Request (code 1) ID 47 length 6
(61) eap: EAP session adding &reply:State = 0xb751a265b67ebb65
(61)     [eap] = handled
(61)   } # authenticate = handled
(61) Using Post-Auth-Type Challenge
(61) Post-Auth-Type sub-section not found.  Ignoring.
(61) # Executing group from file /etc/freeradius/sites-enabled/default
(61) Sent Access-Challenge Id 157 from 172.17.0.4:1812 to 192.168.1.30:50044 length 0
(61)   EAP-Message = 0x012f00061920
(61)   Message-Authenticator = 0x00000000000000000000000000000000
(61)   State = 0xb751a265b67ebb6513ebc464be04bba2
(61) Finished request
Thread 4 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 3 got semaphore
Thread 3 handling request 62, (13 handled so far)
(62) <running>: Received Access-Request Id 158 from 192.168.1.30:50044 to 172.17.0.4:1812 length 339
(62) <running>:   User-Name = "emiruss"
(62) <running>:   NAS-IP-Address = 192.168.1.30
(62) <running>:   NAS-Identifier = "Ericsson"
(62) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(62) <running>:   NAS-Port-Type = Wireless-802.11
(62) <running>:   NAS-Port = 0
(62) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(62) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(62) <running>:   Acct-Session-Id = "003E2DE6-00000051"
(62) <running>:   Framed-MTU = 1400
(62) <running>:   EAP-Message = 0x022f008f19800000008516030100800100007c030156552d26c080071afa73e56c4415de7f6c08b93d7b31819405eba5502c4d525600003400ffc02cc02bc024c023c00ac009c008c030c02fc028c027c014c013c012009d009c003d003c0035002f000ac007c011000500040100001f000a0008000600
(62) <running>:   State = 0xb751a265b67ebb6513ebc464be04bba2
(62) <running>:   Message-Authenticator = 0xa7bef8b326b503d46dad4d1822d1b350
(62) <running>: session-state: No cached attributes
(62) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(62) <running>:   authorize {
(62) <running>:     policy filter_username {
(62) <running>:       if (!&User-Name) {
(62) <running>:       if (!&User-Name)  -> FALSE
(62) <running>:       if (&User-Name =~ / /) {
(62) <running>:       if (&User-Name =~ / /)  -> FALSE
(62) <running>:       if (&User-Name =~ /@.*@/ ) {
(62) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(62) <running>:       if (&User-Name =~ /\.\./ ) {
(62) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(62) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(62) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(62) <running>:       if (&User-Name =~ /\.$/)  {
(62) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(62) <running>:       if (&User-Name =~ /@\./)  {
(62) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(62) <running>:     } # policy filter_username = notfound
(62)     [preprocess] = ok
(62)     [chap] = noop
(62)     [mschap] = noop
(62)     [digest] = noop
(62) suffix: Checking for suffix after "@"
(62) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(62) suffix: No such realm "NULL"
(62)     [suffix] = noop
(62) eap: Peer sent EAP Response (code 2) ID 47 length 143
(62) eap: Continuing tunnel setup
(62)     [eap] = ok
(62)   } # authorize = ok
(62) Found Auth-Type = EAP
(62) # Executing group from file /etc/freeradius/sites-enabled/default
(62)   authenticate {
(62) eap: Expiring EAP session with state 0xb751a265b67ebb65
(62) eap: Finished EAP session with state 0xb751a265b67ebb65
(62) eap: Previous EAP request found for state 0xb751a265b67ebb65, released from the list
(62) eap: Peer sent packet with method EAP PEAP (25)
(62) eap: Calling submodule eap_peap to process data
(62) eap_peap: Continuing EAP-TLS
(62) eap_peap: Peer indicated complete TLS record size will be 133 bytes
(62) eap_peap: Got complete TLS record (133 bytes)
(62) eap_peap: [eaptls verify] = length included
(62) eap_peap: (other): before/accept initialization
(62) eap_peap: TLS_accept: before/accept initialization
(62) eap_peap: <<< TLS 1.0 Handshake [length 0080], ClientHello 
(62) eap_peap: TLS_accept: SSLv3 read client hello A
(62) eap_peap: >>> TLS 1.0 Handshake [length 0059], ServerHello 
(62) eap_peap: TLS_accept: SSLv3 write server hello A
(62) eap_peap: >>> TLS 1.0 Handshake [length 08d3], Certificate 
(62) eap_peap: TLS_accept: SSLv3 write certificate A
(62) eap_peap: >>> TLS 1.0 Handshake [length 014b], ServerKeyExchange 
(62) eap_peap: TLS_accept: SSLv3 write key exchange A
(62) eap_peap: >>> TLS 1.0 Handshake [length 0004], ServerHelloDone 
(62) eap_peap: TLS_accept: SSLv3 write server done A
(62) eap_peap: TLS_accept: SSLv3 flush data
(62) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(62) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(62) eap_peap: In SSL Handshake Phase
(62) eap_peap: In SSL Accept mode
(62) eap_peap: [eaptls process] = handled
(62) eap: Sending EAP Request (code 1) ID 48 length 1004
(62) eap: EAP session adding &reply:State = 0xb751a265b561bb65
(62)     [eap] = handled
(62)   } # authenticate = handled
(62) Using Post-Auth-Type Challenge
(62) Post-Auth-Type sub-section not found.  Ignoring.
(62) # Executing group from file /etc/freeradius/sites-enabled/default
(62) Sent Access-Challenge Id 158 from 172.17.0.4:1812 to 192.168.1.30:50044 length 0
(62)   EAP-Message = 0x013003ec19c000000a8f1603010059020000550301a9a404b6900d44cec22c389935f59893a6ebc4ebcdd0febf78e26d58933f4b96204325693d85e66321916116cc7fa4680376570298705f29af2c37e2887838721ac01400000dff01000100000b00040300010216030108d30b0008cf0008cc0003de
(62)   Message-Authenticator = 0x00000000000000000000000000000000
(62)   State = 0xb751a265b561bb6513ebc464be04bba2
(62) Finished request
Thread 3 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 2 got semaphore
Thread 2 handling request 63, (13 handled so far)
(63) <running>: Received Access-Request Id 159 from 192.168.1.30:50044 to 172.17.0.4:1812 length 202
(63) <running>:   User-Name = "emiruss"
(63) <running>:   NAS-IP-Address = 192.168.1.30
(63) <running>:   NAS-Identifier = "Ericsson"
(63) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(63) <running>:   NAS-Port-Type = Wireless-802.11
(63) <running>:   NAS-Port = 0
(63) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(63) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(63) <running>:   Acct-Session-Id = "003E2DE6-00000051"
(63) <running>:   Framed-MTU = 1400
(63) <running>:   EAP-Message = 0x023000061900
(63) <running>:   State = 0xb751a265b561bb6513ebc464be04bba2
(63) <running>:   Message-Authenticator = 0xd3423aeb38daa7c9fa52ac7a9d1ad2f7
(63) <running>: session-state: No cached attributes
(63) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(63) <running>:   authorize {
(63) <running>:     policy filter_username {
(63) <running>:       if (!&User-Name) {
(63) <running>:       if (!&User-Name)  -> FALSE
(63) <running>:       if (&User-Name =~ / /) {
(63) <running>:       if (&User-Name =~ / /)  -> FALSE
(63) <running>:       if (&User-Name =~ /@.*@/ ) {
(63) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(63) <running>:       if (&User-Name =~ /\.\./ ) {
(63) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(63) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(63) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(63) <running>:       if (&User-Name =~ /\.$/)  {
(63) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(63) <running>:       if (&User-Name =~ /@\./)  {
(63) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(63) <running>:     } # policy filter_username = notfound
(63)     [preprocess] = ok
(63)     [chap] = noop
(63)     [mschap] = noop
(63)     [digest] = noop
(63) suffix: Checking for suffix after "@"
(63) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(63) suffix: No such realm "NULL"
(63)     [suffix] = noop
(63) eap: Peer sent EAP Response (code 2) ID 48 length 6
(63) eap: Continuing tunnel setup
(63)     [eap] = ok
(63)   } # authorize = ok
(63) Found Auth-Type = EAP
(63) # Executing group from file /etc/freeradius/sites-enabled/default
(63)   authenticate {
(63) eap: Expiring EAP session with state 0xb751a265b561bb65
(63) eap: Finished EAP session with state 0xb751a265b561bb65
(63) eap: Previous EAP request found for state 0xb751a265b561bb65, released from the list
(63) eap: Peer sent packet with method EAP PEAP (25)
(63) eap: Calling submodule eap_peap to process data
(63) eap_peap: Continuing EAP-TLS
(63) eap_peap: Peer ACKed our handshake fragment
(63) eap_peap: [eaptls verify] = request
(63) eap_peap: [eaptls process] = handled
(63) eap: Sending EAP Request (code 1) ID 49 length 1000
(63) eap: EAP session adding &reply:State = 0xb751a265b460bb65
(63)     [eap] = handled
(63)   } # authenticate = handled
(63) Using Post-Auth-Type Challenge
(63) Post-Auth-Type sub-section not found.  Ignoring.
(63) # Executing group from file /etc/freeradius/sites-enabled/default
(63) Sent Access-Challenge Id 159 from 172.17.0.4:1812 to 192.168.1.30:50044 length 0
(63)   EAP-Message = 0x013103e819400dd0405955c762981948527048701681d313d3cc6629a5557b66df2aae22c8590ab99d66ec8d3792a72e30596410f5d1e81f5a774969a1ce9ad6bd01d42da65536016e80a905c662a71ef5c075b8bdf0127a0cf1bd4c91290e15edffa035febde0185096bdc1e553090004e8308204e430
(63)   Message-Authenticator = 0x00000000000000000000000000000000
(63)   State = 0xb751a265b460bb6513ebc464be04bba2
(63) Finished request
Thread 2 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 1 got semaphore
Thread 1 handling request 64, (13 handled so far)
(64) <running>: Received Access-Request Id 160 from 192.168.1.30:50044 to 172.17.0.4:1812 length 202
(64) <running>:   User-Name = "emiruss"
(64) <running>:   NAS-IP-Address = 192.168.1.30
(64) <running>:   NAS-Identifier = "Ericsson"
(64) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(64) <running>:   NAS-Port-Type = Wireless-802.11
(64) <running>:   NAS-Port = 0
(64) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(64) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(64) <running>:   Acct-Session-Id = "003E2DE6-00000051"
(64) <running>:   Framed-MTU = 1400
(64) <running>:   EAP-Message = 0x023100061900
(64) <running>:   State = 0xb751a265b460bb6513ebc464be04bba2
(64) <running>:   Message-Authenticator = 0xd25e32a2da3ec3a426968c3bd7e385a5
(64) <running>: session-state: No cached attributes
(64) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(64) <running>:   authorize {
(64) <running>:     policy filter_username {
(64) <running>:       if (!&User-Name) {
(64) <running>:       if (!&User-Name)  -> FALSE
(64) <running>:       if (&User-Name =~ / /) {
(64) <running>:       if (&User-Name =~ / /)  -> FALSE
(64) <running>:       if (&User-Name =~ /@.*@/ ) {
(64) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(64) <running>:       if (&User-Name =~ /\.\./ ) {
(64) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(64) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(64) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(64) <running>:       if (&User-Name =~ /\.$/)  {
(64) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(64) <running>:       if (&User-Name =~ /@\./)  {
(64) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(64) <running>:     } # policy filter_username = notfound
(64)     [preprocess] = ok
(64)     [chap] = noop
(64)     [mschap] = noop
(64)     [digest] = noop
(64) suffix: Checking for suffix after "@"
(64) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(64) suffix: No such realm "NULL"
(64)     [suffix] = noop
(64) eap: Peer sent EAP Response (code 2) ID 49 length 6
(64) eap: Continuing tunnel setup
(64)     [eap] = ok
(64)   } # authorize = ok
(64) Found Auth-Type = EAP
(64) # Executing group from file /etc/freeradius/sites-enabled/default
(64)   authenticate {
(64) eap: Expiring EAP session with state 0xb751a265b460bb65
(64) eap: Finished EAP session with state 0xb751a265b460bb65
(64) eap: Previous EAP request found for state 0xb751a265b460bb65, released from the list
(64) eap: Peer sent packet with method EAP PEAP (25)
(64) eap: Calling submodule eap_peap to process data
(64) eap_peap: Continuing EAP-TLS
(64) eap_peap: Peer ACKed our handshake fragment
(64) eap_peap: [eaptls verify] = request
(64) eap_peap: [eaptls process] = handled
(64) eap: Sending EAP Request (code 1) ID 50 length 721
(64) eap: EAP session adding &reply:State = 0xb751a265b363bb65
(64)     [eap] = handled
(64)   } # authenticate = handled
(64) Using Post-Auth-Type Challenge
(64) Post-Auth-Type sub-section not found.  Ignoring.
(64) # Executing group from file /etc/freeradius/sites-enabled/default
(64) Sent Access-Challenge Id 160 from 172.17.0.4:1812 to 192.168.1.30:50044 length 0
(64)   EAP-Message = 0x013202d1190020417574686f72697479820900c3fc536eef83d741300f0603551d130101ff040530030101ff30360603551d1f042f302d302ba029a0278625687474703a2f2f7777772e6578616d706c652e6f72672f6578616d706c655f63612e63726c300d06092a864886f70d01010b050003820101
(64)   Message-Authenticator = 0x00000000000000000000000000000000
(64)   State = 0xb751a265b363bb6513ebc464be04bba2
(64) Finished request
Thread 1 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 5 got semaphore
Thread 5 handling request 65, (14 handled so far)
(65) <running>: Received Access-Request Id 161 from 192.168.1.30:50044 to 172.17.0.4:1812 length 340
(65) <running>:   User-Name = "emiruss"
(65) <running>:   NAS-IP-Address = 192.168.1.30
(65) <running>:   NAS-Identifier = "Ericsson"
(65) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(65) <running>:   NAS-Port-Type = Wireless-802.11
(65) <running>:   NAS-Port = 0
(65) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(65) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(65) <running>:   Acct-Session-Id = "003E2DE6-00000051"
(65) <running>:   Framed-MTU = 1400
(65) <running>:   EAP-Message = 0x02320090198000000086160301004610000042410477bc3b6b8dd9dc0b0416db5a15d375d4617bcc29b050d0a9a019f42bab87b941f073b927070de0ccb7bcd8ac48fc50223fb9f0281a9cdbc23083aa6ef5a9bb25140301000101160301003051f69af90fdbf502e8246809e826ece913fdba068b3ae4
(65) <running>:   State = 0xb751a265b363bb6513ebc464be04bba2
(65) <running>:   Message-Authenticator = 0x8d08b237b49512eb398e57f3edb414f1
(65) <running>: session-state: No cached attributes
(65) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(65) <running>:   authorize {
(65) <running>:     policy filter_username {
(65) <running>:       if (!&User-Name) {
(65) <running>:       if (!&User-Name)  -> FALSE
(65) <running>:       if (&User-Name =~ / /) {
(65) <running>:       if (&User-Name =~ / /)  -> FALSE
(65) <running>:       if (&User-Name =~ /@.*@/ ) {
(65) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(65) <running>:       if (&User-Name =~ /\.\./ ) {
(65) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(65) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(65) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(65) <running>:       if (&User-Name =~ /\.$/)  {
(65) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(65) <running>:       if (&User-Name =~ /@\./)  {
(65) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(65) <running>:     } # policy filter_username = notfound
(65)     [preprocess] = ok
(65)     [chap] = noop
(65)     [mschap] = noop
(65)     [digest] = noop
(65) suffix: Checking for suffix after "@"
(65) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(65) suffix: No such realm "NULL"
(65)     [suffix] = noop
(65) eap: Peer sent EAP Response (code 2) ID 50 length 144
(65) eap: Continuing tunnel setup
(65)     [eap] = ok
(65)   } # authorize = ok
(65) Found Auth-Type = EAP
(65) # Executing group from file /etc/freeradius/sites-enabled/default
(65)   authenticate {
(65) eap: Expiring EAP session with state 0xb751a265b363bb65
(65) eap: Finished EAP session with state 0xb751a265b363bb65
(65) eap: Previous EAP request found for state 0xb751a265b363bb65, released from the list
(65) eap: Peer sent packet with method EAP PEAP (25)
(65) eap: Calling submodule eap_peap to process data
(65) eap_peap: Continuing EAP-TLS
(65) eap_peap: Peer indicated complete TLS record size will be 134 bytes
(65) eap_peap: Got complete TLS record (134 bytes)
(65) eap_peap: [eaptls verify] = length included
(65) eap_peap: <<< TLS 1.0 Handshake [length 0046], ClientKeyExchange 
(65) eap_peap: TLS_accept: SSLv3 read client key exchange A
(65) eap_peap: <<< TLS 1.0 ChangeCipherSpec [length 0001] 
(65) eap_peap: <<< TLS 1.0 Handshake [length 0010], Finished 
(65) eap_peap: TLS_accept: SSLv3 read finished A
(65) eap_peap: >>> TLS 1.0 ChangeCipherSpec [length 0001] 
(65) eap_peap: TLS_accept: SSLv3 write change cipher spec A
(65) eap_peap: >>> TLS 1.0 Handshake [length 0010], Finished 
(65) eap_peap: TLS_accept: SSLv3 write finished A
(65) eap_peap: TLS_accept: SSLv3 flush data
(65) eap_peap: (other): SSL negotiation finished successfully
(65) eap_peap: SSL Connection Established
(65) eap_peap: [eaptls process] = handled
(65) eap: Sending EAP Request (code 1) ID 51 length 65
(65) eap: EAP session adding &reply:State = 0xb751a265b262bb65
(65)     [eap] = handled
(65)   } # authenticate = handled
(65) Using Post-Auth-Type Challenge
(65) Post-Auth-Type sub-section not found.  Ignoring.
(65) # Executing group from file /etc/freeradius/sites-enabled/default
(65) Sent Access-Challenge Id 161 from 172.17.0.4:1812 to 192.168.1.30:50044 length 0
(65)   EAP-Message = 0x01330041190014030100010116030100308985a202032d70b19aff834629fd6dd559404db0c1401b335b0d0bfe45513868db7af62c16ed8e39f95ea7ea05564656
(65)   Message-Authenticator = 0x00000000000000000000000000000000
(65)   State = 0xb751a265b262bb6513ebc464be04bba2
(65) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 4 got semaphore
Thread 4 handling request 66, (14 handled so far)
(66) <running>: Received Access-Request Id 162 from 192.168.1.30:50044 to 172.17.0.4:1812 length 202
(66) <running>:   User-Name = "emiruss"
(66) <running>:   NAS-IP-Address = 192.168.1.30
(66) <running>:   NAS-Identifier = "Ericsson"
(66) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(66) <running>:   NAS-Port-Type = Wireless-802.11
(66) <running>:   NAS-Port = 0
(66) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(66) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(66) <running>:   Acct-Session-Id = "003E2DE6-00000051"
(66) <running>:   Framed-MTU = 1400
(66) <running>:   EAP-Message = 0x023300061900
(66) <running>:   State = 0xb751a265b262bb6513ebc464be04bba2
(66) <running>:   Message-Authenticator = 0x57c31111282de891d3de49694dd72ba1
(66) <running>: session-state: No cached attributes
(66) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(66) <running>:   authorize {
(66) <running>:     policy filter_username {
(66) <running>:       if (!&User-Name) {
(66) <running>:       if (!&User-Name)  -> FALSE
(66) <running>:       if (&User-Name =~ / /) {
(66) <running>:       if (&User-Name =~ / /)  -> FALSE
(66) <running>:       if (&User-Name =~ /@.*@/ ) {
(66) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(66) <running>:       if (&User-Name =~ /\.\./ ) {
(66) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(66) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(66) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(66) <running>:       if (&User-Name =~ /\.$/)  {
(66) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(66) <running>:       if (&User-Name =~ /@\./)  {
(66) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(66) <running>:     } # policy filter_username = notfound
(66)     [preprocess] = ok
(66)     [chap] = noop
(66)     [mschap] = noop
(66)     [digest] = noop
(66) suffix: Checking for suffix after "@"
(66) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(66) suffix: No such realm "NULL"
(66)     [suffix] = noop
(66) eap: Peer sent EAP Response (code 2) ID 51 length 6
(66) eap: Continuing tunnel setup
(66)     [eap] = ok
(66)   } # authorize = ok
(66) Found Auth-Type = EAP
(66) # Executing group from file /etc/freeradius/sites-enabled/default
(66)   authenticate {
(66) eap: Expiring EAP session with state 0xb751a265b262bb65
(66) eap: Finished EAP session with state 0xb751a265b262bb65
(66) eap: Previous EAP request found for state 0xb751a265b262bb65, released from the list
(66) eap: Peer sent packet with method EAP PEAP (25)
(66) eap: Calling submodule eap_peap to process data
(66) eap_peap: Continuing EAP-TLS
(66) eap_peap: Peer ACKed our handshake fragment.  handshake is finished
(66) eap_peap: [eaptls verify] = success
(66) eap_peap: [eaptls process] = success
(66) eap_peap: Session established.  Decoding tunneled attributes
(66) eap_peap: PEAP state TUNNEL ESTABLISHED
(66) eap: Sending EAP Request (code 1) ID 52 length 43
(66) eap: EAP session adding &reply:State = 0xb751a265b165bb65
(66)     [eap] = handled
(66)   } # authenticate = handled
(66) Using Post-Auth-Type Challenge
(66) Post-Auth-Type sub-section not found.  Ignoring.
(66) # Executing group from file /etc/freeradius/sites-enabled/default
(66) Sent Access-Challenge Id 162 from 172.17.0.4:1812 to 192.168.1.30:50044 length 0
(66)   EAP-Message = 0x0134002b19001703010020cf5710a7a1773844725862f12edd2116c416a3427c51c2f0e4acc7e2b9d08b7d
(66)   Message-Authenticator = 0x00000000000000000000000000000000
(66)   State = 0xb751a265b165bb6513ebc464be04bba2
(66) Finished request
Thread 4 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 3 got semaphore
Thread 3 handling request 67, (14 handled so far)
(67) <running>: Received Access-Request Id 163 from 192.168.1.30:50044 to 172.17.0.4:1812 length 239
(67) <running>:   User-Name = "emiruss"
(67) <running>:   NAS-IP-Address = 192.168.1.30
(67) <running>:   NAS-Identifier = "Ericsson"
(67) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(67) <running>:   NAS-Port-Type = Wireless-802.11
(67) <running>:   NAS-Port = 0
(67) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(67) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(67) <running>:   Acct-Session-Id = "003E2DE6-00000051"
(67) <running>:   Framed-MTU = 1400
(67) <running>:   EAP-Message = 0x0234002b190017030100205ad1d05ef39ad4424fb660581863c1eca71aa9a4d0179d22ac7fcf9ca2c18108
(67) <running>:   State = 0xb751a265b165bb6513ebc464be04bba2
(67) <running>:   Message-Authenticator = 0xef3376d0bb5c3b777c5314262d8f5871
(67) <running>: session-state: No cached attributes
(67) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(67) <running>:   authorize {
(67) <running>:     policy filter_username {
(67) <running>:       if (!&User-Name) {
(67) <running>:       if (!&User-Name)  -> FALSE
(67) <running>:       if (&User-Name =~ / /) {
(67) <running>:       if (&User-Name =~ / /)  -> FALSE
(67) <running>:       if (&User-Name =~ /@.*@/ ) {
(67) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(67) <running>:       if (&User-Name =~ /\.\./ ) {
(67) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(67) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(67) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(67) <running>:       if (&User-Name =~ /\.$/)  {
(67) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(67) <running>:       if (&User-Name =~ /@\./)  {
(67) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(67) <running>:     } # policy filter_username = notfound
(67)     [preprocess] = ok
(67)     [chap] = noop
(67)     [mschap] = noop
(67)     [digest] = noop
(67) suffix: Checking for suffix after "@"
(67) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(67) suffix: No such realm "NULL"
(67)     [suffix] = noop
(67) eap: Peer sent EAP Response (code 2) ID 52 length 43
(67) eap: Continuing tunnel setup
(67)     [eap] = ok
(67)   } # authorize = ok
(67) Found Auth-Type = EAP
(67) # Executing group from file /etc/freeradius/sites-enabled/default
(67)   authenticate {
(67) eap: Expiring EAP session with state 0xb751a265b165bb65
(67) eap: Finished EAP session with state 0xb751a265b165bb65
(67) eap: Previous EAP request found for state 0xb751a265b165bb65, released from the list
(67) eap: Peer sent packet with method EAP PEAP (25)
(67) eap: Calling submodule eap_peap to process data
(67) eap_peap: Continuing EAP-TLS
(67) eap_peap: [eaptls verify] = ok
(67) eap_peap: Done initial handshake
(67) eap_peap: [eaptls process] = ok
(67) eap_peap: Session established.  Decoding tunneled attributes
(67) eap_peap: PEAP state WAITING FOR INNER IDENTITY
(67) eap_peap: Identity - emiruss
(67) eap_peap: Got inner identity 'emiruss'
(67) eap_peap: Setting default EAP type for tunneled EAP session
(67) eap_peap: Got tunneled request
(67) eap_peap:   EAP-Message = 0x0234000c01656d6972757373
(67) eap_peap: Setting User-Name to emiruss
(67) eap_peap: Sending tunneled request to inner-tunnel
(67) eap_peap:   EAP-Message = 0x0234000c01656d6972757373
(67) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(67) eap_peap:   User-Name = "emiruss"
(67) Virtual server inner-tunnel received request
(67)   EAP-Message = 0x0234000c01656d6972757373
(67)   FreeRADIUS-Proxied-To = 127.0.0.1
(67)   User-Name = "emiruss"
(67) server inner-tunnel {
(67)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(67)     authorize {
(67)       [chap] = noop
(67)       [mschap] = noop
(67) suffix: Checking for suffix after "@"
(67) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(67) suffix: No such realm "NULL"
(67)       [suffix] = noop
(67)       update control {
(67)         &Proxy-To-Realm := LOCAL
(67)       } # update control = noop
(67) eap: Peer sent EAP Response (code 2) ID 52 length 12
(67) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(67)       [eap] = ok
(67)     } # authorize = ok
(67)   Found Auth-Type = EAP
(67)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(67)     authenticate {
(67) eap: Peer sent packet with method EAP Identity (1)
(67) eap: Calling submodule eap_mschapv2 to process data
(67) eap_mschapv2: Issuing Challenge
(67) eap: Sending EAP Request (code 1) ID 53 length 43
(67) eap: EAP session adding &reply:State = 0x7b662d707b533776
(67)       [eap] = handled
(67)     } # authenticate = handled
(67) } # server inner-tunnel
(67) Virtual server sending reply
(67)   EAP-Message = 0x0135002b1a0135002610758d43bd37c5d95cd8d33a33215c7b30667265657261646975732d332e302e3130
(67)   Message-Authenticator = 0x00000000000000000000000000000000
(67)   State = 0x7b662d707b533776523c2fc611e5a07b
(67) eap_peap: Got tunneled reply code 11
(67) eap_peap:   EAP-Message = 0x0135002b1a0135002610758d43bd37c5d95cd8d33a33215c7b30667265657261646975732d332e302e3130
(67) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(67) eap_peap:   State = 0x7b662d707b533776523c2fc611e5a07b
(67) eap_peap: Got tunneled Access-Challenge
(67) eap: Sending EAP Request (code 1) ID 53 length 75
(67) eap: EAP session adding &reply:State = 0xb751a265b064bb65
(67)     [eap] = handled
(67)   } # authenticate = handled
(67) Using Post-Auth-Type Challenge
(67) Post-Auth-Type sub-section not found.  Ignoring.
(67) # Executing group from file /etc/freeradius/sites-enabled/default
(67) Sent Access-Challenge Id 163 from 172.17.0.4:1812 to 192.168.1.30:50044 length 0
(67)   EAP-Message = 0x0135004b190017030100403f3bdfb946ebf0413cb8f41da4faa58c8a57c0559475d5a9263d6dc9906fd800c5f6982bb1240545595f3d93518a8ddc38dec72daf4855fcbd25e04675a67645
(67)   Message-Authenticator = 0x00000000000000000000000000000000
(67)   State = 0xb751a265b064bb6513ebc464be04bba2
(67) Finished request
Thread 3 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 2 got semaphore
Thread 2 handling request 68, (14 handled so far)
(68) <running>: Received Access-Request Id 164 from 192.168.1.30:50044 to 172.17.0.4:1812 length 303
(68) <running>:   User-Name = "emiruss"
(68) <running>:   NAS-IP-Address = 192.168.1.30
(68) <running>:   NAS-Identifier = "Ericsson"
(68) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(68) <running>:   NAS-Port-Type = Wireless-802.11
(68) <running>:   NAS-Port = 0
(68) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(68) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(68) <running>:   Acct-Session-Id = "003E2DE6-00000051"
(68) <running>:   Framed-MTU = 1400
(68) <running>:   EAP-Message = 0x0235006b19001703010060fd2c06f0056a7d8b4c2fdbb396ab5e870b7fb2baa3ed259710807f03088eb3af459fe01cce183caa26414b3cfe4e512ea4b44f3ddf6772bfaadf104f021671b4fbdfdf057a772f0002ae735b5b8483a0c45b964a9368e6e5e608cb09b8b351a5
(68) <running>:   State = 0xb751a265b064bb6513ebc464be04bba2
(68) <running>:   Message-Authenticator = 0x90ce6752af420c6e36d7ab4078bdf5dd
(68) <running>: session-state: No cached attributes
(68) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(68) <running>:   authorize {
(68) <running>:     policy filter_username {
(68) <running>:       if (!&User-Name) {
(68) <running>:       if (!&User-Name)  -> FALSE
(68) <running>:       if (&User-Name =~ / /) {
(68) <running>:       if (&User-Name =~ / /)  -> FALSE
(68) <running>:       if (&User-Name =~ /@.*@/ ) {
(68) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(68) <running>:       if (&User-Name =~ /\.\./ ) {
(68) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(68) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(68) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(68) <running>:       if (&User-Name =~ /\.$/)  {
(68) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(68) <running>:       if (&User-Name =~ /@\./)  {
(68) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(68) <running>:     } # policy filter_username = notfound
(68)     [preprocess] = ok
(68)     [chap] = noop
(68)     [mschap] = noop
(68)     [digest] = noop
(68) suffix: Checking for suffix after "@"
(68) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(68) suffix: No such realm "NULL"
(68)     [suffix] = noop
(68) eap: Peer sent EAP Response (code 2) ID 53 length 107
(68) eap: Continuing tunnel setup
(68)     [eap] = ok
(68)   } # authorize = ok
(68) Found Auth-Type = EAP
(68) # Executing group from file /etc/freeradius/sites-enabled/default
(68)   authenticate {
(68) eap: Expiring EAP session with state 0x7b662d707b533776
(68) eap: Finished EAP session with state 0xb751a265b064bb65
(68) eap: Previous EAP request found for state 0xb751a265b064bb65, released from the list
(68) eap: Peer sent packet with method EAP PEAP (25)
(68) eap: Calling submodule eap_peap to process data
(68) eap_peap: Continuing EAP-TLS
(68) eap_peap: [eaptls verify] = ok
(68) eap_peap: Done initial handshake
(68) eap_peap: [eaptls process] = ok
(68) eap_peap: Session established.  Decoding tunneled attributes
(68) eap_peap: PEAP state phase2
(68) eap_peap: EAP method MSCHAPv2 (26)
(68) eap_peap: Got tunneled request
(68) eap_peap:   EAP-Message = 0x023500421a0235003d319527ea12272710c8fd64c6387813f3da0000000000000000e104da13c98fb1573e72689c0000e734e298acf29e6d71d200656d6972757373
(68) eap_peap: Setting User-Name to emiruss
(68) eap_peap: Sending tunneled request to inner-tunnel
(68) eap_peap:   EAP-Message = 0x023500421a0235003d319527ea12272710c8fd64c6387813f3da0000000000000000e104da13c98fb1573e72689c0000e734e298acf29e6d71d200656d6972757373
(68) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(68) eap_peap:   User-Name = "emiruss"
(68) eap_peap:   State = 0x7b662d707b533776523c2fc611e5a07b
(68) Virtual server inner-tunnel received request
(68)   EAP-Message = 0x023500421a0235003d319527ea12272710c8fd64c6387813f3da0000000000000000e104da13c98fb1573e72689c0000e734e298acf29e6d71d200656d6972757373
(68)   FreeRADIUS-Proxied-To = 127.0.0.1
(68)   User-Name = "emiruss"
(68)   State = 0x7b662d707b533776523c2fc611e5a07b
(68) server inner-tunnel {
(68)   session-state: No cached attributes
(68)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(68)     authorize {
(68)       [chap] = noop
(68)       [mschap] = noop
(68) suffix: Checking for suffix after "@"
(68) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(68) suffix: No such realm "NULL"
(68)       [suffix] = noop
(68)       update control {
(68)         &Proxy-To-Realm := LOCAL
(68)       } # update control = noop
(68) eap: Peer sent EAP Response (code 2) ID 53 length 66
(68) eap: No EAP Start, assuming it's an on-going EAP conversation
(68)       [eap] = updated
(68)       [files] = noop
(68) sql: EXPAND %{User-Name}
(68) sql:    --> emiruss
(68) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Reserved connection (11)
(68) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(68) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(68) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(68) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(68) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(68) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(68) sql: User not found in any groups
rlm_sql (sql): Released connection (11)
(68)       [sql] = notfound
(68)       [expiration] = noop
(68)       [logintime] = noop
(68)       [pap] = noop
(68)     } # authorize = updated
(68)   Found Auth-Type = EAP
(68)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(68)     authenticate {
(68) eap: Expiring EAP session with state 0x7b662d707b533776
(68) eap: Finished EAP session with state 0x7b662d707b533776
(68) eap: Previous EAP request found for state 0x7b662d707b533776, released from the list
(68) eap: Peer sent packet with method EAP MSCHAPv2 (26)
(68) eap: Calling submodule eap_mschapv2 to process data
(68) eap_mschapv2: # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(68) eap_mschapv2:   Auth-Type MS-CHAP {
(68) mschap: WARNING: No Cleartext-Password configured.  Cannot create NT-Password
(68) mschap: WARNING: No Cleartext-Password configured.  Cannot create LM-Password
(68) mschap: Creating challenge hash with username: emiruss
(68) mschap: Client is using MS-CHAPv2
(68) mschap: ERROR: FAILED: No NT/LM-Password.  Cannot perform authentication
(68) mschap: ERROR: MS-CHAP2-Response is incorrect
(68)     [mschap] = reject
(68)   } # Auth-Type MS-CHAP = reject
(68) eap: Sending EAP Failure (code 4) ID 53 length 4
(68) eap: Freeing handler
(68)       [eap] = reject
(68)     } # authenticate = reject
(68)   Failed to authenticate the user
(68)   Using Post-Auth-Type Reject
(68)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(68)     Post-Auth-Type REJECT {
(68) sql: EXPAND .query
(68) sql:    --> .query
(68) sql: Using query template 'query'
rlm_sql (sql): Reserved connection (9)
(68) sql: EXPAND %{User-Name}
(68) sql:    --> emiruss
(68) sql: SQL-User-Name set to 'emiruss'
(68) sql: EXPAND INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')
(68) sql:    --> INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:34:05')
(68) sql: Executing query: INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:34:05')
(68) sql: SQL query returned: success
(68) sql: 1 record(s) updated
rlm_sql (sql): Released connection (9)
(68)       [sql] = ok
(68) attr_filter.access_reject: EXPAND %{User-Name}
(68) attr_filter.access_reject:    --> emiruss
(68) attr_filter.access_reject: Matched entry DEFAULT at line 11
(68)       [attr_filter.access_reject] = updated
(68)       update outer.session-state {
(68)         &Module-Failure-Message := &request:Module-Failure-Message -> 'mschap: FAILED: No NT/LM-Password.  Cannot perform authentication'
(68)       } # update outer.session-state = noop
(68)     } # Post-Auth-Type REJECT = updated
(68) } # server inner-tunnel
(68) Virtual server sending reply
(68)   MS-CHAP-Error = "5E=691 R=1 C=22fa17b2d021760ae69df231c8204ed0 V=3 M=Authentication failed"
(68)   EAP-Message = 0x04350004
(68)   Message-Authenticator = 0x00000000000000000000000000000000
(68) eap_peap: Got tunneled reply code 3
(68) eap_peap:   MS-CHAP-Error = "5E=691 R=1 C=22fa17b2d021760ae69df231c8204ed0 V=3 M=Authentication failed"
(68) eap_peap:   EAP-Message = 0x04350004
(68) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(68) eap_peap: Tunneled authentication was rejected
(68) eap_peap: FAILURE
(68) eap: Sending EAP Request (code 1) ID 54 length 43
(68) eap: EAP session adding &reply:State = 0xb751a265bf67bb65
(68)     [eap] = handled
(68)   } # authenticate = handled
(68) Using Post-Auth-Type Challenge
(68) Post-Auth-Type sub-section not found.  Ignoring.
(68) # Executing group from file /etc/freeradius/sites-enabled/default
(68) session-state: Saving cached attributes
(68)   Module-Failure-Message := "mschap: FAILED: No NT/LM-Password.  Cannot perform authentication"
(68) Sent Access-Challenge Id 164 from 172.17.0.4:1812 to 192.168.1.30:50044 length 0
(68)   EAP-Message = 0x0136002b19001703010020dc0aa9637f260df432fe87951900aebcd27f02476aa4dcfc261cf9de87ce52df
(68)   Message-Authenticator = 0x00000000000000000000000000000000
(68)   State = 0xb751a265bf67bb6513ebc464be04bba2
(68) Finished request
Thread 2 waiting to be assigned a request
Thread 1 got semaphore
Thread 1 handling request 69, (14 handled so far)
(69) <running>: Received Access-Request Id 165 from 192.168.1.30:50044 to 172.17.0.4:1812 length 239
(69) <running>:   User-Name = "emiruss"
(69) <running>:   NAS-IP-Address = 192.168.1.30
(69) <running>:   NAS-Identifier = "Ericsson"
(69) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(69) <running>:   NAS-Port-Type = Wireless-802.11
(69) <running>:   NAS-Port = 0
(69) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(69) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(69) <running>:   Acct-Session-Id = "003E2DE6-00000051"
(69) <running>:   Framed-MTU = 1400
(69) <running>:   EAP-Message = 0x0236002b190017030100202178441b42d2f927ec4e8ca86e9bb9784aaad91cb496421b29a78ec09c4135de
(69) <running>:   State = 0xb751a265bf67bb6513ebc464be04bba2
(69) <running>:   Message-Authenticator = 0xc59d94aeea7dc85e2561eecc3306003e
(69) <running>: session-state: Found cached attributes
(69) <running>:   Module-Failure-Message := "mschap: FAILED: No NT/LM-Password.  Cannot perform authentication"
(69) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(69) <running>:   authorize {
(69) <running>:     policy filter_username {
(69) <running>:       if (!&User-Name) {
(69) <running>:       if (!&User-Name)  -> FALSE
(69) <running>:       if (&User-Name =~ / /) {
(69) <running>:       if (&User-Name =~ / /)  -> FALSE
(69) <running>:       if (&User-Name =~ /@.*@/ ) {
(69) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(69) <running>:       if (&User-Name =~ /\.\./ ) {
(69) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(69) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(69) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(69) <running>:       if (&User-Name =~ /\.$/)  {
(69) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(69) <running>:       if (&User-Name =~ /@\./)  {
(69) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(69) <running>:     } # policy filter_username = notfound
(69)     [preprocess] = ok
(69)     [chap] = noop
(69)     [mschap] = noop
(69)     [digest] = noop
(69) suffix: Checking for suffix after "@"
(69) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(69) suffix: No such realm "NULL"
(69)     [suffix] = noop
(69) eap: Peer sent EAP Response (code 2) ID 54 length 43
(69) eap: Continuing tunnel setup
(69)     [eap] = ok
(69)   } # authorize = ok
(69) Found Auth-Type = EAP
(69) # Executing group from file /etc/freeradius/sites-enabled/default
(69)   authenticate {
(69) eap: Expiring EAP session with state 0xb751a265bf67bb65
(69) eap: Finished EAP session with state 0xb751a265bf67bb65
(69) eap: Previous EAP request found for state 0xb751a265bf67bb65, released from the list
(69) eap: Peer sent packet with method EAP PEAP (25)
(69) eap: Calling submodule eap_peap to process data
(69) eap_peap: Continuing EAP-TLS
(69) eap_peap: [eaptls verify] = ok
(69) eap_peap: Done initial handshake
(69) eap_peap: [eaptls process] = ok
(69) eap_peap: Session established.  Decoding tunneled attributes
(69) eap_peap: PEAP state send tlv failure
(69) eap_peap: Received EAP-TLV response
(69) eap_peap:   The users session was previously rejected: returning reject (again.)
(69) eap_peap:   This means you need to read the PREVIOUS messages in the debug output
(69) eap_peap:   to find out the reason why the user was rejected
(69) eap_peap:   Look for "reject" or "fail".  Those earlier messages will tell you
(69) eap_peap:   what went wrong, and how to fix the problem
(69) eap: ERROR: Failed continuing EAP PEAP (25) session.  EAP sub-module failed
(69) eap: Sending EAP Failure (code 4) ID 54 length 4
(69) eap: Failed in EAP select
(69)     [eap] = invalid
(69)   } # authenticate = invalid
(69) Failed to authenticate the user
(69) Using Post-Auth-Type Reject
(69) # Executing group from file /etc/freeradius/sites-enabled/default
(69)   Post-Auth-Type REJECT {
(69) sql: EXPAND .query
(69) sql:    --> .query
(69) sql: Using query template 'query'
rlm_sql (sql): Reserved connection (10)
(69) sql: EXPAND %{User-Name}
(69) sql:    --> emiruss
(69) sql: SQL-User-Name set to 'emiruss'
(69) sql: EXPAND INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')
(69) sql:    --> INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:34:05')
(69) sql: Executing query: INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Reject', '2015-11-25 03:34:05')
(69) sql: SQL query returned: success
(69) sql: 1 record(s) updated
rlm_sql (sql): Released connection (10)
(69)     [sql] = ok
(69) attr_filter.access_reject: EXPAND %{User-Name}
(69) attr_filter.access_reject:    --> emiruss
(69) attr_filter.access_reject: Matched entry DEFAULT at line 11
(69)     [attr_filter.access_reject] = updated
(69)     [eap] = noop
(69)     policy remove_reply_message_if_eap {
(69)       if (&reply:EAP-Message && &reply:Reply-Message) {
(69)       if (&reply:EAP-Message && &reply:Reply-Message)  -> FALSE
(69)       else {
(69)         [noop] = noop
(69)       } # else = noop
(69)     } # policy remove_reply_message_if_eap = noop
(69)   } # Post-Auth-Type REJECT = updated
(69) Delaying response for 1.000000 seconds
Thread 1 waiting to be assigned a request
(69) Discarding duplicate request from client roocell-ap port 50044 - ID: 165 due to delayed response
Waking up in 0.6 seconds.
(69) Sending delayed response
(69) Sent Access-Reject Id 165 from 172.17.0.4:1812 to 192.168.1.30:50044 length 44
(69)   EAP-Message = 0x04360004
(69)   Message-Authenticator = 0x00000000000000000000000000000000
Waking up in 3.7 seconds.
(60) Cleaning up request packet ID 156 with timestamp +1280
(61) Cleaning up request packet ID 157 with timestamp +1280
(62) Cleaning up request packet ID 158 with timestamp +1280
(63) Cleaning up request packet ID 159 with timestamp +1280
(64) Cleaning up request packet ID 160 with timestamp +1280
(65) Cleaning up request packet ID 161 with timestamp +1280
(66) Cleaning up request packet ID 162 with timestamp +1280
(67) Cleaning up request packet ID 163 with timestamp +1280
(68) Cleaning up request packet ID 164 with timestamp +1280
(69) Cleaning up request packet ID 165 with timestamp +1280
Ready to process requests
main {
	name = "freeradius"
	prefix = "/usr"
	localstatedir = "/var"
	sbindir = "/usr/sbin"
	logdir = "/var/log/freeradius"
	run_dir = "/var/run/freeradius"
	libdir = "/usr/lib/freeradius"
	radacctdir = "/var/log/freeradius/radacct"
	hostname_lookups = no
	max_request_time = 30
	cleanup_delay = 5
	max_requests = 16384
	pidfile = "/var/run/freeradius/freeradius.pid"
	checkrad = "/usr/sbin/checkrad"
	debug_level = 0
	proxy_requests = yes
 log {
 	stripped_names = no
 	auth = no
 	auth_badpass = no
 	auth_goodpass = no
 	colourise = yes
 	msg_denied = "You are already logged in - access denied"
 }
 resources {
 }
 security {
 	max_attributes = 200
 	reject_delay = 1.000000
 	status_server = yes
 }
}
radiusd: #### Loading Realms and Home Servers ####
 proxy server {
 	retry_delay = 5
 	retry_count = 3
 	default_fallback = no
 	dead_time = 120
 	wake_all_if_all_dead = no
 }
 home_server localhost {
 	ipaddr = 127.0.0.1
 	port = 1812
 	type = "auth"
 	secret = <<< secret >>>
 	response_window = 20.000000
 	response_timeouts = 1
 	max_outstanding = 65536
 	zombie_period = 40
 	status_check = "status-server"
 	ping_interval = 30
 	check_interval = 30
 	check_timeout = 4
 	num_answers_to_alive = 3
 	revive_interval = 120
  limit {
  	max_connections = 16
  	max_requests = 0
  	lifetime = 0
  	idle_timeout = 0
  }
  coa {
  	irt = 2
  	mrt = 16
  	mrc = 5
  	mrd = 30
  }
 }
 home_server_pool my_auth_failover {
	type = fail-over
	home_server = localhost
 }
 realm example.com {
	auth_pool = my_auth_failover
 }
 realm LOCAL {
 }
radiusd: #### Loading Clients ####
 client localhost {
 	ipaddr = 127.0.0.1
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	nas_type = "other"
 	proto = "*"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client localhost_ipv6 {
 	ipv6addr = ::1
 	require_message_authenticator = no
 	secret = <<< secret >>>
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client 192.168.1.0/24 {
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	shortname = "roocell-ap"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
No 'ipaddr' or 'ipv4addr' or 'ipv6addr' field found in client 192.168.1.0/24. Please fix your configuration
Support for old-style clients will be removed in a future release
Debug state unknown (cap_sys_ptrace capability not set)
 # Creating Auth-Type = digest
radiusd: #### Instantiating modules ####
  # Loaded module rlm_always
  # Loading module "reject" from file /etc/freeradius/mods-enabled/always
  always reject {
  	rcode = "reject"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "fail" from file /etc/freeradius/mods-enabled/always
  always fail {
  	rcode = "fail"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "ok" from file /etc/freeradius/mods-enabled/always
  always ok {
  	rcode = "ok"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "handled" from file /etc/freeradius/mods-enabled/always
  always handled {
  	rcode = "handled"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "invalid" from file /etc/freeradius/mods-enabled/always
  always invalid {
  	rcode = "invalid"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "userlock" from file /etc/freeradius/mods-enabled/always
  always userlock {
  	rcode = "userlock"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "notfound" from file /etc/freeradius/mods-enabled/always
  always notfound {
  	rcode = "notfound"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "noop" from file /etc/freeradius/mods-enabled/always
  always noop {
  	rcode = "noop"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "updated" from file /etc/freeradius/mods-enabled/always
  always updated {
  	rcode = "updated"
  	simulcount = 0
  	mpp = no
  }
  # Loaded module rlm_attr_filter
  # Loading module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.post-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/post-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.pre-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/pre-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_reject {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_reject"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_challenge {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_challenge"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.accounting_response {
  	filename = "/etc/freeradius/mods-config/attr_filter/accounting_response"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loaded module rlm_cache
  # Loading module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
  cache cache_eap {
  	driver = "rlm_cache_rbtree"
  	key = "%{%{control:State}:-%{%{reply:State}:-%{State}}}"
  	ttl = 15
  	max_entries = 0
  	epoch = 0
  	add_stats = no
  }
  # Loaded module rlm_chap
  # Loading module "chap" from file /etc/freeradius/mods-enabled/chap
  # Loaded module rlm_detail
  # Loading module "detail" from file /etc/freeradius/mods-enabled/detail
  detail {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
  detail auth_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/auth-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  detail reply_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/reply-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail pre_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/pre-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail post_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/post-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loaded module rlm_digest
  # Loading module "digest" from file /etc/freeradius/mods-enabled/digest
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_eap
  # Loading module "eap" from file /etc/freeradius/mods-enabled/eap
  eap {
  	default_eap_type = "md5"
  	timer_expire = 60
  	ignore_unknown_eap_types = no
  	cisco_accounting_username_bug = no
  	max_sessions = 16384
  }
  # Loaded module rlm_exec
  # Loading module "echo" from file /etc/freeradius/mods-enabled/echo
  exec echo {
  	wait = yes
  	program = "/bin/echo %{User-Name}"
  	input_pairs = "request"
  	output_pairs = "reply"
  	shell_escape = yes
  }
  # Loading module "exec" from file /etc/freeradius/mods-enabled/exec
  exec {
  	wait = no
  	input_pairs = "request"
  	shell_escape = yes
  	timeout = 10
  }
  # Loaded module rlm_expiration
  # Loading module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Loaded module rlm_expr
  # Loading module "expr" from file /etc/freeradius/mods-enabled/expr
  expr {
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /äéöüàâæçèéêëîïôœùûüaÿÄÉÖÜßÀÂÆÇÈÉÊËÎÏÔŒÙÛÜŸ"
  }
  # Loaded module rlm_files
  # Loading module "files" from file /etc/freeradius/mods-enabled/files
  files {
  	filename = "/etc/freeradius/mods-config/files/authorize"
  	acctusersfile = "/etc/freeradius/mods-config/files/accounting"
  	preproxy_usersfile = "/etc/freeradius/mods-config/files/pre-proxy"
  }
  # Loaded module rlm_linelog
  # Loading module "linelog" from file /etc/freeradius/mods-enabled/linelog
  linelog {
  	filename = "/var/log/freeradius/linelog"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = "This is a log message for %{User-Name}"
  	reference = "messages.%{%{reply:Packet-Type}:-default}"
  }
  # Loading module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  linelog log_accounting {
  	filename = "/var/log/freeradius/linelog-accounting"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = ""
  	reference = "Accounting-Request.%{%{Acct-Status-Type}:-unknown}"
  }
  # Loaded module rlm_logintime
  # Loading module "logintime" from file /etc/freeradius/mods-enabled/logintime
  logintime {
  	minimum_timeout = 60
  }
  # Loaded module rlm_mschap
  # Loading module "mschap" from file /etc/freeradius/mods-enabled/mschap
  mschap {
  	use_mppe = yes
  	require_encryption = no
  	require_strong = no
  	with_ntdomain_hack = yes
   passchange {
   }
  	allow_retry = yes
  }
  # Loading module "ntlm_auth" from file /etc/freeradius/mods-enabled/ntlm_auth
  exec ntlm_auth {
  	wait = yes
  	program = "/path/to/ntlm_auth --request-nt-key --domain=MYDOMAIN --username=%{mschap:User-Name} --password=%{User-Password}"
  	shell_escape = yes
  }
  # Loaded module rlm_pap
  # Loading module "pap" from file /etc/freeradius/mods-enabled/pap
  pap {
  	normalise = yes
  }
  # Loaded module rlm_passwd
  # Loading module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
  passwd etc_passwd {
  	filename = "/etc/passwd"
  	format = "*User-Name:Crypt-Password:"
  	delimiter = ":"
  	ignore_nislike = no
  	ignore_empty = yes
  	allow_multiple_keys = no
  	hash_size = 100
  }
  # Loaded module rlm_preprocess
  # Loading module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
  preprocess {
  	huntgroups = "/etc/freeradius/mods-config/preprocess/huntgroups"
  	hints = "/etc/freeradius/mods-config/preprocess/hints"
  	with_ascend_hack = no
  	ascend_channels_per_line = 23
  	with_ntdomain_hack = no
  	with_specialix_jetstream_hack = no
  	with_cisco_vsa_hack = no
  	with_alvarion_vsa_hack = no
  }
  # Loaded module rlm_radutmp
  # Loading module "radutmp" from file /etc/freeradius/mods-enabled/radutmp
  radutmp {
  	filename = "/var/log/freeradius/radutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 384
  	caller_id = yes
  }
  # Loaded module rlm_realm
  # Loading module "IPASS" from file /etc/freeradius/mods-enabled/realm
  realm IPASS {
  	format = "prefix"
  	delimiter = "/"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "suffix" from file /etc/freeradius/mods-enabled/realm
  realm suffix {
  	format = "suffix"
  	delimiter = "@"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  realm realmpercent {
  	format = "suffix"
  	delimiter = "%"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "ntdomain" from file /etc/freeradius/mods-enabled/realm
  realm ntdomain {
  	format = "prefix"
  	delimiter = "\\"
  	ignore_default = no
  	ignore_null = no
  }
  # Loaded module rlm_replicate
  # Loading module "replicate" from file /etc/freeradius/mods-enabled/replicate
  # Loaded module rlm_soh
  # Loading module "soh" from file /etc/freeradius/mods-enabled/soh
  soh {
  	dhcp = yes
  }
  # Loaded module rlm_sql
  # Loading module "sql" from file /etc/freeradius/mods-enabled/sql
  sql {
  	driver = "rlm_sql_mysql"
  	server = "172.17.0.2"
  	port = 3306
  	login = "radius"
  	password = <<< secret >>>
  	radius_db = "radius"
  	read_groups = yes
  	read_profiles = yes
  	read_clients = no
  	delete_stale_sessions = yes
  	sql_user_name = "%{User-Name}"
  	default_user_profile = ""
  	client_query = "SELECT id, nasname, shortname, type, secret, server FROM nas"
  	authorize_check_query = "SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id"
  	authorize_reply_query = "SELECT id, username, attribute, value, op FROM radreply WHERE username = '%{SQL-User-Name}' ORDER BY id"
  	authorize_group_check_query = "SELECT id, groupname, attribute, Value, op FROM radgroupcheck WHERE groupname = '%{SQL-Group}' ORDER BY id"
  	authorize_group_reply_query = "SELECT id, groupname, attribute, value, op FROM radgroupreply WHERE groupname = '%{SQL-Group}' ORDER BY id"
  	group_membership_query = "SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority"
  	simul_verify_query = "SELECT radacctid, acctsessionid, username, nasipaddress, nasportid, framedipaddress, callingstationid, framedprotocol FROM radacct WHERE username = '%{SQL-Group}' AND acctstoptime IS NULL"
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /"
   accounting {
   	reference = "%{tolower:type.%{Acct-Status-Type}.query}"
    type {
     accounting-on {
     	query = "UPDATE radacct SET acctstoptime = %{%{integer:Event-Timestamp}:-date('now')}, acctsessiontime	= (%{%{integer:Event-Timestamp}:-strftime('%%s', 'now')} - strftime('%%s', acctstarttime)), acctterminatecause = '%{Acct-Terminate-Cause}' WHERE acctstoptime IS NULL AND nasipaddress   = '%{NAS-IP-Address}' AND acctstarttime <= %{integer:Event-Timestamp}"
     }
     accounting-off {
     	query = "UPDATE radacct SET acctstoptime = %{%{integer:Event-Timestamp}:-date('now')}, acctsessiontime	= (%{%{integer:Event-Timestamp}:-strftime('%%s', 'now')} - strftime('%%s', acctstarttime)), acctterminatecause = '%{Acct-Terminate-Cause}' WHERE acctstoptime IS NULL AND nasipaddress   = '%{NAS-IP-Address}' AND acctstarttime <= %{integer:Event-Timestamp}"
     }
     start {
     	query = "INSERT INTO radacct (acctsessionid, acctuniqueid, username, realm, nasipaddress, nasportid, nasporttype, acctstarttime, acctupdatetime, acctstoptime, acctsessiontime, acctauthentic, connectinfo_start, connectinfo_stop, acctinputoctets, acctoutputoctets, calledstationid, callingstationid, acctterminatecause, servicetype, framedprotocol, framedipaddress) VALUES ('%{Acct-Session-Id}', '%{Acct-Unique-Session-Id}', '%{SQL-User-Name}', '%{Realm}', '%{NAS-IP-Address}', '%{%{NAS-Port-ID}:-%{NAS-Port}}', '%{NAS-Port-Type}', %{%{integer:Event-Timestamp}:-date('now')}, %{%{integer:Event-Timestamp}:-date('now')}, NULL, '0', '%{Acct-Authentic}', '%{Connect-Info}', '', '0', '0', '%{Called-Station-Id}', '%{Calling-Station-Id}', '', '%{Service-Type}', '%{Framed-Protocol}', '%{Framed-IP-Address}')"
     }
     interim-update {
     	query = "UPDATE radacct SET acctupdatetime  = %{%{integer:Event-Timestamp}:-date('now')}, acctinterval    = 0, framedipaddress = '%{Framed-IP-Address}', acctsessiontime = %{%{Acct-Session-Time}:-NULL}, acctinputoctets = %{%{Acct-Input-Gigawords}:-0} << 32 | %{%{Acct-Input-Octets}:-0}, acctoutputoctets = %{%{Acct-Output-Gigawords}:-0} << 32 | %{%{Acct-Output-Octets}:-0} WHERE AcctUniqueId = '%{Acct-Unique-Session-Id}'"
     }
     stop {
     	query = "UPDATE radacct SET acctstoptime	= %{%{integer:Event-Timestamp}:-date('now')}, acctsessiontime	= %{%{Acct-Session-Time}:-NULL}, acctinputoctets	= %{%{Acct-Input-Gigawords}:-0} << 32 | %{%{Acct-Input-Octets}:-0}, acctoutputoctets = %{%{Acct-Output-Gigawords}:-0} << 32 | %{%{Acct-Output-Octets}:-0}, acctterminatecause = '%{Acct-Terminate-Cause}', connectinfo_stop = '%{Connect-Info}' WHERE AcctUniqueId = '%{Acct-Unique-Session-Id}'"
     }
    }
   }
   post-auth {
   	reference = ".query"
   	query = "INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')"
   }
  }
rlm_sql (sql): Driver rlm_sql_mysql (module rlm_sql_mysql) loaded and linked
Creating attribute SQL-Group
  # Loading module "sradutmp" from file /etc/freeradius/mods-enabled/sradutmp
  radutmp sradutmp {
  	filename = "/var/log/freeradius/sradutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 420
  	caller_id = no
  }
  # Loaded module rlm_unix
  # Loading module "unix" from file /etc/freeradius/mods-enabled/unix
  unix {
  	radwtmp = "/var/log/freeradius/radwtmp"
  }
Creating attribute Unix-Group
  # Loaded module rlm_unpack
  # Loading module "unpack" from file /etc/freeradius/mods-enabled/unpack
  # Loaded module rlm_utf8
  # Loading module "utf8" from file /etc/freeradius/mods-enabled/utf8
 instantiate {
 }
 modules {
  # Instantiating module "reject" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "fail" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "ok" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "handled" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "invalid" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "userlock" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "notfound" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "noop" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "updated" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/post-proxy
  # Instantiating module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/pre-proxy
  # Instantiating module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_reject
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay" 	found in filter list for realm "DEFAULT". 
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay-USec" 	found in filter list for realm "DEFAULT". 
  # Instantiating module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_challenge
  # Instantiating module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/accounting_response
  # Instantiating module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
rlm_cache (cache_eap): Driver rlm_cache_rbtree (module rlm_cache_rbtree) loaded and linked
  # Instantiating module "detail" from file /etc/freeradius/mods-enabled/detail
  # Instantiating module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
rlm_detail (auth_log): 'User-Password' suppressed, will not appear in detail output
  # Instantiating module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "eap" from file /etc/freeradius/mods-enabled/eap
   # Linked to sub-module rlm_eap_md5
   # Linked to sub-module rlm_eap_leap
   # Linked to sub-module rlm_eap_gtc
   gtc {
   	challenge = "Password: "
   	auth_type = "PAP"
   }
   # Linked to sub-module rlm_eap_tls
   tls {
   	tls = "tls-common"
   }
   tls-config tls-common {
   	rsa_key_exchange = no
   	dh_key_exchange = yes
   	rsa_key_length = 512
   	dh_key_length = 512
   	verify_depth = 0
   	ca_path = "/etc/freeradius/certs"
   	pem_file_type = yes
   	private_key_file = "/etc/freeradius/certs/server.pem"
   	certificate_file = "/etc/freeradius/certs/server.pem"
   	ca_file = "/etc/freeradius/certs/ca.pem"
   	private_key_password = <<< secret >>>
   	dh_file = "/etc/freeradius/certs/dh"
   	fragment_size = 1024
   	include_length = yes
   	check_crl = no
   	check_all_crl = no
   	cipher_list = "DEFAULT"
   	ecdh_curve = "prime256v1"
    cache {
    	enable = yes
    	lifetime = 24
    	max_entries = 255
    }
    verify {
    }
    ocsp {
    	enable = no
    	override_cert_url = yes
    	url = "http://127.0.0.1/ocsp/"
    	use_nonce = yes
    	timeout = 0
    	softfail = no
    }
   }
   # Linked to sub-module rlm_eap_ttls
   ttls {
   	tls = "tls-common"
   	default_eap_type = "md5"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	virtual_server = "inner-tunnel"
   	include_length = yes
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_peap
   peap {
   	tls = "tls-common"
   	default_eap_type = "mschapv2"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	proxy_tunneled_request_as_eap = yes
   	virtual_server = "inner-tunnel"
   	soh = no
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_mschapv2
   mschapv2 {
   	with_ntdomain_hack = no
   	send_error = no
   }
  # Instantiating module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Instantiating module "files" from file /etc/freeradius/mods-enabled/files
reading pairlist file /etc/freeradius/mods-config/files/authorize
reading pairlist file /etc/freeradius/mods-config/files/accounting
reading pairlist file /etc/freeradius/mods-config/files/pre-proxy
  # Instantiating module "linelog" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "logintime" from file /etc/freeradius/mods-enabled/logintime
  # Instantiating module "mschap" from file /etc/freeradius/mods-enabled/mschap
rlm_mschap (mschap): using internal authentication
  # Instantiating module "pap" from file /etc/freeradius/mods-enabled/pap
  # Instantiating module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
rlm_passwd: nfields: 3 keyfield 0(User-Name) listable: no
  # Instantiating module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
reading pairlist file /etc/freeradius/mods-config/preprocess/huntgroups
reading pairlist file /etc/freeradius/mods-config/preprocess/hints
  # Instantiating module "IPASS" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "suffix" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "ntdomain" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "sql" from file /etc/freeradius/mods-enabled/sql
rlm_sql_mysql: libmysql version: 5.5.46
   mysql {
    tls {
    }
   	warnings = "auto"
   }
rlm_sql (sql): Attempting to connect to database "radius"
rlm_sql (sql): Initialising connection pool
   pool {
   	start = 5
   	min = 3
   	max = 32
   	spare = 10
   	uses = 0
   	lifetime = 0
   	cleanup_interval = 30
   	idle_timeout = 60
   	retry_delay = 30
   	spread = no
   }
rlm_sql (sql): Opening additional connection (0), 1 of 32 pending slots used
rlm_sql_mysql: Starting connect to MySQL server
rlm_sql_mysql: Couldn't connect to MySQL server radius@172.17.0.2:radius
rlm_sql_mysql: MySQL error: Access denied for user 'radius'@'172.17.0.4' (using password: YES)
rlm_sql_mysql: Socket destructor called, closing socket
rlm_sql (sql): Opening connection failed (0)
rlm_sql (sql): Removing connection pool
/etc/freeradius/mods-enabled/sql[20]: Instantiation failed for module "sql"
main {
	name = "freeradius"
	prefix = "/usr"
	localstatedir = "/var"
	sbindir = "/usr/sbin"
	logdir = "/var/log/freeradius"
	run_dir = "/var/run/freeradius"
	libdir = "/usr/lib/freeradius"
	radacctdir = "/var/log/freeradius/radacct"
	hostname_lookups = no
	max_request_time = 30
	cleanup_delay = 5
	max_requests = 16384
	pidfile = "/var/run/freeradius/freeradius.pid"
	checkrad = "/usr/sbin/checkrad"
	debug_level = 0
	proxy_requests = yes
 log {
 	stripped_names = no
 	auth = no
 	auth_badpass = no
 	auth_goodpass = no
 	colourise = yes
 	msg_denied = "You are already logged in - access denied"
 }
 resources {
 }
 security {
 	max_attributes = 200
 	reject_delay = 1.000000
 	status_server = yes
 }
}
radiusd: #### Loading Realms and Home Servers ####
 proxy server {
 	retry_delay = 5
 	retry_count = 3
 	default_fallback = no
 	dead_time = 120
 	wake_all_if_all_dead = no
 }
 home_server localhost {
 	ipaddr = 127.0.0.1
 	port = 1812
 	type = "auth"
 	secret = <<< secret >>>
 	response_window = 20.000000
 	response_timeouts = 1
 	max_outstanding = 65536
 	zombie_period = 40
 	status_check = "status-server"
 	ping_interval = 30
 	check_interval = 30
 	check_timeout = 4
 	num_answers_to_alive = 3
 	revive_interval = 120
  limit {
  	max_connections = 16
  	max_requests = 0
  	lifetime = 0
  	idle_timeout = 0
  }
  coa {
  	irt = 2
  	mrt = 16
  	mrc = 5
  	mrd = 30
  }
 }
 home_server_pool my_auth_failover {
	type = fail-over
	home_server = localhost
 }
 realm example.com {
	auth_pool = my_auth_failover
 }
 realm LOCAL {
 }
radiusd: #### Loading Clients ####
 client localhost {
 	ipaddr = 127.0.0.1
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	nas_type = "other"
 	proto = "*"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client localhost_ipv6 {
 	ipv6addr = ::1
 	require_message_authenticator = no
 	secret = <<< secret >>>
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client 192.168.1.0/24 {
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	shortname = "roocell-ap"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
No 'ipaddr' or 'ipv4addr' or 'ipv6addr' field found in client 192.168.1.0/24. Please fix your configuration
Support for old-style clients will be removed in a future release
Debug state unknown (cap_sys_ptrace capability not set)
 # Creating Auth-Type = digest
radiusd: #### Instantiating modules ####
  # Loaded module rlm_always
  # Loading module "reject" from file /etc/freeradius/mods-enabled/always
  always reject {
  	rcode = "reject"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "fail" from file /etc/freeradius/mods-enabled/always
  always fail {
  	rcode = "fail"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "ok" from file /etc/freeradius/mods-enabled/always
  always ok {
  	rcode = "ok"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "handled" from file /etc/freeradius/mods-enabled/always
  always handled {
  	rcode = "handled"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "invalid" from file /etc/freeradius/mods-enabled/always
  always invalid {
  	rcode = "invalid"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "userlock" from file /etc/freeradius/mods-enabled/always
  always userlock {
  	rcode = "userlock"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "notfound" from file /etc/freeradius/mods-enabled/always
  always notfound {
  	rcode = "notfound"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "noop" from file /etc/freeradius/mods-enabled/always
  always noop {
  	rcode = "noop"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "updated" from file /etc/freeradius/mods-enabled/always
  always updated {
  	rcode = "updated"
  	simulcount = 0
  	mpp = no
  }
  # Loaded module rlm_attr_filter
  # Loading module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.post-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/post-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.pre-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/pre-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_reject {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_reject"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_challenge {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_challenge"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.accounting_response {
  	filename = "/etc/freeradius/mods-config/attr_filter/accounting_response"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loaded module rlm_cache
  # Loading module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
  cache cache_eap {
  	driver = "rlm_cache_rbtree"
  	key = "%{%{control:State}:-%{%{reply:State}:-%{State}}}"
  	ttl = 15
  	max_entries = 0
  	epoch = 0
  	add_stats = no
  }
  # Loaded module rlm_chap
  # Loading module "chap" from file /etc/freeradius/mods-enabled/chap
  # Loaded module rlm_detail
  # Loading module "detail" from file /etc/freeradius/mods-enabled/detail
  detail {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
  detail auth_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/auth-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  detail reply_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/reply-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail pre_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/pre-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail post_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/post-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loaded module rlm_digest
  # Loading module "digest" from file /etc/freeradius/mods-enabled/digest
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_eap
  # Loading module "eap" from file /etc/freeradius/mods-enabled/eap
  eap {
  	default_eap_type = "md5"
  	timer_expire = 60
  	ignore_unknown_eap_types = no
  	cisco_accounting_username_bug = no
  	max_sessions = 16384
  }
  # Loaded module rlm_exec
  # Loading module "echo" from file /etc/freeradius/mods-enabled/echo
  exec echo {
  	wait = yes
  	program = "/bin/echo %{User-Name}"
  	input_pairs = "request"
  	output_pairs = "reply"
  	shell_escape = yes
  }
  # Loading module "exec" from file /etc/freeradius/mods-enabled/exec
  exec {
  	wait = no
  	input_pairs = "request"
  	shell_escape = yes
  	timeout = 10
  }
  # Loaded module rlm_expiration
  # Loading module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Loaded module rlm_expr
  # Loading module "expr" from file /etc/freeradius/mods-enabled/expr
  expr {
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /äéöüàâæçèéêëîïôœùûüaÿÄÉÖÜßÀÂÆÇÈÉÊËÎÏÔŒÙÛÜŸ"
  }
  # Loaded module rlm_files
  # Loading module "files" from file /etc/freeradius/mods-enabled/files
  files {
  	filename = "/etc/freeradius/mods-config/files/authorize"
  	acctusersfile = "/etc/freeradius/mods-config/files/accounting"
  	preproxy_usersfile = "/etc/freeradius/mods-config/files/pre-proxy"
  }
  # Loaded module rlm_linelog
  # Loading module "linelog" from file /etc/freeradius/mods-enabled/linelog
  linelog {
  	filename = "/var/log/freeradius/linelog"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = "This is a log message for %{User-Name}"
  	reference = "messages.%{%{reply:Packet-Type}:-default}"
  }
  # Loading module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  linelog log_accounting {
  	filename = "/var/log/freeradius/linelog-accounting"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = ""
  	reference = "Accounting-Request.%{%{Acct-Status-Type}:-unknown}"
  }
  # Loaded module rlm_logintime
  # Loading module "logintime" from file /etc/freeradius/mods-enabled/logintime
  logintime {
  	minimum_timeout = 60
  }
  # Loaded module rlm_mschap
  # Loading module "mschap" from file /etc/freeradius/mods-enabled/mschap
  mschap {
  	use_mppe = yes
  	require_encryption = no
  	require_strong = no
  	with_ntdomain_hack = yes
   passchange {
   }
  	allow_retry = yes
  }
  # Loading module "ntlm_auth" from file /etc/freeradius/mods-enabled/ntlm_auth
  exec ntlm_auth {
  	wait = yes
  	program = "/path/to/ntlm_auth --request-nt-key --domain=MYDOMAIN --username=%{mschap:User-Name} --password=%{User-Password}"
  	shell_escape = yes
  }
  # Loaded module rlm_pap
  # Loading module "pap" from file /etc/freeradius/mods-enabled/pap
  pap {
  	normalise = yes
  }
  # Loaded module rlm_passwd
  # Loading module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
  passwd etc_passwd {
  	filename = "/etc/passwd"
  	format = "*User-Name:Crypt-Password:"
  	delimiter = ":"
  	ignore_nislike = no
  	ignore_empty = yes
  	allow_multiple_keys = no
  	hash_size = 100
  }
  # Loaded module rlm_preprocess
  # Loading module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
  preprocess {
  	huntgroups = "/etc/freeradius/mods-config/preprocess/huntgroups"
  	hints = "/etc/freeradius/mods-config/preprocess/hints"
  	with_ascend_hack = no
  	ascend_channels_per_line = 23
  	with_ntdomain_hack = no
  	with_specialix_jetstream_hack = no
  	with_cisco_vsa_hack = no
  	with_alvarion_vsa_hack = no
  }
  # Loaded module rlm_radutmp
  # Loading module "radutmp" from file /etc/freeradius/mods-enabled/radutmp
  radutmp {
  	filename = "/var/log/freeradius/radutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 384
  	caller_id = yes
  }
  # Loaded module rlm_realm
  # Loading module "IPASS" from file /etc/freeradius/mods-enabled/realm
  realm IPASS {
  	format = "prefix"
  	delimiter = "/"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "suffix" from file /etc/freeradius/mods-enabled/realm
  realm suffix {
  	format = "suffix"
  	delimiter = "@"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  realm realmpercent {
  	format = "suffix"
  	delimiter = "%"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "ntdomain" from file /etc/freeradius/mods-enabled/realm
  realm ntdomain {
  	format = "prefix"
  	delimiter = "\\"
  	ignore_default = no
  	ignore_null = no
  }
  # Loaded module rlm_replicate
  # Loading module "replicate" from file /etc/freeradius/mods-enabled/replicate
  # Loaded module rlm_soh
  # Loading module "soh" from file /etc/freeradius/mods-enabled/soh
  soh {
  	dhcp = yes
  }
  # Loaded module rlm_sql
  # Loading module "sql" from file /etc/freeradius/mods-enabled/sql
  sql {
  	driver = "rlm_sql_mysql"
  	server = "172.17.0.2"
  	port = 3306
  	login = "radius"
  	password = <<< secret >>>
  	radius_db = "radius"
  	read_groups = yes
  	read_profiles = yes
  	read_clients = no
  	delete_stale_sessions = yes
  	sql_user_name = "%{User-Name}"
  	default_user_profile = ""
  	client_query = "SELECT id, nasname, shortname, type, secret, server FROM nas"
  	authorize_check_query = "SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id"
  	authorize_reply_query = "SELECT id, username, attribute, value, op FROM radreply WHERE username = '%{SQL-User-Name}' ORDER BY id"
  	authorize_group_check_query = "SELECT id, groupname, attribute, Value, op FROM radgroupcheck WHERE groupname = '%{SQL-Group}' ORDER BY id"
  	authorize_group_reply_query = "SELECT id, groupname, attribute, value, op FROM radgroupreply WHERE groupname = '%{SQL-Group}' ORDER BY id"
  	group_membership_query = "SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority"
  	simul_verify_query = "SELECT radacctid, acctsessionid, username, nasipaddress, nasportid, framedipaddress, callingstationid, framedprotocol FROM radacct WHERE username = '%{SQL-Group}' AND acctstoptime IS NULL"
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /"
   accounting {
   	reference = "%{tolower:type.%{Acct-Status-Type}.query}"
    type {
     accounting-on {
     	query = "UPDATE radacct SET acctstoptime = %{%{integer:Event-Timestamp}:-date('now')}, acctsessiontime	= (%{%{integer:Event-Timestamp}:-strftime('%%s', 'now')} - strftime('%%s', acctstarttime)), acctterminatecause = '%{Acct-Terminate-Cause}' WHERE acctstoptime IS NULL AND nasipaddress   = '%{NAS-IP-Address}' AND acctstarttime <= %{integer:Event-Timestamp}"
     }
     accounting-off {
     	query = "UPDATE radacct SET acctstoptime = %{%{integer:Event-Timestamp}:-date('now')}, acctsessiontime	= (%{%{integer:Event-Timestamp}:-strftime('%%s', 'now')} - strftime('%%s', acctstarttime)), acctterminatecause = '%{Acct-Terminate-Cause}' WHERE acctstoptime IS NULL AND nasipaddress   = '%{NAS-IP-Address}' AND acctstarttime <= %{integer:Event-Timestamp}"
     }
     start {
     	query = "INSERT INTO radacct (acctsessionid, acctuniqueid, username, realm, nasipaddress, nasportid, nasporttype, acctstarttime, acctupdatetime, acctstoptime, acctsessiontime, acctauthentic, connectinfo_start, connectinfo_stop, acctinputoctets, acctoutputoctets, calledstationid, callingstationid, acctterminatecause, servicetype, framedprotocol, framedipaddress) VALUES ('%{Acct-Session-Id}', '%{Acct-Unique-Session-Id}', '%{SQL-User-Name}', '%{Realm}', '%{NAS-IP-Address}', '%{%{NAS-Port-ID}:-%{NAS-Port}}', '%{NAS-Port-Type}', %{%{integer:Event-Timestamp}:-date('now')}, %{%{integer:Event-Timestamp}:-date('now')}, NULL, '0', '%{Acct-Authentic}', '%{Connect-Info}', '', '0', '0', '%{Called-Station-Id}', '%{Calling-Station-Id}', '', '%{Service-Type}', '%{Framed-Protocol}', '%{Framed-IP-Address}')"
     }
     interim-update {
     	query = "UPDATE radacct SET acctupdatetime  = %{%{integer:Event-Timestamp}:-date('now')}, acctinterval    = 0, framedipaddress = '%{Framed-IP-Address}', acctsessiontime = %{%{Acct-Session-Time}:-NULL}, acctinputoctets = %{%{Acct-Input-Gigawords}:-0} << 32 | %{%{Acct-Input-Octets}:-0}, acctoutputoctets = %{%{Acct-Output-Gigawords}:-0} << 32 | %{%{Acct-Output-Octets}:-0} WHERE AcctUniqueId = '%{Acct-Unique-Session-Id}'"
     }
     stop {
     	query = "UPDATE radacct SET acctstoptime	= %{%{integer:Event-Timestamp}:-date('now')}, acctsessiontime	= %{%{Acct-Session-Time}:-NULL}, acctinputoctets	= %{%{Acct-Input-Gigawords}:-0} << 32 | %{%{Acct-Input-Octets}:-0}, acctoutputoctets = %{%{Acct-Output-Gigawords}:-0} << 32 | %{%{Acct-Output-Octets}:-0}, acctterminatecause = '%{Acct-Terminate-Cause}', connectinfo_stop = '%{Connect-Info}' WHERE AcctUniqueId = '%{Acct-Unique-Session-Id}'"
     }
    }
   }
   post-auth {
   	reference = ".query"
   	query = "INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')"
   }
  }
rlm_sql (sql): Driver rlm_sql_mysql (module rlm_sql_mysql) loaded and linked
Creating attribute SQL-Group
  # Loading module "sradutmp" from file /etc/freeradius/mods-enabled/sradutmp
  radutmp sradutmp {
  	filename = "/var/log/freeradius/sradutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 420
  	caller_id = no
  }
  # Loaded module rlm_unix
  # Loading module "unix" from file /etc/freeradius/mods-enabled/unix
  unix {
  	radwtmp = "/var/log/freeradius/radwtmp"
  }
Creating attribute Unix-Group
  # Loaded module rlm_unpack
  # Loading module "unpack" from file /etc/freeradius/mods-enabled/unpack
  # Loaded module rlm_utf8
  # Loading module "utf8" from file /etc/freeradius/mods-enabled/utf8
 instantiate {
 }
 modules {
  # Instantiating module "reject" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "fail" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "ok" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "handled" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "invalid" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "userlock" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "notfound" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "noop" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "updated" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/post-proxy
  # Instantiating module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/pre-proxy
  # Instantiating module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_reject
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay" 	found in filter list for realm "DEFAULT". 
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay-USec" 	found in filter list for realm "DEFAULT". 
  # Instantiating module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_challenge
  # Instantiating module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/accounting_response
  # Instantiating module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
rlm_cache (cache_eap): Driver rlm_cache_rbtree (module rlm_cache_rbtree) loaded and linked
  # Instantiating module "detail" from file /etc/freeradius/mods-enabled/detail
  # Instantiating module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
rlm_detail (auth_log): 'User-Password' suppressed, will not appear in detail output
  # Instantiating module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "eap" from file /etc/freeradius/mods-enabled/eap
   # Linked to sub-module rlm_eap_md5
   # Linked to sub-module rlm_eap_leap
   # Linked to sub-module rlm_eap_gtc
   gtc {
   	challenge = "Password: "
   	auth_type = "PAP"
   }
   # Linked to sub-module rlm_eap_tls
   tls {
   	tls = "tls-common"
   }
   tls-config tls-common {
   	rsa_key_exchange = no
   	dh_key_exchange = yes
   	rsa_key_length = 512
   	dh_key_length = 512
   	verify_depth = 0
   	ca_path = "/etc/freeradius/certs"
   	pem_file_type = yes
   	private_key_file = "/etc/freeradius/certs/server.pem"
   	certificate_file = "/etc/freeradius/certs/server.pem"
   	ca_file = "/etc/freeradius/certs/ca.pem"
   	private_key_password = <<< secret >>>
   	dh_file = "/etc/freeradius/certs/dh"
   	fragment_size = 1024
   	include_length = yes
   	check_crl = no
   	check_all_crl = no
   	cipher_list = "DEFAULT"
   	ecdh_curve = "prime256v1"
    cache {
    	enable = yes
    	lifetime = 24
    	max_entries = 255
    }
    verify {
    }
    ocsp {
    	enable = no
    	override_cert_url = yes
    	url = "http://127.0.0.1/ocsp/"
    	use_nonce = yes
    	timeout = 0
    	softfail = no
    }
   }
   # Linked to sub-module rlm_eap_ttls
   ttls {
   	tls = "tls-common"
   	default_eap_type = "md5"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	virtual_server = "inner-tunnel"
   	include_length = yes
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_peap
   peap {
   	tls = "tls-common"
   	default_eap_type = "mschapv2"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	proxy_tunneled_request_as_eap = yes
   	virtual_server = "inner-tunnel"
   	soh = no
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_mschapv2
   mschapv2 {
   	with_ntdomain_hack = no
   	send_error = no
   }
  # Instantiating module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Instantiating module "files" from file /etc/freeradius/mods-enabled/files
reading pairlist file /etc/freeradius/mods-config/files/authorize
reading pairlist file /etc/freeradius/mods-config/files/accounting
reading pairlist file /etc/freeradius/mods-config/files/pre-proxy
  # Instantiating module "linelog" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "logintime" from file /etc/freeradius/mods-enabled/logintime
  # Instantiating module "mschap" from file /etc/freeradius/mods-enabled/mschap
rlm_mschap (mschap): using internal authentication
  # Instantiating module "pap" from file /etc/freeradius/mods-enabled/pap
  # Instantiating module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
rlm_passwd: nfields: 3 keyfield 0(User-Name) listable: no
  # Instantiating module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
reading pairlist file /etc/freeradius/mods-config/preprocess/huntgroups
reading pairlist file /etc/freeradius/mods-config/preprocess/hints
  # Instantiating module "IPASS" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "suffix" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "ntdomain" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "sql" from file /etc/freeradius/mods-enabled/sql
rlm_sql_mysql: libmysql version: 5.5.46
   mysql {
    tls {
    }
   	warnings = "auto"
   }
rlm_sql (sql): Attempting to connect to database "radius"
rlm_sql (sql): Initialising connection pool
   pool {
   	start = 5
   	min = 3
   	max = 32
   	spare = 10
   	uses = 0
   	lifetime = 0
   	cleanup_interval = 30
   	idle_timeout = 60
   	retry_delay = 30
   	spread = no
   }
rlm_sql (sql): Opening additional connection (0), 1 of 32 pending slots used
rlm_sql_mysql: Starting connect to MySQL server
rlm_sql_mysql: Couldn't connect to MySQL server radius@172.17.0.2:radius
rlm_sql_mysql: MySQL error: Access denied for user 'radius'@'172.17.0.4' (using password: YES)
rlm_sql_mysql: Socket destructor called, closing socket
rlm_sql (sql): Opening connection failed (0)
rlm_sql (sql): Removing connection pool
/etc/freeradius/mods-enabled/sql[20]: Instantiation failed for module "sql"
main {
	name = "freeradius"
	prefix = "/usr"
	localstatedir = "/var"
	sbindir = "/usr/sbin"
	logdir = "/var/log/freeradius"
	run_dir = "/var/run/freeradius"
	libdir = "/usr/lib/freeradius"
	radacctdir = "/var/log/freeradius/radacct"
	hostname_lookups = no
	max_request_time = 30
	cleanup_delay = 5
	max_requests = 16384
	pidfile = "/var/run/freeradius/freeradius.pid"
	checkrad = "/usr/sbin/checkrad"
	debug_level = 0
	proxy_requests = yes
 log {
 	stripped_names = no
 	auth = no
 	auth_badpass = no
 	auth_goodpass = no
 	colourise = yes
 	msg_denied = "You are already logged in - access denied"
 }
 resources {
 }
 security {
 	max_attributes = 200
 	reject_delay = 1.000000
 	status_server = yes
 }
}
radiusd: #### Loading Realms and Home Servers ####
 proxy server {
 	retry_delay = 5
 	retry_count = 3
 	default_fallback = no
 	dead_time = 120
 	wake_all_if_all_dead = no
 }
 home_server localhost {
 	ipaddr = 127.0.0.1
 	port = 1812
 	type = "auth"
 	secret = <<< secret >>>
 	response_window = 20.000000
 	response_timeouts = 1
 	max_outstanding = 65536
 	zombie_period = 40
 	status_check = "status-server"
 	ping_interval = 30
 	check_interval = 30
 	check_timeout = 4
 	num_answers_to_alive = 3
 	revive_interval = 120
  limit {
  	max_connections = 16
  	max_requests = 0
  	lifetime = 0
  	idle_timeout = 0
  }
  coa {
  	irt = 2
  	mrt = 16
  	mrc = 5
  	mrd = 30
  }
 }
 home_server_pool my_auth_failover {
	type = fail-over
	home_server = localhost
 }
 realm example.com {
	auth_pool = my_auth_failover
 }
 realm LOCAL {
 }
radiusd: #### Loading Clients ####
 client localhost {
 	ipaddr = 127.0.0.1
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	nas_type = "other"
 	proto = "*"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client localhost_ipv6 {
 	ipv6addr = ::1
 	require_message_authenticator = no
 	secret = <<< secret >>>
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
 client 192.168.1.0/24 {
 	require_message_authenticator = no
 	secret = <<< secret >>>
 	shortname = "roocell-ap"
  limit {
  	max_connections = 16
  	lifetime = 0
  	idle_timeout = 30
  }
 }
No 'ipaddr' or 'ipv4addr' or 'ipv6addr' field found in client 192.168.1.0/24. Please fix your configuration
Support for old-style clients will be removed in a future release
Debug state unknown (cap_sys_ptrace capability not set)
 # Creating Auth-Type = digest
radiusd: #### Instantiating modules ####
  # Loaded module rlm_always
  # Loading module "reject" from file /etc/freeradius/mods-enabled/always
  always reject {
  	rcode = "reject"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "fail" from file /etc/freeradius/mods-enabled/always
  always fail {
  	rcode = "fail"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "ok" from file /etc/freeradius/mods-enabled/always
  always ok {
  	rcode = "ok"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "handled" from file /etc/freeradius/mods-enabled/always
  always handled {
  	rcode = "handled"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "invalid" from file /etc/freeradius/mods-enabled/always
  always invalid {
  	rcode = "invalid"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "userlock" from file /etc/freeradius/mods-enabled/always
  always userlock {
  	rcode = "userlock"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "notfound" from file /etc/freeradius/mods-enabled/always
  always notfound {
  	rcode = "notfound"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "noop" from file /etc/freeradius/mods-enabled/always
  always noop {
  	rcode = "noop"
  	simulcount = 0
  	mpp = no
  }
  # Loading module "updated" from file /etc/freeradius/mods-enabled/always
  always updated {
  	rcode = "updated"
  	simulcount = 0
  	mpp = no
  }
  # Loaded module rlm_attr_filter
  # Loading module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.post-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/post-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.pre-proxy {
  	filename = "/etc/freeradius/mods-config/attr_filter/pre-proxy"
  	key = "%{Realm}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_reject {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_reject"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.access_challenge {
  	filename = "/etc/freeradius/mods-config/attr_filter/access_challenge"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loading module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
  attr_filter attr_filter.accounting_response {
  	filename = "/etc/freeradius/mods-config/attr_filter/accounting_response"
  	key = "%{User-Name}"
  	relaxed = no
  }
  # Loaded module rlm_cache
  # Loading module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
  cache cache_eap {
  	driver = "rlm_cache_rbtree"
  	key = "%{%{control:State}:-%{%{reply:State}:-%{State}}}"
  	ttl = 15
  	max_entries = 0
  	epoch = 0
  	add_stats = no
  }
  # Loaded module rlm_chap
  # Loading module "chap" from file /etc/freeradius/mods-enabled/chap
  # Loaded module rlm_detail
  # Loading module "detail" from file /etc/freeradius/mods-enabled/detail
  detail {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
  detail auth_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/auth-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  detail reply_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/reply-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail pre_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/pre-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loading module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  detail post_proxy_log {
  	filename = "/var/log/freeradius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/post-proxy-detail-%Y%m%d"
  	header = "%t"
  	permissions = 384
  	locking = no
  	escape_filenames = no
  	log_packet_header = no
  }
  # Loaded module rlm_digest
  # Loading module "digest" from file /etc/freeradius/mods-enabled/digest
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_eap
  # Loading module "eap" from file /etc/freeradius/mods-enabled/eap
  eap {
  	default_eap_type = "md5"
  	timer_expire = 60
  	ignore_unknown_eap_types = no
  	cisco_accounting_username_bug = no
  	max_sessions = 16384
  }
  # Loaded module rlm_exec
  # Loading module "echo" from file /etc/freeradius/mods-enabled/echo
  exec echo {
  	wait = yes
  	program = "/bin/echo %{User-Name}"
  	input_pairs = "request"
  	output_pairs = "reply"
  	shell_escape = yes
  }
  # Loading module "exec" from file /etc/freeradius/mods-enabled/exec
  exec {
  	wait = no
  	input_pairs = "request"
  	shell_escape = yes
  	timeout = 10
  }
  # Loaded module rlm_expiration
  # Loading module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Loaded module rlm_expr
  # Loading module "expr" from file /etc/freeradius/mods-enabled/expr
  expr {
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /äéöüàâæçèéêëîïôœùûüaÿÄÉÖÜßÀÂÆÇÈÉÊËÎÏÔŒÙÛÜŸ"
  }
  # Loaded module rlm_files
  # Loading module "files" from file /etc/freeradius/mods-enabled/files
  files {
  	filename = "/etc/freeradius/mods-config/files/authorize"
  	acctusersfile = "/etc/freeradius/mods-config/files/accounting"
  	preproxy_usersfile = "/etc/freeradius/mods-config/files/pre-proxy"
  }
  # Loaded module rlm_linelog
  # Loading module "linelog" from file /etc/freeradius/mods-enabled/linelog
  linelog {
  	filename = "/var/log/freeradius/linelog"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = "This is a log message for %{User-Name}"
  	reference = "messages.%{%{reply:Packet-Type}:-default}"
  }
  # Loading module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  linelog log_accounting {
  	filename = "/var/log/freeradius/linelog-accounting"
  	escape_filenames = no
  	syslog_severity = "info"
  	permissions = 384
  	format = ""
  	reference = "Accounting-Request.%{%{Acct-Status-Type}:-unknown}"
  }
  # Loaded module rlm_logintime
  # Loading module "logintime" from file /etc/freeradius/mods-enabled/logintime
  logintime {
  	minimum_timeout = 60
  }
  # Loaded module rlm_mschap
  # Loading module "mschap" from file /etc/freeradius/mods-enabled/mschap
  mschap {
  	use_mppe = yes
  	require_encryption = no
  	require_strong = no
  	with_ntdomain_hack = yes
   passchange {
   }
  	allow_retry = yes
  }
  # Loading module "ntlm_auth" from file /etc/freeradius/mods-enabled/ntlm_auth
  exec ntlm_auth {
  	wait = yes
  	program = "/path/to/ntlm_auth --request-nt-key --domain=MYDOMAIN --username=%{mschap:User-Name} --password=%{User-Password}"
  	shell_escape = yes
  }
  # Loaded module rlm_pap
  # Loading module "pap" from file /etc/freeradius/mods-enabled/pap
  pap {
  	normalise = yes
  }
  # Loaded module rlm_passwd
  # Loading module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
  passwd etc_passwd {
  	filename = "/etc/passwd"
  	format = "*User-Name:Crypt-Password:"
  	delimiter = ":"
  	ignore_nislike = no
  	ignore_empty = yes
  	allow_multiple_keys = no
  	hash_size = 100
  }
  # Loaded module rlm_preprocess
  # Loading module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
  preprocess {
  	huntgroups = "/etc/freeradius/mods-config/preprocess/huntgroups"
  	hints = "/etc/freeradius/mods-config/preprocess/hints"
  	with_ascend_hack = no
  	ascend_channels_per_line = 23
  	with_ntdomain_hack = no
  	with_specialix_jetstream_hack = no
  	with_cisco_vsa_hack = no
  	with_alvarion_vsa_hack = no
  }
  # Loaded module rlm_radutmp
  # Loading module "radutmp" from file /etc/freeradius/mods-enabled/radutmp
  radutmp {
  	filename = "/var/log/freeradius/radutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 384
  	caller_id = yes
  }
  # Loaded module rlm_realm
  # Loading module "IPASS" from file /etc/freeradius/mods-enabled/realm
  realm IPASS {
  	format = "prefix"
  	delimiter = "/"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "suffix" from file /etc/freeradius/mods-enabled/realm
  realm suffix {
  	format = "suffix"
  	delimiter = "@"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  realm realmpercent {
  	format = "suffix"
  	delimiter = "%"
  	ignore_default = no
  	ignore_null = no
  }
  # Loading module "ntdomain" from file /etc/freeradius/mods-enabled/realm
  realm ntdomain {
  	format = "prefix"
  	delimiter = "\\"
  	ignore_default = no
  	ignore_null = no
  }
  # Loaded module rlm_replicate
  # Loading module "replicate" from file /etc/freeradius/mods-enabled/replicate
  # Loaded module rlm_soh
  # Loading module "soh" from file /etc/freeradius/mods-enabled/soh
  soh {
  	dhcp = yes
  }
  # Loaded module rlm_sql
  # Loading module "sql" from file /etc/freeradius/mods-enabled/sql
  sql {
  	driver = "rlm_sql_mysql"
  	server = "172.17.0.2"
  	port = 3306
  	login = "radius"
  	password = <<< secret >>>
  	radius_db = "radius"
  	read_groups = yes
  	read_profiles = yes
  	read_clients = no
  	delete_stale_sessions = yes
  	sql_user_name = "%{User-Name}"
  	default_user_profile = ""
  	client_query = "SELECT id, nasname, shortname, type, secret, server FROM nas"
  	authorize_check_query = "SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id"
  	authorize_reply_query = "SELECT id, username, attribute, value, op FROM radreply WHERE username = '%{SQL-User-Name}' ORDER BY id"
  	authorize_group_check_query = "SELECT id, groupname, attribute, Value, op FROM radgroupcheck WHERE groupname = '%{SQL-Group}' ORDER BY id"
  	authorize_group_reply_query = "SELECT id, groupname, attribute, value, op FROM radgroupreply WHERE groupname = '%{SQL-Group}' ORDER BY id"
  	group_membership_query = "SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority"
  	simul_verify_query = "SELECT radacctid, acctsessionid, username, nasipaddress, nasportid, framedipaddress, callingstationid, framedprotocol FROM radacct WHERE username = '%{SQL-Group}' AND acctstoptime IS NULL"
  	safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /"
   accounting {
   	reference = "%{tolower:type.%{Acct-Status-Type}.query}"
    type {
     accounting-on {
     	query = "UPDATE radacct SET acctstoptime = %{%{integer:Event-Timestamp}:-date('now')}, acctsessiontime	= (%{%{integer:Event-Timestamp}:-strftime('%%s', 'now')} - strftime('%%s', acctstarttime)), acctterminatecause = '%{Acct-Terminate-Cause}' WHERE acctstoptime IS NULL AND nasipaddress   = '%{NAS-IP-Address}' AND acctstarttime <= %{integer:Event-Timestamp}"
     }
     accounting-off {
     	query = "UPDATE radacct SET acctstoptime = %{%{integer:Event-Timestamp}:-date('now')}, acctsessiontime	= (%{%{integer:Event-Timestamp}:-strftime('%%s', 'now')} - strftime('%%s', acctstarttime)), acctterminatecause = '%{Acct-Terminate-Cause}' WHERE acctstoptime IS NULL AND nasipaddress   = '%{NAS-IP-Address}' AND acctstarttime <= %{integer:Event-Timestamp}"
     }
     start {
     	query = "INSERT INTO radacct (acctsessionid, acctuniqueid, username, realm, nasipaddress, nasportid, nasporttype, acctstarttime, acctupdatetime, acctstoptime, acctsessiontime, acctauthentic, connectinfo_start, connectinfo_stop, acctinputoctets, acctoutputoctets, calledstationid, callingstationid, acctterminatecause, servicetype, framedprotocol, framedipaddress) VALUES ('%{Acct-Session-Id}', '%{Acct-Unique-Session-Id}', '%{SQL-User-Name}', '%{Realm}', '%{NAS-IP-Address}', '%{%{NAS-Port-ID}:-%{NAS-Port}}', '%{NAS-Port-Type}', %{%{integer:Event-Timestamp}:-date('now')}, %{%{integer:Event-Timestamp}:-date('now')}, NULL, '0', '%{Acct-Authentic}', '%{Connect-Info}', '', '0', '0', '%{Called-Station-Id}', '%{Calling-Station-Id}', '', '%{Service-Type}', '%{Framed-Protocol}', '%{Framed-IP-Address}')"
     }
     interim-update {
     	query = "UPDATE radacct SET acctupdatetime  = %{%{integer:Event-Timestamp}:-date('now')}, acctinterval    = 0, framedipaddress = '%{Framed-IP-Address}', acctsessiontime = %{%{Acct-Session-Time}:-NULL}, acctinputoctets = %{%{Acct-Input-Gigawords}:-0} << 32 | %{%{Acct-Input-Octets}:-0}, acctoutputoctets = %{%{Acct-Output-Gigawords}:-0} << 32 | %{%{Acct-Output-Octets}:-0} WHERE AcctUniqueId = '%{Acct-Unique-Session-Id}'"
     }
     stop {
     	query = "UPDATE radacct SET acctstoptime	= %{%{integer:Event-Timestamp}:-date('now')}, acctsessiontime	= %{%{Acct-Session-Time}:-NULL}, acctinputoctets	= %{%{Acct-Input-Gigawords}:-0} << 32 | %{%{Acct-Input-Octets}:-0}, acctoutputoctets = %{%{Acct-Output-Gigawords}:-0} << 32 | %{%{Acct-Output-Octets}:-0}, acctterminatecause = '%{Acct-Terminate-Cause}', connectinfo_stop = '%{Connect-Info}' WHERE AcctUniqueId = '%{Acct-Unique-Session-Id}'"
     }
    }
   }
   post-auth {
   	reference = ".query"
   	query = "INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')"
   }
  }
rlm_sql (sql): Driver rlm_sql_mysql (module rlm_sql_mysql) loaded and linked
Creating attribute SQL-Group
  # Loading module "sradutmp" from file /etc/freeradius/mods-enabled/sradutmp
  radutmp sradutmp {
  	filename = "/var/log/freeradius/sradutmp"
  	username = "%{User-Name}"
  	case_sensitive = yes
  	check_with_nas = yes
  	permissions = 420
  	caller_id = no
  }
  # Loaded module rlm_unix
  # Loading module "unix" from file /etc/freeradius/mods-enabled/unix
  unix {
  	radwtmp = "/var/log/freeradius/radwtmp"
  }
Creating attribute Unix-Group
  # Loaded module rlm_unpack
  # Loading module "unpack" from file /etc/freeradius/mods-enabled/unpack
  # Loaded module rlm_utf8
  # Loading module "utf8" from file /etc/freeradius/mods-enabled/utf8
 instantiate {
 }
 modules {
  # Instantiating module "reject" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "fail" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "ok" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "handled" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "invalid" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "userlock" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "notfound" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "noop" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "updated" from file /etc/freeradius/mods-enabled/always
  # Instantiating module "attr_filter.post-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/post-proxy
  # Instantiating module "attr_filter.pre-proxy" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/pre-proxy
  # Instantiating module "attr_filter.access_reject" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_reject
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay" 	found in filter list for realm "DEFAULT". 
[/etc/freeradius/mods-config/attr_filter/access_reject]:11 Check item "FreeRADIUS-Response-Delay-USec" 	found in filter list for realm "DEFAULT". 
  # Instantiating module "attr_filter.access_challenge" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/access_challenge
  # Instantiating module "attr_filter.accounting_response" from file /etc/freeradius/mods-enabled/attr_filter
reading pairlist file /etc/freeradius/mods-config/attr_filter/accounting_response
  # Instantiating module "cache_eap" from file /etc/freeradius/mods-enabled/cache_eap
rlm_cache (cache_eap): Driver rlm_cache_rbtree (module rlm_cache_rbtree) loaded and linked
  # Instantiating module "detail" from file /etc/freeradius/mods-enabled/detail
  # Instantiating module "auth_log" from file /etc/freeradius/mods-enabled/detail.log
rlm_detail (auth_log): 'User-Password' suppressed, will not appear in detail output
  # Instantiating module "reply_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "pre_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "post_proxy_log" from file /etc/freeradius/mods-enabled/detail.log
  # Instantiating module "eap" from file /etc/freeradius/mods-enabled/eap
   # Linked to sub-module rlm_eap_md5
   # Linked to sub-module rlm_eap_leap
   # Linked to sub-module rlm_eap_gtc
   gtc {
   	challenge = "Password: "
   	auth_type = "PAP"
   }
   # Linked to sub-module rlm_eap_tls
   tls {
   	tls = "tls-common"
   }
   tls-config tls-common {
   	rsa_key_exchange = no
   	dh_key_exchange = yes
   	rsa_key_length = 512
   	dh_key_length = 512
   	verify_depth = 0
   	ca_path = "/etc/freeradius/certs"
   	pem_file_type = yes
   	private_key_file = "/etc/freeradius/certs/server.pem"
   	certificate_file = "/etc/freeradius/certs/server.pem"
   	ca_file = "/etc/freeradius/certs/ca.pem"
   	private_key_password = <<< secret >>>
   	dh_file = "/etc/freeradius/certs/dh"
   	fragment_size = 1024
   	include_length = yes
   	check_crl = no
   	check_all_crl = no
   	cipher_list = "DEFAULT"
   	ecdh_curve = "prime256v1"
    cache {
    	enable = yes
    	lifetime = 24
    	max_entries = 255
    }
    verify {
    }
    ocsp {
    	enable = no
    	override_cert_url = yes
    	url = "http://127.0.0.1/ocsp/"
    	use_nonce = yes
    	timeout = 0
    	softfail = no
    }
   }
   # Linked to sub-module rlm_eap_ttls
   ttls {
   	tls = "tls-common"
   	default_eap_type = "md5"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	virtual_server = "inner-tunnel"
   	include_length = yes
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_peap
   peap {
   	tls = "tls-common"
   	default_eap_type = "mschapv2"
   	copy_request_to_tunnel = no
   	use_tunneled_reply = no
   	proxy_tunneled_request_as_eap = yes
   	virtual_server = "inner-tunnel"
   	soh = no
   	require_client_cert = no
   }
tls: Using cached TLS configuration from previous invocation
   # Linked to sub-module rlm_eap_mschapv2
   mschapv2 {
   	with_ntdomain_hack = no
   	send_error = no
   }
  # Instantiating module "expiration" from file /etc/freeradius/mods-enabled/expiration
  # Instantiating module "files" from file /etc/freeradius/mods-enabled/files
reading pairlist file /etc/freeradius/mods-config/files/authorize
reading pairlist file /etc/freeradius/mods-config/files/accounting
reading pairlist file /etc/freeradius/mods-config/files/pre-proxy
  # Instantiating module "linelog" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "log_accounting" from file /etc/freeradius/mods-enabled/linelog
  # Instantiating module "logintime" from file /etc/freeradius/mods-enabled/logintime
  # Instantiating module "mschap" from file /etc/freeradius/mods-enabled/mschap
rlm_mschap (mschap): using internal authentication
  # Instantiating module "pap" from file /etc/freeradius/mods-enabled/pap
  # Instantiating module "etc_passwd" from file /etc/freeradius/mods-enabled/passwd
rlm_passwd: nfields: 3 keyfield 0(User-Name) listable: no
  # Instantiating module "preprocess" from file /etc/freeradius/mods-enabled/preprocess
reading pairlist file /etc/freeradius/mods-config/preprocess/huntgroups
reading pairlist file /etc/freeradius/mods-config/preprocess/hints
  # Instantiating module "IPASS" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "suffix" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "realmpercent" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "ntdomain" from file /etc/freeradius/mods-enabled/realm
  # Instantiating module "sql" from file /etc/freeradius/mods-enabled/sql
rlm_sql_mysql: libmysql version: 5.5.46
   mysql {
    tls {
    }
   	warnings = "auto"
   }
rlm_sql (sql): Attempting to connect to database "radius"
rlm_sql (sql): Initialising connection pool
   pool {
   	start = 5
   	min = 3
   	max = 32
   	spare = 10
   	uses = 0
   	lifetime = 0
   	cleanup_interval = 30
   	idle_timeout = 60
   	retry_delay = 30
   	spread = no
   }
rlm_sql (sql): Opening additional connection (0), 1 of 32 pending slots used
rlm_sql_mysql: Starting connect to MySQL server
rlm_sql_mysql: Connected to database 'radius' on 172.17.0.2 via TCP/IP, server version 5.7.9, protocol version 10
rlm_sql (sql): Opening additional connection (1), 1 of 31 pending slots used
rlm_sql_mysql: Starting connect to MySQL server
rlm_sql_mysql: Connected to database 'radius' on 172.17.0.2 via TCP/IP, server version 5.7.9, protocol version 10
rlm_sql (sql): Opening additional connection (2), 1 of 30 pending slots used
rlm_sql_mysql: Starting connect to MySQL server
rlm_sql_mysql: Connected to database 'radius' on 172.17.0.2 via TCP/IP, server version 5.7.9, protocol version 10
rlm_sql (sql): Opening additional connection (3), 1 of 29 pending slots used
rlm_sql_mysql: Starting connect to MySQL server
rlm_sql_mysql: Connected to database 'radius' on 172.17.0.2 via TCP/IP, server version 5.7.9, protocol version 10
rlm_sql (sql): Opening additional connection (4), 1 of 28 pending slots used
rlm_sql_mysql: Starting connect to MySQL server
rlm_sql_mysql: Connected to database 'radius' on 172.17.0.2 via TCP/IP, server version 5.7.9, protocol version 10
 } # modules
radiusd: #### Loading Virtual Servers ####
server { # from file /etc/freeradius/radiusd.conf
} # server
server default { # from file /etc/freeradius/sites-enabled/default
 # Loading authenticate {...}
 # Loading authorize {...}
Ignoring "ldap" (see raddb/mods-available/README.rst)
 # Loading preacct {...}
 # Loading accounting {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server default
server inner-tunnel { # from file /etc/freeradius/sites-enabled/inner-tunnel
 # Loading authenticate {...}
 # Loading authorize {...}
 # Loading session {...}
 # Loading post-proxy {...}
 # Loading post-auth {...}
} # server inner-tunnel
 thread pool {
 	start_servers = 5
 	max_servers = 32
 	min_spare_servers = 3
 	max_spare_servers = 10
 	max_requests_per_server = 0
 	cleanup_delay = 5
 	max_queue_size = 65536
 	auto_limit_acct = no
 }
Thread spawned new child 1. Total threads in pool: 1
Thread spawned new child 2. Total threads in pool: 2
Thread spawned new child 3. Total threads in pool: 3
Thread spawned new child 4. Total threads in pool: 4
Thread spawned new child 5. Total threads in pool: 5
Thread pool initialized
radiusd: #### Opening IP addresses and Ports ####
listen {
  	type = "auth"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
Thread 3 waiting to be assigned a request
Thread 2 waiting to be assigned a request
Thread 1 waiting to be assigned a request
Thread 5 waiting to be assigned a request
Thread 4 waiting to be assigned a request
}
listen {
  	type = "acct"
  	ipaddr = *
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "acct"
  	ipv6addr = ::
  	port = 0
   limit {
   	max_connections = 16
   	lifetime = 0
   	idle_timeout = 30
   }
}
listen {
  	type = "auth"
  	ipaddr = 127.0.0.1
  	port = 18120
}
Listening on auth address * port 1812 bound to server default
Listening on acct address * port 1813 bound to server default
Listening on auth address :: port 1812 bound to server default
Listening on acct address :: port 1813 bound to server default
Listening on auth address 127.0.0.1 port 18120 bound to server inner-tunnel
Listening on proxy address * port 35615
Listening on proxy address :: port 56813
Ready to process requests
Threads: total/active/spare threads = 5/0/5
Thread 5 got semaphore
Thread 5 handling request 0, (1 handled so far)
(0) <running>: Received Access-Request Id 166 from 192.168.1.30:50045 to 172.17.0.4:1812 length 190
(0) <running>:   User-Name = "emiruss"
(0) <running>:   NAS-IP-Address = 192.168.1.30
(0) <running>:   NAS-Identifier = "Ericsson"
(0) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(0) <running>:   NAS-Port-Type = Wireless-802.11
(0) <running>:   NAS-Port = 0
(0) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(0) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(0) <running>:   Acct-Session-Id = "003E2DE6-00000052"
(0) <running>:   Framed-MTU = 1400
(0) <running>:   EAP-Message = 0x02a2000c01656d6972757373
(0) <running>:   Message-Authenticator = 0x35588007b84512211eec263251b213f4
(0) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(0) <running>:   authorize {
(0) <running>:     policy filter_username {
(0) <running>:       if (!&User-Name) {
(0) <running>:       if (!&User-Name)  -> FALSE
(0) <running>:       if (&User-Name =~ / /) {
(0) <running>:       if (&User-Name =~ / /)  -> FALSE
(0) <running>:       if (&User-Name =~ /@.*@/ ) {
(0) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(0) <running>:       if (&User-Name =~ /\.\./ ) {
(0) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(0) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(0) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(0) <running>:       if (&User-Name =~ /\.$/)  {
(0) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(0) <running>:       if (&User-Name =~ /@\./)  {
(0) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(0) <running>:     } # policy filter_username = notfound
(0)     [preprocess] = ok
(0)     [chap] = noop
(0)     [mschap] = noop
(0)     [digest] = noop
(0) suffix: Checking for suffix after "@"
(0) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(0) suffix: No such realm "NULL"
(0)     [suffix] = noop
Waking up in 0.3 seconds.
(0) eap: Peer sent EAP Response (code 2) ID 162 length 12
(0) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(0)     [eap] = ok
(0)   } # authorize = ok
(0) Found Auth-Type = EAP
(0) # Executing group from file /etc/freeradius/sites-enabled/default
(0)   authenticate {
(0) eap: Peer sent packet with method EAP Identity (1)
(0) eap: Calling submodule eap_md5 to process data
(0) eap_md5: Issuing MD5 Challenge
(0) eap: Sending EAP Request (code 1) ID 163 length 22
(0) eap: EAP session adding &reply:State = 0x7c56f34f7cf5f75a
(0)     [eap] = handled
(0)   } # authenticate = handled
(0) Using Post-Auth-Type Challenge
(0) Post-Auth-Type sub-section not found.  Ignoring.
(0) # Executing group from file /etc/freeradius/sites-enabled/default
(0) Sent Access-Challenge Id 166 from 172.17.0.4:1812 to 192.168.1.30:50045 length 0
(0)   EAP-Message = 0x01a3001604107bd117ea12bb111d2de9351936886bc8
(0)   Message-Authenticator = 0x00000000000000000000000000000000
(0)   State = 0x7c56f34f7cf5f75af8f261097ea5c8b6
(0) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.3 seconds.
Thread 4 got semaphore
Thread 4 handling request 1, (1 handled so far)
(1) <running>: Received Access-Request Id 167 from 192.168.1.30:50045 to 172.17.0.4:1812 length 204
(1) <running>:   User-Name = "emiruss"
(1) <running>:   NAS-IP-Address = 192.168.1.30
(1) <running>:   NAS-Identifier = "Ericsson"
(1) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(1) <running>:   NAS-Port-Type = Wireless-802.11
(1) <running>:   NAS-Port = 0
(1) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(1) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(1) <running>:   Acct-Session-Id = "003E2DE6-00000052"
(1) <running>:   Framed-MTU = 1400
(1) <running>:   EAP-Message = 0x02a300080319152b
(1) <running>:   State = 0x7c56f34f7cf5f75af8f261097ea5c8b6
(1) <running>:   Message-Authenticator = 0x8c05dde3fc02d26287423179aa2a9dfe
(1) <running>: session-state: No cached attributes
(1) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(1) <running>:   authorize {
(1) <running>:     policy filter_username {
(1) <running>:       if (!&User-Name) {
(1) <running>:       if (!&User-Name)  -> FALSE
(1) <running>:       if (&User-Name =~ / /) {
(1) <running>:       if (&User-Name =~ / /)  -> FALSE
(1) <running>:       if (&User-Name =~ /@.*@/ ) {
(1) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(1) <running>:       if (&User-Name =~ /\.\./ ) {
(1) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(1) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(1) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(1) <running>:       if (&User-Name =~ /\.$/)  {
(1) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(1) <running>:       if (&User-Name =~ /@\./)  {
(1) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(1) <running>:     } # policy filter_username = notfound
(1)     [preprocess] = ok
(1)     [chap] = noop
(1)     [mschap] = noop
(1)     [digest] = noop
(1) suffix: Checking for suffix after "@"
(1) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(1) suffix: No such realm "NULL"
(1)     [suffix] = noop
(1) eap: Peer sent EAP Response (code 2) ID 163 length 8
(1) eap: No EAP Start, assuming it's an on-going EAP conversation
(1)     [eap] = updated
(1)     [files] = noop
(1) sql: EXPAND %{User-Name}
(1) sql:    --> emiruss
(1) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Closing connection (0): Hit idle_timeout, was idle for 1231 seconds
rlm_sql_mysql: Socket destructor called, closing socket
rlm_sql (sql): Closing connection (1): Hit idle_timeout, was idle for 1231 seconds
rlm_sql_mysql: Socket destructor called, closing socket
rlm_sql (sql): Closing connection (2): Hit idle_timeout, was idle for 1231 seconds
rlm_sql (sql): You probably need to lower "min"
rlm_sql_mysql: Socket destructor called, closing socket
rlm_sql (sql): Closing connection (3): Hit idle_timeout, was idle for 1231 seconds
rlm_sql (sql): You probably need to lower "min"
rlm_sql_mysql: Socket destructor called, closing socket
rlm_sql (sql): Closing connection (4): Hit idle_timeout, was idle for 1231 seconds
rlm_sql (sql): You probably need to lower "min"
rlm_sql_mysql: Socket destructor called, closing socket
rlm_sql (sql): 0 of 0 connections in use.  You  may need to increase "spare"
rlm_sql (sql): Opening additional connection (5), 1 of 32 pending slots used
rlm_sql_mysql: Starting connect to MySQL server
rlm_sql_mysql: Connected to database 'radius' on 172.17.0.2 via TCP/IP, server version 5.7.9, protocol version 10
rlm_sql (sql): Reserved connection (5)
(1) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(1) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(1) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(1) sql: User found in radcheck table
(1) sql: Conditional check items matched, merging assignment check items
(1) sql:   Cleartext-Password := "emiruss"
(1) sql: EXPAND SELECT id, username, attribute, value, op FROM radreply WHERE username = '%{SQL-User-Name}' ORDER BY id
(1) sql:    --> SELECT id, username, attribute, value, op FROM radreply WHERE username = 'emiruss' ORDER BY id
(1) sql: Executing select query: SELECT id, username, attribute, value, op FROM radreply WHERE username = 'emiruss' ORDER BY id
(1) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(1) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(1) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(1) sql: User not found in any groups
rlm_sql (sql): Released connection (5)
rlm_sql (sql): Need 2 more connections to reach 10 spares
rlm_sql (sql): Opening additional connection (6), 1 of 31 pending slots used
rlm_sql_mysql: Starting connect to MySQL server
rlm_sql_mysql: Connected to database 'radius' on 172.17.0.2 via TCP/IP, server version 5.7.9, protocol version 10
(1)     [sql] = ok
(1)     [expiration] = noop
(1)     [logintime] = noop
(1) pap: WARNING: Auth-Type already set.  Not setting to PAP
(1)     [pap] = noop
(1)   } # authorize = updated
(1) Found Auth-Type = EAP
(1) # Executing group from file /etc/freeradius/sites-enabled/default
(1)   authenticate {
(1) eap: Expiring EAP session with state 0x7c56f34f7cf5f75a
(1) eap: Finished EAP session with state 0x7c56f34f7cf5f75a
(1) eap: Previous EAP request found for state 0x7c56f34f7cf5f75a, released from the list
(1) eap: Peer sent packet with method EAP NAK (3)
(1) eap: Found mutually acceptable type PEAP (25)
(1) eap: Calling submodule eap_peap to process data
(1) eap_peap: Initiating new EAP-TLS session
(1) eap_peap: Flushing SSL sessions (of #0)
(1) eap_peap: [eaptls start] = request
(1) eap: Sending EAP Request (code 1) ID 164 length 6
(1) eap: EAP session adding &reply:State = 0x7c56f34f7df2ea5a
(1)     [eap] = handled
(1)   } # authenticate = handled
(1) Using Post-Auth-Type Challenge
(1) Post-Auth-Type sub-section not found.  Ignoring.
(1) # Executing group from file /etc/freeradius/sites-enabled/default
(1) Sent Access-Challenge Id 167 from 172.17.0.4:1812 to 192.168.1.30:50045 length 0
(1)   EAP-Message = 0x01a400061920
(1)   Message-Authenticator = 0x00000000000000000000000000000000
(1)   State = 0x7c56f34f7df2ea5af8f261097ea5c8b6
(1) Finished request
Thread 4 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 3 got semaphore
Thread 3 handling request 2, (1 handled so far)
(2) <running>: Received Access-Request Id 168 from 192.168.1.30:50045 to 172.17.0.4:1812 length 339
(2) <running>:   User-Name = "emiruss"
(2) <running>:   NAS-IP-Address = 192.168.1.30
(2) <running>:   NAS-Identifier = "Ericsson"
(2) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(2) <running>:   NAS-Port-Type = Wireless-802.11
(2) <running>:   NAS-Port = 0
(2) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(2) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(2) <running>:   Acct-Session-Id = "003E2DE6-00000052"
(2) <running>:   Framed-MTU = 1400
(2) <running>:   EAP-Message = 0x02a4008f19800000008516030100800100007c03015655318ad8056018c5d1247363f5eeeabbae851e8690aead5d5307b04998a0a700003400ffc02cc02bc024c023c00ac009c008c030c02fc028c027c014c013c012009d009c003d003c0035002f000ac007c011000500040100001f000a0008000600
(2) <running>:   State = 0x7c56f34f7df2ea5af8f261097ea5c8b6
(2) <running>:   Message-Authenticator = 0x80748352853c60b1a8cac149937adce5
(2) <running>: session-state: No cached attributes
(2) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(2) <running>:   authorize {
(2) <running>:     policy filter_username {
(2) <running>:       if (!&User-Name) {
(2) <running>:       if (!&User-Name)  -> FALSE
(2) <running>:       if (&User-Name =~ / /) {
(2) <running>:       if (&User-Name =~ / /)  -> FALSE
(2) <running>:       if (&User-Name =~ /@.*@/ ) {
(2) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(2) <running>:       if (&User-Name =~ /\.\./ ) {
(2) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(2) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(2) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(2) <running>:       if (&User-Name =~ /\.$/)  {
(2) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(2) <running>:       if (&User-Name =~ /@\./)  {
(2) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(2) <running>:     } # policy filter_username = notfound
(2)     [preprocess] = ok
(2)     [chap] = noop
(2)     [mschap] = noop
(2)     [digest] = noop
(2) suffix: Checking for suffix after "@"
(2) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(2) suffix: No such realm "NULL"
(2)     [suffix] = noop
(2) eap: Peer sent EAP Response (code 2) ID 164 length 143
(2) eap: Continuing tunnel setup
(2)     [eap] = ok
(2)   } # authorize = ok
(2) Found Auth-Type = EAP
(2) # Executing group from file /etc/freeradius/sites-enabled/default
(2)   authenticate {
(2) eap: Expiring EAP session with state 0x7c56f34f7df2ea5a
(2) eap: Finished EAP session with state 0x7c56f34f7df2ea5a
(2) eap: Previous EAP request found for state 0x7c56f34f7df2ea5a, released from the list
(2) eap: Peer sent packet with method EAP PEAP (25)
(2) eap: Calling submodule eap_peap to process data
(2) eap_peap: Continuing EAP-TLS
(2) eap_peap: Peer indicated complete TLS record size will be 133 bytes
(2) eap_peap: Got complete TLS record (133 bytes)
(2) eap_peap: [eaptls verify] = length included
(2) eap_peap: (other): before/accept initialization
(2) eap_peap: TLS_accept: before/accept initialization
(2) eap_peap: <<< TLS 1.0 Handshake [length 0080], ClientHello 
(2) eap_peap: TLS_accept: SSLv3 read client hello A
(2) eap_peap: >>> TLS 1.0 Handshake [length 0059], ServerHello 
(2) eap_peap: TLS_accept: SSLv3 write server hello A
(2) eap_peap: >>> TLS 1.0 Handshake [length 08d3], Certificate 
(2) eap_peap: TLS_accept: SSLv3 write certificate A
(2) eap_peap: >>> TLS 1.0 Handshake [length 014b], ServerKeyExchange 
(2) eap_peap: TLS_accept: SSLv3 write key exchange A
(2) eap_peap: >>> TLS 1.0 Handshake [length 0004], ServerHelloDone 
(2) eap_peap: TLS_accept: SSLv3 write server done A
(2) eap_peap: TLS_accept: SSLv3 flush data
(2) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(2) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(2) eap_peap: In SSL Handshake Phase
(2) eap_peap: In SSL Accept mode
(2) eap_peap: [eaptls process] = handled
(2) eap: Sending EAP Request (code 1) ID 165 length 1004
(2) eap: EAP session adding &reply:State = 0x7c56f34f7ef3ea5a
(2)     [eap] = handled
(2)   } # authenticate = handled
(2) Using Post-Auth-Type Challenge
(2) Post-Auth-Type sub-section not found.  Ignoring.
(2) # Executing group from file /etc/freeradius/sites-enabled/default
(2) Sent Access-Challenge Id 168 from 172.17.0.4:1812 to 192.168.1.30:50045 length 0
(2)   EAP-Message = 0x01a503ec19c000000a8f160301005902000055030103feab0a67e7eb317bb98c8018f60f35d209e8311365c29258f39b6b74bbbdf9206d8c7318522a1ca2f1850c00dffb9e247ba4362c5112625227716029ed3c67f6c01400000dff01000100000b00040300010216030108d30b0008cf0008cc0003de
(2)   Message-Authenticator = 0x00000000000000000000000000000000
(2)   State = 0x7c56f34f7ef3ea5af8f261097ea5c8b6
(2) Finished request
Thread 3 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 2 got semaphore
Thread 2 handling request 3, (1 handled so far)
(3) <running>: Received Access-Request Id 169 from 192.168.1.30:50045 to 172.17.0.4:1812 length 202
(3) <running>:   User-Name = "emiruss"
(3) <running>:   NAS-IP-Address = 192.168.1.30
(3) <running>:   NAS-Identifier = "Ericsson"
(3) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(3) <running>:   NAS-Port-Type = Wireless-802.11
(3) <running>:   NAS-Port = 0
(3) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(3) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(3) <running>:   Acct-Session-Id = "003E2DE6-00000052"
(3) <running>:   Framed-MTU = 1400
(3) <running>:   EAP-Message = 0x02a500061900
(3) <running>:   State = 0x7c56f34f7ef3ea5af8f261097ea5c8b6
(3) <running>:   Message-Authenticator = 0x43429f0bcafe88c77bc426adaba2c1c4
(3) <running>: session-state: No cached attributes
(3) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(3) <running>:   authorize {
(3) <running>:     policy filter_username {
(3) <running>:       if (!&User-Name) {
(3) <running>:       if (!&User-Name)  -> FALSE
(3) <running>:       if (&User-Name =~ / /) {
(3) <running>:       if (&User-Name =~ / /)  -> FALSE
(3) <running>:       if (&User-Name =~ /@.*@/ ) {
(3) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(3) <running>:       if (&User-Name =~ /\.\./ ) {
(3) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(3) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(3) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(3) <running>:       if (&User-Name =~ /\.$/)  {
(3) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(3) <running>:       if (&User-Name =~ /@\./)  {
(3) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(3) <running>:     } # policy filter_username = notfound
(3)     [preprocess] = ok
(3)     [chap] = noop
(3)     [mschap] = noop
(3)     [digest] = noop
(3) suffix: Checking for suffix after "@"
(3) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(3) suffix: No such realm "NULL"
(3)     [suffix] = noop
(3) eap: Peer sent EAP Response (code 2) ID 165 length 6
(3) eap: Continuing tunnel setup
(3)     [eap] = ok
(3)   } # authorize = ok
(3) Found Auth-Type = EAP
(3) # Executing group from file /etc/freeradius/sites-enabled/default
(3)   authenticate {
(3) eap: Expiring EAP session with state 0x7c56f34f7ef3ea5a
(3) eap: Finished EAP session with state 0x7c56f34f7ef3ea5a
(3) eap: Previous EAP request found for state 0x7c56f34f7ef3ea5a, released from the list
(3) eap: Peer sent packet with method EAP PEAP (25)
(3) eap: Calling submodule eap_peap to process data
(3) eap_peap: Continuing EAP-TLS
(3) eap_peap: Peer ACKed our handshake fragment
(3) eap_peap: [eaptls verify] = request
(3) eap_peap: [eaptls process] = handled
(3) eap: Sending EAP Request (code 1) ID 166 length 1000
(3) eap: EAP session adding &reply:State = 0x7c56f34f7ff0ea5a
(3)     [eap] = handled
(3)   } # authenticate = handled
(3) Using Post-Auth-Type Challenge
(3) Post-Auth-Type sub-section not found.  Ignoring.
(3) # Executing group from file /etc/freeradius/sites-enabled/default
(3) Sent Access-Challenge Id 169 from 172.17.0.4:1812 to 192.168.1.30:50045 length 0
(3)   EAP-Message = 0x01a603e819400dd0405955c762981948527048701681d313d3cc6629a5557b66df2aae22c8590ab99d66ec8d3792a72e30596410f5d1e81f5a774969a1ce9ad6bd01d42da65536016e80a905c662a71ef5c075b8bdf0127a0cf1bd4c91290e15edffa035febde0185096bdc1e553090004e8308204e430
(3)   Message-Authenticator = 0x00000000000000000000000000000000
(3)   State = 0x7c56f34f7ff0ea5af8f261097ea5c8b6
(3) Finished request
Thread 2 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 1 got semaphore
Thread 1 handling request 4, (1 handled so far)
(4) <running>: Received Access-Request Id 170 from 192.168.1.30:50045 to 172.17.0.4:1812 length 202
(4) <running>:   User-Name = "emiruss"
(4) <running>:   NAS-IP-Address = 192.168.1.30
(4) <running>:   NAS-Identifier = "Ericsson"
(4) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(4) <running>:   NAS-Port-Type = Wireless-802.11
(4) <running>:   NAS-Port = 0
(4) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(4) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(4) <running>:   Acct-Session-Id = "003E2DE6-00000052"
(4) <running>:   Framed-MTU = 1400
(4) <running>:   EAP-Message = 0x02a600061900
(4) <running>:   State = 0x7c56f34f7ff0ea5af8f261097ea5c8b6
(4) <running>:   Message-Authenticator = 0x279fec3374c394d37ce87b8251653734
(4) <running>: session-state: No cached attributes
(4) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(4) <running>:   authorize {
(4) <running>:     policy filter_username {
(4) <running>:       if (!&User-Name) {
(4) <running>:       if (!&User-Name)  -> FALSE
(4) <running>:       if (&User-Name =~ / /) {
(4) <running>:       if (&User-Name =~ / /)  -> FALSE
(4) <running>:       if (&User-Name =~ /@.*@/ ) {
(4) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(4) <running>:       if (&User-Name =~ /\.\./ ) {
(4) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(4) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(4) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(4) <running>:       if (&User-Name =~ /\.$/)  {
(4) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(4) <running>:       if (&User-Name =~ /@\./)  {
(4) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(4) <running>:     } # policy filter_username = notfound
(4)     [preprocess] = ok
(4)     [chap] = noop
(4)     [mschap] = noop
(4)     [digest] = noop
(4) suffix: Checking for suffix after "@"
(4) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(4) suffix: No such realm "NULL"
(4)     [suffix] = noop
(4) eap: Peer sent EAP Response (code 2) ID 166 length 6
(4) eap: Continuing tunnel setup
(4)     [eap] = ok
(4)   } # authorize = ok
(4) Found Auth-Type = EAP
(4) # Executing group from file /etc/freeradius/sites-enabled/default
(4)   authenticate {
(4) eap: Expiring EAP session with state 0x7c56f34f7ff0ea5a
(4) eap: Finished EAP session with state 0x7c56f34f7ff0ea5a
(4) eap: Previous EAP request found for state 0x7c56f34f7ff0ea5a, released from the list
(4) eap: Peer sent packet with method EAP PEAP (25)
(4) eap: Calling submodule eap_peap to process data
(4) eap_peap: Continuing EAP-TLS
(4) eap_peap: Peer ACKed our handshake fragment
(4) eap_peap: [eaptls verify] = request
(4) eap_peap: [eaptls process] = handled
(4) eap: Sending EAP Request (code 1) ID 167 length 721
(4) eap: EAP session adding &reply:State = 0x7c56f34f78f1ea5a
(4)     [eap] = handled
(4)   } # authenticate = handled
(4) Using Post-Auth-Type Challenge
(4) Post-Auth-Type sub-section not found.  Ignoring.
(4) # Executing group from file /etc/freeradius/sites-enabled/default
(4) Sent Access-Challenge Id 170 from 172.17.0.4:1812 to 192.168.1.30:50045 length 0
(4)   EAP-Message = 0x01a702d1190020417574686f72697479820900c3fc536eef83d741300f0603551d130101ff040530030101ff30360603551d1f042f302d302ba029a0278625687474703a2f2f7777772e6578616d706c652e6f72672f6578616d706c655f63612e63726c300d06092a864886f70d01010b050003820101
(4)   Message-Authenticator = 0x00000000000000000000000000000000
(4)   State = 0x7c56f34f78f1ea5af8f261097ea5c8b6
(4) Finished request
Thread 1 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 5 got semaphore
Thread 5 handling request 5, (2 handled so far)
(5) <running>: Received Access-Request Id 171 from 192.168.1.30:50045 to 172.17.0.4:1812 length 340
(5) <running>:   User-Name = "emiruss"
(5) <running>:   NAS-IP-Address = 192.168.1.30
(5) <running>:   NAS-Identifier = "Ericsson"
(5) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(5) <running>:   NAS-Port-Type = Wireless-802.11
(5) <running>:   NAS-Port = 0
(5) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(5) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(5) <running>:   Acct-Session-Id = "003E2DE6-00000052"
(5) <running>:   Framed-MTU = 1400
(5) <running>:   EAP-Message = 0x02a7009019800000008616030100461000004241041ea03c3c9b898e1347f22f3342c5b21e41c680c06e6c2608499c171e9ec2c66fb53be9504046a1a6667db7ca0e390432853124939af9344acfc53f0d177686d51403010001011603010030b709f6a4aea53be0b43f2c9a2775ae71241841a1fbfe15
(5) <running>:   State = 0x7c56f34f78f1ea5af8f261097ea5c8b6
(5) <running>:   Message-Authenticator = 0x6eee180649e68e1c26ec400c8f7dd935
(5) <running>: session-state: No cached attributes
(5) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(5) <running>:   authorize {
(5) <running>:     policy filter_username {
(5) <running>:       if (!&User-Name) {
(5) <running>:       if (!&User-Name)  -> FALSE
(5) <running>:       if (&User-Name =~ / /) {
(5) <running>:       if (&User-Name =~ / /)  -> FALSE
(5) <running>:       if (&User-Name =~ /@.*@/ ) {
(5) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(5) <running>:       if (&User-Name =~ /\.\./ ) {
(5) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(5) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(5) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(5) <running>:       if (&User-Name =~ /\.$/)  {
(5) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(5) <running>:       if (&User-Name =~ /@\./)  {
(5) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(5) <running>:     } # policy filter_username = notfound
(5)     [preprocess] = ok
(5)     [chap] = noop
(5)     [mschap] = noop
(5)     [digest] = noop
(5) suffix: Checking for suffix after "@"
(5) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(5) suffix: No such realm "NULL"
(5)     [suffix] = noop
(5) eap: Peer sent EAP Response (code 2) ID 167 length 144
(5) eap: Continuing tunnel setup
(5)     [eap] = ok
(5)   } # authorize = ok
(5) Found Auth-Type = EAP
(5) # Executing group from file /etc/freeradius/sites-enabled/default
(5)   authenticate {
(5) eap: Expiring EAP session with state 0x7c56f34f78f1ea5a
(5) eap: Finished EAP session with state 0x7c56f34f78f1ea5a
(5) eap: Previous EAP request found for state 0x7c56f34f78f1ea5a, released from the list
(5) eap: Peer sent packet with method EAP PEAP (25)
(5) eap: Calling submodule eap_peap to process data
(5) eap_peap: Continuing EAP-TLS
(5) eap_peap: Peer indicated complete TLS record size will be 134 bytes
(5) eap_peap: Got complete TLS record (134 bytes)
(5) eap_peap: [eaptls verify] = length included
(5) eap_peap: <<< TLS 1.0 Handshake [length 0046], ClientKeyExchange 
(5) eap_peap: TLS_accept: SSLv3 read client key exchange A
(5) eap_peap: <<< TLS 1.0 ChangeCipherSpec [length 0001] 
(5) eap_peap: <<< TLS 1.0 Handshake [length 0010], Finished 
(5) eap_peap: TLS_accept: SSLv3 read finished A
(5) eap_peap: >>> TLS 1.0 ChangeCipherSpec [length 0001] 
(5) eap_peap: TLS_accept: SSLv3 write change cipher spec A
(5) eap_peap: >>> TLS 1.0 Handshake [length 0010], Finished 
(5) eap_peap: TLS_accept: SSLv3 write finished A
(5) eap_peap: TLS_accept: SSLv3 flush data
(5) eap_peap: (other): SSL negotiation finished successfully
(5) eap_peap: SSL Connection Established
(5) eap_peap: [eaptls process] = handled
(5) eap: Sending EAP Request (code 1) ID 168 length 65
(5) eap: EAP session adding &reply:State = 0x7c56f34f79feea5a
(5)     [eap] = handled
(5)   } # authenticate = handled
(5) Using Post-Auth-Type Challenge
(5) Post-Auth-Type sub-section not found.  Ignoring.
(5) # Executing group from file /etc/freeradius/sites-enabled/default
(5) Sent Access-Challenge Id 171 from 172.17.0.4:1812 to 192.168.1.30:50045 length 0
(5)   EAP-Message = 0x01a800411900140301000101160301003001b996678fd3043fd832edd61863079482026e6b6ff9f1fcec5c4aa479e3dca8eb798c799df0c796123243af7d11d860
(5)   Message-Authenticator = 0x00000000000000000000000000000000
(5)   State = 0x7c56f34f79feea5af8f261097ea5c8b6
(5) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 4 got semaphore
Thread 4 handling request 6, (2 handled so far)
(6) <running>: Received Access-Request Id 172 from 192.168.1.30:50045 to 172.17.0.4:1812 length 202
(6) <running>:   User-Name = "emiruss"
(6) <running>:   NAS-IP-Address = 192.168.1.30
(6) <running>:   NAS-Identifier = "Ericsson"
(6) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(6) <running>:   NAS-Port-Type = Wireless-802.11
(6) <running>:   NAS-Port = 0
(6) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(6) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(6) <running>:   Acct-Session-Id = "003E2DE6-00000052"
(6) <running>:   Framed-MTU = 1400
(6) <running>:   EAP-Message = 0x02a800061900
(6) <running>:   State = 0x7c56f34f79feea5af8f261097ea5c8b6
(6) <running>:   Message-Authenticator = 0x05db55fee699ea32727042fa9c6e343a
(6) <running>: session-state: No cached attributes
(6) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(6) <running>:   authorize {
(6) <running>:     policy filter_username {
(6) <running>:       if (!&User-Name) {
(6) <running>:       if (!&User-Name)  -> FALSE
(6) <running>:       if (&User-Name =~ / /) {
(6) <running>:       if (&User-Name =~ / /)  -> FALSE
(6) <running>:       if (&User-Name =~ /@.*@/ ) {
(6) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(6) <running>:       if (&User-Name =~ /\.\./ ) {
(6) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(6) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(6) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(6) <running>:       if (&User-Name =~ /\.$/)  {
(6) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(6) <running>:       if (&User-Name =~ /@\./)  {
(6) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(6) <running>:     } # policy filter_username = notfound
(6)     [preprocess] = ok
(6)     [chap] = noop
(6)     [mschap] = noop
(6)     [digest] = noop
(6) suffix: Checking for suffix after "@"
(6) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(6) suffix: No such realm "NULL"
(6)     [suffix] = noop
(6) eap: Peer sent EAP Response (code 2) ID 168 length 6
(6) eap: Continuing tunnel setup
(6)     [eap] = ok
(6)   } # authorize = ok
(6) Found Auth-Type = EAP
(6) # Executing group from file /etc/freeradius/sites-enabled/default
(6)   authenticate {
(6) eap: Expiring EAP session with state 0x7c56f34f79feea5a
(6) eap: Finished EAP session with state 0x7c56f34f79feea5a
(6) eap: Previous EAP request found for state 0x7c56f34f79feea5a, released from the list
(6) eap: Peer sent packet with method EAP PEAP (25)
(6) eap: Calling submodule eap_peap to process data
(6) eap_peap: Continuing EAP-TLS
(6) eap_peap: Peer ACKed our handshake fragment.  handshake is finished
(6) eap_peap: [eaptls verify] = success
(6) eap_peap: [eaptls process] = success
(6) eap_peap: Session established.  Decoding tunneled attributes
(6) eap_peap: PEAP state TUNNEL ESTABLISHED
(6) eap: Sending EAP Request (code 1) ID 169 length 43
(6) eap: EAP session adding &reply:State = 0x7c56f34f7affea5a
(6)     [eap] = handled
(6)   } # authenticate = handled
(6) Using Post-Auth-Type Challenge
(6) Post-Auth-Type sub-section not found.  Ignoring.
(6) # Executing group from file /etc/freeradius/sites-enabled/default
(6) Sent Access-Challenge Id 172 from 172.17.0.4:1812 to 192.168.1.30:50045 length 0
(6)   EAP-Message = 0x01a9002b19001703010020e9bd08f8a8cd0fd0d2ab5e25c23f7a83460bf075bc14cdfad9184c5ab18a0ecf
(6)   Message-Authenticator = 0x00000000000000000000000000000000
(6)   State = 0x7c56f34f7affea5af8f261097ea5c8b6
(6) Finished request
Thread 4 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 3 got semaphore
Thread 3 handling request 7, (2 handled so far)
(7) <running>: Received Access-Request Id 173 from 192.168.1.30:50045 to 172.17.0.4:1812 length 239
(7) <running>:   User-Name = "emiruss"
(7) <running>:   NAS-IP-Address = 192.168.1.30
(7) <running>:   NAS-Identifier = "Ericsson"
(7) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(7) <running>:   NAS-Port-Type = Wireless-802.11
(7) <running>:   NAS-Port = 0
(7) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(7) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(7) <running>:   Acct-Session-Id = "003E2DE6-00000052"
(7) <running>:   Framed-MTU = 1400
(7) <running>:   EAP-Message = 0x02a9002b19001703010020f5f0d7cc852b1f3885cc3628de8060b16c01bd0470e4427c72acbd1f0a2557e2
(7) <running>:   State = 0x7c56f34f7affea5af8f261097ea5c8b6
(7) <running>:   Message-Authenticator = 0xbb5b58c2eaa107bd393cef25a31f3d13
(7) <running>: session-state: No cached attributes
(7) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(7) <running>:   authorize {
(7) <running>:     policy filter_username {
(7) <running>:       if (!&User-Name) {
(7) <running>:       if (!&User-Name)  -> FALSE
(7) <running>:       if (&User-Name =~ / /) {
(7) <running>:       if (&User-Name =~ / /)  -> FALSE
(7) <running>:       if (&User-Name =~ /@.*@/ ) {
(7) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(7) <running>:       if (&User-Name =~ /\.\./ ) {
(7) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(7) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(7) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(7) <running>:       if (&User-Name =~ /\.$/)  {
(7) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(7) <running>:       if (&User-Name =~ /@\./)  {
(7) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(7) <running>:     } # policy filter_username = notfound
(7)     [preprocess] = ok
(7)     [chap] = noop
(7)     [mschap] = noop
(7)     [digest] = noop
(7) suffix: Checking for suffix after "@"
(7) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(7) suffix: No such realm "NULL"
(7)     [suffix] = noop
(7) eap: Peer sent EAP Response (code 2) ID 169 length 43
(7) eap: Continuing tunnel setup
(7)     [eap] = ok
(7)   } # authorize = ok
(7) Found Auth-Type = EAP
(7) # Executing group from file /etc/freeradius/sites-enabled/default
(7)   authenticate {
(7) eap: Expiring EAP session with state 0x7c56f34f7affea5a
(7) eap: Finished EAP session with state 0x7c56f34f7affea5a
(7) eap: Previous EAP request found for state 0x7c56f34f7affea5a, released from the list
(7) eap: Peer sent packet with method EAP PEAP (25)
(7) eap: Calling submodule eap_peap to process data
(7) eap_peap: Continuing EAP-TLS
(7) eap_peap: [eaptls verify] = ok
(7) eap_peap: Done initial handshake
(7) eap_peap: [eaptls process] = ok
(7) eap_peap: Session established.  Decoding tunneled attributes
(7) eap_peap: PEAP state WAITING FOR INNER IDENTITY
(7) eap_peap: Identity - emiruss
(7) eap_peap: Got inner identity 'emiruss'
(7) eap_peap: Setting default EAP type for tunneled EAP session
(7) eap_peap: Got tunneled request
(7) eap_peap:   EAP-Message = 0x02a9000c01656d6972757373
(7) eap_peap: Setting User-Name to emiruss
(7) eap_peap: Sending tunneled request to inner-tunnel
(7) eap_peap:   EAP-Message = 0x02a9000c01656d6972757373
(7) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(7) eap_peap:   User-Name = "emiruss"
(7) Virtual server inner-tunnel received request
(7)   EAP-Message = 0x02a9000c01656d6972757373
(7)   FreeRADIUS-Proxied-To = 127.0.0.1
(7)   User-Name = "emiruss"
(7) server inner-tunnel {
(7)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(7)     authorize {
(7)       [chap] = noop
(7)       [mschap] = noop
(7) suffix: Checking for suffix after "@"
(7) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(7) suffix: No such realm "NULL"
(7)       [suffix] = noop
(7)       update control {
(7)         &Proxy-To-Realm := LOCAL
(7)       } # update control = noop
(7) eap: Peer sent EAP Response (code 2) ID 169 length 12
(7) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(7)       [eap] = ok
(7)     } # authorize = ok
(7)   Found Auth-Type = EAP
(7)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(7)     authenticate {
(7) eap: Peer sent packet with method EAP Identity (1)
(7) eap: Calling submodule eap_mschapv2 to process data
(7) eap_mschapv2: Issuing Challenge
(7) eap: Sending EAP Request (code 1) ID 170 length 43
(7) eap: EAP session adding &reply:State = 0x82e05cb0824a4626
(7)       [eap] = handled
(7)     } # authenticate = handled
(7) } # server inner-tunnel
(7) Virtual server sending reply
(7)   EAP-Message = 0x01aa002b1a01aa0026103631c248a27b23cac029b37d3aae0f9b667265657261646975732d332e302e3130
(7)   Message-Authenticator = 0x00000000000000000000000000000000
(7)   State = 0x82e05cb0824a4626299321af6915e006
(7) eap_peap: Got tunneled reply code 11
(7) eap_peap:   EAP-Message = 0x01aa002b1a01aa0026103631c248a27b23cac029b37d3aae0f9b667265657261646975732d332e302e3130
(7) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(7) eap_peap:   State = 0x82e05cb0824a4626299321af6915e006
(7) eap_peap: Got tunneled Access-Challenge
(7) eap: Sending EAP Request (code 1) ID 170 length 75
(7) eap: EAP session adding &reply:State = 0x7c56f34f7bfcea5a
(7)     [eap] = handled
(7)   } # authenticate = handled
(7) Using Post-Auth-Type Challenge
(7) Post-Auth-Type sub-section not found.  Ignoring.
(7) # Executing group from file /etc/freeradius/sites-enabled/default
(7) Sent Access-Challenge Id 173 from 172.17.0.4:1812 to 192.168.1.30:50045 length 0
(7)   EAP-Message = 0x01aa004b19001703010040e5e55f9bef3639a865c83bca5c4b93751e916ae72da2a99526598fd59a4140c46ce4d2db0bc2b10f2c840d3759fd7d4516a98b41b5316c1df0a955b336c3bb23
(7)   Message-Authenticator = 0x00000000000000000000000000000000
(7)   State = 0x7c56f34f7bfcea5af8f261097ea5c8b6
(7) Finished request
Thread 3 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 2 got semaphore
Thread 2 handling request 8, (2 handled so far)
(8) <running>: Received Access-Request Id 174 from 192.168.1.30:50045 to 172.17.0.4:1812 length 303
(8) <running>:   User-Name = "emiruss"
(8) <running>:   NAS-IP-Address = 192.168.1.30
(8) <running>:   NAS-Identifier = "Ericsson"
(8) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(8) <running>:   NAS-Port-Type = Wireless-802.11
(8) <running>:   NAS-Port = 0
(8) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(8) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(8) <running>:   Acct-Session-Id = "003E2DE6-00000052"
(8) <running>:   Framed-MTU = 1400
(8) <running>:   EAP-Message = 0x02aa006b19001703010060878a46eac3fcf311d3d90f296cceca95308b4041329d822855bef7ab9713ec664cf72f9bed1a01f1c559bff9c358589a044f081ea2bb02642a1cd6308708fac5b98f33319b4575cbca4efa382c880bb14f797ebe4a76423f73fc31d91cad5b12
(8) <running>:   State = 0x7c56f34f7bfcea5af8f261097ea5c8b6
(8) <running>:   Message-Authenticator = 0xf255e4b344e05c5cfb4c9cc3715d8dad
(8) <running>: session-state: No cached attributes
(8) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(8) <running>:   authorize {
(8) <running>:     policy filter_username {
(8) <running>:       if (!&User-Name) {
(8) <running>:       if (!&User-Name)  -> FALSE
(8) <running>:       if (&User-Name =~ / /) {
(8) <running>:       if (&User-Name =~ / /)  -> FALSE
(8) <running>:       if (&User-Name =~ /@.*@/ ) {
(8) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(8) <running>:       if (&User-Name =~ /\.\./ ) {
(8) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(8) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(8) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(8) <running>:       if (&User-Name =~ /\.$/)  {
(8) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(8) <running>:       if (&User-Name =~ /@\./)  {
(8) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(8) <running>:     } # policy filter_username = notfound
(8)     [preprocess] = ok
(8)     [chap] = noop
(8)     [mschap] = noop
(8)     [digest] = noop
(8) suffix: Checking for suffix after "@"
(8) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(8) suffix: No such realm "NULL"
(8)     [suffix] = noop
(8) eap: Peer sent EAP Response (code 2) ID 170 length 107
(8) eap: Continuing tunnel setup
(8)     [eap] = ok
(8)   } # authorize = ok
(8) Found Auth-Type = EAP
(8) # Executing group from file /etc/freeradius/sites-enabled/default
(8)   authenticate {
(8) eap: Expiring EAP session with state 0x82e05cb0824a4626
(8) eap: Finished EAP session with state 0x7c56f34f7bfcea5a
(8) eap: Previous EAP request found for state 0x7c56f34f7bfcea5a, released from the list
(8) eap: Peer sent packet with method EAP PEAP (25)
(8) eap: Calling submodule eap_peap to process data
(8) eap_peap: Continuing EAP-TLS
(8) eap_peap: [eaptls verify] = ok
(8) eap_peap: Done initial handshake
(8) eap_peap: [eaptls process] = ok
(8) eap_peap: Session established.  Decoding tunneled attributes
(8) eap_peap: PEAP state phase2
(8) eap_peap: EAP method MSCHAPv2 (26)
(8) eap_peap: Got tunneled request
(8) eap_peap:   EAP-Message = 0x02aa00421a02aa003d31d1b9f855be0743946bf5bae8d5ce5881000000000000000007659d4cf9cc68f5d2fc55a9d7d52594dbb06211c707f76f00656d6972757373
(8) eap_peap: Setting User-Name to emiruss
(8) eap_peap: Sending tunneled request to inner-tunnel
(8) eap_peap:   EAP-Message = 0x02aa00421a02aa003d31d1b9f855be0743946bf5bae8d5ce5881000000000000000007659d4cf9cc68f5d2fc55a9d7d52594dbb06211c707f76f00656d6972757373
(8) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(8) eap_peap:   User-Name = "emiruss"
(8) eap_peap:   State = 0x82e05cb0824a4626299321af6915e006
(8) Virtual server inner-tunnel received request
(8)   EAP-Message = 0x02aa00421a02aa003d31d1b9f855be0743946bf5bae8d5ce5881000000000000000007659d4cf9cc68f5d2fc55a9d7d52594dbb06211c707f76f00656d6972757373
(8)   FreeRADIUS-Proxied-To = 127.0.0.1
(8)   User-Name = "emiruss"
(8)   State = 0x82e05cb0824a4626299321af6915e006
(8) server inner-tunnel {
(8)   session-state: No cached attributes
(8)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(8)     authorize {
(8)       [chap] = noop
(8)       [mschap] = noop
(8) suffix: Checking for suffix after "@"
(8) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(8) suffix: No such realm "NULL"
(8)       [suffix] = noop
(8)       update control {
(8)         &Proxy-To-Realm := LOCAL
(8)       } # update control = noop
(8) eap: Peer sent EAP Response (code 2) ID 170 length 66
(8) eap: No EAP Start, assuming it's an on-going EAP conversation
(8)       [eap] = updated
(8)       [files] = noop
(8) sql: EXPAND %{User-Name}
(8) sql:    --> emiruss
(8) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Reserved connection (5)
(8) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(8) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(8) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(8) sql: User found in radcheck table
(8) sql: Conditional check items matched, merging assignment check items
(8) sql:   Cleartext-Password := "emiruss"
(8) sql: EXPAND SELECT id, username, attribute, value, op FROM radreply WHERE username = '%{SQL-User-Name}' ORDER BY id
(8) sql:    --> SELECT id, username, attribute, value, op FROM radreply WHERE username = 'emiruss' ORDER BY id
(8) sql: Executing select query: SELECT id, username, attribute, value, op FROM radreply WHERE username = 'emiruss' ORDER BY id
(8) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(8) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(8) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(8) sql: User not found in any groups
rlm_sql (sql): Released connection (5)
(8)       [sql] = ok
(8)       [expiration] = noop
(8)       [logintime] = noop
(8) pap: WARNING: Auth-Type already set.  Not setting to PAP
(8)       [pap] = noop
(8)     } # authorize = updated
(8)   Found Auth-Type = EAP
(8)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(8)     authenticate {
(8) eap: Expiring EAP session with state 0x82e05cb0824a4626
(8) eap: Finished EAP session with state 0x82e05cb0824a4626
(8) eap: Previous EAP request found for state 0x82e05cb0824a4626, released from the list
(8) eap: Peer sent packet with method EAP MSCHAPv2 (26)
(8) eap: Calling submodule eap_mschapv2 to process data
(8) eap_mschapv2: # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(8) eap_mschapv2:   Auth-Type MS-CHAP {
(8) mschap: Found Cleartext-Password, hashing to create NT-Password
(8) mschap: Found Cleartext-Password, hashing to create LM-Password
(8) mschap: Creating challenge hash with username: emiruss
(8) mschap: Client is using MS-CHAPv2
(8) mschap: Adding MS-CHAPv2 MPPE keys
(8)     [mschap] = ok
(8)   } # Auth-Type MS-CHAP = ok
(8) MSCHAP Success
(8) eap: Sending EAP Request (code 1) ID 171 length 51
(8) eap: EAP session adding &reply:State = 0x82e05cb0834b4626
(8)       [eap] = handled
(8)     } # authenticate = handled
(8) } # server inner-tunnel
(8) Virtual server sending reply
(8)   EAP-Message = 0x01ab00331a03aa002e533d46333537444639324445313744393646424342344242323245304345344635304534454642373545
(8)   Message-Authenticator = 0x00000000000000000000000000000000
(8)   State = 0x82e05cb0834b4626299321af6915e006
(8) eap_peap: Got tunneled reply code 11
(8) eap_peap:   EAP-Message = 0x01ab00331a03aa002e533d46333537444639324445313744393646424342344242323245304345344635304534454642373545
(8) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(8) eap_peap:   State = 0x82e05cb0834b4626299321af6915e006
(8) eap_peap: Got tunneled Access-Challenge
(8) eap: Sending EAP Request (code 1) ID 171 length 91
(8) eap: EAP session adding &reply:State = 0x7c56f34f74fdea5a
(8)     [eap] = handled
(8)   } # authenticate = handled
(8) Using Post-Auth-Type Challenge
(8) Post-Auth-Type sub-section not found.  Ignoring.
(8) # Executing group from file /etc/freeradius/sites-enabled/default
(8) Sent Access-Challenge Id 174 from 172.17.0.4:1812 to 192.168.1.30:50045 length 0
(8)   EAP-Message = 0x01ab005b19001703010050fa9219844277d59f7dc1441759e403314bbad067e1830638799c54675f2d4c1e95c8db861d05075d506d9c9d3ecb2d160f3f37f25387d8193efdd4dd6b550f299362b8538d51cbbbe9bdf788e7241d93
(8)   Message-Authenticator = 0x00000000000000000000000000000000
(8)   State = 0x7c56f34f74fdea5af8f261097ea5c8b6
(8) Finished request
Thread 2 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 1 got semaphore
Thread 1 handling request 9, (2 handled so far)
(9) <running>: Received Access-Request Id 175 from 192.168.1.30:50045 to 172.17.0.4:1812 length 239
(9) <running>:   User-Name = "emiruss"
(9) <running>:   NAS-IP-Address = 192.168.1.30
(9) <running>:   NAS-Identifier = "Ericsson"
(9) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(9) <running>:   NAS-Port-Type = Wireless-802.11
(9) <running>:   NAS-Port = 0
(9) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(9) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(9) <running>:   Acct-Session-Id = "003E2DE6-00000052"
(9) <running>:   Framed-MTU = 1400
(9) <running>:   EAP-Message = 0x02ab002b1900170301002016fa2b4e1a86ff1db46049e5be77c44a6b9ae8927cb0428905a3ea533427eba3
(9) <running>:   State = 0x7c56f34f74fdea5af8f261097ea5c8b6
(9) <running>:   Message-Authenticator = 0x7578233d6aaeb999bf0491ee859df463
(9) <running>: session-state: No cached attributes
(9) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(9) <running>:   authorize {
(9) <running>:     policy filter_username {
(9) <running>:       if (!&User-Name) {
(9) <running>:       if (!&User-Name)  -> FALSE
(9) <running>:       if (&User-Name =~ / /) {
(9) <running>:       if (&User-Name =~ / /)  -> FALSE
(9) <running>:       if (&User-Name =~ /@.*@/ ) {
(9) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(9) <running>:       if (&User-Name =~ /\.\./ ) {
(9) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(9) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(9) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(9) <running>:       if (&User-Name =~ /\.$/)  {
(9) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(9) <running>:       if (&User-Name =~ /@\./)  {
(9) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(9) <running>:     } # policy filter_username = notfound
(9)     [preprocess] = ok
(9)     [chap] = noop
(9)     [mschap] = noop
(9)     [digest] = noop
(9) suffix: Checking for suffix after "@"
(9) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(9) suffix: No such realm "NULL"
(9)     [suffix] = noop
(9) eap: Peer sent EAP Response (code 2) ID 171 length 43
(9) eap: Continuing tunnel setup
(9)     [eap] = ok
(9)   } # authorize = ok
(9) Found Auth-Type = EAP
(9) # Executing group from file /etc/freeradius/sites-enabled/default
(9)   authenticate {
(9) eap: Expiring EAP session with state 0x82e05cb0834b4626
(9) eap: Finished EAP session with state 0x7c56f34f74fdea5a
(9) eap: Previous EAP request found for state 0x7c56f34f74fdea5a, released from the list
(9) eap: Peer sent packet with method EAP PEAP (25)
(9) eap: Calling submodule eap_peap to process data
(9) eap_peap: Continuing EAP-TLS
(9) eap_peap: [eaptls verify] = ok
(9) eap_peap: Done initial handshake
(9) eap_peap: [eaptls process] = ok
(9) eap_peap: Session established.  Decoding tunneled attributes
(9) eap_peap: PEAP state phase2
(9) eap_peap: EAP method MSCHAPv2 (26)
(9) eap_peap: Got tunneled request
(9) eap_peap:   EAP-Message = 0x02ab00061a03
(9) eap_peap: Setting User-Name to emiruss
(9) eap_peap: Sending tunneled request to inner-tunnel
(9) eap_peap:   EAP-Message = 0x02ab00061a03
(9) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(9) eap_peap:   User-Name = "emiruss"
(9) eap_peap:   State = 0x82e05cb0834b4626299321af6915e006
(9) Virtual server inner-tunnel received request
(9)   EAP-Message = 0x02ab00061a03
(9)   FreeRADIUS-Proxied-To = 127.0.0.1
(9)   User-Name = "emiruss"
(9)   State = 0x82e05cb0834b4626299321af6915e006
(9) server inner-tunnel {
(9)   session-state: No cached attributes
(9)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(9)     authorize {
(9)       [chap] = noop
(9)       [mschap] = noop
(9) suffix: Checking for suffix after "@"
(9) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(9) suffix: No such realm "NULL"
(9)       [suffix] = noop
(9)       update control {
(9)         &Proxy-To-Realm := LOCAL
(9)       } # update control = noop
(9) eap: Peer sent EAP Response (code 2) ID 171 length 6
(9) eap: No EAP Start, assuming it's an on-going EAP conversation
(9)       [eap] = updated
(9)       [files] = noop
(9) sql: EXPAND %{User-Name}
(9) sql:    --> emiruss
(9) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Reserved connection (6)
(9) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(9) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(9) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(9) sql: User found in radcheck table
(9) sql: Conditional check items matched, merging assignment check items
(9) sql:   Cleartext-Password := "emiruss"
(9) sql: EXPAND SELECT id, username, attribute, value, op FROM radreply WHERE username = '%{SQL-User-Name}' ORDER BY id
(9) sql:    --> SELECT id, username, attribute, value, op FROM radreply WHERE username = 'emiruss' ORDER BY id
(9) sql: Executing select query: SELECT id, username, attribute, value, op FROM radreply WHERE username = 'emiruss' ORDER BY id
(9) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(9) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(9) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(9) sql: User not found in any groups
rlm_sql (sql): Released connection (6)
(9)       [sql] = ok
(9)       [expiration] = noop
(9)       [logintime] = noop
(9) pap: WARNING: Auth-Type already set.  Not setting to PAP
(9)       [pap] = noop
(9)     } # authorize = updated
(9)   Found Auth-Type = EAP
(9)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(9)     authenticate {
(9) eap: Expiring EAP session with state 0x82e05cb0834b4626
(9) eap: Finished EAP session with state 0x82e05cb0834b4626
(9) eap: Previous EAP request found for state 0x82e05cb0834b4626, released from the list
(9) eap: Peer sent packet with method EAP MSCHAPv2 (26)
(9) eap: Calling submodule eap_mschapv2 to process data
(9) eap: Sending EAP Success (code 3) ID 171 length 4
(9) eap: Freeing handler
(9)       [eap] = ok
(9)     } # authenticate = ok
(9)   # Executing section post-auth from file /etc/freeradius/sites-enabled/inner-tunnel
(9)     post-auth {
(9) sql: EXPAND .query
(9) sql:    --> .query
(9) sql: Using query template 'query'
rlm_sql (sql): Reserved connection (5)
(9) sql: EXPAND %{User-Name}
(9) sql:    --> emiruss
(9) sql: SQL-User-Name set to 'emiruss'
(9) sql: EXPAND INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')
(9) sql:    --> INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Accept', '2015-11-25 03:56:36')
(9) sql: Executing query: INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Accept', '2015-11-25 03:56:36')
(9) sql: SQL query returned: success
(9) sql: 1 record(s) updated
rlm_sql (sql): Released connection (5)
(9)       [sql] = ok
(9)     } # post-auth = ok
(9) } # server inner-tunnel
(9) Virtual server sending reply
(9)   MS-MPPE-Encryption-Policy = Encryption-Allowed
(9)   MS-MPPE-Encryption-Types = RC4-40or128-bit-Allowed
(9)   MS-MPPE-Send-Key = 0x8f87a9982e0dc75430d5fbe36580b1ff
(9)   MS-MPPE-Recv-Key = 0xaf952e4f791a058bcf942981d0d181f5
(9)   EAP-Message = 0x03ab0004
(9)   Message-Authenticator = 0x00000000000000000000000000000000
(9)   User-Name = "emiruss"
(9) eap_peap: Got tunneled reply code 2
(9) eap_peap:   MS-MPPE-Encryption-Policy = Encryption-Allowed
(9) eap_peap:   MS-MPPE-Encryption-Types = RC4-40or128-bit-Allowed
(9) eap_peap:   MS-MPPE-Send-Key = 0x8f87a9982e0dc75430d5fbe36580b1ff
(9) eap_peap:   MS-MPPE-Recv-Key = 0xaf952e4f791a058bcf942981d0d181f5
(9) eap_peap:   EAP-Message = 0x03ab0004
(9) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(9) eap_peap:   User-Name = "emiruss"
(9) eap_peap: Tunneled authentication was successful
(9) eap_peap: SUCCESS
(9) eap: Sending EAP Request (code 1) ID 172 length 43
(9) eap: EAP session adding &reply:State = 0x7c56f34f75faea5a
(9)     [eap] = handled
(9)   } # authenticate = handled
(9) Using Post-Auth-Type Challenge
(9) Post-Auth-Type sub-section not found.  Ignoring.
(9) # Executing group from file /etc/freeradius/sites-enabled/default
(9) Sent Access-Challenge Id 175 from 172.17.0.4:1812 to 192.168.1.30:50045 length 0
(9)   EAP-Message = 0x01ac002b190017030100204e1c884d66ec1868a63cb553d99fdc3f2a6da6236be9f42c2acda090a7726995
(9)   Message-Authenticator = 0x00000000000000000000000000000000
(9)   State = 0x7c56f34f75faea5af8f261097ea5c8b6
(9) Finished request
Thread 1 waiting to be assigned a request
Thread 5 got semaphore
Thread 5 handling request 10, (3 handled so far)
(10) <running>: Received Access-Request Id 176 from 192.168.1.30:50045 to 172.17.0.4:1812 length 239
(10) <running>:   User-Name = "emiruss"
(10) <running>:   NAS-IP-Address = 192.168.1.30
(10) <running>:   NAS-Identifier = "Ericsson"
(10) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(10) <running>:   NAS-Port-Type = Wireless-802.11
(10) <running>:   NAS-Port = 0
(10) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(10) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(10) <running>:   Acct-Session-Id = "003E2DE6-00000052"
(10) <running>:   Framed-MTU = 1400
(10) <running>:   EAP-Message = 0x02ac002b1900170301002068a8ce12f6d698dc2517c80d7a2ccc74eecae6c94a4d445b3357a3a77430a463
(10) <running>:   State = 0x7c56f34f75faea5af8f261097ea5c8b6
(10) <running>:   Message-Authenticator = 0xf6a51288d9438b2589886c5ec105c6a5
(10) <running>: session-state: No cached attributes
(10) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(10) <running>:   authorize {
(10) <running>:     policy filter_username {
(10) <running>:       if (!&User-Name) {
(10) <running>:       if (!&User-Name)  -> FALSE
(10) <running>:       if (&User-Name =~ / /) {
(10) <running>:       if (&User-Name =~ / /)  -> FALSE
(10) <running>:       if (&User-Name =~ /@.*@/ ) {
(10) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(10) <running>:       if (&User-Name =~ /\.\./ ) {
(10) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(10) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(10) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(10) <running>:       if (&User-Name =~ /\.$/)  {
(10) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(10) <running>:       if (&User-Name =~ /@\./)  {
(10) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(10) <running>:     } # policy filter_username = notfound
(10)     [preprocess] = ok
(10)     [chap] = noop
(10)     [mschap] = noop
(10)     [digest] = noop
(10) suffix: Checking for suffix after "@"
(10) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(10) suffix: No such realm "NULL"
(10)     [suffix] = noop
(10) eap: Peer sent EAP Response (code 2) ID 172 length 43
(10) eap: Continuing tunnel setup
(10)     [eap] = ok
(10)   } # authorize = ok
(10) Found Auth-Type = EAP
(10) # Executing group from file /etc/freeradius/sites-enabled/default
(10)   authenticate {
(10) eap: Expiring EAP session with state 0x7c56f34f75faea5a
(10) eap: Finished EAP session with state 0x7c56f34f75faea5a
(10) eap: Previous EAP request found for state 0x7c56f34f75faea5a, released from the list
(10) eap: Peer sent packet with method EAP PEAP (25)
(10) eap: Calling submodule eap_peap to process data
(10) eap_peap: Continuing EAP-TLS
(10) eap_peap: [eaptls verify] = ok
(10) eap_peap: Done initial handshake
(10) eap_peap: [eaptls process] = ok
(10) eap_peap: Session established.  Decoding tunneled attributes
(10) eap_peap: PEAP state send tlv success
(10) eap_peap: Received EAP-TLV response
(10) eap_peap: Success
(10) eap_peap: No information to cache: session caching will be disabled for session 6d8c7318522a1ca2f1850c00dffb9e247ba4362c5112625227716029ed3c67f6
(10) eap: Sending EAP Success (code 3) ID 172 length 4
(10) eap: Freeing handler
(10)     [eap] = ok
(10)   } # authenticate = ok
(10) # Executing section post-auth from file /etc/freeradius/sites-enabled/default
(10)   post-auth {
(10)     update {
(10)       No attributes updated
(10)     } # update = noop
(10) sql: EXPAND .query
(10) sql:    --> .query
(10) sql: Using query template 'query'
rlm_sql (sql): Reserved connection (6)
(10) sql: EXPAND %{User-Name}
(10) sql:    --> emiruss
(10) sql: SQL-User-Name set to 'emiruss'
(10) sql: EXPAND INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')
(10) sql:    --> INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Accept', '2015-11-25 03:56:36')
(10) sql: Executing query: INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Accept', '2015-11-25 03:56:36')
(10) sql: SQL query returned: success
(10) sql: 1 record(s) updated
rlm_sql (sql): Released connection (6)
(10)     [sql] = ok
(10)     [exec] = noop
(10)     policy remove_reply_message_if_eap {
(10)       if (&reply:EAP-Message && &reply:Reply-Message) {
(10)       if (&reply:EAP-Message && &reply:Reply-Message)  -> FALSE
(10)       else {
(10)         [noop] = noop
(10)       } # else = noop
(10)     } # policy remove_reply_message_if_eap = noop
(10)   } # post-auth = ok
(10) Sent Access-Accept Id 176 from 172.17.0.4:1812 to 192.168.1.30:50045 length 0
(10)   MS-MPPE-Recv-Key = 0xf66c25b9b564ad826cfe5f6a850cbb6966a5604480d94bc450159d569e095114
(10)   MS-MPPE-Send-Key = 0xb822e94a56273202249b47b8ed2375c2b547dbecf62d4bea8a9e623d3ecc536b
(10)   EAP-Message = 0x03ac0004
(10)   Message-Authenticator = 0x00000000000000000000000000000000
(10)   User-Name = "emiruss"
(10) Finished request
Thread 5 waiting to be assigned a request
Waking up in 4.4 seconds.
(0) Cleaning up request packet ID 166 with timestamp +1231
(1) Cleaning up request packet ID 167 with timestamp +1231
(2) Cleaning up request packet ID 168 with timestamp +1231
(3) Cleaning up request packet ID 169 with timestamp +1231
(4) Cleaning up request packet ID 170 with timestamp +1231
(5) Cleaning up request packet ID 171 with timestamp +1231
(6) Cleaning up request packet ID 172 with timestamp +1231
(7) Cleaning up request packet ID 173 with timestamp +1231
(8) Cleaning up request packet ID 174 with timestamp +1231
(9) Cleaning up request packet ID 175 with timestamp +1231
(10) Cleaning up request packet ID 176 with timestamp +1231
Ready to process requests
Waking up in 0.3 seconds.
Thread 4 got semaphore
Thread 4 handling request 11, (3 handled so far)
(11) <running>: Received Access-Request Id 177 from 192.168.1.30:50046 to 172.17.0.4:1812 length 190
(11) <running>:   User-Name = "emiruss"
(11) <running>:   NAS-IP-Address = 192.168.1.30
(11) <running>:   NAS-Identifier = "Ericsson"
(11) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(11) <running>:   NAS-Port-Type = Wireless-802.11
(11) <running>:   NAS-Port = 0
(11) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(11) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(11) <running>:   Acct-Session-Id = "003E2DE6-00000053"
(11) <running>:   Framed-MTU = 1400
(11) <running>:   EAP-Message = 0x02c9000c01656d6972757373
(11) <running>:   Message-Authenticator = 0x97f0e0905a5205e7d3159740def4e7ad
(11) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(11) <running>:   authorize {
(11) <running>:     policy filter_username {
(11) <running>:       if (!&User-Name) {
(11) <running>:       if (!&User-Name)  -> FALSE
(11) <running>:       if (&User-Name =~ / /) {
(11) <running>:       if (&User-Name =~ / /)  -> FALSE
(11) <running>:       if (&User-Name =~ /@.*@/ ) {
(11) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(11) <running>:       if (&User-Name =~ /\.\./ ) {
(11) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(11) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(11) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(11) <running>:       if (&User-Name =~ /\.$/)  {
(11) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(11) <running>:       if (&User-Name =~ /@\./)  {
(11) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(11) <running>:     } # policy filter_username = notfound
(11)     [preprocess] = ok
(11)     [chap] = noop
(11)     [mschap] = noop
(11)     [digest] = noop
(11) suffix: Checking for suffix after "@"
(11) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(11) suffix: No such realm "NULL"
(11)     [suffix] = noop
(11) eap: Peer sent EAP Response (code 2) ID 201 length 12
(11) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(11)     [eap] = ok
(11)   } # authorize = ok
(11) Found Auth-Type = EAP
(11) # Executing group from file /etc/freeradius/sites-enabled/default
(11)   authenticate {
(11) eap: Peer sent packet with method EAP Identity (1)
(11) eap: Calling submodule eap_md5 to process data
(11) eap_md5: Issuing MD5 Challenge
(11) eap: Sending EAP Request (code 1) ID 202 length 22
(11) eap: EAP session adding &reply:State = 0xe90d8ab1e9c78e0b
(11)     [eap] = handled
(11)   } # authenticate = handled
(11) Using Post-Auth-Type Challenge
(11) Post-Auth-Type sub-section not found.  Ignoring.
(11) # Executing group from file /etc/freeradius/sites-enabled/default
(11) Sent Access-Challenge Id 177 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(11)   EAP-Message = 0x01ca00160410507c9d4e276565b2a3ff57ce4f0e065f
(11)   Message-Authenticator = 0x00000000000000000000000000000000
(11)   State = 0xe90d8ab1e9c78e0bc8d1f3d8f4ce5b78
(11) Finished request
Thread 4 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 3 got semaphore
Thread 3 handling request 12, (3 handled so far)
(12) <running>: Received Access-Request Id 178 from 192.168.1.30:50046 to 172.17.0.4:1812 length 204
(12) <running>:   User-Name = "emiruss"
(12) <running>:   NAS-IP-Address = 192.168.1.30
(12) <running>:   NAS-Identifier = "Ericsson"
(12) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(12) <running>:   NAS-Port-Type = Wireless-802.11
(12) <running>:   NAS-Port = 0
(12) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(12) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(12) <running>:   Acct-Session-Id = "003E2DE6-00000053"
(12) <running>:   Framed-MTU = 1400
(12) <running>:   EAP-Message = 0x02ca00080319152b
(12) <running>:   State = 0xe90d8ab1e9c78e0bc8d1f3d8f4ce5b78
(12) <running>:   Message-Authenticator = 0xe0f29342881c50bf7ee88e02fc59d49f
(12) <running>: session-state: No cached attributes
(12) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(12) <running>:   authorize {
(12) <running>:     policy filter_username {
(12) <running>:       if (!&User-Name) {
(12) <running>:       if (!&User-Name)  -> FALSE
(12) <running>:       if (&User-Name =~ / /) {
(12) <running>:       if (&User-Name =~ / /)  -> FALSE
(12) <running>:       if (&User-Name =~ /@.*@/ ) {
(12) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(12) <running>:       if (&User-Name =~ /\.\./ ) {
(12) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(12) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(12) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(12) <running>:       if (&User-Name =~ /\.$/)  {
(12) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(12) <running>:       if (&User-Name =~ /@\./)  {
(12) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(12) <running>:     } # policy filter_username = notfound
(12)     [preprocess] = ok
(12)     [chap] = noop
(12)     [mschap] = noop
(12)     [digest] = noop
(12) suffix: Checking for suffix after "@"
(12) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(12) suffix: No such realm "NULL"
(12)     [suffix] = noop
(12) eap: Peer sent EAP Response (code 2) ID 202 length 8
(12) eap: No EAP Start, assuming it's an on-going EAP conversation
(12)     [eap] = updated
(12)     [files] = noop
(12) sql: EXPAND %{User-Name}
(12) sql:    --> emiruss
(12) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Closing connection (5): Hit idle_timeout, was idle for 66260 seconds
rlm_sql (sql): You probably need to lower "min"
rlm_sql_mysql: Socket destructor called, closing socket
rlm_sql (sql): Closing connection (6): Hit idle_timeout, was idle for 66260 seconds
rlm_sql (sql): You probably need to lower "min"
rlm_sql_mysql: Socket destructor called, closing socket
rlm_sql (sql): 0 of 0 connections in use.  You  may need to increase "spare"
rlm_sql (sql): Opening additional connection (7), 1 of 32 pending slots used
rlm_sql_mysql: Starting connect to MySQL server
rlm_sql_mysql: Connected to database 'radius' on 172.17.0.2 via TCP/IP, server version 5.7.9, protocol version 10
rlm_sql (sql): Reserved connection (7)
(12) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(12) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(12) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(12) sql: User found in radcheck table
(12) sql: Conditional check items matched, merging assignment check items
(12) sql:   Cleartext-Password := "emiruss"
(12) sql: EXPAND SELECT id, username, attribute, value, op FROM radreply WHERE username = '%{SQL-User-Name}' ORDER BY id
(12) sql:    --> SELECT id, username, attribute, value, op FROM radreply WHERE username = 'emiruss' ORDER BY id
(12) sql: Executing select query: SELECT id, username, attribute, value, op FROM radreply WHERE username = 'emiruss' ORDER BY id
(12) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(12) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(12) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(12) sql: User not found in any groups
rlm_sql (sql): Released connection (7)
rlm_sql (sql): Need 2 more connections to reach 10 spares
rlm_sql (sql): Opening additional connection (8), 1 of 31 pending slots used
rlm_sql_mysql: Starting connect to MySQL server
rlm_sql_mysql: Connected to database 'radius' on 172.17.0.2 via TCP/IP, server version 5.7.9, protocol version 10
(12)     [sql] = ok
(12)     [expiration] = noop
(12)     [logintime] = noop
(12) pap: WARNING: Auth-Type already set.  Not setting to PAP
(12)     [pap] = noop
(12)   } # authorize = updated
(12) Found Auth-Type = EAP
(12) # Executing group from file /etc/freeradius/sites-enabled/default
(12)   authenticate {
(12) eap: Expiring EAP session with state 0xe90d8ab1e9c78e0b
(12) eap: Finished EAP session with state 0xe90d8ab1e9c78e0b
(12) eap: Previous EAP request found for state 0xe90d8ab1e9c78e0b, released from the list
(12) eap: Peer sent packet with method EAP NAK (3)
(12) eap: Found mutually acceptable type PEAP (25)
(12) eap: Calling submodule eap_peap to process data
(12) eap_peap: Initiating new EAP-TLS session
(12) eap_peap: Flushing SSL sessions (of #0)
(12) eap_peap: [eaptls start] = request
(12) eap: Sending EAP Request (code 1) ID 203 length 6
(12) eap: EAP session adding &reply:State = 0xe90d8ab1e8c6930b
(12)     [eap] = handled
(12)   } # authenticate = handled
(12) Using Post-Auth-Type Challenge
(12) Post-Auth-Type sub-section not found.  Ignoring.
(12) # Executing group from file /etc/freeradius/sites-enabled/default
(12) Sent Access-Challenge Id 178 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(12)   EAP-Message = 0x01cb00061920
(12)   Message-Authenticator = 0x00000000000000000000000000000000
(12)   State = 0xe90d8ab1e8c6930bc8d1f3d8f4ce5b78
(12) Finished request
Thread 3 waiting to be assigned a request
Thread 2 got semaphore
Thread 2 handling request 13, (3 handled so far)
(13) <running>: Received Access-Request Id 179 from 192.168.1.30:50046 to 172.17.0.4:1812 length 339
(13) <running>:   User-Name = "emiruss"
(13) <running>:   NAS-IP-Address = 192.168.1.30
(13) <running>:   NAS-Identifier = "Ericsson"
(13) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(13) <running>:   NAS-Port-Type = Wireless-802.11
(13) <running>:   NAS-Port = 0
(13) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(13) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(13) <running>:   Acct-Session-Id = "003E2DE6-00000053"
(13) <running>:   Framed-MTU = 1400
(13) <running>:   EAP-Message = 0x02cb008f19800000008516030100800100007c0301565638d67a0d08c6ff9801afa4a5589e0d6c4f76a6193b95905c6dbcd51f8aaf00003400ffc02cc02bc024c023c00ac009c008c030c02fc028c027c014c013c012009d009c003d003c0035002f000ac007c011000500040100001f000a0008000600
(13) <running>:   State = 0xe90d8ab1e8c6930bc8d1f3d8f4ce5b78
(13) <running>:   Message-Authenticator = 0x0d30dd99511630fa2023d0c53eeda968
(13) <running>: session-state: No cached attributes
(13) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(13) <running>:   authorize {
(13) <running>:     policy filter_username {
(13) <running>:       if (!&User-Name) {
(13) <running>:       if (!&User-Name)  -> FALSE
(13) <running>:       if (&User-Name =~ / /) {
(13) <running>:       if (&User-Name =~ / /)  -> FALSE
(13) <running>:       if (&User-Name =~ /@.*@/ ) {
(13) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(13) <running>:       if (&User-Name =~ /\.\./ ) {
(13) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(13) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(13) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(13) <running>:       if (&User-Name =~ /\.$/)  {
(13) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(13) <running>:       if (&User-Name =~ /@\./)  {
(13) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(13) <running>:     } # policy filter_username = notfound
(13)     [preprocess] = ok
(13)     [chap] = noop
(13)     [mschap] = noop
(13)     [digest] = noop
(13) suffix: Checking for suffix after "@"
(13) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(13) suffix: No such realm "NULL"
(13)     [suffix] = noop
(13) eap: Peer sent EAP Response (code 2) ID 203 length 143
(13) eap: Continuing tunnel setup
(13)     [eap] = ok
(13)   } # authorize = ok
(13) Found Auth-Type = EAP
(13) # Executing group from file /etc/freeradius/sites-enabled/default
(13)   authenticate {
(13) eap: Expiring EAP session with state 0xe90d8ab1e8c6930b
(13) eap: Finished EAP session with state 0xe90d8ab1e8c6930b
(13) eap: Previous EAP request found for state 0xe90d8ab1e8c6930b, released from the list
(13) eap: Peer sent packet with method EAP PEAP (25)
(13) eap: Calling submodule eap_peap to process data
(13) eap_peap: Continuing EAP-TLS
(13) eap_peap: Peer indicated complete TLS record size will be 133 bytes
(13) eap_peap: Got complete TLS record (133 bytes)
(13) eap_peap: [eaptls verify] = length included
(13) eap_peap: (other): before/accept initialization
(13) eap_peap: TLS_accept: before/accept initialization
(13) eap_peap: <<< TLS 1.0 Handshake [length 0080], ClientHello 
(13) eap_peap: TLS_accept: SSLv3 read client hello A
(13) eap_peap: >>> TLS 1.0 Handshake [length 0059], ServerHello 
(13) eap_peap: TLS_accept: SSLv3 write server hello A
(13) eap_peap: >>> TLS 1.0 Handshake [length 08d3], Certificate 
(13) eap_peap: TLS_accept: SSLv3 write certificate A
(13) eap_peap: >>> TLS 1.0 Handshake [length 014b], ServerKeyExchange 
(13) eap_peap: TLS_accept: SSLv3 write key exchange A
(13) eap_peap: >>> TLS 1.0 Handshake [length 0004], ServerHelloDone 
(13) eap_peap: TLS_accept: SSLv3 write server done A
(13) eap_peap: TLS_accept: SSLv3 flush data
(13) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(13) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(13) eap_peap: In SSL Handshake Phase
(13) eap_peap: In SSL Accept mode
(13) eap_peap: [eaptls process] = handled
(13) eap: Sending EAP Request (code 1) ID 204 length 1004
(13) eap: EAP session adding &reply:State = 0xe90d8ab1ebc1930b
(13)     [eap] = handled
(13)   } # authenticate = handled
(13) Using Post-Auth-Type Challenge
(13) Post-Auth-Type sub-section not found.  Ignoring.
(13) # Executing group from file /etc/freeradius/sites-enabled/default
(13) Sent Access-Challenge Id 179 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(13)   EAP-Message = 0x01cc03ec19c000000a8f16030100590200005503012971993f1bbfc3a04704930fc40778d25c46a2bd80ea99d66b721832eb6f46d620188bec9f690643e171a907fc26c91e197fb763ca0c5ee0519806e5c439251685c01400000dff01000100000b00040300010216030108d30b0008cf0008cc0003de
(13)   Message-Authenticator = 0x00000000000000000000000000000000
(13)   State = 0xe90d8ab1ebc1930bc8d1f3d8f4ce5b78
(13) Finished request
Thread 2 waiting to be assigned a request
Thread 1 got semaphore
Thread 1 handling request 14, (3 handled so far)
(14) <running>: Received Access-Request Id 180 from 192.168.1.30:50046 to 172.17.0.4:1812 length 202
(14) <running>:   User-Name = "emiruss"
(14) <running>:   NAS-IP-Address = 192.168.1.30
(14) <running>:   NAS-Identifier = "Ericsson"
(14) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(14) <running>:   NAS-Port-Type = Wireless-802.11
(14) <running>:   NAS-Port = 0
(14) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(14) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(14) <running>:   Acct-Session-Id = "003E2DE6-00000053"
(14) <running>:   Framed-MTU = 1400
(14) <running>:   EAP-Message = 0x02cc00061900
(14) <running>:   State = 0xe90d8ab1ebc1930bc8d1f3d8f4ce5b78
(14) <running>:   Message-Authenticator = 0x6f81bd6f48be41e390e7e4ac03cbe6ea
(14) <running>: session-state: No cached attributes
(14) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(14) <running>:   authorize {
(14) <running>:     policy filter_username {
(14) <running>:       if (!&User-Name) {
(14) <running>:       if (!&User-Name)  -> FALSE
(14) <running>:       if (&User-Name =~ / /) {
(14) <running>:       if (&User-Name =~ / /)  -> FALSE
(14) <running>:       if (&User-Name =~ /@.*@/ ) {
(14) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(14) <running>:       if (&User-Name =~ /\.\./ ) {
(14) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(14) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(14) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(14) <running>:       if (&User-Name =~ /\.$/)  {
(14) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(14) <running>:       if (&User-Name =~ /@\./)  {
(14) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(14) <running>:     } # policy filter_username = notfound
(14)     [preprocess] = ok
(14)     [chap] = noop
(14)     [mschap] = noop
(14)     [digest] = noop
(14) suffix: Checking for suffix after "@"
(14) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(14) suffix: No such realm "NULL"
(14)     [suffix] = noop
(14) eap: Peer sent EAP Response (code 2) ID 204 length 6
(14) eap: Continuing tunnel setup
(14)     [eap] = ok
(14)   } # authorize = ok
(14) Found Auth-Type = EAP
(14) # Executing group from file /etc/freeradius/sites-enabled/default
(14)   authenticate {
(14) eap: Expiring EAP session with state 0xe90d8ab1ebc1930b
(14) eap: Finished EAP session with state 0xe90d8ab1ebc1930b
(14) eap: Previous EAP request found for state 0xe90d8ab1ebc1930b, released from the list
(14) eap: Peer sent packet with method EAP PEAP (25)
(14) eap: Calling submodule eap_peap to process data
(14) eap_peap: Continuing EAP-TLS
(14) eap_peap: Peer ACKed our handshake fragment
(14) eap_peap: [eaptls verify] = request
(14) eap_peap: [eaptls process] = handled
(14) eap: Sending EAP Request (code 1) ID 205 length 1000
(14) eap: EAP session adding &reply:State = 0xe90d8ab1eac0930b
(14)     [eap] = handled
(14)   } # authenticate = handled
(14) Using Post-Auth-Type Challenge
(14) Post-Auth-Type sub-section not found.  Ignoring.
(14) # Executing group from file /etc/freeradius/sites-enabled/default
(14) Sent Access-Challenge Id 180 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(14)   EAP-Message = 0x01cd03e819400dd0405955c762981948527048701681d313d3cc6629a5557b66df2aae22c8590ab99d66ec8d3792a72e30596410f5d1e81f5a774969a1ce9ad6bd01d42da65536016e80a905c662a71ef5c075b8bdf0127a0cf1bd4c91290e15edffa035febde0185096bdc1e553090004e8308204e430
(14)   Message-Authenticator = 0x00000000000000000000000000000000
(14)   State = 0xe90d8ab1eac0930bc8d1f3d8f4ce5b78
(14) Finished request
Thread 1 waiting to be assigned a request
Thread 5 got semaphore
Thread 5 handling request 15, (4 handled so far)
(15) <running>: Received Access-Request Id 181 from 192.168.1.30:50046 to 172.17.0.4:1812 length 202
(15) <running>:   User-Name = "emiruss"
(15) <running>:   NAS-IP-Address = 192.168.1.30
(15) <running>:   NAS-Identifier = "Ericsson"
(15) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(15) <running>:   NAS-Port-Type = Wireless-802.11
(15) <running>:   NAS-Port = 0
(15) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(15) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(15) <running>:   Acct-Session-Id = "003E2DE6-00000053"
(15) <running>:   Framed-MTU = 1400
(15) <running>:   EAP-Message = 0x02cd00061900
(15) <running>:   State = 0xe90d8ab1eac0930bc8d1f3d8f4ce5b78
(15) <running>:   Message-Authenticator = 0x01547e3134b0a4069b1cef11382ed3bb
(15) <running>: session-state: No cached attributes
(15) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(15) <running>:   authorize {
(15) <running>:     policy filter_username {
(15) <running>:       if (!&User-Name) {
(15) <running>:       if (!&User-Name)  -> FALSE
(15) <running>:       if (&User-Name =~ / /) {
(15) <running>:       if (&User-Name =~ / /)  -> FALSE
(15) <running>:       if (&User-Name =~ /@.*@/ ) {
(15) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(15) <running>:       if (&User-Name =~ /\.\./ ) {
(15) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(15) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(15) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(15) <running>:       if (&User-Name =~ /\.$/)  {
(15) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(15) <running>:       if (&User-Name =~ /@\./)  {
(15) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(15) <running>:     } # policy filter_username = notfound
(15)     [preprocess] = ok
(15)     [chap] = noop
(15)     [mschap] = noop
(15)     [digest] = noop
(15) suffix: Checking for suffix after "@"
(15) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(15) suffix: No such realm "NULL"
(15)     [suffix] = noop
(15) eap: Peer sent EAP Response (code 2) ID 205 length 6
(15) eap: Continuing tunnel setup
(15)     [eap] = ok
(15)   } # authorize = ok
(15) Found Auth-Type = EAP
(15) # Executing group from file /etc/freeradius/sites-enabled/default
(15)   authenticate {
(15) eap: Expiring EAP session with state 0xe90d8ab1eac0930b
(15) eap: Finished EAP session with state 0xe90d8ab1eac0930b
(15) eap: Previous EAP request found for state 0xe90d8ab1eac0930b, released from the list
(15) eap: Peer sent packet with method EAP PEAP (25)
(15) eap: Calling submodule eap_peap to process data
(15) eap_peap: Continuing EAP-TLS
(15) eap_peap: Peer ACKed our handshake fragment
(15) eap_peap: [eaptls verify] = request
(15) eap_peap: [eaptls process] = handled
(15) eap: Sending EAP Request (code 1) ID 206 length 721
(15) eap: EAP session adding &reply:State = 0xe90d8ab1edc3930b
(15)     [eap] = handled
(15)   } # authenticate = handled
(15) Using Post-Auth-Type Challenge
(15) Post-Auth-Type sub-section not found.  Ignoring.
(15) # Executing group from file /etc/freeradius/sites-enabled/default
(15) Sent Access-Challenge Id 181 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(15)   EAP-Message = 0x01ce02d1190020417574686f72697479820900c3fc536eef83d741300f0603551d130101ff040530030101ff30360603551d1f042f302d302ba029a0278625687474703a2f2f7777772e6578616d706c652e6f72672f6578616d706c655f63612e63726c300d06092a864886f70d01010b050003820101
(15)   Message-Authenticator = 0x00000000000000000000000000000000
(15)   State = 0xe90d8ab1edc3930bc8d1f3d8f4ce5b78
(15) Finished request
Thread 5 waiting to be assigned a request
Thread 4 got semaphore
Thread 4 handling request 16, (4 handled so far)
(16) <running>: Received Access-Request Id 182 from 192.168.1.30:50046 to 172.17.0.4:1812 length 340
(16) <running>:   User-Name = "emiruss"
(16) <running>:   NAS-IP-Address = 192.168.1.30
(16) <running>:   NAS-Identifier = "Ericsson"
(16) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(16) <running>:   NAS-Port-Type = Wireless-802.11
(16) <running>:   NAS-Port = 0
(16) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(16) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(16) <running>:   Acct-Session-Id = "003E2DE6-00000053"
(16) <running>:   Framed-MTU = 1400
(16) <running>:   EAP-Message = 0x02ce00901980000000861603010046100000424104548578fe7a71437fbb4609598030c615440fda9e179a1b1821f949078a7a34e1ffc36d4eea4c21d6e1b779f175d49759ba95c228da436f57ee09cec608a97d0f1403010001011603010030e2e7699abdb3e018b04e772a36db0bc8e8235ad1ee730c
(16) <running>:   State = 0xe90d8ab1edc3930bc8d1f3d8f4ce5b78
(16) <running>:   Message-Authenticator = 0xa81f3a0a78642c527dc3864f33f01bc2
(16) <running>: session-state: No cached attributes
(16) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(16) <running>:   authorize {
(16) <running>:     policy filter_username {
(16) <running>:       if (!&User-Name) {
(16) <running>:       if (!&User-Name)  -> FALSE
(16) <running>:       if (&User-Name =~ / /) {
(16) <running>:       if (&User-Name =~ / /)  -> FALSE
(16) <running>:       if (&User-Name =~ /@.*@/ ) {
(16) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(16) <running>:       if (&User-Name =~ /\.\./ ) {
(16) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(16) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(16) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(16) <running>:       if (&User-Name =~ /\.$/)  {
(16) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(16) <running>:       if (&User-Name =~ /@\./)  {
(16) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(16) <running>:     } # policy filter_username = notfound
(16)     [preprocess] = ok
(16)     [chap] = noop
(16)     [mschap] = noop
(16)     [digest] = noop
(16) suffix: Checking for suffix after "@"
(16) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(16) suffix: No such realm "NULL"
(16)     [suffix] = noop
(16) eap: Peer sent EAP Response (code 2) ID 206 length 144
(16) eap: Continuing tunnel setup
(16)     [eap] = ok
(16)   } # authorize = ok
(16) Found Auth-Type = EAP
(16) # Executing group from file /etc/freeradius/sites-enabled/default
(16)   authenticate {
(16) eap: Expiring EAP session with state 0xe90d8ab1edc3930b
(16) eap: Finished EAP session with state 0xe90d8ab1edc3930b
(16) eap: Previous EAP request found for state 0xe90d8ab1edc3930b, released from the list
(16) eap: Peer sent packet with method EAP PEAP (25)
(16) eap: Calling submodule eap_peap to process data
(16) eap_peap: Continuing EAP-TLS
(16) eap_peap: Peer indicated complete TLS record size will be 134 bytes
(16) eap_peap: Got complete TLS record (134 bytes)
(16) eap_peap: [eaptls verify] = length included
(16) eap_peap: <<< TLS 1.0 Handshake [length 0046], ClientKeyExchange 
(16) eap_peap: TLS_accept: SSLv3 read client key exchange A
(16) eap_peap: <<< TLS 1.0 ChangeCipherSpec [length 0001] 
(16) eap_peap: <<< TLS 1.0 Handshake [length 0010], Finished 
(16) eap_peap: TLS_accept: SSLv3 read finished A
(16) eap_peap: >>> TLS 1.0 ChangeCipherSpec [length 0001] 
(16) eap_peap: TLS_accept: SSLv3 write change cipher spec A
(16) eap_peap: >>> TLS 1.0 Handshake [length 0010], Finished 
(16) eap_peap: TLS_accept: SSLv3 write finished A
(16) eap_peap: TLS_accept: SSLv3 flush data
(16) eap_peap: (other): SSL negotiation finished successfully
(16) eap_peap: SSL Connection Established
(16) eap_peap: [eaptls process] = handled
(16) eap: Sending EAP Request (code 1) ID 207 length 65
(16) eap: EAP session adding &reply:State = 0xe90d8ab1ecc2930b
(16)     [eap] = handled
(16)   } # authenticate = handled
(16) Using Post-Auth-Type Challenge
(16) Post-Auth-Type sub-section not found.  Ignoring.
(16) # Executing group from file /etc/freeradius/sites-enabled/default
(16) Sent Access-Challenge Id 182 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(16)   EAP-Message = 0x01cf004119001403010001011603010030dc43da51f757679bfec4b419f28b9b530ca6430c4743660df769e5a1a2b6e8eb0348b31c88885108bf651e13200c0f16
(16)   Message-Authenticator = 0x00000000000000000000000000000000
(16)   State = 0xe90d8ab1ecc2930bc8d1f3d8f4ce5b78
(16) Finished request
Thread 4 waiting to be assigned a request
Thread 3 got semaphore
Thread 3 handling request 17, (4 handled so far)
(17) <running>: Received Access-Request Id 183 from 192.168.1.30:50046 to 172.17.0.4:1812 length 202
(17) <running>:   User-Name = "emiruss"
(17) <running>:   NAS-IP-Address = 192.168.1.30
(17) <running>:   NAS-Identifier = "Ericsson"
(17) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(17) <running>:   NAS-Port-Type = Wireless-802.11
(17) <running>:   NAS-Port = 0
(17) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(17) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(17) <running>:   Acct-Session-Id = "003E2DE6-00000053"
(17) <running>:   Framed-MTU = 1400
(17) <running>:   EAP-Message = 0x02cf00061900
(17) <running>:   State = 0xe90d8ab1ecc2930bc8d1f3d8f4ce5b78
(17) <running>:   Message-Authenticator = 0x3d732af724b0c84f8e2b09c5094cdd55
(17) <running>: session-state: No cached attributes
(17) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(17) <running>:   authorize {
(17) <running>:     policy filter_username {
(17) <running>:       if (!&User-Name) {
(17) <running>:       if (!&User-Name)  -> FALSE
(17) <running>:       if (&User-Name =~ / /) {
(17) <running>:       if (&User-Name =~ / /)  -> FALSE
(17) <running>:       if (&User-Name =~ /@.*@/ ) {
(17) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(17) <running>:       if (&User-Name =~ /\.\./ ) {
(17) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(17) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(17) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(17) <running>:       if (&User-Name =~ /\.$/)  {
(17) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(17) <running>:       if (&User-Name =~ /@\./)  {
(17) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(17) <running>:     } # policy filter_username = notfound
(17)     [preprocess] = ok
(17)     [chap] = noop
(17)     [mschap] = noop
(17)     [digest] = noop
(17) suffix: Checking for suffix after "@"
(17) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(17) suffix: No such realm "NULL"
(17)     [suffix] = noop
(17) eap: Peer sent EAP Response (code 2) ID 207 length 6
(17) eap: Continuing tunnel setup
(17)     [eap] = ok
(17)   } # authorize = ok
(17) Found Auth-Type = EAP
(17) # Executing group from file /etc/freeradius/sites-enabled/default
(17)   authenticate {
(17) eap: Expiring EAP session with state 0xe90d8ab1ecc2930b
(17) eap: Finished EAP session with state 0xe90d8ab1ecc2930b
(17) eap: Previous EAP request found for state 0xe90d8ab1ecc2930b, released from the list
(17) eap: Peer sent packet with method EAP PEAP (25)
(17) eap: Calling submodule eap_peap to process data
(17) eap_peap: Continuing EAP-TLS
(17) eap_peap: Peer ACKed our handshake fragment.  handshake is finished
(17) eap_peap: [eaptls verify] = success
(17) eap_peap: [eaptls process] = success
(17) eap_peap: Session established.  Decoding tunneled attributes
(17) eap_peap: PEAP state TUNNEL ESTABLISHED
(17) eap: Sending EAP Request (code 1) ID 208 length 43
(17) eap: EAP session adding &reply:State = 0xe90d8ab1efdd930b
(17)     [eap] = handled
(17)   } # authenticate = handled
(17) Using Post-Auth-Type Challenge
(17) Post-Auth-Type sub-section not found.  Ignoring.
(17) # Executing group from file /etc/freeradius/sites-enabled/default
(17) Sent Access-Challenge Id 183 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(17)   EAP-Message = 0x01d0002b1900170301002068838333beaeb490b3c61071fd24495ec8b7e52f89dbe7df0cec177966e299b6
(17)   Message-Authenticator = 0x00000000000000000000000000000000
(17)   State = 0xe90d8ab1efdd930bc8d1f3d8f4ce5b78
(17) Finished request
Thread 3 waiting to be assigned a request
Waking up in 0.2 seconds.
Waking up in 0.2 seconds.
Thread 2 got semaphore
Thread 2 handling request 18, (4 handled so far)
(18) <running>: Received Access-Request Id 184 from 192.168.1.30:50046 to 172.17.0.4:1812 length 239
(18) <running>:   User-Name = "emiruss"
(18) <running>:   NAS-IP-Address = 192.168.1.30
(18) <running>:   NAS-Identifier = "Ericsson"
(18) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(18) <running>:   NAS-Port-Type = Wireless-802.11
(18) <running>:   NAS-Port = 0
(18) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(18) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(18) <running>:   Acct-Session-Id = "003E2DE6-00000053"
(18) <running>:   Framed-MTU = 1400
(18) <running>:   EAP-Message = 0x02d0002b19001703010020f8221011662f3391cf0356bfd1e738a1e238fb1928bd01096c6af17e8cfd93ff
(18) <running>:   State = 0xe90d8ab1efdd930bc8d1f3d8f4ce5b78
(18) <running>:   Message-Authenticator = 0xff39ea5c42b23692dda8d793798a5700
(18) <running>: session-state: No cached attributes
(18) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(18) <running>:   authorize {
(18) <running>:     policy filter_username {
(18) <running>:       if (!&User-Name) {
(18) <running>:       if (!&User-Name)  -> FALSE
(18) <running>:       if (&User-Name =~ / /) {
(18) <running>:       if (&User-Name =~ / /)  -> FALSE
(18) <running>:       if (&User-Name =~ /@.*@/ ) {
(18) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(18) <running>:       if (&User-Name =~ /\.\./ ) {
(18) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(18) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(18) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(18) <running>:       if (&User-Name =~ /\.$/)  {
(18) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(18) <running>:       if (&User-Name =~ /@\./)  {
(18) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(18) <running>:     } # policy filter_username = notfound
(18)     [preprocess] = ok
(18)     [chap] = noop
(18)     [mschap] = noop
(18)     [digest] = noop
(18) suffix: Checking for suffix after "@"
(18) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(18) suffix: No such realm "NULL"
(18)     [suffix] = noop
(18) eap: Peer sent EAP Response (code 2) ID 208 length 43
(18) eap: Continuing tunnel setup
(18)     [eap] = ok
(18)   } # authorize = ok
(18) Found Auth-Type = EAP
(18) # Executing group from file /etc/freeradius/sites-enabled/default
(18)   authenticate {
(18) eap: Expiring EAP session with state 0xe90d8ab1efdd930b
(18) eap: Finished EAP session with state 0xe90d8ab1efdd930b
(18) eap: Previous EAP request found for state 0xe90d8ab1efdd930b, released from the list
(18) eap: Peer sent packet with method EAP PEAP (25)
(18) eap: Calling submodule eap_peap to process data
(18) eap_peap: Continuing EAP-TLS
(18) eap_peap: [eaptls verify] = ok
(18) eap_peap: Done initial handshake
(18) eap_peap: [eaptls process] = ok
(18) eap_peap: Session established.  Decoding tunneled attributes
(18) eap_peap: PEAP state WAITING FOR INNER IDENTITY
(18) eap_peap: Identity - emiruss
(18) eap_peap: Got inner identity 'emiruss'
(18) eap_peap: Setting default EAP type for tunneled EAP session
(18) eap_peap: Got tunneled request
(18) eap_peap:   EAP-Message = 0x02d0000c01656d6972757373
(18) eap_peap: Setting User-Name to emiruss
(18) eap_peap: Sending tunneled request to inner-tunnel
(18) eap_peap:   EAP-Message = 0x02d0000c01656d6972757373
(18) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(18) eap_peap:   User-Name = "emiruss"
(18) Virtual server inner-tunnel received request
(18)   EAP-Message = 0x02d0000c01656d6972757373
(18)   FreeRADIUS-Proxied-To = 127.0.0.1
(18)   User-Name = "emiruss"
(18) server inner-tunnel {
(18)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(18)     authorize {
(18)       [chap] = noop
(18)       [mschap] = noop
(18) suffix: Checking for suffix after "@"
(18) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(18) suffix: No such realm "NULL"
(18)       [suffix] = noop
(18)       update control {
(18)         &Proxy-To-Realm := LOCAL
(18)       } # update control = noop
(18) eap: Peer sent EAP Response (code 2) ID 208 length 12
(18) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(18)       [eap] = ok
(18)     } # authorize = ok
(18)   Found Auth-Type = EAP
(18)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(18)     authenticate {
(18) eap: Peer sent packet with method EAP Identity (1)
(18) eap: Calling submodule eap_mschapv2 to process data
(18) eap_mschapv2: Issuing Challenge
(18) eap: Sending EAP Request (code 1) ID 209 length 43
(18) eap: EAP session adding &reply:State = 0x6d1d44086dcc5edc
(18)       [eap] = handled
(18)     } # authenticate = handled
(18) } # server inner-tunnel
(18) Virtual server sending reply
(18)   EAP-Message = 0x01d1002b1a01d10026101c8cbcdae84c89efd441bb46a10b8232667265657261646975732d332e302e3130
(18)   Message-Authenticator = 0x00000000000000000000000000000000
(18)   State = 0x6d1d44086dcc5edcba00b82bb2ce7be6
(18) eap_peap: Got tunneled reply code 11
(18) eap_peap:   EAP-Message = 0x01d1002b1a01d10026101c8cbcdae84c89efd441bb46a10b8232667265657261646975732d332e302e3130
(18) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(18) eap_peap:   State = 0x6d1d44086dcc5edcba00b82bb2ce7be6
(18) eap_peap: Got tunneled Access-Challenge
(18) eap: Sending EAP Request (code 1) ID 209 length 75
(18) eap: EAP session adding &reply:State = 0xe90d8ab1eedc930b
(18)     [eap] = handled
(18)   } # authenticate = handled
(18) Using Post-Auth-Type Challenge
(18) Post-Auth-Type sub-section not found.  Ignoring.
(18) # Executing group from file /etc/freeradius/sites-enabled/default
(18) Sent Access-Challenge Id 184 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(18)   EAP-Message = 0x01d1004b1900170301004063755f48e365ec0f2c240abf518ec0d1068b5da263be2c48c15b8462f8d1602f3683628df8b748da34fe9e37ecebdab61a114df85f4dbe05aef196370a288219
(18)   Message-Authenticator = 0x00000000000000000000000000000000
(18)   State = 0xe90d8ab1eedc930bc8d1f3d8f4ce5b78
(18) Finished request
Thread 2 waiting to be assigned a request
Waking up in 0.2 seconds.
Thread 1 got semaphore
Thread 1 handling request 19, (4 handled so far)
(19) <running>: Received Access-Request Id 185 from 192.168.1.30:50046 to 172.17.0.4:1812 length 303
(19) <running>:   User-Name = "emiruss"
(19) <running>:   NAS-IP-Address = 192.168.1.30
(19) <running>:   NAS-Identifier = "Ericsson"
(19) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(19) <running>:   NAS-Port-Type = Wireless-802.11
(19) <running>:   NAS-Port = 0
(19) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(19) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(19) <running>:   Acct-Session-Id = "003E2DE6-00000053"
(19) <running>:   Framed-MTU = 1400
(19) <running>:   EAP-Message = 0x02d1006b190017030100604828cf0ce53e00221aec53b20ab012f6ebf440e7866d4bc254dafcadd5f916fa165d22dfbe9d5564532078ac0dc9c248e75a6493a0523d72cce02d4b272ecd3957d652552ec0a80b20ea9d39ee9fcb80fffdddebecefa5653d07564239daa5d5
(19) <running>:   State = 0xe90d8ab1eedc930bc8d1f3d8f4ce5b78
(19) <running>:   Message-Authenticator = 0x6c9e704794f69e7dbffdd5ccf720ad02
(19) <running>: session-state: No cached attributes
(19) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(19) <running>:   authorize {
(19) <running>:     policy filter_username {
(19) <running>:       if (!&User-Name) {
(19) <running>:       if (!&User-Name)  -> FALSE
(19) <running>:       if (&User-Name =~ / /) {
(19) <running>:       if (&User-Name =~ / /)  -> FALSE
(19) <running>:       if (&User-Name =~ /@.*@/ ) {
(19) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(19) <running>:       if (&User-Name =~ /\.\./ ) {
(19) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(19) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(19) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(19) <running>:       if (&User-Name =~ /\.$/)  {
(19) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(19) <running>:       if (&User-Name =~ /@\./)  {
(19) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(19) <running>:     } # policy filter_username = notfound
(19)     [preprocess] = ok
(19)     [chap] = noop
(19)     [mschap] = noop
(19)     [digest] = noop
(19) suffix: Checking for suffix after "@"
(19) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(19) suffix: No such realm "NULL"
(19)     [suffix] = noop
(19) eap: Peer sent EAP Response (code 2) ID 209 length 107
(19) eap: Continuing tunnel setup
(19)     [eap] = ok
(19)   } # authorize = ok
(19) Found Auth-Type = EAP
(19) # Executing group from file /etc/freeradius/sites-enabled/default
(19)   authenticate {
(19) eap: Expiring EAP session with state 0x6d1d44086dcc5edc
(19) eap: Finished EAP session with state 0xe90d8ab1eedc930b
(19) eap: Previous EAP request found for state 0xe90d8ab1eedc930b, released from the list
(19) eap: Peer sent packet with method EAP PEAP (25)
(19) eap: Calling submodule eap_peap to process data
(19) eap_peap: Continuing EAP-TLS
(19) eap_peap: [eaptls verify] = ok
(19) eap_peap: Done initial handshake
(19) eap_peap: [eaptls process] = ok
(19) eap_peap: Session established.  Decoding tunneled attributes
(19) eap_peap: PEAP state phase2
(19) eap_peap: EAP method MSCHAPv2 (26)
(19) eap_peap: Got tunneled request
(19) eap_peap:   EAP-Message = 0x02d100421a02d1003d3152e1a1eb2752e27fdcd7c319b80cc34600000000000000009b84f4238debaf5c878e205c87739bd2d35ae2e3fcf4076100656d6972757373
(19) eap_peap: Setting User-Name to emiruss
(19) eap_peap: Sending tunneled request to inner-tunnel
(19) eap_peap:   EAP-Message = 0x02d100421a02d1003d3152e1a1eb2752e27fdcd7c319b80cc34600000000000000009b84f4238debaf5c878e205c87739bd2d35ae2e3fcf4076100656d6972757373
(19) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(19) eap_peap:   User-Name = "emiruss"
(19) eap_peap:   State = 0x6d1d44086dcc5edcba00b82bb2ce7be6
(19) Virtual server inner-tunnel received request
(19)   EAP-Message = 0x02d100421a02d1003d3152e1a1eb2752e27fdcd7c319b80cc34600000000000000009b84f4238debaf5c878e205c87739bd2d35ae2e3fcf4076100656d6972757373
(19)   FreeRADIUS-Proxied-To = 127.0.0.1
(19)   User-Name = "emiruss"
(19)   State = 0x6d1d44086dcc5edcba00b82bb2ce7be6
(19) server inner-tunnel {
(19)   session-state: No cached attributes
(19)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(19)     authorize {
(19)       [chap] = noop
(19)       [mschap] = noop
(19) suffix: Checking for suffix after "@"
(19) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(19) suffix: No such realm "NULL"
(19)       [suffix] = noop
(19)       update control {
(19)         &Proxy-To-Realm := LOCAL
(19)       } # update control = noop
(19) eap: Peer sent EAP Response (code 2) ID 209 length 66
(19) eap: No EAP Start, assuming it's an on-going EAP conversation
(19)       [eap] = updated
(19)       [files] = noop
(19) sql: EXPAND %{User-Name}
(19) sql:    --> emiruss
(19) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Reserved connection (7)
(19) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(19) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(19) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(19) sql: User found in radcheck table
(19) sql: Conditional check items matched, merging assignment check items
(19) sql:   Cleartext-Password := "emiruss"
(19) sql: EXPAND SELECT id, username, attribute, value, op FROM radreply WHERE username = '%{SQL-User-Name}' ORDER BY id
(19) sql:    --> SELECT id, username, attribute, value, op FROM radreply WHERE username = 'emiruss' ORDER BY id
(19) sql: Executing select query: SELECT id, username, attribute, value, op FROM radreply WHERE username = 'emiruss' ORDER BY id
(19) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(19) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(19) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(19) sql: User not found in any groups
rlm_sql (sql): Released connection (7)
(19)       [sql] = ok
(19)       [expiration] = noop
(19)       [logintime] = noop
(19) pap: WARNING: Auth-Type already set.  Not setting to PAP
(19)       [pap] = noop
(19)     } # authorize = updated
(19)   Found Auth-Type = EAP
(19)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(19)     authenticate {
(19) eap: Expiring EAP session with state 0x6d1d44086dcc5edc
(19) eap: Finished EAP session with state 0x6d1d44086dcc5edc
(19) eap: Previous EAP request found for state 0x6d1d44086dcc5edc, released from the list
(19) eap: Peer sent packet with method EAP MSCHAPv2 (26)
(19) eap: Calling submodule eap_mschapv2 to process data
(19) eap_mschapv2: # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(19) eap_mschapv2:   Auth-Type MS-CHAP {
(19) mschap: Found Cleartext-Password, hashing to create NT-Password
(19) mschap: Found Cleartext-Password, hashing to create LM-Password
(19) mschap: Creating challenge hash with username: emiruss
(19) mschap: Client is using MS-CHAPv2
(19) mschap: Adding MS-CHAPv2 MPPE keys
(19)     [mschap] = ok
(19)   } # Auth-Type MS-CHAP = ok
(19) MSCHAP Success
(19) eap: Sending EAP Request (code 1) ID 210 length 51
(19) eap: EAP session adding &reply:State = 0x6d1d44086ccf5edc
(19)       [eap] = handled
(19)     } # authenticate = handled
(19) } # server inner-tunnel
(19) Virtual server sending reply
(19)   EAP-Message = 0x01d200331a03d1002e533d46363842423935424638323037333945323931304344313046374437393442394231353739453043
(19)   Message-Authenticator = 0x00000000000000000000000000000000
(19)   State = 0x6d1d44086ccf5edcba00b82bb2ce7be6
(19) eap_peap: Got tunneled reply code 11
(19) eap_peap:   EAP-Message = 0x01d200331a03d1002e533d46363842423935424638323037333945323931304344313046374437393442394231353739453043
(19) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(19) eap_peap:   State = 0x6d1d44086ccf5edcba00b82bb2ce7be6
(19) eap_peap: Got tunneled Access-Challenge
(19) eap: Sending EAP Request (code 1) ID 210 length 91
(19) eap: EAP session adding &reply:State = 0xe90d8ab1e1df930b
(19)     [eap] = handled
(19)   } # authenticate = handled
(19) Using Post-Auth-Type Challenge
(19) Post-Auth-Type sub-section not found.  Ignoring.
(19) # Executing group from file /etc/freeradius/sites-enabled/default
(19) Sent Access-Challenge Id 185 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(19)   EAP-Message = 0x01d2005b190017030100500bc5b750fce6dd953347610bd6af70306090e7b1da44e0a3d6bf3008379e76e7bd36bc02d302cfae88f8fee5cbca5021aea5bc234b77ade3fd67c0294e4c27966fc5d2ea119e60bb72477c5b2cb481c5
(19)   Message-Authenticator = 0x00000000000000000000000000000000
(19)   State = 0xe90d8ab1e1df930bc8d1f3d8f4ce5b78
(19) Finished request
Thread 1 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 5 got semaphore
Thread 5 handling request 20, (5 handled so far)
(20) <running>: Received Access-Request Id 186 from 192.168.1.30:50046 to 172.17.0.4:1812 length 239
(20) <running>:   User-Name = "emiruss"
(20) <running>:   NAS-IP-Address = 192.168.1.30
(20) <running>:   NAS-Identifier = "Ericsson"
(20) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(20) <running>:   NAS-Port-Type = Wireless-802.11
(20) <running>:   NAS-Port = 0
(20) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(20) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(20) <running>:   Acct-Session-Id = "003E2DE6-00000053"
(20) <running>:   Framed-MTU = 1400
(20) <running>:   EAP-Message = 0x02d2002b19001703010020cd979b87a2c5960fbbce72cd67ba5a6e2b33bc0600b945b0d19f76ab95125873
(20) <running>:   State = 0xe90d8ab1e1df930bc8d1f3d8f4ce5b78
(20) <running>:   Message-Authenticator = 0x1d67f5c66277a57f14b3c91697405ea0
(20) <running>: session-state: No cached attributes
(20) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(20) <running>:   authorize {
(20) <running>:     policy filter_username {
(20) <running>:       if (!&User-Name) {
(20) <running>:       if (!&User-Name)  -> FALSE
(20) <running>:       if (&User-Name =~ / /) {
(20) <running>:       if (&User-Name =~ / /)  -> FALSE
(20) <running>:       if (&User-Name =~ /@.*@/ ) {
(20) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(20) <running>:       if (&User-Name =~ /\.\./ ) {
(20) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(20) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(20) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(20) <running>:       if (&User-Name =~ /\.$/)  {
(20) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(20) <running>:       if (&User-Name =~ /@\./)  {
(20) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(20) <running>:     } # policy filter_username = notfound
(20)     [preprocess] = ok
(20)     [chap] = noop
(20)     [mschap] = noop
(20)     [digest] = noop
(20) suffix: Checking for suffix after "@"
(20) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(20) suffix: No such realm "NULL"
(20)     [suffix] = noop
(20) eap: Peer sent EAP Response (code 2) ID 210 length 43
(20) eap: Continuing tunnel setup
(20)     [eap] = ok
(20)   } # authorize = ok
(20) Found Auth-Type = EAP
(20) # Executing group from file /etc/freeradius/sites-enabled/default
(20)   authenticate {
(20) eap: Expiring EAP session with state 0x6d1d44086ccf5edc
(20) eap: Finished EAP session with state 0xe90d8ab1e1df930b
(20) eap: Previous EAP request found for state 0xe90d8ab1e1df930b, released from the list
(20) eap: Peer sent packet with method EAP PEAP (25)
(20) eap: Calling submodule eap_peap to process data
(20) eap_peap: Continuing EAP-TLS
(20) eap_peap: [eaptls verify] = ok
(20) eap_peap: Done initial handshake
(20) eap_peap: [eaptls process] = ok
(20) eap_peap: Session established.  Decoding tunneled attributes
(20) eap_peap: PEAP state phase2
(20) eap_peap: EAP method MSCHAPv2 (26)
(20) eap_peap: Got tunneled request
(20) eap_peap:   EAP-Message = 0x02d200061a03
(20) eap_peap: Setting User-Name to emiruss
(20) eap_peap: Sending tunneled request to inner-tunnel
(20) eap_peap:   EAP-Message = 0x02d200061a03
(20) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(20) eap_peap:   User-Name = "emiruss"
(20) eap_peap:   State = 0x6d1d44086ccf5edcba00b82bb2ce7be6
(20) Virtual server inner-tunnel received request
(20)   EAP-Message = 0x02d200061a03
(20)   FreeRADIUS-Proxied-To = 127.0.0.1
(20)   User-Name = "emiruss"
(20)   State = 0x6d1d44086ccf5edcba00b82bb2ce7be6
(20) server inner-tunnel {
(20)   session-state: No cached attributes
(20)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(20)     authorize {
(20)       [chap] = noop
(20)       [mschap] = noop
(20) suffix: Checking for suffix after "@"
(20) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(20) suffix: No such realm "NULL"
(20)       [suffix] = noop
(20)       update control {
(20)         &Proxy-To-Realm := LOCAL
(20)       } # update control = noop
(20) eap: Peer sent EAP Response (code 2) ID 210 length 6
(20) eap: No EAP Start, assuming it's an on-going EAP conversation
(20)       [eap] = updated
(20)       [files] = noop
(20) sql: EXPAND %{User-Name}
(20) sql:    --> emiruss
(20) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Reserved connection (8)
(20) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(20) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(20) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(20) sql: User found in radcheck table
(20) sql: Conditional check items matched, merging assignment check items
(20) sql:   Cleartext-Password := "emiruss"
(20) sql: EXPAND SELECT id, username, attribute, value, op FROM radreply WHERE username = '%{SQL-User-Name}' ORDER BY id
(20) sql:    --> SELECT id, username, attribute, value, op FROM radreply WHERE username = 'emiruss' ORDER BY id
(20) sql: Executing select query: SELECT id, username, attribute, value, op FROM radreply WHERE username = 'emiruss' ORDER BY id
(20) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(20) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(20) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(20) sql: User not found in any groups
rlm_sql (sql): Released connection (8)
(20)       [sql] = ok
(20)       [expiration] = noop
(20)       [logintime] = noop
(20) pap: WARNING: Auth-Type already set.  Not setting to PAP
(20)       [pap] = noop
(20)     } # authorize = updated
(20)   Found Auth-Type = EAP
(20)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(20)     authenticate {
(20) eap: Expiring EAP session with state 0x6d1d44086ccf5edc
(20) eap: Finished EAP session with state 0x6d1d44086ccf5edc
(20) eap: Previous EAP request found for state 0x6d1d44086ccf5edc, released from the list
(20) eap: Peer sent packet with method EAP MSCHAPv2 (26)
(20) eap: Calling submodule eap_mschapv2 to process data
(20) eap: Sending EAP Success (code 3) ID 210 length 4
(20) eap: Freeing handler
(20)       [eap] = ok
(20)     } # authenticate = ok
(20)   # Executing section post-auth from file /etc/freeradius/sites-enabled/inner-tunnel
(20)     post-auth {
(20) sql: EXPAND .query
(20) sql:    --> .query
(20) sql: Using query template 'query'
rlm_sql (sql): Reserved connection (7)
(20) sql: EXPAND %{User-Name}
(20) sql:    --> emiruss
(20) sql: SQL-User-Name set to 'emiruss'
(20) sql: EXPAND INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')
(20) sql:    --> INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Accept', '2015-11-25 22:20:56')
(20) sql: Executing query: INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Accept', '2015-11-25 22:20:56')
(20) sql: SQL query returned: success
(20) sql: 1 record(s) updated
rlm_sql (sql): Released connection (7)
(20)       [sql] = ok
(20)     } # post-auth = ok
(20) } # server inner-tunnel
(20) Virtual server sending reply
(20)   MS-MPPE-Encryption-Policy = Encryption-Allowed
(20)   MS-MPPE-Encryption-Types = RC4-40or128-bit-Allowed
(20)   MS-MPPE-Send-Key = 0x394382f7e8ac6aa40ebc5f5d1b06463f
(20)   MS-MPPE-Recv-Key = 0xdbc25193b170dad9810f0395d8667d6e
(20)   EAP-Message = 0x03d20004
(20)   Message-Authenticator = 0x00000000000000000000000000000000
(20)   User-Name = "emiruss"
(20) eap_peap: Got tunneled reply code 2
(20) eap_peap:   MS-MPPE-Encryption-Policy = Encryption-Allowed
(20) eap_peap:   MS-MPPE-Encryption-Types = RC4-40or128-bit-Allowed
(20) eap_peap:   MS-MPPE-Send-Key = 0x394382f7e8ac6aa40ebc5f5d1b06463f
(20) eap_peap:   MS-MPPE-Recv-Key = 0xdbc25193b170dad9810f0395d8667d6e
(20) eap_peap:   EAP-Message = 0x03d20004
(20) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(20) eap_peap:   User-Name = "emiruss"
(20) eap_peap: Tunneled authentication was successful
(20) eap_peap: SUCCESS
(20) eap: Sending EAP Request (code 1) ID 211 length 43
(20) eap: EAP session adding &reply:State = 0xe90d8ab1e0de930b
(20)     [eap] = handled
(20)   } # authenticate = handled
(20) Using Post-Auth-Type Challenge
(20) Post-Auth-Type sub-section not found.  Ignoring.
(20) # Executing group from file /etc/freeradius/sites-enabled/default
(20) Sent Access-Challenge Id 186 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(20)   EAP-Message = 0x01d3002b19001703010020e9876b663c62d4eeebba2691551554200b8e26a39188e4263ae16a246a290710
(20)   Message-Authenticator = 0x00000000000000000000000000000000
(20)   State = 0xe90d8ab1e0de930bc8d1f3d8f4ce5b78
(20) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 4 got semaphore
Thread 4 handling request 21, (5 handled so far)
(21) <running>: Received Access-Request Id 187 from 192.168.1.30:50046 to 172.17.0.4:1812 length 239
(21) <running>:   User-Name = "emiruss"
(21) <running>:   NAS-IP-Address = 192.168.1.30
(21) <running>:   NAS-Identifier = "Ericsson"
(21) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(21) <running>:   NAS-Port-Type = Wireless-802.11
(21) <running>:   NAS-Port = 0
(21) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(21) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(21) <running>:   Acct-Session-Id = "003E2DE6-00000053"
(21) <running>:   Framed-MTU = 1400
(21) <running>:   EAP-Message = 0x02d3002b190017030100208948edcaedc7f0e2262f443438e47e1fa80ee3d707e6547a22c8be22ba113cc7
(21) <running>:   State = 0xe90d8ab1e0de930bc8d1f3d8f4ce5b78
(21) <running>:   Message-Authenticator = 0x25130fb02f4b27eeb288092692fcfe96
(21) <running>: session-state: No cached attributes
(21) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(21) <running>:   authorize {
(21) <running>:     policy filter_username {
(21) <running>:       if (!&User-Name) {
(21) <running>:       if (!&User-Name)  -> FALSE
(21) <running>:       if (&User-Name =~ / /) {
(21) <running>:       if (&User-Name =~ / /)  -> FALSE
(21) <running>:       if (&User-Name =~ /@.*@/ ) {
(21) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(21) <running>:       if (&User-Name =~ /\.\./ ) {
(21) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(21) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(21) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(21) <running>:       if (&User-Name =~ /\.$/)  {
(21) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(21) <running>:       if (&User-Name =~ /@\./)  {
(21) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(21) <running>:     } # policy filter_username = notfound
(21)     [preprocess] = ok
(21)     [chap] = noop
(21)     [mschap] = noop
(21)     [digest] = noop
(21) suffix: Checking for suffix after "@"
(21) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(21) suffix: No such realm "NULL"
(21)     [suffix] = noop
(21) eap: Peer sent EAP Response (code 2) ID 211 length 43
(21) eap: Continuing tunnel setup
(21)     [eap] = ok
(21)   } # authorize = ok
(21) Found Auth-Type = EAP
(21) # Executing group from file /etc/freeradius/sites-enabled/default
(21)   authenticate {
(21) eap: Expiring EAP session with state 0xe90d8ab1e0de930b
(21) eap: Finished EAP session with state 0xe90d8ab1e0de930b
(21) eap: Previous EAP request found for state 0xe90d8ab1e0de930b, released from the list
(21) eap: Peer sent packet with method EAP PEAP (25)
(21) eap: Calling submodule eap_peap to process data
(21) eap_peap: Continuing EAP-TLS
(21) eap_peap: [eaptls verify] = ok
(21) eap_peap: Done initial handshake
(21) eap_peap: [eaptls process] = ok
(21) eap_peap: Session established.  Decoding tunneled attributes
(21) eap_peap: PEAP state send tlv success
(21) eap_peap: Received EAP-TLV response
(21) eap_peap: Success
(21) eap_peap: No information to cache: session caching will be disabled for session 188bec9f690643e171a907fc26c91e197fb763ca0c5ee0519806e5c439251685
(21) eap: Sending EAP Success (code 3) ID 211 length 4
(21) eap: Freeing handler
(21)     [eap] = ok
(21)   } # authenticate = ok
(21) # Executing section post-auth from file /etc/freeradius/sites-enabled/default
(21)   post-auth {
(21)     update {
(21)       No attributes updated
(21)     } # update = noop
(21) sql: EXPAND .query
(21) sql:    --> .query
(21) sql: Using query template 'query'
rlm_sql (sql): Reserved connection (8)
(21) sql: EXPAND %{User-Name}
(21) sql:    --> emiruss
(21) sql: SQL-User-Name set to 'emiruss'
(21) sql: EXPAND INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')
(21) sql:    --> INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Accept', '2015-11-25 22:20:56')
(21) sql: Executing query: INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Accept', '2015-11-25 22:20:56')
(21) sql: SQL query returned: success
(21) sql: 1 record(s) updated
rlm_sql (sql): Released connection (8)
(21)     [sql] = ok
(21)     [exec] = noop
(21)     policy remove_reply_message_if_eap {
(21)       if (&reply:EAP-Message && &reply:Reply-Message) {
(21)       if (&reply:EAP-Message && &reply:Reply-Message)  -> FALSE
(21)       else {
(21)         [noop] = noop
(21)       } # else = noop
(21)     } # policy remove_reply_message_if_eap = noop
(21)   } # post-auth = ok
(21) Sent Access-Accept Id 187 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(21)   MS-MPPE-Recv-Key = 0xbee1ac0126a818be0abc999f4d49f95027eafa864006e488e6e8133e6c9f3d66
(21)   MS-MPPE-Send-Key = 0x5071a307cd1f786a0c6c28ffd9847d7c823bc607ecc358ff46006e94ed2279b0
(21)   EAP-Message = 0x03d30004
(21)   Message-Authenticator = 0x00000000000000000000000000000000
(21)   User-Name = "emiruss"
(21) Finished request
Thread 4 waiting to be assigned a request
Thread 3 got semaphore
Thread 3 handling request 22, (5 handled so far)
(22) <running>: Received Access-Request Id 188 from 192.168.1.30:50046 to 172.17.0.4:1812 length 190
(22) <running>:   User-Name = "emiruss"
(22) <running>:   NAS-IP-Address = 192.168.1.30
(22) <running>:   NAS-Identifier = "Ericsson"
(22) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(22) <running>:   NAS-Port-Type = Wireless-802.11
(22) <running>:   NAS-Port = 0
(22) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(22) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(22) <running>:   Acct-Session-Id = "003E2DE6-00000054"
(22) <running>:   Framed-MTU = 1400
(22) <running>:   EAP-Message = 0x0219000c01656d6972757373
(22) <running>:   Message-Authenticator = 0x7e582c9e3f39023156a94979b224b642
(22) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(22) <running>:   authorize {
(22) <running>:     policy filter_username {
(22) <running>:       if (!&User-Name) {
(22) <running>:       if (!&User-Name)  -> FALSE
(22) <running>:       if (&User-Name =~ / /) {
(22) <running>:       if (&User-Name =~ / /)  -> FALSE
(22) <running>:       if (&User-Name =~ /@.*@/ ) {
(22) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(22) <running>:       if (&User-Name =~ /\.\./ ) {
(22) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(22) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(22) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(22) <running>:       if (&User-Name =~ /\.$/)  {
(22) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(22) <running>:       if (&User-Name =~ /@\./)  {
(22) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(22) <running>:     } # policy filter_username = notfound
(22)     [preprocess] = ok
(22)     [chap] = noop
(22)     [mschap] = noop
(22)     [digest] = noop
(22) suffix: Checking for suffix after "@"
(22) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(22) suffix: No such realm "NULL"
(22)     [suffix] = noop
(22) eap: Peer sent EAP Response (code 2) ID 25 length 12
(22) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(22)     [eap] = ok
(22)   } # authorize = ok
(22) Found Auth-Type = EAP
(22) # Executing group from file /etc/freeradius/sites-enabled/default
(22)   authenticate {
(22) eap: Peer sent packet with method EAP Identity (1)
(22) eap: Calling submodule eap_md5 to process data
(22) eap_md5: Issuing MD5 Challenge
(22) eap: Sending EAP Request (code 1) ID 26 length 22
(22) eap: EAP session adding &reply:State = 0x0f38de710f22da07
(22)     [eap] = handled
(22)   } # authenticate = handled
(22) Using Post-Auth-Type Challenge
(22) Post-Auth-Type sub-section not found.  Ignoring.
(22) # Executing group from file /etc/freeradius/sites-enabled/default
(22) Sent Access-Challenge Id 188 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(22)   EAP-Message = 0x011a00160410ba644675c1e16610232c1db2ce52882a
(22)   Message-Authenticator = 0x00000000000000000000000000000000
(22)   State = 0x0f38de710f22da0770c94d6db95ea3e7
(22) Finished request
Thread 3 waiting to be assigned a request
Thread 2 got semaphore
Thread 2 handling request 23, (5 handled so far)
(23) <running>: Received Access-Request Id 189 from 192.168.1.30:50046 to 172.17.0.4:1812 length 204
(23) <running>:   User-Name = "emiruss"
(23) <running>:   NAS-IP-Address = 192.168.1.30
(23) <running>:   NAS-Identifier = "Ericsson"
(23) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(23) <running>:   NAS-Port-Type = Wireless-802.11
(23) <running>:   NAS-Port = 0
(23) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(23) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(23) <running>:   Acct-Session-Id = "003E2DE6-00000054"
(23) <running>:   Framed-MTU = 1400
(23) <running>:   EAP-Message = 0x021a00080319152b
(23) <running>:   State = 0x0f38de710f22da0770c94d6db95ea3e7
(23) <running>:   Message-Authenticator = 0x432f79283b47ca1fc64b2ee989d786f9
(23) <running>: session-state: No cached attributes
(23) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(23) <running>:   authorize {
(23) <running>:     policy filter_username {
(23) <running>:       if (!&User-Name) {
(23) <running>:       if (!&User-Name)  -> FALSE
(23) <running>:       if (&User-Name =~ / /) {
(23) <running>:       if (&User-Name =~ / /)  -> FALSE
(23) <running>:       if (&User-Name =~ /@.*@/ ) {
(23) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(23) <running>:       if (&User-Name =~ /\.\./ ) {
(23) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(23) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(23) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(23) <running>:       if (&User-Name =~ /\.$/)  {
(23) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(23) <running>:       if (&User-Name =~ /@\./)  {
(23) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(23) <running>:     } # policy filter_username = notfound
(23)     [preprocess] = ok
(23)     [chap] = noop
(23)     [mschap] = noop
(23)     [digest] = noop
(23) suffix: Checking for suffix after "@"
(23) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(23) suffix: No such realm "NULL"
(23)     [suffix] = noop
(23) eap: Peer sent EAP Response (code 2) ID 26 length 8
(23) eap: No EAP Start, assuming it's an on-going EAP conversation
(23)     [eap] = updated
(23)     [files] = noop
(23) sql: EXPAND %{User-Name}
(23) sql:    --> emiruss
(23) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Reserved connection (7)
(23) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(23) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(23) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(23) sql: User found in radcheck table
(23) sql: Conditional check items matched, merging assignment check items
(23) sql:   Cleartext-Password := "emiruss"
(23) sql: EXPAND SELECT id, username, attribute, value, op FROM radreply WHERE username = '%{SQL-User-Name}' ORDER BY id
(23) sql:    --> SELECT id, username, attribute, value, op FROM radreply WHERE username = 'emiruss' ORDER BY id
(23) sql: Executing select query: SELECT id, username, attribute, value, op FROM radreply WHERE username = 'emiruss' ORDER BY id
(23) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(23) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(23) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(23) sql: User not found in any groups
rlm_sql (sql): Released connection (7)
(23)     [sql] = ok
(23)     [expiration] = noop
(23)     [logintime] = noop
(23) pap: WARNING: Auth-Type already set.  Not setting to PAP
(23)     [pap] = noop
(23)   } # authorize = updated
(23) Found Auth-Type = EAP
(23) # Executing group from file /etc/freeradius/sites-enabled/default
(23)   authenticate {
(23) eap: Expiring EAP session with state 0x0f38de710f22da07
(23) eap: Finished EAP session with state 0x0f38de710f22da07
(23) eap: Previous EAP request found for state 0x0f38de710f22da07, released from the list
(23) eap: Peer sent packet with method EAP NAK (3)
(23) eap: Found mutually acceptable type PEAP (25)
(23) eap: Calling submodule eap_peap to process data
(23) eap_peap: Initiating new EAP-TLS session
(23) eap_peap: [eaptls start] = request
(23) eap: Sending EAP Request (code 1) ID 27 length 6
(23) eap: EAP session adding &reply:State = 0x0f38de710e23c707
(23)     [eap] = handled
(23)   } # authenticate = handled
(23) Using Post-Auth-Type Challenge
(23) Post-Auth-Type sub-section not found.  Ignoring.
(23) # Executing group from file /etc/freeradius/sites-enabled/default
(23) Sent Access-Challenge Id 189 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(23)   EAP-Message = 0x011b00061920
(23)   Message-Authenticator = 0x00000000000000000000000000000000
(23)   State = 0x0f38de710e23c70770c94d6db95ea3e7
(23) Finished request
Thread 2 waiting to be assigned a request
Thread 1 got semaphore
Thread 1 handling request 24, (5 handled so far)
(24) <running>: Received Access-Request Id 190 from 192.168.1.30:50046 to 172.17.0.4:1812 length 339
(24) <running>:   User-Name = "emiruss"
(24) <running>:   NAS-IP-Address = 192.168.1.30
(24) <running>:   NAS-Identifier = "Ericsson"
(24) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(24) <running>:   NAS-Port-Type = Wireless-802.11
(24) <running>:   NAS-Port = 0
(24) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(24) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(24) <running>:   Acct-Session-Id = "003E2DE6-00000054"
(24) <running>:   Framed-MTU = 1400
(24) <running>:   EAP-Message = 0x021b008f19800000008516030100800100007c0301565638d9f628b68a0103481ced31700baf8d08e3131d555b460fb11c89ec502500003400ffc02cc02bc024c023c00ac009c008c030c02fc028c027c014c013c012009d009c003d003c0035002f000ac007c011000500040100001f000a0008000600
(24) <running>:   State = 0x0f38de710e23c70770c94d6db95ea3e7
(24) <running>:   Message-Authenticator = 0xf3393ac0a6c925449452d816019d1e20
(24) <running>: session-state: No cached attributes
(24) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(24) <running>:   authorize {
(24) <running>:     policy filter_username {
(24) <running>:       if (!&User-Name) {
(24) <running>:       if (!&User-Name)  -> FALSE
(24) <running>:       if (&User-Name =~ / /) {
(24) <running>:       if (&User-Name =~ / /)  -> FALSE
(24) <running>:       if (&User-Name =~ /@.*@/ ) {
(24) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(24) <running>:       if (&User-Name =~ /\.\./ ) {
(24) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(24) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(24) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(24) <running>:       if (&User-Name =~ /\.$/)  {
(24) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(24) <running>:       if (&User-Name =~ /@\./)  {
(24) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(24) <running>:     } # policy filter_username = notfound
(24)     [preprocess] = ok
(24)     [chap] = noop
(24)     [mschap] = noop
(24)     [digest] = noop
(24) suffix: Checking for suffix after "@"
(24) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(24) suffix: No such realm "NULL"
(24)     [suffix] = noop
(24) eap: Peer sent EAP Response (code 2) ID 27 length 143
(24) eap: Continuing tunnel setup
(24)     [eap] = ok
(24)   } # authorize = ok
(24) Found Auth-Type = EAP
(24) # Executing group from file /etc/freeradius/sites-enabled/default
(24)   authenticate {
(24) eap: Expiring EAP session with state 0x0f38de710e23c707
(24) eap: Finished EAP session with state 0x0f38de710e23c707
(24) eap: Previous EAP request found for state 0x0f38de710e23c707, released from the list
(24) eap: Peer sent packet with method EAP PEAP (25)
(24) eap: Calling submodule eap_peap to process data
(24) eap_peap: Continuing EAP-TLS
(24) eap_peap: Peer indicated complete TLS record size will be 133 bytes
(24) eap_peap: Got complete TLS record (133 bytes)
(24) eap_peap: [eaptls verify] = length included
(24) eap_peap: (other): before/accept initialization
(24) eap_peap: TLS_accept: before/accept initialization
(24) eap_peap: <<< TLS 1.0 Handshake [length 0080], ClientHello 
(24) eap_peap: TLS_accept: SSLv3 read client hello A
(24) eap_peap: >>> TLS 1.0 Handshake [length 0059], ServerHello 
(24) eap_peap: TLS_accept: SSLv3 write server hello A
(24) eap_peap: >>> TLS 1.0 Handshake [length 08d3], Certificate 
(24) eap_peap: TLS_accept: SSLv3 write certificate A
(24) eap_peap: >>> TLS 1.0 Handshake [length 014b], ServerKeyExchange 
(24) eap_peap: TLS_accept: SSLv3 write key exchange A
(24) eap_peap: >>> TLS 1.0 Handshake [length 0004], ServerHelloDone 
(24) eap_peap: TLS_accept: SSLv3 write server done A
(24) eap_peap: TLS_accept: SSLv3 flush data
(24) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(24) eap_peap: TLS_accept: Need to read more data: SSLv3 read client certificate A
(24) eap_peap: In SSL Handshake Phase
(24) eap_peap: In SSL Accept mode
(24) eap_peap: [eaptls process] = handled
(24) eap: Sending EAP Request (code 1) ID 28 length 1004
(24) eap: EAP session adding &reply:State = 0x0f38de710d24c707
(24)     [eap] = handled
(24)   } # authenticate = handled
(24) Using Post-Auth-Type Challenge
(24) Post-Auth-Type sub-section not found.  Ignoring.
(24) # Executing group from file /etc/freeradius/sites-enabled/default
(24) Sent Access-Challenge Id 190 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(24)   EAP-Message = 0x011c03ec19c000000a8f1603010059020000550301e1d0d2bc6cda5237d63f5c83b94632f80fc15dd681fa346977271569cbf2a24f20b6918f49f07bd6e9c61a6bbc3a12f989b9e8d6f31f2c59c229ac156d37ba8db1c01400000dff01000100000b00040300010216030108d30b0008cf0008cc0003de
(24)   Message-Authenticator = 0x00000000000000000000000000000000
(24)   State = 0x0f38de710d24c70770c94d6db95ea3e7
(24) Finished request
Thread 1 waiting to be assigned a request
Thread 5 got semaphore
Thread 5 handling request 25, (6 handled so far)
(25) <running>: Received Access-Request Id 191 from 192.168.1.30:50046 to 172.17.0.4:1812 length 202
(25) <running>:   User-Name = "emiruss"
(25) <running>:   NAS-IP-Address = 192.168.1.30
(25) <running>:   NAS-Identifier = "Ericsson"
(25) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(25) <running>:   NAS-Port-Type = Wireless-802.11
(25) <running>:   NAS-Port = 0
(25) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(25) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(25) <running>:   Acct-Session-Id = "003E2DE6-00000054"
(25) <running>:   Framed-MTU = 1400
(25) <running>:   EAP-Message = 0x021c00061900
(25) <running>:   State = 0x0f38de710d24c70770c94d6db95ea3e7
(25) <running>:   Message-Authenticator = 0x996d9d986c8ded918fde69f3ef01e139
(25) <running>: session-state: No cached attributes
(25) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(25) <running>:   authorize {
(25) <running>:     policy filter_username {
(25) <running>:       if (!&User-Name) {
(25) <running>:       if (!&User-Name)  -> FALSE
(25) <running>:       if (&User-Name =~ / /) {
(25) <running>:       if (&User-Name =~ / /)  -> FALSE
(25) <running>:       if (&User-Name =~ /@.*@/ ) {
(25) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(25) <running>:       if (&User-Name =~ /\.\./ ) {
(25) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(25) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(25) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(25) <running>:       if (&User-Name =~ /\.$/)  {
(25) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(25) <running>:       if (&User-Name =~ /@\./)  {
(25) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(25) <running>:     } # policy filter_username = notfound
(25)     [preprocess] = ok
(25)     [chap] = noop
(25)     [mschap] = noop
(25)     [digest] = noop
(25) suffix: Checking for suffix after "@"
(25) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(25) suffix: No such realm "NULL"
(25)     [suffix] = noop
(25) eap: Peer sent EAP Response (code 2) ID 28 length 6
(25) eap: Continuing tunnel setup
(25)     [eap] = ok
(25)   } # authorize = ok
(25) Found Auth-Type = EAP
(25) # Executing group from file /etc/freeradius/sites-enabled/default
(25)   authenticate {
(25) eap: Expiring EAP session with state 0x0f38de710d24c707
(25) eap: Finished EAP session with state 0x0f38de710d24c707
(25) eap: Previous EAP request found for state 0x0f38de710d24c707, released from the list
(25) eap: Peer sent packet with method EAP PEAP (25)
(25) eap: Calling submodule eap_peap to process data
(25) eap_peap: Continuing EAP-TLS
(25) eap_peap: Peer ACKed our handshake fragment
(25) eap_peap: [eaptls verify] = request
(25) eap_peap: [eaptls process] = handled
(25) eap: Sending EAP Request (code 1) ID 29 length 1000
(25) eap: EAP session adding &reply:State = 0x0f38de710c25c707
(25)     [eap] = handled
(25)   } # authenticate = handled
(25) Using Post-Auth-Type Challenge
(25) Post-Auth-Type sub-section not found.  Ignoring.
(25) # Executing group from file /etc/freeradius/sites-enabled/default
(25) Sent Access-Challenge Id 191 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(25)   EAP-Message = 0x011d03e819400dd0405955c762981948527048701681d313d3cc6629a5557b66df2aae22c8590ab99d66ec8d3792a72e30596410f5d1e81f5a774969a1ce9ad6bd01d42da65536016e80a905c662a71ef5c075b8bdf0127a0cf1bd4c91290e15edffa035febde0185096bdc1e553090004e8308204e430
(25)   Message-Authenticator = 0x00000000000000000000000000000000
(25)   State = 0x0f38de710c25c70770c94d6db95ea3e7
(25) Finished request
Thread 5 waiting to be assigned a request
Thread 4 got semaphore
Thread 4 handling request 26, (6 handled so far)
(26) <running>: Received Access-Request Id 192 from 192.168.1.30:50046 to 172.17.0.4:1812 length 202
(26) <running>:   User-Name = "emiruss"
(26) <running>:   NAS-IP-Address = 192.168.1.30
(26) <running>:   NAS-Identifier = "Ericsson"
(26) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(26) <running>:   NAS-Port-Type = Wireless-802.11
(26) <running>:   NAS-Port = 0
(26) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(26) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(26) <running>:   Acct-Session-Id = "003E2DE6-00000054"
(26) <running>:   Framed-MTU = 1400
(26) <running>:   EAP-Message = 0x021d00061900
(26) <running>:   State = 0x0f38de710c25c70770c94d6db95ea3e7
(26) <running>:   Message-Authenticator = 0xbb34cec2b7d0c9e39c959f6f51152287
(26) <running>: session-state: No cached attributes
(26) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(26) <running>:   authorize {
(26) <running>:     policy filter_username {
(26) <running>:       if (!&User-Name) {
(26) <running>:       if (!&User-Name)  -> FALSE
(26) <running>:       if (&User-Name =~ / /) {
(26) <running>:       if (&User-Name =~ / /)  -> FALSE
(26) <running>:       if (&User-Name =~ /@.*@/ ) {
(26) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(26) <running>:       if (&User-Name =~ /\.\./ ) {
(26) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(26) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(26) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(26) <running>:       if (&User-Name =~ /\.$/)  {
(26) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(26) <running>:       if (&User-Name =~ /@\./)  {
(26) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(26) <running>:     } # policy filter_username = notfound
(26)     [preprocess] = ok
(26)     [chap] = noop
(26)     [mschap] = noop
(26)     [digest] = noop
(26) suffix: Checking for suffix after "@"
(26) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(26) suffix: No such realm "NULL"
(26)     [suffix] = noop
(26) eap: Peer sent EAP Response (code 2) ID 29 length 6
(26) eap: Continuing tunnel setup
(26)     [eap] = ok
(26)   } # authorize = ok
(26) Found Auth-Type = EAP
(26) # Executing group from file /etc/freeradius/sites-enabled/default
(26)   authenticate {
(26) eap: Expiring EAP session with state 0x0f38de710c25c707
(26) eap: Finished EAP session with state 0x0f38de710c25c707
(26) eap: Previous EAP request found for state 0x0f38de710c25c707, released from the list
(26) eap: Peer sent packet with method EAP PEAP (25)
(26) eap: Calling submodule eap_peap to process data
(26) eap_peap: Continuing EAP-TLS
(26) eap_peap: Peer ACKed our handshake fragment
(26) eap_peap: [eaptls verify] = request
(26) eap_peap: [eaptls process] = handled
(26) eap: Sending EAP Request (code 1) ID 30 length 721
(26) eap: EAP session adding &reply:State = 0x0f38de710b26c707
(26)     [eap] = handled
(26)   } # authenticate = handled
(26) Using Post-Auth-Type Challenge
(26) Post-Auth-Type sub-section not found.  Ignoring.
(26) # Executing group from file /etc/freeradius/sites-enabled/default
(26) Sent Access-Challenge Id 192 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(26)   EAP-Message = 0x011e02d1190020417574686f72697479820900c3fc536eef83d741300f0603551d130101ff040530030101ff30360603551d1f042f302d302ba029a0278625687474703a2f2f7777772e6578616d706c652e6f72672f6578616d706c655f63612e63726c300d06092a864886f70d01010b050003820101
(26)   Message-Authenticator = 0x00000000000000000000000000000000
(26)   State = 0x0f38de710b26c70770c94d6db95ea3e7
(26) Finished request
Thread 4 waiting to be assigned a request
Thread 3 got semaphore
Thread 3 handling request 27, (6 handled so far)
(27) <running>: Received Access-Request Id 193 from 192.168.1.30:50046 to 172.17.0.4:1812 length 340
(27) <running>:   User-Name = "emiruss"
(27) <running>:   NAS-IP-Address = 192.168.1.30
(27) <running>:   NAS-Identifier = "Ericsson"
(27) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(27) <running>:   NAS-Port-Type = Wireless-802.11
(27) <running>:   NAS-Port = 0
(27) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(27) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(27) <running>:   Acct-Session-Id = "003E2DE6-00000054"
(27) <running>:   Framed-MTU = 1400
(27) <running>:   EAP-Message = 0x021e009019800000008616030100461000004241049bed6f1a35f6775f866183886a35aa823a68c3b1de4638551faae510fa74838e3b3f2df272869a05f15c6020f73999665d9156de2c2e6d82bd0744a701d441ef140301000101160301003056154de5b0e6fe07a259d975a146e863434bf5f4f8aee5
(27) <running>:   State = 0x0f38de710b26c70770c94d6db95ea3e7
(27) <running>:   Message-Authenticator = 0x4081c1a46dfb7d3a3458571c2aeac279
(27) <running>: session-state: No cached attributes
(27) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(27) <running>:   authorize {
(27) <running>:     policy filter_username {
(27) <running>:       if (!&User-Name) {
(27) <running>:       if (!&User-Name)  -> FALSE
(27) <running>:       if (&User-Name =~ / /) {
(27) <running>:       if (&User-Name =~ / /)  -> FALSE
(27) <running>:       if (&User-Name =~ /@.*@/ ) {
(27) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(27) <running>:       if (&User-Name =~ /\.\./ ) {
(27) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(27) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(27) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(27) <running>:       if (&User-Name =~ /\.$/)  {
(27) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(27) <running>:       if (&User-Name =~ /@\./)  {
(27) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(27) <running>:     } # policy filter_username = notfound
(27)     [preprocess] = ok
(27)     [chap] = noop
(27)     [mschap] = noop
(27)     [digest] = noop
(27) suffix: Checking for suffix after "@"
(27) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(27) suffix: No such realm "NULL"
(27)     [suffix] = noop
(27) eap: Peer sent EAP Response (code 2) ID 30 length 144
(27) eap: Continuing tunnel setup
(27)     [eap] = ok
(27)   } # authorize = ok
(27) Found Auth-Type = EAP
(27) # Executing group from file /etc/freeradius/sites-enabled/default
(27)   authenticate {
(27) eap: Expiring EAP session with state 0x0f38de710b26c707
(27) eap: Finished EAP session with state 0x0f38de710b26c707
(27) eap: Previous EAP request found for state 0x0f38de710b26c707, released from the list
(27) eap: Peer sent packet with method EAP PEAP (25)
(27) eap: Calling submodule eap_peap to process data
(27) eap_peap: Continuing EAP-TLS
(27) eap_peap: Peer indicated complete TLS record size will be 134 bytes
(27) eap_peap: Got complete TLS record (134 bytes)
(27) eap_peap: [eaptls verify] = length included
(27) eap_peap: <<< TLS 1.0 Handshake [length 0046], ClientKeyExchange 
(27) eap_peap: TLS_accept: SSLv3 read client key exchange A
(27) eap_peap: <<< TLS 1.0 ChangeCipherSpec [length 0001] 
(27) eap_peap: <<< TLS 1.0 Handshake [length 0010], Finished 
(27) eap_peap: TLS_accept: SSLv3 read finished A
(27) eap_peap: >>> TLS 1.0 ChangeCipherSpec [length 0001] 
(27) eap_peap: TLS_accept: SSLv3 write change cipher spec A
(27) eap_peap: >>> TLS 1.0 Handshake [length 0010], Finished 
(27) eap_peap: TLS_accept: SSLv3 write finished A
(27) eap_peap: TLS_accept: SSLv3 flush data
(27) eap_peap: (other): SSL negotiation finished successfully
(27) eap_peap: SSL Connection Established
(27) eap_peap: [eaptls process] = handled
(27) eap: Sending EAP Request (code 1) ID 31 length 65
(27) eap: EAP session adding &reply:State = 0x0f38de710a27c707
(27)     [eap] = handled
(27)   } # authenticate = handled
(27) Using Post-Auth-Type Challenge
(27) Post-Auth-Type sub-section not found.  Ignoring.
(27) # Executing group from file /etc/freeradius/sites-enabled/default
(27) Sent Access-Challenge Id 193 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(27)   EAP-Message = 0x011f0041190014030100010116030100304eae64136cacccec50ecfe827db3426bbecefa044bc505194fddd120f8c9528036d1b1177c515e46a15490a19a32a3ee
(27)   Message-Authenticator = 0x00000000000000000000000000000000
(27)   State = 0x0f38de710a27c70770c94d6db95ea3e7
(27) Finished request
Waking up in 0.1 seconds.
Thread 3 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 2 got semaphore
Thread 2 handling request 28, (6 handled so far)
(28) <running>: Received Access-Request Id 194 from 192.168.1.30:50046 to 172.17.0.4:1812 length 202
(28) <running>:   User-Name = "emiruss"
(28) <running>:   NAS-IP-Address = 192.168.1.30
(28) <running>:   NAS-Identifier = "Ericsson"
(28) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(28) <running>:   NAS-Port-Type = Wireless-802.11
(28) <running>:   NAS-Port = 0
(28) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(28) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(28) <running>:   Acct-Session-Id = "003E2DE6-00000054"
(28) <running>:   Framed-MTU = 1400
(28) <running>:   EAP-Message = 0x021f00061900
(28) <running>:   State = 0x0f38de710a27c70770c94d6db95ea3e7
(28) <running>:   Message-Authenticator = 0x82ef595d73623f8e5bfcd292e3674e50
(28) <running>: session-state: No cached attributes
(28) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(28) <running>:   authorize {
(28) <running>:     policy filter_username {
(28) <running>:       if (!&User-Name) {
(28) <running>:       if (!&User-Name)  -> FALSE
(28) <running>:       if (&User-Name =~ / /) {
(28) <running>:       if (&User-Name =~ / /)  -> FALSE
(28) <running>:       if (&User-Name =~ /@.*@/ ) {
(28) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(28) <running>:       if (&User-Name =~ /\.\./ ) {
(28) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(28) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(28) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(28) <running>:       if (&User-Name =~ /\.$/)  {
(28) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(28) <running>:       if (&User-Name =~ /@\./)  {
(28) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(28) <running>:     } # policy filter_username = notfound
(28)     [preprocess] = ok
(28)     [chap] = noop
(28)     [mschap] = noop
(28)     [digest] = noop
(28) suffix: Checking for suffix after "@"
(28) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(28) suffix: No such realm "NULL"
(28)     [suffix] = noop
(28) eap: Peer sent EAP Response (code 2) ID 31 length 6
(28) eap: Continuing tunnel setup
(28)     [eap] = ok
(28)   } # authorize = ok
(28) Found Auth-Type = EAP
(28) # Executing group from file /etc/freeradius/sites-enabled/default
(28)   authenticate {
(28) eap: Expiring EAP session with state 0x0f38de710a27c707
(28) eap: Finished EAP session with state 0x0f38de710a27c707
(28) eap: Previous EAP request found for state 0x0f38de710a27c707, released from the list
(28) eap: Peer sent packet with method EAP PEAP (25)
(28) eap: Calling submodule eap_peap to process data
(28) eap_peap: Continuing EAP-TLS
(28) eap_peap: Peer ACKed our handshake fragment.  handshake is finished
(28) eap_peap: [eaptls verify] = success
(28) eap_peap: [eaptls process] = success
(28) eap_peap: Session established.  Decoding tunneled attributes
(28) eap_peap: PEAP state TUNNEL ESTABLISHED
(28) eap: Sending EAP Request (code 1) ID 32 length 43
(28) eap: EAP session adding &reply:State = 0x0f38de710918c707
(28)     [eap] = handled
(28)   } # authenticate = handled
(28) Using Post-Auth-Type Challenge
(28) Post-Auth-Type sub-section not found.  Ignoring.
(28) # Executing group from file /etc/freeradius/sites-enabled/default
(28) Sent Access-Challenge Id 194 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(28)   EAP-Message = 0x0120002b1900170301002088d39fbfe22fd1fa9158e5bc313cfc9a7130ad28fd5f639fc3a561fd01ccd127
(28)   Message-Authenticator = 0x00000000000000000000000000000000
(28)   State = 0x0f38de710918c70770c94d6db95ea3e7
(28) Finished request
Thread 2 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 1 got semaphore
Thread 1 handling request 29, (6 handled so far)
(29) <running>: Received Access-Request Id 195 from 192.168.1.30:50046 to 172.17.0.4:1812 length 239
(29) <running>:   User-Name = "emiruss"
(29) <running>:   NAS-IP-Address = 192.168.1.30
(29) <running>:   NAS-Identifier = "Ericsson"
(29) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(29) <running>:   NAS-Port-Type = Wireless-802.11
(29) <running>:   NAS-Port = 0
(29) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(29) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(29) <running>:   Acct-Session-Id = "003E2DE6-00000054"
(29) <running>:   Framed-MTU = 1400
(29) <running>:   EAP-Message = 0x0220002b19001703010020c62c4574770b259e12c6d640a909e4d4bf4aaf38383d3f02df8789a006a71586
(29) <running>:   State = 0x0f38de710918c70770c94d6db95ea3e7
(29) <running>:   Message-Authenticator = 0x4af498665961864413ef3fd1f62f5c49
(29) <running>: session-state: No cached attributes
(29) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(29) <running>:   authorize {
(29) <running>:     policy filter_username {
(29) <running>:       if (!&User-Name) {
(29) <running>:       if (!&User-Name)  -> FALSE
(29) <running>:       if (&User-Name =~ / /) {
(29) <running>:       if (&User-Name =~ / /)  -> FALSE
(29) <running>:       if (&User-Name =~ /@.*@/ ) {
(29) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(29) <running>:       if (&User-Name =~ /\.\./ ) {
(29) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(29) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(29) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(29) <running>:       if (&User-Name =~ /\.$/)  {
(29) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(29) <running>:       if (&User-Name =~ /@\./)  {
(29) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(29) <running>:     } # policy filter_username = notfound
(29)     [preprocess] = ok
(29)     [chap] = noop
(29)     [mschap] = noop
(29)     [digest] = noop
(29) suffix: Checking for suffix after "@"
(29) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(29) suffix: No such realm "NULL"
(29)     [suffix] = noop
(29) eap: Peer sent EAP Response (code 2) ID 32 length 43
(29) eap: Continuing tunnel setup
(29)     [eap] = ok
(29)   } # authorize = ok
(29) Found Auth-Type = EAP
(29) # Executing group from file /etc/freeradius/sites-enabled/default
(29)   authenticate {
(29) eap: Expiring EAP session with state 0x0f38de710918c707
(29) eap: Finished EAP session with state 0x0f38de710918c707
(29) eap: Previous EAP request found for state 0x0f38de710918c707, released from the list
(29) eap: Peer sent packet with method EAP PEAP (25)
(29) eap: Calling submodule eap_peap to process data
(29) eap_peap: Continuing EAP-TLS
(29) eap_peap: [eaptls verify] = ok
(29) eap_peap: Done initial handshake
(29) eap_peap: [eaptls process] = ok
(29) eap_peap: Session established.  Decoding tunneled attributes
(29) eap_peap: PEAP state WAITING FOR INNER IDENTITY
(29) eap_peap: Identity - emiruss
(29) eap_peap: Got inner identity 'emiruss'
(29) eap_peap: Setting default EAP type for tunneled EAP session
(29) eap_peap: Got tunneled request
(29) eap_peap:   EAP-Message = 0x0220000c01656d6972757373
(29) eap_peap: Setting User-Name to emiruss
(29) eap_peap: Sending tunneled request to inner-tunnel
(29) eap_peap:   EAP-Message = 0x0220000c01656d6972757373
(29) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(29) eap_peap:   User-Name = "emiruss"
(29) Virtual server inner-tunnel received request
(29)   EAP-Message = 0x0220000c01656d6972757373
(29)   FreeRADIUS-Proxied-To = 127.0.0.1
(29)   User-Name = "emiruss"
(29) server inner-tunnel {
(29)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(29)     authorize {
(29)       [chap] = noop
(29)       [mschap] = noop
(29) suffix: Checking for suffix after "@"
(29) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(29) suffix: No such realm "NULL"
(29)       [suffix] = noop
(29)       update control {
(29)         &Proxy-To-Realm := LOCAL
(29)       } # update control = noop
(29) eap: Peer sent EAP Response (code 2) ID 32 length 12
(29) eap: EAP-Identity reply, returning 'ok' so we can short-circuit the rest of authorize
(29)       [eap] = ok
(29)     } # authorize = ok
(29)   Found Auth-Type = EAP
(29)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(29)     authenticate {
(29) eap: Peer sent packet with method EAP Identity (1)
(29) eap: Calling submodule eap_mschapv2 to process data
(29) eap_mschapv2: Issuing Challenge
(29) eap: Sending EAP Request (code 1) ID 33 length 43
(29) eap: EAP session adding &reply:State = 0x1958188c19790226
(29)       [eap] = handled
(29)     } # authenticate = handled
(29) } # server inner-tunnel
(29) Virtual server sending reply
(29)   EAP-Message = 0x0121002b1a012100261063f5e473a19249987c56b799209967da667265657261646975732d332e302e3130
(29)   Message-Authenticator = 0x00000000000000000000000000000000
(29)   State = 0x1958188c19790226351e9f2ea372209a
(29) eap_peap: Got tunneled reply code 11
(29) eap_peap:   EAP-Message = 0x0121002b1a012100261063f5e473a19249987c56b799209967da667265657261646975732d332e302e3130
(29) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(29) eap_peap:   State = 0x1958188c19790226351e9f2ea372209a
(29) eap_peap: Got tunneled Access-Challenge
(29) eap: Sending EAP Request (code 1) ID 33 length 75
(29) eap: EAP session adding &reply:State = 0x0f38de710819c707
(29)     [eap] = handled
(29)   } # authenticate = handled
(29) Using Post-Auth-Type Challenge
(29) Post-Auth-Type sub-section not found.  Ignoring.
(29) # Executing group from file /etc/freeradius/sites-enabled/default
(29) Sent Access-Challenge Id 195 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(29)   EAP-Message = 0x0121004b19001703010040d6b7b5443c35cfcd84c53373e23ef733aaf72943002f156ade903bb8532e219e31a3bcabcc4bd4ee7a17a3c329a1cd45edcef5eaa40a6cbd81bdb91fdc8875b1
(29)   Message-Authenticator = 0x00000000000000000000000000000000
(29)   State = 0x0f38de710819c70770c94d6db95ea3e7
(29) Finished request
Thread 1 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 5 got semaphore
Thread 5 handling request 30, (7 handled so far)
(30) <running>: Received Access-Request Id 196 from 192.168.1.30:50046 to 172.17.0.4:1812 length 303
(30) <running>:   User-Name = "emiruss"
(30) <running>:   NAS-IP-Address = 192.168.1.30
(30) <running>:   NAS-Identifier = "Ericsson"
(30) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(30) <running>:   NAS-Port-Type = Wireless-802.11
(30) <running>:   NAS-Port = 0
(30) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(30) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(30) <running>:   Acct-Session-Id = "003E2DE6-00000054"
(30) <running>:   Framed-MTU = 1400
(30) <running>:   EAP-Message = 0x0221006b190017030100609c2ec385faf903d78d9c177fa6ac4d886ce4bc7d7f95aed35793216b3b5cf04218c90fb4ce9e1b8af556ffa7a57ef6bdd4d0aecf4ba4c02e9d922568d1af5fd0c7de4c3236a93ecead8f5fd1ca91a43b59e10b3333131a1171a3b0bd5229be58
(30) <running>:   State = 0x0f38de710819c70770c94d6db95ea3e7
(30) <running>:   Message-Authenticator = 0x3e79ce4ff786ed7bc2952c6cc57e4c0e
(30) <running>: session-state: No cached attributes
(30) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(30) <running>:   authorize {
(30) <running>:     policy filter_username {
(30) <running>:       if (!&User-Name) {
(30) <running>:       if (!&User-Name)  -> FALSE
(30) <running>:       if (&User-Name =~ / /) {
(30) <running>:       if (&User-Name =~ / /)  -> FALSE
(30) <running>:       if (&User-Name =~ /@.*@/ ) {
(30) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(30) <running>:       if (&User-Name =~ /\.\./ ) {
(30) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(30) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(30) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(30) <running>:       if (&User-Name =~ /\.$/)  {
(30) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(30) <running>:       if (&User-Name =~ /@\./)  {
(30) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(30) <running>:     } # policy filter_username = notfound
(30)     [preprocess] = ok
(30)     [chap] = noop
(30)     [mschap] = noop
(30)     [digest] = noop
(30) suffix: Checking for suffix after "@"
(30) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(30) suffix: No such realm "NULL"
(30)     [suffix] = noop
(30) eap: Peer sent EAP Response (code 2) ID 33 length 107
(30) eap: Continuing tunnel setup
(30)     [eap] = ok
(30)   } # authorize = ok
(30) Found Auth-Type = EAP
(30) # Executing group from file /etc/freeradius/sites-enabled/default
(30)   authenticate {
(30) eap: Expiring EAP session with state 0x1958188c19790226
(30) eap: Finished EAP session with state 0x0f38de710819c707
(30) eap: Previous EAP request found for state 0x0f38de710819c707, released from the list
(30) eap: Peer sent packet with method EAP PEAP (25)
(30) eap: Calling submodule eap_peap to process data
(30) eap_peap: Continuing EAP-TLS
(30) eap_peap: [eaptls verify] = ok
(30) eap_peap: Done initial handshake
(30) eap_peap: [eaptls process] = ok
(30) eap_peap: Session established.  Decoding tunneled attributes
(30) eap_peap: PEAP state phase2
(30) eap_peap: EAP method MSCHAPv2 (26)
(30) eap_peap: Got tunneled request
(30) eap_peap:   EAP-Message = 0x022100421a0221003d31d806c5fd1974209dc08a9af1707f97c10000000000000000ceb96fae5f1a064a7da93fbb3091b6bc1d69a5305ea6e30f00656d6972757373
(30) eap_peap: Setting User-Name to emiruss
(30) eap_peap: Sending tunneled request to inner-tunnel
(30) eap_peap:   EAP-Message = 0x022100421a0221003d31d806c5fd1974209dc08a9af1707f97c10000000000000000ceb96fae5f1a064a7da93fbb3091b6bc1d69a5305ea6e30f00656d6972757373
(30) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(30) eap_peap:   User-Name = "emiruss"
(30) eap_peap:   State = 0x1958188c19790226351e9f2ea372209a
(30) Virtual server inner-tunnel received request
(30)   EAP-Message = 0x022100421a0221003d31d806c5fd1974209dc08a9af1707f97c10000000000000000ceb96fae5f1a064a7da93fbb3091b6bc1d69a5305ea6e30f00656d6972757373
(30)   FreeRADIUS-Proxied-To = 127.0.0.1
(30)   User-Name = "emiruss"
(30)   State = 0x1958188c19790226351e9f2ea372209a
(30) server inner-tunnel {
(30)   session-state: No cached attributes
(30)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(30)     authorize {
(30)       [chap] = noop
(30)       [mschap] = noop
(30) suffix: Checking for suffix after "@"
(30) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(30) suffix: No such realm "NULL"
(30)       [suffix] = noop
(30)       update control {
(30)         &Proxy-To-Realm := LOCAL
(30)       } # update control = noop
(30) eap: Peer sent EAP Response (code 2) ID 33 length 66
(30) eap: No EAP Start, assuming it's an on-going EAP conversation
(30)       [eap] = updated
(30)       [files] = noop
(30) sql: EXPAND %{User-Name}
(30) sql:    --> emiruss
(30) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Reserved connection (8)
(30) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(30) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(30) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(30) sql: User found in radcheck table
(30) sql: Conditional check items matched, merging assignment check items
(30) sql:   Cleartext-Password := "emiruss"
(30) sql: EXPAND SELECT id, username, attribute, value, op FROM radreply WHERE username = '%{SQL-User-Name}' ORDER BY id
(30) sql:    --> SELECT id, username, attribute, value, op FROM radreply WHERE username = 'emiruss' ORDER BY id
(30) sql: Executing select query: SELECT id, username, attribute, value, op FROM radreply WHERE username = 'emiruss' ORDER BY id
(30) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(30) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(30) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(30) sql: User not found in any groups
rlm_sql (sql): Released connection (8)
rlm_sql (sql): Need 1 more connections to reach 10 spares
rlm_sql (sql): Opening additional connection (9), 1 of 30 pending slots used
rlm_sql_mysql: Starting connect to MySQL server
rlm_sql_mysql: Connected to database 'radius' on 172.17.0.2 via TCP/IP, server version 5.7.9, protocol version 10
(30)       [sql] = ok
(30)       [expiration] = noop
(30)       [logintime] = noop
(30) pap: WARNING: Auth-Type already set.  Not setting to PAP
(30)       [pap] = noop
(30)     } # authorize = updated
(30)   Found Auth-Type = EAP
(30)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(30)     authenticate {
(30) eap: Expiring EAP session with state 0x1958188c19790226
(30) eap: Finished EAP session with state 0x1958188c19790226
(30) eap: Previous EAP request found for state 0x1958188c19790226, released from the list
(30) eap: Peer sent packet with method EAP MSCHAPv2 (26)
(30) eap: Calling submodule eap_mschapv2 to process data
(30) eap_mschapv2: # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(30) eap_mschapv2:   Auth-Type MS-CHAP {
(30) mschap: Found Cleartext-Password, hashing to create NT-Password
(30) mschap: Found Cleartext-Password, hashing to create LM-Password
(30) mschap: Creating challenge hash with username: emiruss
(30) mschap: Client is using MS-CHAPv2
(30) mschap: Adding MS-CHAPv2 MPPE keys
(30)     [mschap] = ok
(30)   } # Auth-Type MS-CHAP = ok
(30) MSCHAP Success
(30) eap: Sending EAP Request (code 1) ID 34 length 51
(30) eap: EAP session adding &reply:State = 0x1958188c187a0226
(30)       [eap] = handled
(30)     } # authenticate = handled
(30) } # server inner-tunnel
(30) Virtual server sending reply
(30)   EAP-Message = 0x012200331a0321002e533d30334342384344364237384432313735464331334643423345334636383934363934363442353637
(30)   Message-Authenticator = 0x00000000000000000000000000000000
(30)   State = 0x1958188c187a0226351e9f2ea372209a
(30) eap_peap: Got tunneled reply code 11
(30) eap_peap:   EAP-Message = 0x012200331a0321002e533d30334342384344364237384432313735464331334643423345334636383934363934363442353637
(30) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(30) eap_peap:   State = 0x1958188c187a0226351e9f2ea372209a
(30) eap_peap: Got tunneled Access-Challenge
(30) eap: Sending EAP Request (code 1) ID 34 length 91
(30) eap: EAP session adding &reply:State = 0x0f38de71071ac707
(30)     [eap] = handled
(30)   } # authenticate = handled
(30) Using Post-Auth-Type Challenge
(30) Post-Auth-Type sub-section not found.  Ignoring.
(30) # Executing group from file /etc/freeradius/sites-enabled/default
(30) Sent Access-Challenge Id 196 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(30)   EAP-Message = 0x0122005b1900170301005083d4c2bbd1ed024da01a95c808306ba2b80d14dbbca1f9cda3d63e51f8ba40619cb4c8d33f5955d4bcc1665c4a350472c5d928115ae10a8805c0a580c7a7d13f2acf7812ad06d1bbbbab23498fb9deb3
(30)   Message-Authenticator = 0x00000000000000000000000000000000
(30)   State = 0x0f38de71071ac70770c94d6db95ea3e7
(30) Finished request
Thread 5 waiting to be assigned a request
Waking up in 0.1 seconds.
Thread 4 got semaphore
Thread 4 handling request 31, (7 handled so far)
(31) <running>: Received Access-Request Id 197 from 192.168.1.30:50046 to 172.17.0.4:1812 length 239
(31) <running>:   User-Name = "emiruss"
(31) <running>:   NAS-IP-Address = 192.168.1.30
(31) <running>:   NAS-Identifier = "Ericsson"
(31) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(31) <running>:   NAS-Port-Type = Wireless-802.11
(31) <running>:   NAS-Port = 0
(31) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(31) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(31) <running>:   Acct-Session-Id = "003E2DE6-00000054"
(31) <running>:   Framed-MTU = 1400
(31) <running>:   EAP-Message = 0x0222002b19001703010020896d4cf43d8a3cf41b32a58aff4269affb18d2947e3170011c6bd7164f392450
(31) <running>:   State = 0x0f38de71071ac70770c94d6db95ea3e7
(31) <running>:   Message-Authenticator = 0xf17b2881fdb24271283f8dd7cc7bce17
(31) <running>: session-state: No cached attributes
(31) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(31) <running>:   authorize {
(31) <running>:     policy filter_username {
(31) <running>:       if (!&User-Name) {
(31) <running>:       if (!&User-Name)  -> FALSE
(31) <running>:       if (&User-Name =~ / /) {
(31) <running>:       if (&User-Name =~ / /)  -> FALSE
(31) <running>:       if (&User-Name =~ /@.*@/ ) {
(31) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(31) <running>:       if (&User-Name =~ /\.\./ ) {
(31) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(31) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(31) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(31) <running>:       if (&User-Name =~ /\.$/)  {
(31) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(31) <running>:       if (&User-Name =~ /@\./)  {
(31) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(31) <running>:     } # policy filter_username = notfound
(31)     [preprocess] = ok
(31)     [chap] = noop
(31)     [mschap] = noop
(31)     [digest] = noop
(31) suffix: Checking for suffix after "@"
(31) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(31) suffix: No such realm "NULL"
(31)     [suffix] = noop
(31) eap: Peer sent EAP Response (code 2) ID 34 length 43
(31) eap: Continuing tunnel setup
(31)     [eap] = ok
(31)   } # authorize = ok
(31) Found Auth-Type = EAP
(31) # Executing group from file /etc/freeradius/sites-enabled/default
(31)   authenticate {
(31) eap: Expiring EAP session with state 0x1958188c187a0226
(31) eap: Finished EAP session with state 0x0f38de71071ac707
(31) eap: Previous EAP request found for state 0x0f38de71071ac707, released from the list
(31) eap: Peer sent packet with method EAP PEAP (25)
(31) eap: Calling submodule eap_peap to process data
(31) eap_peap: Continuing EAP-TLS
(31) eap_peap: [eaptls verify] = ok
(31) eap_peap: Done initial handshake
(31) eap_peap: [eaptls process] = ok
(31) eap_peap: Session established.  Decoding tunneled attributes
(31) eap_peap: PEAP state phase2
(31) eap_peap: EAP method MSCHAPv2 (26)
(31) eap_peap: Got tunneled request
(31) eap_peap:   EAP-Message = 0x022200061a03
(31) eap_peap: Setting User-Name to emiruss
(31) eap_peap: Sending tunneled request to inner-tunnel
(31) eap_peap:   EAP-Message = 0x022200061a03
(31) eap_peap:   FreeRADIUS-Proxied-To = 127.0.0.1
(31) eap_peap:   User-Name = "emiruss"
(31) eap_peap:   State = 0x1958188c187a0226351e9f2ea372209a
(31) Virtual server inner-tunnel received request
(31)   EAP-Message = 0x022200061a03
(31)   FreeRADIUS-Proxied-To = 127.0.0.1
(31)   User-Name = "emiruss"
(31)   State = 0x1958188c187a0226351e9f2ea372209a
(31) server inner-tunnel {
(31)   session-state: No cached attributes
(31)   # Executing section authorize from file /etc/freeradius/sites-enabled/inner-tunnel
(31)     authorize {
(31)       [chap] = noop
(31)       [mschap] = noop
(31) suffix: Checking for suffix after "@"
(31) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(31) suffix: No such realm "NULL"
(31)       [suffix] = noop
(31)       update control {
(31)         &Proxy-To-Realm := LOCAL
(31)       } # update control = noop
(31) eap: Peer sent EAP Response (code 2) ID 34 length 6
(31) eap: No EAP Start, assuming it's an on-going EAP conversation
(31)       [eap] = updated
(31)       [files] = noop
(31) sql: EXPAND %{User-Name}
(31) sql:    --> emiruss
(31) sql: SQL-User-Name set to 'emiruss'
rlm_sql (sql): Reserved connection (7)
(31) sql: EXPAND SELECT id, username, attribute, value, op FROM radcheck WHERE username = '%{SQL-User-Name}' ORDER BY id
(31) sql:    --> SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(31) sql: Executing select query: SELECT id, username, attribute, value, op FROM radcheck WHERE username = 'emiruss' ORDER BY id
(31) sql: User found in radcheck table
(31) sql: Conditional check items matched, merging assignment check items
(31) sql:   Cleartext-Password := "emiruss"
(31) sql: EXPAND SELECT id, username, attribute, value, op FROM radreply WHERE username = '%{SQL-User-Name}' ORDER BY id
(31) sql:    --> SELECT id, username, attribute, value, op FROM radreply WHERE username = 'emiruss' ORDER BY id
(31) sql: Executing select query: SELECT id, username, attribute, value, op FROM radreply WHERE username = 'emiruss' ORDER BY id
(31) sql: EXPAND SELECT groupname FROM radusergroup WHERE username = '%{SQL-User-Name}' ORDER BY priority
(31) sql:    --> SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(31) sql: Executing select query: SELECT groupname FROM radusergroup WHERE username = 'emiruss' ORDER BY priority
(31) sql: User not found in any groups
rlm_sql (sql): Released connection (7)
(31)       [sql] = ok
(31)       [expiration] = noop
(31)       [logintime] = noop
(31) pap: WARNING: Auth-Type already set.  Not setting to PAP
(31)       [pap] = noop
(31)     } # authorize = updated
(31)   Found Auth-Type = EAP
(31)   # Executing group from file /etc/freeradius/sites-enabled/inner-tunnel
(31)     authenticate {
(31) eap: Expiring EAP session with state 0x1958188c187a0226
(31) eap: Finished EAP session with state 0x1958188c187a0226
(31) eap: Previous EAP request found for state 0x1958188c187a0226, released from the list
(31) eap: Peer sent packet with method EAP MSCHAPv2 (26)
(31) eap: Calling submodule eap_mschapv2 to process data
(31) eap: Sending EAP Success (code 3) ID 34 length 4
(31) eap: Freeing handler
(31)       [eap] = ok
(31)     } # authenticate = ok
(31)   # Executing section post-auth from file /etc/freeradius/sites-enabled/inner-tunnel
(31)     post-auth {
(31) sql: EXPAND .query
(31) sql:    --> .query
(31) sql: Using query template 'query'
rlm_sql (sql): Reserved connection (8)
(31) sql: EXPAND %{User-Name}
(31) sql:    --> emiruss
(31) sql: SQL-User-Name set to 'emiruss'
(31) sql: EXPAND INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')
(31) sql:    --> INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Accept', '2015-11-25 22:20:57')
(31) sql: Executing query: INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Accept', '2015-11-25 22:20:57')
(31) sql: SQL query returned: success
(31) sql: 1 record(s) updated
rlm_sql (sql): Released connection (8)
(31)       [sql] = ok
(31)     } # post-auth = ok
(31) } # server inner-tunnel
(31) Virtual server sending reply
(31)   MS-MPPE-Encryption-Policy = Encryption-Allowed
(31)   MS-MPPE-Encryption-Types = RC4-40or128-bit-Allowed
(31)   MS-MPPE-Send-Key = 0x4ddaed799d4a288ed55a022917bab668
(31)   MS-MPPE-Recv-Key = 0x0fe780e9a39bd3a50012a4ea47be7164
(31)   EAP-Message = 0x03220004
(31)   Message-Authenticator = 0x00000000000000000000000000000000
(31)   User-Name = "emiruss"
(31) eap_peap: Got tunneled reply code 2
(31) eap_peap:   MS-MPPE-Encryption-Policy = Encryption-Allowed
(31) eap_peap:   MS-MPPE-Encryption-Types = RC4-40or128-bit-Allowed
(31) eap_peap:   MS-MPPE-Send-Key = 0x4ddaed799d4a288ed55a022917bab668
(31) eap_peap:   MS-MPPE-Recv-Key = 0x0fe780e9a39bd3a50012a4ea47be7164
(31) eap_peap:   EAP-Message = 0x03220004
(31) eap_peap:   Message-Authenticator = 0x00000000000000000000000000000000
(31) eap_peap:   User-Name = "emiruss"
(31) eap_peap: Tunneled authentication was successful
(31) eap_peap: SUCCESS
(31) eap: Sending EAP Request (code 1) ID 35 length 43
(31) eap: EAP session adding &reply:State = 0x0f38de71061bc707
(31)     [eap] = handled
(31)   } # authenticate = handled
(31) Using Post-Auth-Type Challenge
(31) Post-Auth-Type sub-section not found.  Ignoring.
(31) # Executing group from file /etc/freeradius/sites-enabled/default
(31) Sent Access-Challenge Id 197 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(31)   EAP-Message = 0x0123002b190017030100204516146f09fbbc0fce54b5cb4951c07f7e19508f923661278b1b7fc4166b7a71
(31)   Message-Authenticator = 0x00000000000000000000000000000000
(31)   State = 0x0f38de71061bc70770c94d6db95ea3e7
(31) Finished request
Thread 4 waiting to be assigned a request
Thread 3 got semaphore
Thread 3 handling request 32, (7 handled so far)
(32) <running>: Received Access-Request Id 198 from 192.168.1.30:50046 to 172.17.0.4:1812 length 239
(32) <running>:   User-Name = "emiruss"
(32) <running>:   NAS-IP-Address = 192.168.1.30
(32) <running>:   NAS-Identifier = "Ericsson"
(32) <running>:   Called-Station-Id = "00-0D-67-6F-99-58:roocell_radius"
(32) <running>:   NAS-Port-Type = Wireless-802.11
(32) <running>:   NAS-Port = 0
(32) <running>:   Calling-Station-Id = "E4-98-D6-16-D7-64"
(32) <running>:   Connect-Info = "CONNECT 0Mbps 802.11b"
(32) <running>:   Acct-Session-Id = "003E2DE6-00000054"
(32) <running>:   Framed-MTU = 1400
(32) <running>:   EAP-Message = 0x0223002b190017030100203cd1a06fce2ea2cbc4945b2462c54f79ae56e64876119a6c0de0169c615afc73
(32) <running>:   State = 0x0f38de71061bc70770c94d6db95ea3e7
(32) <running>:   Message-Authenticator = 0xc34cbd41af65680194a86142254a16cc
(32) <running>: session-state: No cached attributes
(32) <running>: # Executing section authorize from file /etc/freeradius/sites-enabled/default
(32) <running>:   authorize {
(32) <running>:     policy filter_username {
(32) <running>:       if (!&User-Name) {
(32) <running>:       if (!&User-Name)  -> FALSE
(32) <running>:       if (&User-Name =~ / /) {
(32) <running>:       if (&User-Name =~ / /)  -> FALSE
(32) <running>:       if (&User-Name =~ /@.*@/ ) {
(32) <running>:       if (&User-Name =~ /@.*@/ )  -> FALSE
(32) <running>:       if (&User-Name =~ /\.\./ ) {
(32) <running>:       if (&User-Name =~ /\.\./ )  -> FALSE
(32) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))  {
(32) <running>:       if ((&User-Name =~ /@/) && (&User-Name !~ /@(.+)\.(.+)$/))   -> FALSE
(32) <running>:       if (&User-Name =~ /\.$/)  {
(32) <running>:       if (&User-Name =~ /\.$/)   -> FALSE
(32) <running>:       if (&User-Name =~ /@\./)  {
(32) <running>:       if (&User-Name =~ /@\./)   -> FALSE
(32) <running>:     } # policy filter_username = notfound
(32)     [preprocess] = ok
(32)     [chap] = noop
(32)     [mschap] = noop
(32)     [digest] = noop
(32) suffix: Checking for suffix after "@"
(32) suffix: No '@' in User-Name = "emiruss", looking up realm NULL
(32) suffix: No such realm "NULL"
(32)     [suffix] = noop
(32) eap: Peer sent EAP Response (code 2) ID 35 length 43
(32) eap: Continuing tunnel setup
(32)     [eap] = ok
(32)   } # authorize = ok
(32) Found Auth-Type = EAP
(32) # Executing group from file /etc/freeradius/sites-enabled/default
(32)   authenticate {
(32) eap: Expiring EAP session with state 0x0f38de71061bc707
(32) eap: Finished EAP session with state 0x0f38de71061bc707
(32) eap: Previous EAP request found for state 0x0f38de71061bc707, released from the list
(32) eap: Peer sent packet with method EAP PEAP (25)
(32) eap: Calling submodule eap_peap to process data
(32) eap_peap: Continuing EAP-TLS
(32) eap_peap: [eaptls verify] = ok
(32) eap_peap: Done initial handshake
(32) eap_peap: [eaptls process] = ok
(32) eap_peap: Session established.  Decoding tunneled attributes
(32) eap_peap: PEAP state send tlv success
(32) eap_peap: Received EAP-TLV response
(32) eap_peap: Success
(32) eap_peap: No information to cache: session caching will be disabled for session b6918f49f07bd6e9c61a6bbc3a12f989b9e8d6f31f2c59c229ac156d37ba8db1
(32) eap: Sending EAP Success (code 3) ID 35 length 4
(32) eap: Freeing handler
(32)     [eap] = ok
(32)   } # authenticate = ok
(32) # Executing section post-auth from file /etc/freeradius/sites-enabled/default
(32)   post-auth {
(32)     update {
(32)       No attributes updated
(32)     } # update = noop
(32) sql: EXPAND .query
(32) sql:    --> .query
(32) sql: Using query template 'query'
rlm_sql (sql): Reserved connection (9)
(32) sql: EXPAND %{User-Name}
(32) sql:    --> emiruss
(32) sql: SQL-User-Name set to 'emiruss'
(32) sql: EXPAND INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', '%S')
(32) sql:    --> INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Accept', '2015-11-25 22:20:57')
(32) sql: Executing query: INSERT INTO radpostauth (username, pass, reply, authdate) VALUES ( 'emiruss', '', 'Access-Accept', '2015-11-25 22:20:57')
(32) sql: SQL query returned: success
(32) sql: 1 record(s) updated
rlm_sql (sql): Released connection (9)
(32)     [sql] = ok
(32)     [exec] = noop
(32)     policy remove_reply_message_if_eap {
(32)       if (&reply:EAP-Message && &reply:Reply-Message) {
(32)       if (&reply:EAP-Message && &reply:Reply-Message)  -> FALSE
(32)       else {
(32)         [noop] = noop
(32)       } # else = noop
(32)     } # policy remove_reply_message_if_eap = noop
(32)   } # post-auth = ok
(32) Sent Access-Accept Id 198 from 172.17.0.4:1812 to 192.168.1.30:50046 length 0
(32)   MS-MPPE-Recv-Key = 0xdffb8f1701d67a7de141a0a252a94c5fe0d42a4cffc3aaef533a46d8942f0228
(32)   MS-MPPE-Send-Key = 0xe90f2dbcc639fde2ed5fa3170d1a7913dddf342ad9988c9afa1dc085863af179
(32)   EAP-Message = 0x03230004
(32)   Message-Authenticator = 0x00000000000000000000000000000000
(32)   User-Name = "emiruss"
(32) Finished request
Thread 3 waiting to be assigned a request
Waking up in 3.7 seconds.
(11) Cleaning up request packet ID 177 with timestamp +67491
Waking up in 0.1 seconds.
(12) Cleaning up request packet ID 178 with timestamp +67491
(13) Cleaning up request packet ID 179 with timestamp +67491
(14) Cleaning up request packet ID 180 with timestamp +67491
(15) Cleaning up request packet ID 181 with timestamp +67491
(16) Cleaning up request packet ID 182 with timestamp +67491
(17) Cleaning up request packet ID 183 with timestamp +67491
(18) Cleaning up request packet ID 184 with timestamp +67491
(19) Cleaning up request packet ID 185 with timestamp +67491
(20) Cleaning up request packet ID 186 with timestamp +67491
(21) Cleaning up request packet ID 187 with timestamp +67491
Waking up in 0.1 seconds.
(22) Cleaning up request packet ID 188 with timestamp +67491
(23) Cleaning up request packet ID 189 with timestamp +67491
(24) Cleaning up request packet ID 190 with timestamp +67492
(25) Cleaning up request packet ID 191 with timestamp +67492
(26) Cleaning up request packet ID 192 with timestamp +67492
(27) Cleaning up request packet ID 193 with timestamp +67492
(28) Cleaning up request packet ID 194 with timestamp +67492
(29) Cleaning up request packet ID 195 with timestamp +67492
(30) Cleaning up request packet ID 196 with timestamp +67492
(31) Cleaning up request packet ID 197 with timestamp +67492
(32) Cleaning up request packet ID 198 with timestamp +67492
Ready to process requests
